// ==UserScript==
// @name         Image Max URL
// @namespace    http://tampermonkey.net/
// @version      0.7.6
// @description  Finds larger or original versions of images
// @author       qsniyg
// @include      *
// @grant        GM.xmlHttpRequest
// @grant        GM_xmlhttpRequest
// @grant        GM.setValue
// @grant        GM_setValue
// @grant        GM.getValue
// @grant        GM_getValue
// @connect      *
// @run-at       document-start
// @license      Apache 2.0
// ==/UserScript==

// If you see "A userscript wants to access a cross-origin resource.",
//   it's either used to detect whether or not the destination URL exists before redirecting (near the end of the script),
//   or used to query flickr's API to get larger images.
// Search for GM_xmlhttpRequest and do_request if you want to see what the code does exactly.


var $$IMU_EXPORT$$;

(function() {
    'use strict';

    var _nir_debug_ = false;

    if (_nir_debug_) {
        _nir_debug_ = {
            no_request: false
        };
    }

    var is_extension = false;
    var is_webextension = false;
    var extension_send_message = null;
    var extension_options_page = null;
    var is_extension_options_page = false;
    try {
        var extension_manifest = chrome.runtime.getManifest();
        is_extension = extension_manifest.name === "Image Max URL";

        extension_options_page = chrome.runtime.getURL("extension/options.html");
        is_extension_options_page = document.location.href.replace(/[?#].*$/, "") === extension_options_page;

        if (is_extension) {
            extension_send_message = function(message, respond) {
                message = deepcopy(message, {json:true});
                return chrome.runtime.sendMessage(null, message, null, respond);
            };
        }
    } catch (e) {
    }

    var do_request = null;
    if (is_extension) {
        do_request = function(data) {
            var onload = data.onload;
            var onerror = data.onerror;

            extension_send_message({
                type: "request",
                data: data
            }, function (response) {
                if (response.data.responseType === "blob") {
                    var enc = response.data._responseEncoded;
                    var array = new Uint8Array(enc.value.length);
                    for (var i = 0; i < enc.value.length; i++) {
                        array[i] = enc.value.charCodeAt(i);
                    }
                    response.data.response = new Blob([array.buffer], { type: enc.type });
                }

                if (response.type === "onload")
                    onload(response.data);
                else if (response.type === "onerror" && response.onerror)
                    onerror(response.data);
            });
        };
    } else if (typeof(GM_xmlhttpRequest) !== "undefined") {
        do_request = GM_xmlhttpRequest;
    } else if (typeof(GM) !== "undefined" && typeof(GM.xmlHttpRequest) !== "undefined") {
        do_request = GM.xmlHttpRequest;
    }

    var default_options = {
        fill_object: true,
        null_if_no_change: false,
        use_cache: true,
        iterations: 200,
        exclude_problems: [
            "watermark",
            "smaller"
        ],
        include_pastobjs: true,

        do_request: do_request,
        host_url: null,
        document: null,
        window: null,
        element: null,

        cb: null
    };

    var default_object = {
        url: null,
        always_ok: false,
        can_head: true,
        head_ok_errors: [],
        head_wrong_contenttype: false,
        head_wrong_contentlength: false,
        waiting: false,
        redirects: false,
        bad: false,
        headers: {},
        extra: {},
        problems: {
            watermark: false,
            smaller: false
        }
    };

    var options_page = "https://qsniyg.github.io/maxurl/options.html";

    // restore console.log for websites that remove it (twitter)
    // https://gist.github.com/Ivanca/4586071
    //var console_log = function(){ return window.console.__proto__.log.apply(console, arguments) } ;
    //var console_error = function(){ return window.console.__proto__.error.apply(console, arguments) } ;

    // since the userscript is run first, this generally shouldn't be a problem
    var console_log = console.log;
    var console_error = console.error;
    var JSON_stringify = JSON.stringify;
    var JSON_parse = JSON.parse;

    function deepcopy(x, options) {
        if (!options)
            options = {};
        if (!options.history)
            options.history = [];

        if (typeof x === "object") {
            if (options.history.indexOf(x) >= 0)
                return;
            else
                options.history.push(x);
        }

        if (typeof x === "string") {
            return x;
        } else if ((typeof Element !== "undefined" && x instanceof Element) ||
                   (x && typeof x === "object" && (("namespaceURI" in x) && ("ariaSort" in x)))) {
            if (options.json) {
                return undefined;
            } else {
                return x;
            }
        } else if (typeof x === "function") {
            if (options.json) {
                return undefined;
            } else {
                return x;
            }
        } else if (x instanceof Array) {
            var result = [];
            x.forEach(function (item) {
                result.push(deepcopy(item, options));
            });
            return result;
        } else if (typeof x === "object") {
            var result = {};
            for (var key in x) {
                result[key] = deepcopy(x[key], options);
            }
            return result;
        } else {
            return x;
        }
    }


    var settings = {
        redirect: true,
        redirect_history: true,
        mouseover: true,
        mouseover_trigger: ["ctrl", "shift"],
        // thanks to blue-lightning on github for the idea
        mouseover_open_behavior: "popup",
        // also thanks to blue-lightning
        mouseover_close_behavior: "any",
        // thanks to acid-crash on github for the idea
        mouseover_styles: "",
        website_image: true,
        allow_watermark: false,
        allow_smaller: false
    };
    var orig_settings = deepcopy(settings);

    var settings_meta = {
        redirect: {
            name: "Enable redirection",
            description: "Redirect images opened in their own tab"
        },
        redirect_history: {
            name: "Add to history",
            description: "Redirection will add a new entry to the browser's history",
            requires: {
                redirect: true
            }
        },
        mouseover: {
            name: "Enable mouseover popup",
            description: "Show a popup with the larger image when you mouseover an image with the trigger key held"
        },
        mouseover_trigger: {
            name: "Mouseover popup trigger",
            description: "Trigger key that, when held, will show the popup",
            options: {
                _type: "and",
                _group1: {
                    _type: "and",
                    ctrl: {
                        name: "Ctrl"
                    },
                    shift: {
                        name: "Shift"
                    },
                    alt: {
                        name: "Alt"
                    }
                },
                _group2: {
                    _type: "or",
                    delay_1: {
                        name: "Delay 1s"
                    },
                    delay_3: {
                        name: "Delay 3s"
                    }
                }
            },
            requires: {
                mouseover: true
            }
        },
        mouseover_open_behavior: {
            name: "Mouseover popup action",
            description: "Determines how the mouseover popup will open",
            extension_only: true,
            options: {
                _type: "or",
                popup: {
                    name: "Popup"
                },
                newtab: {
                    name: "New tab"
                }
            },
            requires: {
                mouseover: true
            }
        },
        mouseover_close_behavior: {
            name: "Keep popup open until",
            description: "Closes the popup when the selected condition is met",
            options: {
                _type: "or",
                _group1: {
                    any: {
                        name: "Any trigger is released"
                    }
                },
                _group2: {
                    all: {
                        name: "All triggers are released"
                    }
                }
            },
            requires: {
                mouseover: true
            }
        },
        mouseover_styles: {
            name: "Popup CSS style",
            description: "CSS style rules for the mouseover popup",
            type: "textarea"
        },
        website_image: {
            name: "Website image preview",
            description: "Enables a preview of the image on the website",
            userscript_only: true
        },
        allow_watermark: {
            name: "Larger watermarked images",
            description: "Enables rules that return larger images that include watermarks"
        },
        allow_smaller: {
            name: "Smaller non-watermarked images",
            description: "Enables rules that return smaller images without watermarks"
        }
    };

    var option_to_problems = {
        allow_watermark: "watermark",
        allow_smaller: "smaller"
    };


    var url_cache = {};


    var is_node = false;
    if ((typeof module !== 'undefined' && module.exports) &&
        typeof window === 'undefined' && typeof document === 'undefined') {
        is_node = true;
    }

    var urlparse = function(x) {
        return new URL(x);
    };

    if (is_node && typeof URL === 'undefined') {
        var url = require("url");
        urlparse = function(x) {
            var parsed = url.parse(x);
            parsed.searchParams = new Map();
            if (parsed.query) {
                parsed.query.split("&").forEach(function (query) {
                    var splitted = query.split("=");
                    parsed.searchParams.set(splitted[0], splitted[1]);
                });
            }
            return parsed;
        };
    }

    var is_scripttag = false;
    if (typeof imu_variable !== 'undefined' && (typeof(GM_xmlhttpRequest) === 'undefined' &&
                                                typeof(GM) === 'undefined'))
        is_scripttag = true;

    var is_userscript = false;
    if (!is_node && !is_scripttag && !is_extension)
        is_userscript = true;

    // https://stackoverflow.com/a/17323608
    function mod(n, m) {
        return ((n % m) + m) % m;
    }

    function urlsplit(a) {
        var protocol_split = a.split("://");
        var protocol = protocol_split[0];
        var splitted = protocol_split[1].split("/");
        var domain = splitted[0];
        var start = protocol + "://" + domain;
        return {
            protocol: protocol,
            domain: domain,
            url: a
        };
    }

    function urljoin(a, b, browser) {
        if (b.length === 0)
            return a;
        if (b.match(/[a-z]*:\/\//) || b.match(/^data:/))
            return b;

        var protocol_split = a.split("://");
        var protocol = protocol_split[0];
        var splitted = protocol_split[1].split("/");
        var domain = splitted[0];
        var start = protocol + "://" + domain;

        if (b.length >= 2 && b.slice(0, 2) === "//")
            return protocol + ":" + b;
        if (b.length >= 1 && b.slice(0, 1) === "/")
            return start + b;

        if (!browser) {
            // simple path join
            // urljoin("http://site.com/index.html", "file.png") = "http://site.com/index.html/file.png"
            return a + "/" + b;
        } else {
            // to emulate the browser's behavior instead
            // urljoin("http://site.com/index.html", "file.png") = "http://site.com/file.png"
            if (a.match(/\/$/))
                return a + b.replace(/^\/*/, "");
            else
                //return a.replace(/\/[^/]*$/, "/") + b.replace(/^\/*/, "");
                return a.replace(/^([^?]*)\/.*?$/, "$1/") + b.replace(/^\/*/, "");
        }
    }

    var fullurl = function(url, x) {
        if (x === undefined || x === null)
            return x;

        var a = document.createElement(a);
        a.href = x;
        return a.href;
    };

    var fillobj_urls = function(urls, obj) {
        var newobj = [];
        for (var i = 0; i < urls.length; i++) {
            var currentobj = deepcopy(obj);
            currentobj.url = urls[i];
            newobj.push(currentobj);
        }

        return newobj;
    };

    var add_extensions = function(url) {
        if (url.match(/\.jpg(?:\?.*)?$/)) {
            return [url, url.replace(/\.jpg(\?.*)?$/, ".png$1")];
        } else {
            return [url, url.replace(/\.png(\?.*)?$/, ".jpg$1")];
        }
    };

    var add_extensions_jpeg = function(url) {
        if (url.match(/\.jpeg(?:\?.*)?$/)) {
            return [url, url.replace(/\.jpeg(\?.*)?$/, ".png$1")];
        } else {
            return [url, url.replace(/\.png(\?.*)?$/, ".jpeg$1")];
        }
    };

    var add_extensions_with_jpeg = function(url) {
        if (url.match(/\.jpg(?:\?.*)?$/)) {
            return [url, url.replace(/\.jpg(\?.*)?$/, ".png$1"), , url.replace(/\.jpg(\?.*)?$/, ".jpeg$1")];
        } else if (url.match(/\.jpeg(?:\?.*)?$/)) {
            return [url, url.replace(/\.jpeg(\?.*)?$/, ".png$1"), , url.replace(/\.jpeg(\?.*)?$/, ".jpg$1")];
        } else {
            return [url, url.replace(/\.png(\?.*)?$/, ".jpg$1"), url.replace(/\.png(\?.*)?$/, ".jpeg$1")];
        }
    };

    var add_extensions_gif = function(url) {
        if (url.match(/\.jpg(?:\?.*)?$/)) {
            return [url, url.replace(/\.jpg(\?.*)?$/, ".png$1"), url.replace(/\.jpg(\?.*)?$/, ".gif$1")];
        } else if (url.match(/\.png(?:\?.*)?$/)) {
            return [url, url.replace(/\.png(\?.*)?$/, ".jpg$1"), url.replace(/\.png(\?.*)?$/, ".gif$1")];
        } else if (url.match(/\.gif(?:\?.*)?$/)) {
            return [url, url.replace(/\.gif(\?.*)?$/, ".jpg$1"), url.replace(/\.gif(\?.*)?$/, ".png$1")];
        }
    };

    var add_extensions_upper = function(url) {
        if (url.toLowerCase().match(/\.jpg(?:\?.*)?$/)) {
            if (url.match(/\.jpg(?:\?.*)?$/)) {
                return [url, url.replace(/\.jpg(\?.*)?$/, ".JPG$1"), url.replace(/\.jpg(\?.*)?$/, ".png$1"), url.replace(/\.jpg(\?.*)?$/, ".PNG$1")];
            } else {
                return [url, url.replace(/\.JPG(\?.*)?$/, ".jpg$1"), url.replace(/\.JPG(\?.*)?$/, ".png$1"), url.replace(/\.JPG(\?.*)?$/, ".PNG$1")];
            }
        } else {
            if (url.match(/\.png(?:\?.*)?$/)) {
                return [url, url.replace(/\.png(\?.*)?$/, ".PNG$1"), url.replace(/\.png(\?.*)?$/, ".jpg$1"), url.replace(/\.png(\?.*)?$/, ".JPG$1")];
            } else {
                return [url, url.replace(/\.PNG(\?.*)?$/, ".png$1"), url.replace(/\.PNG(\?.*)?$/, ".jpg$1"), url.replace(/\.PNG(\?.*)?$/, ".JPG$1")];
            }
        }
    };

    var add_http = function(url) {
        if (!url.match(/^[a-z]+:\/\//))
            return "http://" + url;
        return url;
    };

    // bug in chrome, see
    // https://github.com/qsniyg/maxurl/issues/7
    // https://our.umbraco.org/forum/using-umbraco-and-getting-started/91715-js-error-when-aligning-content-left-center-right-justify-in-richtext-editor
    if (is_node || true) {
        fullurl = function(url, x) {
            return urljoin(url, x);
        };
    }


    function bigimage(src, options) {
        if (!src)
            return src;

        // to prevent infinite loops
        if (src.length >= 65536)
            return src;

        var origsrc = src;

        var url = urlparse(src);

        var protocol;
        var domain;
        var port;

        if (!src.match(/^data:/)) {
            var protocol_split = src.split("://");
            protocol = protocol_split[0];
            var splitted = protocol_split[1].split("/");
            domain = splitted[0];

            port = domain.replace(/.*:([0-9]+)$/, "$1");
            if (port === domain)
                port = "";
            domain = domain.replace(/(.*):[0-9]+$/, "$1");
        } else {
            protocol = "data";
            domain = "";
        }

        var domain_nowww = domain.replace(/^www\./, "");
        var domain_nosub = domain.replace(/^.*\.([^.]*\.[^.]*)$/, "$1");
        if (domain_nosub.match(/^co\.[a-z]{2}$/) ||
            domain_nosub.match(/^ne\.jp$/) || // stream.ne.jp
            domain_nosub.match(/^or\.jp$/) ||
            domain_nosub.match(/^com\.[a-z]{2}$/) ||
            domain_nosub.match(/^org\.[a-z]{2}$/) ||
            domain_nosub.match(/^net\.[a-z]{2}$/)) {
            domain_nosub = domain.replace(/^.*\.([^.]*\.[^.]*\.[^.]*)$/, "$1");
        }

        var amazon_container = null;
        if (domain.indexOf(".amazonaws.com") >= 0) {
            // https://timely-api-public.s3.us-west-2.amazonaws.com/116743_phpg7Ixww_small.JPG
            if (domain.match(/^s3(?:[-.][-a-z0-9]+)?\.amazonaws\.com/))
                amazon_container = src.replace(/^[a-z]*:\/\/[^/]*\/([^/]*)\/.*/, "$1");
            else if (domain.match(/[^/]*\.s3(?:[-.][-a-z0-9]+)?\.amazonaws\.com/))
                amazon_container = src.replace(/^[a-z]*:\/\/([^/]*)\.s3(?:[-.][-a-z0-9]+)?\.amazonaws\.com\/.*/, "$1");
        }

        var googleapis_container = null;
        if (domain.indexOf(".googleapis.com") >= 0) {
            googleapis_container = src.replace(/^[a-z]*:\/\/[^/]*\/([^/]*)\/.*/, "$1");
        }

        var googlestorage_container = null;
        if (domain_nosub === "googleapis.com" &&
            (domain === "storage.googleapis.com" ||
             domain.match(/\.storage\.googleapis\.com$/) ||
             domain === "commondatastorage.googleapis.com" ||
             domain.match(/\.commondatastorage\.googleapis\.com$/))) {
            if (domain.match(/\.[a-z]+\.googleapis\.com$/)) {
                googlestorage_container = src.replace(/^[a-z]*:\/\/([^/]*)\.[a-z]+\.googleapis\.com\/.*/, "$1");
            } else {
                googlestorage_container = src.replace(/^[a-z]*:\/\/[^/]*\/([^/]*)\/.*/, "$1");
            }
        }

        var host_domain = "";
        var host_domain_nowww = "";
        var host_domain_nosub = "";
        if (options.host_url) {
            host_domain = options.host_url.replace(/^[a-z]+:\/\/([^/]*)(?:\/.*)?$/,"$1");

            host_domain_nowww = host_domain.replace(/^www\./, "");
            host_domain_nosub = host_domain.replace(/^.*\.([^.]*\.[^.]*)$/, "$1");
            if (host_domain_nosub.match(/^co\.[a-z]{2}$/)) {
                host_domain_nosub = host_domain.replace(/^.*\.([^.]*\.[^.]*\.[^.]*)$/, "$1");
            }
        }

        var newsrc, i, size, origsize, regex;

        // instart logic morpheus
        // test urls:
        // char - 5
        // https://c-6rtwjumjzx7877x24nrlncx2ewfspjwx2ehtr.g00.ranker.com/g00/3_c-6bbb.wfspjw.htr_/c-6RTWJUMJZX77x24myyux78x3ax2fx2fnrlnc.wfspjw.htrx2fzx78jw_stij_nrlx2f94x2f415044x2ftwnlnsfqx2fjzs-on-bts-wjhtwinsl-fwynx78yx78-fsi-lwtzux78-umtyt-z6x3fbx3d105x26vx3d05x26krx3doulx26knyx3dhwtux26hwtux3dkfhjx78x26n65h.rfwp.nrflj.yduj_$/$/$/$/$/$
        //   https://imgix.ranker.com/user_node_img/49/960599/original/eun-ji-won-recording-artists-and-groups-photo-u1?w=650&q=50&fm=jpg&fit=crop&crop=faces
        // https://c-6rtwjumjzx7877x24nrlncx2ewfspjwx2ehtr.g00.ranker.com/g00/3_c-6bbb.wfspjw.htr_/c-6RTWJUMJZX77x24myyux78x3ax2fx2fnrlnc.wfspjw.htrx2fzx78jw_stij_nrlx2f03x2f6698837x2ftwnlnsfqx2fmjj-hmzq-umtyt-z4x3fbx3d105x26vx3d05x26krx3doulx26knyx3dhwtux26hwtux3dkfhjx78x26n65h.rfwp.nrflj.yduj_$/$/$/$/$/$
        //   https://imgix.ranker.com/user_node_img/58/1143382/original/hee-chul-photo-u9?w=650&q=50&fm=jpg&fit=crop&crop=faces
        // https://c-6rtwjumjzx7877x24nrlncx2ewfspjwx2ehtr.g00.ranker.com/g00/3_c-6bbb.wfspjw.htr_/c-6RTWJUMJZX77x24myyux78x3ax2fx2fnrlnc.wfspjw.htrx2fzx78jw_stij_nrlx2f16x2f6757374x2ftwnlnsfqx2fmdzs-dtzsl-z7x3fbx3d105x26vx3d05x26krx3doulx26knyx3dhwtux26hwtux3dkfhjx78x26n65h.rfwp.nrflj.yduj_$/$/$/$/$/$
        //   https://imgix.ranker.com/user_node_img/61/1202829/original/hyun-young-u2?w=650&q=50&fm=jpg&fit=crop&crop=faces
        //
        // http://c-6rtwjumjzx7877x24bbbx2esfstanx78twx2ent.g00.tomshardware.com/g00/3_c-6bbb.ytrx78mfwibfwj.htr_/c-6RTWJUMJZX77x24myyux78x3ax2fx2fbbb.sfstanx78tw.ntx2fx40u6x2fHfhmjfgqjHXXx3fywfhpx26n65h.rfwp.qnsp.yduj_$/$/$
        //   https://www.nanovisor.io/@p1/CacheableCSS?track
        //
        // char - 8
        // https://c-5uwzmx78pmca09x24quoqfx2ezivsmzx2ekwu.g00.ranker.com/g00/3_c-5eee.zivsmz.kwu_/c-5UWZMXPMCA09x24pbbx78ax3ax2fx2fquoqf.zivsmz.kwux2fcamz_vwlm_quox2f25x2f716313x2fwzqoqvitx2fmuui-eibawv-x78mwx78tm-qv-bd-x78pwbw-c01x3fex3d903x26px3d903x26nqbx3dkzwx78x26kzwx78x3dnikmax26yx3d48x26nux3drx78ox26q98k.uizs.quiom.bgx78m_$/$/$/$/$/$
        //   https://imgix.ranker.com/user_node_img/47/938535/original/emma-watson-people-in-tv-photo-u23?w=125&h=125&fit=crop&crop=faces&q=60&fm=jpg
        //
        // http://c-6rtwjumjzx7877x24zlh-56x2ehfkjrtrx78yfynhx2ehtr.g00.cafemom.com/g00/3_c-6ymjx78ynw.hfkjrtr.htr_/c-6RTWJUMJZX77x24myyux78x3ax2fx2fzlh-56.hfkjrtrx78yfynh.htrx2fljsx2fhwtux2f705x2f695x2f25x2f7563x2f57x2f56x2f65x2f82x2fibx2futpmy32vnt27.uslx3fn65h.rfwpx3dnrflj_$/$/$/$/$/$/$/$/$/$/$/$/$
        //   https://ugc-01.cafemomstatic.com/gen/crop/250/140/70/2018/02/01/10/37/dw/pokht87qio72.png
        if (src.indexOf("/g00/") >= 0 && domain.indexOf(".g00.") >= 0) {
            var str = "";
            //var i;

            // decode x[0-9][0-9] to \x[0-9][0-9]
            for (i = 0; i < src.length; i++) {
                if (src[i] == 'x') {
                    var char = parseInt(src[i + 1] + src[i + 2], 16);
                    str += String.fromCharCode(char);
                    i += 2;
                } else {
                    str += src[i];
                }
            }

            str = str.split("/").slice(5).join("/").split("$").slice(1).join("$");
            if (str && str.indexOf("://") < 10 && str[1] == str[2]) {
                var diff = mod(str.charCodeAt(0) - 'h'.charCodeAt(0), 26);

                // char - diff
                var str1 = "";
                for (i = 0; i < str.length; i++) {
                    var code = str.charCodeAt(i);
                    if(code > 47 && code < 58) {
                        /* number */
                        code = (mod((code - 48 - diff), 10) + 48);
                    } else if (code > 64 && code < 91) {
                        /* uppercase */
                        code = (mod((code - 65 - diff),26) + 65);
                    } else if (code > 96 && code < 123) {
                        /* lowercase */
                        code = (mod((code - 97 - diff),26) + 97);
                    }
                    str1 += String.fromCharCode(code);
                }

                var urlparts = str1;
                if (urlparts && urlparts.indexOf("http") === 0) {
                    var $s = urlparts.replace(/.*?([$/]*)$/, "$1");
                    if ($s !== urlparts && $s) {
                        var count = $s.split("$").length - 1;
                        if (count > 0) {
                            // + 2 for http://
                            var newurl = urlparts.split("/").slice(0, count + 2).join("/");

                            // https://ugc-01.cafemomstatic.com/gen/crop/250/140/70/2018/02/01/10/37/dw/pokht87qio72.png?i10c.mark=image_$
                            //newurl = newurl.split("&").slice(0,-1).join("&"); // remove &i10c.mark.link.type_...
                            newurl = newurl.replace(/[?&]i10c\.mark[^/]*$/, "");

                            if (newurl)
                                return newurl;
                        }
                    }
                } else {
                    console_log(urlparts);
                }
            }
        }

        /*if (domain.indexOf("img.tenasia.hankyung.com") >= 0 && false) {
            // http://img.hankyung.com/photo/201612/AA.12967766.4.jpg -- larger than .1.
            //   http://img.hankyung.com/photo/201612/AA.12967766.1.jpg
            return src.replace(/-[0-9]+x[0-9]+\.([^/.]*)$/, ".$1");
        }*/

        if (domain_nosub === "naver.net" ||
            domain_nosub === "pstatic.net") {
            if (domain.indexOf("gfmarket.") >= 0) {
                return src;
            }

            // http://tv03.search.naver.net/thm?size=120x150&quality=9&q=http://sstatic.naver.net/people/portrait/201401/20140127145415321.jpg
            //   http://sstatic.naver.net/people/portrait/201401/20140127145415321.jpg
            // https://tv.pstatic.net/thm?size=120x150&quality=9&q=http://sstatic.naver.net/people/portrait/201604/20160426164831645.jpg
            //   http://sstatic.naver.net/people/portrait/201604/20160426164831645.jpg
            if (domain.match(/tv[0-9]*\.search\.naver\.net/) ||
                domain.match(/tv[0-9]*\.pstatic\.net/)) {
                return src.replace(/.*\/thm\?.*?q=/, "");
            }

            if (src.match(/[?&]src=/)) {
                return decodeURIComponent(src.replace(/.*src=*([^&]*).*/, "$1")).replace(/^"*/, '').replace(/"$/, '');
            }

            // for some reason it doesn't work with (some?) cafe files?
            // test:
            // https://cafeptthumb-phinf.pstatic.net/20150611_228/pht0829_1434017180824U5auR_JPEG/U01.jpg?type=w1
            // proper:
            // https://cafeptthumb-phinf.pstatic.net/20150611_228/pht0829_1434017180824U5auR_JPEG/U01.jpg

            // however in cases such as
            // https://postfiles.pstatic.net/MjAxNzA2MjVfMjcg/MDAxNDk4MzY2NTU1NDA1._jJeyTBgxoS4OUVFnfUpCTwFlWgsQANPgd5g4Wr__2kg._o3wfc4uAzyG_buHGKqENCl6g1pDt6-thoX-akGet9Qg.JPEG.amyo916/%EB%B0%A4%EB%B9%84%EB%85%B8_%EC%9D%80%EC%86%943.jpg?type=w1
            // doing
            // https://postfiles.pstatic.net/MjAxNzA2MjVfMjcg/MDAxNDk4MzY2NTU1NDA1._jJeyTBgxoS4OUVFnfUpCTwFlWgsQANPgd5g4Wr__2kg._o3wfc4uAzyG_buHGKqENCl6g1pDt6-thoX-akGet9Qg.JPEG.amyo916/%EB%B0%A4%EB%B9%84%EB%85%B8_%EC%9D%80%EC%86%943.jpg
            // returns a smaller file
            // https://blogfiles.pstatic.net/MjAxNzA2MjVfMjcg/MDAxNDk4MzY2NTU1NDA1._jJeyTBgxoS4OUVFnfUpCTwFlWgsQANPgd5g4Wr__2kg._o3wfc4uAzyG_buHGKqENCl6g1pDt6-thoX-akGet9Qg.JPEG.amyo916/%EB%B0%A4%EB%B9%84%EB%85%B8_%EC%9D%80%EC%86%943.jpg is the same size as ?type=w1
            //
            // https://postfiles.pstatic.net/MjAxNzA5MjFfMTg1/MDAxNTA1OTk3ODQzNjU3.oR8-_8p2zkJuFfz41D_ABFDKc82luEh45nxxiH1riAUg.NqrW3NUoqqR_a3Pqbg0jAttIrNst4k5BdFG2M7WNfQsg.JPEG.bho1000/IMG_4092_resize.JPG?type=w966 (900x600)
            //  https://postfiles.pstatic.net/MjAxNzA5MjFfMTg1/MDAxNTA1OTk3ODQzNjU3.oR8-_8p2zkJuFfz41D_ABFDKc82luEh45nxxiH1riAUg.NqrW3NUoqqR_a3Pqbg0jAttIrNst4k5BdFG2M7WNfQsg.JPEG.bho1000/IMG_4092_resize.JPG = smallest
            //  https://postfiles.pstatic.net/MjAxNzA5MjFfMTg1/MDAxNTA1OTk3ODQzNjU3.oR8-_8p2zkJuFfz41D_ABFDKc82luEh45nxxiH1riAUg.NqrW3NUoqqR_a3Pqbg0jAttIrNst4k5BdFG2M7WNfQsg.JPEG.bho1000/IMG_4092_resize.JPG?type=w1 = largest (eq to w966)
            //  https://postfiles.pstatic.net/MjAxNzA5MjFfMTg1/MDAxNTA1OTk3ODQzNjU3.oR8-_8p2zkJuFfz41D_ABFDKc82luEh45nxxiH1riAUg.NqrW3NUoqqR_a3Pqbg0jAttIrNst4k5BdFG2M7WNfQsg.JPEG.bho1000/IMG_4092_resize.JPG?type=w2 = smaller
            //  https://postfiles.pstatic.net/MjAxNzA5MjFfMTg1/MDAxNTA1OTk3ODQzNjU3.oR8-_8p2zkJuFfz41D_ABFDKc82luEh45nxxiH1riAUg.NqrW3NUoqqR_a3Pqbg0jAttIrNst4k5BdFG2M7WNfQsg.JPEG.bho1000/IMG_4092_resize.JPG?type=w3 = smallest (but larger than without)
            //  https://blogfiles.pstatic.net/MjAxNzA5MjFfMTg1/MDAxNTA1OTk3ODQzNjU3.oR8-_8p2zkJuFfz41D_ABFDKc82luEh45nxxiH1riAUg.NqrW3NUoqqR_a3Pqbg0jAttIrNst4k5BdFG2M7WNfQsg.JPEG.bho1000/IMG_4092_resize.JPG = largest (eq to w966)

            // there is also ?type=w2 to consider, but with no change i've seen so far

            // ?type=w1 doesn't work:
            //
            // https://img-pholar.pstatic.net/20161120_290/1479626135018LJPrw_JPEG/p?type=ffn720_720
            //  https://img-pholar.pstatic.net/20161120_290/1479626135018LJPrw_JPEG/p?type=w1 is broken
            //  https://img-pholar.pstatic.net/20161120_290/1479626135018LJPrw_JPEG/p is ok
            // http://dic.phinf.naver.net/20170424_170/1493009773923GjUgo_JPEG/196_cobis_20070206153112.jpg?type=nf118_80_q80

            // ?type=w1 works:
            //
            // https://postfiles.pstatic.net/MjAxNzEyMjNfMTc5/MDAxNTEzOTk4OTA3MzQ0.3GiIBnqVyIshzpThGEE92-RMzAWDRShnmSwfZyviyVQg.OiRXD8qLAXSNXgDUF1yPsXnx8SPxj3RWhYr-eUoCWhUg.JPEG.com862/IMG_1826.jpg?type=w773
            //   https://postfiles.pstatic.net/MjAxNzEyMjNfMTc5/MDAxNTEzOTk4OTA3MzQ0.3GiIBnqVyIshzpThGEE92-RMzAWDRShnmSwfZyviyVQg.OiRXD8qLAXSNXgDUF1yPsXnx8SPxj3RWhYr-eUoCWhUg.JPEG.com862/IMG_1826.jpg?type=w1
            // http://sstatic.naver.net/people/194/201710101543498651.jpg
            //   http://sstatic.naver.net/people/194/201710101543498651.jpg?type=w1
            // http://sstatic.naver.net/people/portraitGroup/201709/20170929171408460-4330243.jpg
            //   http://sstatic.naver.net/people/portraitGroup/201709/20170929171408460-4330243.jpg?type=w1

            // ?type=w1 makes a smaller file:
            // http://blogfiles.naver.net/MjAxNzEyMTNfNzAg/MDAxNTEzMTcxOTYwMTYy.LUNqGf98PVcskK0cLDV3Gil8H861pt8Y-Mv1PP0BnLcg.gC3LNf7q0rJZJ044ZjdDbUQTGqXIYzL-bRiKyxYocDcg.PNG.vvyeo/1_%BD%BA%C0%A7%C4%A1_.png
            //   http://blogfiles.pstatic.net/MjAxNzEyMTNfNzAg/MDAxNTEzMTcxOTYwMTYy.LUNqGf98PVcskK0cLDV3Gil8H861pt8Y-Mv1PP0BnLcg.gC3LNf7q0rJZJ044ZjdDbUQTGqXIYzL-bRiKyxYocDcg.PNG.vvyeo/1_%BD%BA%C0%A7%C4%A1_.png?type=w1
            //   http://blogfiles.pstatic.net/MjAxNzEyMTNfNzAg/MDAxNTEzMTcxOTYwMTYy.LUNqGf98PVcskK0cLDV3Gil8H861pt8Y-Mv1PP0BnLcg.gC3LNf7q0rJZJ044ZjdDbUQTGqXIYzL-bRiKyxYocDcg.PNG.vvyeo/1_%BD%BA%C0%A7%C4%A1_.png?type=w2 (even smaller)
            //   http://blogfiles.pstatic.net/MjAxNzEyMTNfNzAg/MDAxNTEzMTcxOTYwMTYy.LUNqGf98PVcskK0cLDV3Gil8H861pt8Y-Mv1PP0BnLcg.gC3LNf7q0rJZJ044ZjdDbUQTGqXIYzL-bRiKyxYocDcg.PNG.vvyeo/1_%BD%BA%C0%A7%C4%A1_.png?type=w3 (smallest)
            // with that being said, type=w3 does look the least stretched. however, with other images, it just resizes, no un-stretching
            if (domain.search(/^[-a-z0-9]*cafe[-a-z0-9]*\./) < 0 &&
                domain.search(/^img-pholar[-a-z0-9]*\./) < 0 &&
                domain.search(/^shopping-phinf[-a-z0-9]*\./) < 0 &&
                domain.search(/^dic.phinf.naver.net/) < 0 &&
                domain.search(/^musicmeta.phinf.naver.net/) < 0 && false)
                src = src.replace(/\?type=[^/]*$/, "?type=w1");
            else
                src = src.replace(/\?type=[^/]*$/, "");

            src = src.replace(/#[^/]*$/, "");

            if (domain.search(/^[-a-z0-9]*blog[-a-z0-9]*\./) < 0 &&
                domain.search(/^[-a-z0-9]*cafe[-a-z0-9]*\./) < 0 &&
                domain.search(/^[-a-z0-9]*news[-a-z0-9]*\./) < 0 &&
                domain.search(/^[-a-z0-9]*post[-a-z0-9]*\./) < 0 &&
                domain.search(/^[-a-z0-9]*v.phinf[-a-z0-9]*\./) < 0 &&
                domain.search(/^[-a-z0-9]*shopping.phinf[-a-z0-9]*\./) < 0 &&
                domain.search(/^[-a-z0-9]*musicmeta.phinf[-a-z0-9]*\./) < 0) {
                return src;
            }

            // http://post.phinf.naver.net/20160324_74/1458783545129zPGJg_JPEG/%B0%AD%B3%B2TV_%B0%C9%B1%D7%B7%EC_%BD%BA%C0%A7%C4%A1%BA%A3%B8%AE_%B0%A1%BB%F3%C7%F6%BD%C7_360VR_%BC%EE%C4%C9%C0%CC%BD%BA_%B9%C2%C1%F7%BA%F1%B5%F0%BF%C0_%BB%E7%C1%F82.jpg/IT8SeAh7YSaM55bq7KMOEE5ImDlU.jpg
            //   http://post-phinf.pstatic.net/20160324_74/1458783545129zPGJg_JPEG/%B0%AD%B3%B2TV_%B0%C9%B1%D7%B7%EC_%BD%BA%C0%A7%C4%A1%BA%A3%B8%AE_%B0%A1%BB%F3%C7%F6%BD%C7_360VR_%BC%EE%C4%C9%C0%CC%BD%BA_%B9%C2%C1%F7%BA%F1%B5%F0%BF%C0_%BB%E7%C1%F82.jpg/IT8SeAh7YSaM55bq7KMOEE5ImDlU.jpg

            // works:
            // https://s.pstatic.net/shopping.phinf/20180115_4/ce3dfbda-c44b-43aa-83d0-2ffb8fa3dd47.jpg
            //   https://shopping-phinf.pstatic.net/20180115_4/ce3dfbda-c44b-43aa-83d0-2ffb8fa3dd47.jpg
            // http://imgnews.pstatic.net/image/origin/433/2017/07/31/33727.jpg
            //   http://s.pstatic.net/imgnews/image/origin/433/2017/07/31/33727.jpg
            // http://imgnews.pstatic.net/image/origin/416/2018/04/04/223346.jpg
            // doesn't work:
            // http://dic.phinf.naver.net/20170424_126/14930112296681HPid_JPEG/14051_getty_20080128162512.jpg
            //   http://s.pstatic.net/dic.phinf/20170424_126/14930112296681HPid_JPEG/14051_getty_20080128162512.jpg
            //
            // can't remove ?
            // http://dbscthumb.phinf.naver.net/4209_000_1/20160408160657214_SYEAAJM97.jpg/5%EA%B0%90%EA%B5%AC.jpg?type=r160
            //   http://dbscthumb-phinf.pstatic.net/4209_000_1/20160408160657214_SYEAAJM97.jpg/5%EA%B0%90%EA%B5%AC.jpg?type=r160

            return src
                .replace(/postfiles[^/.]*\./, "blogfiles.")
                .replace(/m?blogthumb[^./]*/, "blogfiles")
                .replace(/blogfiles[^/.]*\./, "blogfiles.")
                .replace(/postfiles[^/.]*\./, "blogfiles.")

                .replace(/cafeptthumb[^./]*/, "cafefiles")

                // https://cafeskthumb-phinf.pstatic.net/MjAxNzAyMjhfMjIw/MDAxNDg4Mjg1NzU1ODY0.FAX24pXzUaNN-_C5yRRGcJJsswcKtGmsdOi2hTQQfJog.muWF7CuoY7-HKdrPQRYDyp8OlZGyITwmkcGQgzkxzFcg.PNG.yj991224/main-cover1.png?type=w740
                .replace(/cafeskthumb[^./]*/, "cafefiles")
                .replace(/m?cafethumb[^./]*/, "cafefiles")
                .replace(/cafefiles[^/.]*\./, "cafefiles.")

                .replace(/mimgnews[^./]*/, "imgnews")

                .replace(/post\.phinf\./, "post-phinf.")
                // http://v.phinf.naver.net/20180117_164/1516193382182Jx9lx_JPEG/df9c0c3b-fb84-11e7-9554-000000008ca5_07.jpg
                .replace(/v\.phinf\./, "v-phinf.")
                // http://musicmeta.phinf.naver.net/album/002/152/2152949.jpg
                .replace(/musicmeta\.phinf\./, "musicmeta-phinf.")
                .replace(/shopping\.phinf\./, "shopping-phinf.")
                // http://blogpfthumb.phinf.naver.net/20131119_160/thenote_13847965353237CovB_JPEG/controlrooma.jpg
                //   http://blogpfthumb-phinf.pstatic.net/20131119_160/thenote_13847965353237CovB_JPEG/controlrooma.jpg
                .replace(/blogpfthumb\.phinf\./, "blogpfthumb-phinf.")

                .replace(/\.phinf\./, ".")
                .replace(".naver.net/", ".pstatic.net/");
        }

        if ((domain_nosub === "daumcdn.net" ||
             domain_nosub === "kakaocdn.net") &&
            src.indexOf("/thumb/") >= 0) {
            // https://search1.kakaocdn.net/thumb/C72x90h.q85/?fname=http%3A%2F%2Fcfile66.uf.daum.net%2Fimage%2F26191E4558DC88D52BF198
            //   http://cfile66.uf.daum.net/image/26191E4558DC88D52BF198
            return decodeURIComponent(src.replace(/.*fname=([^&]*).*/, "$1"));
        }

        /*if (false && (src.indexOf("daumcdn.net/argon/") >= 0 ||
                      src.indexOf(".kakaocdn.net/argon/") >= 0)) {
            // wip
            // https://search3.kakaocdn.net/argon/600x0_65_wr/CdIaPo4lsew
            // https://search3.kakaocdn.net/argon/0x200_85_hr/CdIaPo4lsew
        }*/

        if ((domain_nosub === "tistory.com" ||
              domain_nosub === "daum.net") &&
             (domain.match(/\.uf\.[a-z]+\.[a-z]+$/) ||
              domain.match(/^cfs[0-9]*\./))) {
            // http://cfile21.uf.tistory.com/image/994900485A9A66EF2564F4 -- 1000x1500
            //   http://cfile21.uf.tistory.com/original/994900485A9A66EF2564F4 -- 1333x2000
            // http://cfile37.uf.daum.net/C160x160/23138C47524BB2D42DD743
            //   http://cfile37.uf.daum.net/original/23138C47524BB2D42DD743
            // http://cfs9.tistory.com/image/30/tistory/2008/06/12/11/13/4850862dc2093
            //   http://cfs9.tistory.com/original/30/tistory/2008/06/12/11/13/4850862dc2093
            // http://cfs11.blog.daum.net/image/10/blog/2008/05/25/00/14/483830c0500a4
            //   http://cfs11.blog.daum.net/original/10/blog/2008/05/25/00/14/483830c0500a4
            // unhandled:
            // https://tistory4.daumcdn.net/tistory/458362/attach/3a4fa78bca8649b6a44bf4627075837e
            // http://t1.daumcdn.net/tvpot/thumb/s07a6T8ejtee6OXNNXjQtVE/thumb.png?ts=1523956270
            //
            // https://t1.daumcdn.net/cfile/tistory/996D34465B12921B1A
            //   http://cfile2.uf.tistory.com/original/996D34465B12921B1AE97C
            //   996D34465B12921B1A
            //   996D34465B12921B1AE97C
            // https://t1.daumcdn.net/cfile/tistory/996A16355B12784D0B
            //   http://cfile5.uf.tistory.com/original/996A16355B12784D0B9CF8
            //   996A16355B12784D0B
            //   996A16355B12784D0B9CF8
            // credit to severus on greasyfork:
            // https://t1.daumcdn.net/cfile/tistory/9921ED405B0FCEDB17 -- 1600x2036
            //   http://cfile25.uf.tistory.com/original/9921ED405B0FCEDB17DF05 -- 2200x2800
            //   9921ED405B0FCEDB17
            //   9921ED405B0FCEDB17DF05
            return src
                .replace("/attach/", "/original/")
                .replace("/image/", "/original/")
                .replace(/\/[RTC][0-9]*x[0-9]*\//, "/original/");
        }

        if (domain_nosub === "daumcdn.net" &&
            domain.match(/^t[0-9]*\.daumcdn\.net/)) {
            // credit to 灰原米兰 on greasyfork for finding this pattern:
            // https://t1.daumcdn.net/cfile/tistory/99DECC4B5B1150482D
            //   https://t1.daumcdn.net/cfile/tistory/99DECC4B5B1150482D?original
            // credit again to severus for the link:
            // https://t1.daumcdn.net/cfile/tistory/9921ED405B0FCEDB17 -- 1600x2036
            //   https://t1.daumcdn.net/cfile/tistory/9921ED405B0FCEDB17?original -- 2200x2800
            //
            // https://t1.daumcdn.net/cfile/211DD54C5627181233
            //   https://t1.daumcdn.net/cfile/211DD54C5627181233?original -- no difference
            return src.replace(/(\/cfile\/(?:tistory\/)?[0-9A-F]+)(?:\\?.*)$/, "$1?original");
        }

        if (domain_nosub === "daumcdn.net" &&
            domain.match(/^i[0-9]*\.media\./)) {
            // http://i1.media.daumcdn.net/uf/image/U01/agora/5134354D420CC80021
            //   http://i1.media.daumcdn.net/uf/original/U01/agora/5134354D420CC80021
            return src.replace(/\/uf\/image\//, "/uf/original/");
        }

        if (domain_nosub === "daumcdn.net" &&
            domain.match(/^[mi][0-9]*\.daumcdn\.net/)) {
            // http://i1.daumcdn.net/cfile37/C160x160/23138C47524BB2D42DD743
            //   http://cfile37.uf.daum.net/C160x160/23138C47524BB2D42DD743
            // http://m1.daumcdn.net/cfile81/C41x41/150A68444FFA321A18F2DB
            //   http://cfile81.uf.daum.net/C41x41/150A68444FFA321A18F2DB
            return src.replace(/:\/\/[^/]*\/(cfile[0-9]+)\//, "://$1.uf.daum.net/");
        }

        if (domain === "image.news1.kr") {
            // http://image.news1.kr/system/thumbnails/photos/2018/2/19/2973418/thumb_336x230.jpg
            //   http://image.news1.kr/system/photos/2018/2/19/2973418/original.jpg
            // http://image.news1.kr/system/photos/2014/8/22/985836/main_thumb.jpg
            //   http://image.news1.kr/system/photos/2014/8/22/985836/original.jpg
            // http://image.news1.kr/system/photos/2018/6/15/3162887/high.jpg -- 1400x1867
            //   http://image.news1.kr/system/photos/2018/6/15/3162887/original.jpg -- 1500x2000
            return src
                .replace(/\/thumbnails\/(.*)\/thumb_[0-9]+x(?:[0-9]+)?(\.[^/.]*)$/, "/$1/original$2")
                .replace(/main_thumb\.jpg/, "original.jpg")
                .replace(/article.jpg/, "original.jpg")
                .replace(/no_water.jpg/, "original.jpg")
                .replace(/photo_sub_thumb.jpg/, "original.jpg")
                .replace(/section_top\.jpg/, "original.jpg")
                .replace(/high\.jpg/, "original.jpg");
        }

        if (domain.indexOf(".joins.com") >= 0) {
            // need test case
            newsrc = src.replace(/\.tn_[0-9]*\..*/, "");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain === "ir.joins.com") {
            // http://ir.joins.com/?u=http%3A%2F%2Fpds.joins.com%2F%2Fnews%2Fcomponent%2Fhtmlphoto_mmdata%2F201802%2F02%2Ff1272e1a-836b-4e54-be62-1ab42de3b53b.jpg
            //   http://pds.joins.com//news/component/htmlphoto_mmdata/201802/02/f1272e1a-836b-4e54-be62-1ab42de3b53b.jpg
            return decodeURIComponent(src.replace(/.*\/\?.*?u=([^&]*).*$/, "$1"));
        }

        if (domain_nosub === "koreadaily.com" &&
            domain.match(/^thumb[0-9]*\./)) {
            // http://thumb5.koreadaily.com/tn.dll?w=450&h=253&url=http://pds.joins.com/news/component/htmlphoto_mmdata/201808/21/687941c0%2Dc590%2D4222%2D9263%2D669a56ff3bbc.jpg
            //   http://pds.joins.com/news/component/htmlphoto_mmdata/201808/21/687941c0-c590-4222-9263-669a56ff3bbc.jpg
            // http://thumb5.koreadaily.com/cache/pds_joins_com/news/component/htmlphoto_mmdata/201808/21/F450x253_687941c0-c590-4222-9263-669a56ff3bbc_jpg.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/tn\.dll.*?[?&]url=([^&]*).*?$/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);
        }

        if (domain === "uhd.img.topstarnews.net") {
            // http://www.topstarnews.net/news/articleView.html?idxno=59506
            // http://uhd.img.topstarnews.net/wys2/file_attach/2014/05/20/1400555456-84-org.jpg -- dead
            //   http://www.topstarnews.net/news/photo/first/201405/img_59506_1_org.jpg
            return src
                .replace("/file_attach_thumb/", "/file_attach/")
                .replace(/_[^/]*[0-9]*x[0-9]*_[^/]*(\.[^/]*)$/, "-org$1")
                .replace(/(-[0-9]*)(\.[^/]*)$/, "$1-org$2");
        }

        if (domain_nowww === "topstarnews.net") {
            // http://www.topstarnews.net/news/thumbnail/201802/365216_8748_4653_v150.jpg
            //   http://www.topstarnews.net/news/photo/201802/365216_8748_4653_org.jpg
            // http://www.topstarnews.net/news/photo/201802/364365_7857_4310.jpg
            //   http://www.topstarnews.net/news/photo/201802/364365_7857_4310_org.jpg
            // http://www.topstarnews.net/news/thumbnail/first/201710/img_319718_1_v150.jpg
            //   http://www.topstarnews.net/news/photo/first/201710/img_319718_1_org.jpg
            //   http://cdn.topstarnews.net/news/photo/first/201710/img_319718_1_org.jpg
            return src
                .replace(/_v[0-9]+(\.[^/.]*)$/, "_org$1")
                .replace(/(_[0-9]+)(\.[^/.]*)$/, "$1_org$2")
                .replace("/thumbnail/", "/photo/");
        }

        if (domain === "cdn.topstarnews.net") {
            // credit to Gyuri on discord
            // http://cdn.topstarnews.net/news/photo/first/201406/img_63025_1.jpg/ndsoft/optimize
            //   http://www.topstarnews.net/news/photo/first/201406/img_63025_1_org.jpg
            return src.replace(/:\/\/[^/]*\/(.*\/photo\/.*_[0-9]+)(\.[^/.]*)\/.*$/, "://www.topstarnews.net/$1_org$2");
        }

        if (domain === "thumb.mt.co.kr" ||
            domain === "thumb.mtstarnews.com") {
            // http://thumb.mt.co.kr/06/2017/12/2017122222438260548_1.jpg
            //   http://image.mt.co.kr/2017/12/2017122222438260548_1.jpg
            // http://thumb.mtstarnews.com/06/2018/04/2018040415075698337_1.jpg
            //   http://thumb.mtstarnews.com/07/2018/04/2018040415075698337_1.jpg -- much smaller
            //   http://image.mtstarnews.com/2018/04/2018040415075698337_1.jpg
            // 06 and 21 seem to be identical
            // after that, in order of size: 05, 07, 17, 11, 16, 10, 20, 04, 15, 03, 14, 19
            //src = src.replace(/(thumb\.[^/]*)\/[0-9]+(\/[0-9]*\/[0-9]*\/[^/]*).*/, "$1/06$2");
            src = src.replace(/:\/\/thumb\.([^/]*)\/[0-9]+\//, "://image.$1/");
        }

        if (domain === "menu.mt.co.kr" ||
            domain_nosub === "myskcdn.com") {
            // http://moneys.mt.co.kr/photoDb/mwPhotoDbList.php?no=2017013115555978429&page=1&idx=3
            //   http://menu.mt.co.kr/moneyweek/photoDb/2017/01/31/20170131155559784294333.jpg/dims/optimize
            //   http://menu.mt.co.kr/moneyweek/thumb/2017/01/31/06/2017013115108024857_1.jpg -- smaller
            //   http://menu.mt.co.kr/moneyweek/thumb/2017/01/31/00/2017013115108024857_1.jpg -- not found
            // http://menu.mt.co.kr/moneyweek/thumb/2018/03/05/19/2018030511008030850_1.jpg
            //   http://menu.mt.co.kr/moneyweek/thumb/2018/03/05/06/2018030511008030850_1.jpg
            //   http://menu.mt.co.kr/moneyweek/thumb/2018/03/05/00/2018030511008030850_1.jpg -- larger
            // http://menu.mt.co.kr/moneyweek/thumb/2017/11/16/00/2017111614558031796_1.jpg/dims/optimize/
            //   http://menu.mt.co.kr/moneyweek/thumb/2017/11/16/00/2017111614558031796_1.jpg
            //   http://menu.mt.co.kr/moneyweek/thumb/2017/11/16/06/2017111614558031796_1.jpg -- smaller
            // http://menu.mt.co.kr/moneyweek/thumb/2018/01/14/00/2018011416088035798_2.jpg/dims/optimize/
            // http://menu.mt.co.kr/moneyweek/thumb/2018/03/09/06/2018030917238012410_1.jpg (found on sidebar)
            //   http://menu.mt.co.kr/moneyweek/thumb/2018/03/09/00/2018030917238012410_1.jpg
            // http://menu.mt.co.kr/moneyweek/thumb/2017/06/24/06/2017062410078087905_1.jpg - larger than 00, but looks scaled

            // http://menu.mt.co.kr/moneyweek/thumb/2017/05/26/00/2017052617068063683_1.jpg -- works
            // http://menu.mt.co.kr/moneyweek/thumb/2017/05/23/00/2017052310108026652_1.jpg -- doesn't

            // http://1290000230.desst.vcase2.myskcdn.com/1100000038/dev/1290000230/2018/03/20/1890835738_1_1.jpg?key=6a156742b5f85fb887bd7b79a94eea2471884c8c.3669019742&cid=1890835745&pid=1993936257&oid=1890835738/dims/resize/95x54
            //   http://1290000230.desst.vcase2.myskcdn.com/1100000038/dev/1290000230/2018/03/20/1890835738_1_1.jpg?key=6a156742b5f85fb887bd7b79a94eea2471884c8c.3669019742&cid=1890835745&pid=1993936257&oid=1890835738

            // http://menu.mt.co.kr/theleader/photo_img/00/2018/02/01/2018020114447262989_0.jpg
            var obj = src.match(/\/thumb\/(?:[0-9]+\/){3}([0-9]+)\//);
            if (obj && obj[1] !== "00") {
                var obj1_str = src.replace(/.*\/thumb\/([0-9]+\/[0-9]+\/[0-9]+\/).*/, "$1").replace(/\//g, "");
                var obj1 = parseInt(obj1_str);
                //console_log(obj1_str);
                if (obj1 >= 20170526)
                    src = src.replace(/(\/thumb\/(?:[0-9]+\/){3})[0-9]+\//, "$100/");
                else
                    src = src.replace(/(\/thumb\/(?:[0-9]+\/){3})[0-9]+\//, "$106/");
            }

            return src
                .replace(/\/dims\/.*/, "");
        }

        if (domain === "img.enews24.cjenm.skcdn.com") {
            // http://img.enews24.cjenm.skcdn.com/News/NewsThumbnail/20180821/4_81524182.jpg
            //   http://img.enews24.cjenm.skcdn.com/News/NewsThumbnail/20180821/81524182.jpg -- 555x757
            //   http://img.enews24.cjenm.skcdn.com/News/Contents/20180821/81524182.jpg -- same size
            // http://img.enews24.cjenm.skcdn.com/News/NewsThumbnail/20180305/96260245.jpg -- 2208x2457
            //   http://img.enews24.cjenm.skcdn.com/News/Contents/20180305/96260245.jpg -- 2208x2457
            // http://img.enews24.cjenm.skcdn.com/Photo/Contents/20180821/3_55037036.jpg -- 115x65
            //   http://img.enews24.cjenm.skcdn.com/Photo/Contents/20180821/55037036.jpg -- 450x602
            return src
                .replace(/\/News\/NewsThumbnail(\/[0-9]+\/)(?:[0-9]+_)?([0-9]+\.[^/.]*)$/, "/News/Contents$1$2")
                .replace(/(\/Photo\/Contents\/[0-9]+\/)[0-9]+_([0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "stardailynews.co.kr" ||
            // http://www.stardailynews.co.kr/news/thumbnail/201808/212431_241837_1916_v150.jpg
            //   http://www.stardailynews.co.kr/news/photo/201808/212431_241837_1916.jpg

            // http://www.liveen.co.kr/news/thumbnail/201809/230495_282622_126_v150.jpg
            //   http://www.liveen.co.kr/news/photo/201809/230495_282622_126.jpg
            domain_nosub === "liveen.co.kr" ||
            // http://ilyoseoul.co.kr/news/thumbnail/201808/251059_177609_143_v150.jpg
            //   http://ilyoseoul.co.kr/news/photo/201808/251059_177609_143.jpg
            domain_nosub === "ilyoseoul.co.kr" ||
            // http://www.sportsq.co.kr/news/thumbnail/201808/300799_291630_537_v150.jpg
            //   http://www.sportsq.co.kr/news/photo/201808/300799_291630_537.jpg
            domain_nosub === "sportsq.co.kr" ||
            // http://www.zenithnews.com/news/thumbnail/201808/119840_109469_1835_v150.jpg
            //   http://www.zenithnews.com/news/photo/201808/119840_109469_1835.jpg
            domain_nosub === "zenithnews.com" ||
            // http://www.munhwanews.com/news/thumbnail/201809/149954_197569_4039_v150.jpg
            //   http://www.munhwanews.com/news/photo/201809/149954_197569_4039.jpg
            // doesn't work for all:
            // http://www.munhwanews.com/news/thumbnail/201801/106108_163361_2456_v150.jpg
            //   http://www.munhwanews.com/news/photo/201801/106108_163361_2456.jpg
            //   http://www.munhwanews.com/news/photo/201801/106108_163361_2456.png -- works
            domain_nowww === "munhwanews.com" ||
            // http://www.ccdailynews.com/news/thumbnail/201801/953374_384565_4611_v150.jpg
            domain === "www.ccdailynews.com" ||
            // http://ph.kyeonggi.com/news/thumbnail/201802/1440153_1332290_5913_150.jpg
            //   http://ph.kyeonggi.com/news/photo/201802/1440153_1332290_5913.jpg
            // http://ph.kyeonggi.com/edit/news/view_img/PHOTO_1440148_1332273_5348_47.jpg
            //   http://ph.kyeonggi.com/news/photo/201802/1440148_1332273_5348.jpg
            domain === "ph.kyeonggi.com" ||
            // http://www.jemin.com/news/thumbnail/201802/495551_158263_5710_v150.jpg
            domain === "www.jemin.com" ||
            // http://www.domin.co.kr/news/thumbnail/201802/1183690_311011_329_v150.jpg
            //   http://www.domin.co.kr/news/photo/201802/1183690_311011_329.jpg (very hq)
            // http://www.domin.co.kr/news/view_img/MAIN_2_2639_2152.jpg
            //   http://www.domin.co.kr/news/photo/201802/1183700_311009_2038.jpg
            domain === "www.domin.co.kr" ||
            // http://cdn.jejudomin.co.kr/news/thumbnail/201802/96102_90506_3656_v150.jpg
            // http://www.jejudomin.co.kr/photobox/photo/2018020261404454865.jpg
            //   http://cdn.jejudomin.co.kr/news/photo/201802/96119_90524_4043.jpg
            domain === "cdn.jejudomin.co.kr" ||
            // http://ph.incheonilbo.com/news/thumbnail/201712/792780_315340_1230_150.jpg
            domain === "ph.incheonilbo.com" ||
            // http://www.hidomin.com/news/thumbnail/201802/349870_151635_5018_v150.jpg
            domain === "www.hidomin.com" ||
            // http://www.newsfreezone.co.kr/news/thumbnail/201802/38623_37635_844_v150.jpg
            domain === "www.newsfreezone.co.kr" ||
            // http://cdn.newsfreezone.co.kr/news/thumbnail/201802/41850_39614_2056_v150.jpg
            domain === "cdn.newsfreezone.co.kr" ||
            // http://www.newsinside.kr/news/thumbnail/201606/412819_220009_299_v150.jpg
            domain === "www.newsinside.kr" ||
            // http://cdn.newsinside.kr/news/thumbnail/201807/500595_348177_554_v150.jpg
            domain === "cdn.newsinside.kr" ||
            // http://www.greenpostkorea.co.kr/news/thumbnail/201802/85004_79031_3615_v150.jpg
            domain === "www.greenpostkorea.co.kr" ||
            // http://www.egn.kr/news/thumbnail/201802/90010_149058_921_v150.jpg
            //
            // http://www.egn.kr/news/photo/201710/87447_142141_178.jpg
            // http://www.egn.kr/news/photo/201710/87447_142142_179.jpg
            // http://www.egn.kr/news/photo/201710/87447_142143_1710.jpg
            domain === "www.egn.kr" ||
            // http://www.whitepaper.co.kr/news/thumbnail/201802/95633_76403_5942_v150.jpg
            domain === "www.whitepaper.co.kr" ||
            // http://www.outdoornews.co.kr/news/thumbnail/201802/30078_79659_4819_v150.jpg
            domain === "www.outdoornews.co.kr" ||
            // http://www.shinailbo.co.kr/news/thumbnail/201803/1049737_358211_645_v150.jpg
            // http://www.shinailbo.co.kr/news/articleView.html?idxno=319278
            //   http://www.shinailbo.co.kr/news/photo/201304/319278_175094_5325.jpg - 3500x1807
            domain === "www.shinailbo.co.kr" ||
            // http://www.ngtv.tv/news/thumbnail/201803/44169_57237_2756_v150.jpg
            // http://www.ngtv.tv/news/articleView.html?idxno=24743
            //   http://www.ngtv.tv/news/thumbnail/201503/24743_28146_3449_v150.jpg
            //     http://www.ngtv.tv/news/photo/201503/24743_28146_3449.jpg - 2364x1971
            domain === "www.ngtv.tv" ||
            // http://www.rnx.kr/news/thumbnail/201803/62152_50525_470_150.jpg
            // http://m.rnx.kr/news/articleView.html?idxno=1390
            domain === "www.rnx.kr" ||
            // http://www.intronews.net/news/thumbnail/201803/85854_115174_717_v150.jpg
            // http://www.intronews.net/news/articleView.html?idxno=85633
            //   http://www.intronews.net/news/thumbnail/201802/85633_114974_1625_v150.jpg
            domain === "www.intronews.net" ||
            // http://www.hg-times.com/news/thumbnail/201803/178090_128993_4414_v150.jpg
            //   http://www.hg-times.com/news/photo/201803/178090_128993_4414.jpg
            domain === "www.hg-times.com" ||
            // http://www.iemn.kr/news/thumbnail/201606/2457_2879_40_v150.jpg
            domain === "www.iemn.kr" ||
            // http://www.newscj.com/news/thumbnail/201803/newscj_%EC%B2%9C%EC%A7%80%EC%9D%BC%EB%B3%B4_505243_487804_229_v150.jpg
            //   http://www.newscj.com/news/photo/201803/newscj_%EC%B2%9C%EC%A7%80%EC%9D%BC%EB%B3%B4_505243_487804_229.jpg
            // http://www.newscj.com/news/thumbnail/201809/newscj_천지일보_552148_548008_98_v150.jpg
            //   http://www.newscj.com/news/photo/201809/newscj_%EC%B2%9C%EC%A7%80%EC%9D%BC%EB%B3%B4_552148_548008_98.jpg
            domain_nowww === "newscj.com" ||
            // http://www.ggilbo.com/news/thumbnail/201802/444114_351433_497_v150.jpg
            domain === "www.ggilbo.com" ||
            // http://www.bstoday.kr/news/thumbnail/201804/200376_125982_145_v150.jpg
            //
            // http://www.bstoday.kr/news/articleView.html?idxno=5090
            // http://www.bstoday.kr/photobox/photo/2018032371050517410.jpg
            //   http://www.bstoday.kr/news/photo/201508/5090_4090_1029.jpg
            domain === "www.bstoday.kr" ||
            // http://interfootball.heraldcorp.com/news/thumbnail/201803/194965_212367_3835_150.jpg
            domain === "interfootball.heraldcorp.com" ||
            // http://www.ilyosisa.co.kr/news/thumbnail/201805/145247_81281_562_v150.jpg
            domain === "www.ilyosisa.co.kr" ||
            // http://www.ynnews.kr/news/thumbnail/201805/130007_85746_295_150.jpg
            domain === "www.ynnews.kr" ||
            // http://www.starilbo.com/news/thumbnail/201802/43552_58572_5916_v150.jpg
            domain === "www.starilbo.com" ||
            // http://www.autoherald.co.kr/news/thumbnail/201805/31572_48631_5317_v150.jpg
            domain === "www.autoherald.co.kr" ||
            // http://www.00news.co.kr/news/thumbnail/201805/53198_101527_5227_v150.jpg
            domain === "www.00news.co.kr" ||
            // http://www.kstarfashion.com/news/thumbnail/201805/131724_67495_4142_v150.jpg
            domain === "www.kstarfashion.com" ||
            // http://www.inewspeople.co.kr/news/thumbnail/201611/12355_20610_5726_v150.jpg
            domain === "www.inewspeople.co.kr" ||
            // http://www.staraz.co.kr/news/thumbnail/201703/32882_7294_2352_v150.jpg
            domain === "www.staraz.co.kr" ||
            // http://www.wonnews.co.kr/news/thumbnail/201805/201275_36498_2029_v150.jpg
            domain === "www.wonnews.co.kr" ||
            // http://www.gukjenews.com/news/thumbnail/201806/938035_714703_1521_v150.jpg
            // http://cdn.gukjenews.com/news/thumbnail/201806/938035_714703_1521_v150.jpg
            domain_nosub === "gukjenews.com" ||
            // http://www.lunarglobalstar.com/news/thumbnail/201806/19254_15963_1148_v150.jpg
            domain === "www.lunarglobalstar.com" ||
            // http://www.sundayjournal.kr/news/thumbnail/201806/15914_26675_3235_v150.jpg
            domain === "www.sundayjournal.kr" ||
            // http://www.stnsports.co.kr/news/thumbnail/201806/78500_39611_034_v150.jpg
            domain === "www.stnsports.co.kr" ||
            // http://www.thekpm.com/news/thumbnail/201806/21213_21127_1440_v150.jpg
            domain === "www.thekpm.com" ||
            // http://chunchu.yonsei.ac.kr/news/thumbnail/201806/24380_12155_3112_v150.jpg
            domain === "chunchu.yonsei.ac.kr" ||
            // http://www.e2news.com/news/thumbnail/201807/200453_60290_1157_v150.jpg
            domain === "www.e2news.com" ||
            // http://www.newswiz.kr/news/thumbnail/201803/2250_2132_412_150.jpg
            domain_nowww === "newswiz.kr" ||
            // http://ph.spotvnews.co.kr/news/thumbnail/201809/234592_287106_0230_150.jpg
            //   http://ph.spotvnews.co.kr/news/photo/201809/234592_287106_0230.jpg
            domain === "ph.spotvnews.co.kr" ||
            // http://www.sisunnews.co.kr/news/thumbnail/201603/34339_48461_5310_v150.jpg
            domain_nowww === "sisunnews.co.kr" ||
            // http://www.kpinews.co.kr/news/thumbnail/201810/83057_52603_315_150.jpg
            domain_nowww === "kpinews.co.kr" ||
            // http://www.newstown.co.kr/news/thumbnail/201801/311251_198441_4816_v150.jpg
            domain_nowww === "newstown.co.kr") {
            return add_extensions_upper(src
                                        .replace("/thumbnail/", "/photo/")
                                        .replace(/_v[0-9]*\.([^/]*)$/, ".$1")
                                        .replace(/(\/[0-9]+_[0-9]+_[0-9]+)_150(\.[^/.]*)$/, "$1$2"));
        }

        if (domain === "img.hankyung.com") {
            // http://img.hankyung.com/photo/201808/ZK.17491055.3.jpg
            //   http://img.hankyung.com/photo/201808/ZK.17491055.1.jpg
            return src.replace(/\.[0-9]\.([a-zA-Z0-9]*)$/, ".1.$1");
        }

        if (domain === "cdn.newsen.com" ||
            domain === "photo.newsen.com") {
            // http://photo.newsen.com/news_photo/2011/04/28/201104281531181001_1.jpg -- 2880x4320
            // http://cdn.newsen.com/newsen/news_photo/2011/04/28/201104281531181001_1.jpg -- same
            src = src.replace(/_ts\.[^/._]*$/, ".jpg").replace("/mphoto/", "/news_photo/");
            if (src.indexOf("/main_photo/") >= 0) {
                // http://cdn.newsen.com/newsen/main_photo/index_a2_201801030825321910_1.jpg
                //   http://cdn.newsen.com/newsen/news_photo/2018/01/03/201801030825321910_1.jpg
                // http://cdn.newsen.com/newsen/main_photo/mobile/favphoto_201807131531391510_1.jpg
                //   http://cdn.newsen.com/newsen/news_photo/2018/07/13/201807131531391510_1.jpg
                //   http://photo.newsen.com/news_photo/2018/07/13/201807131531391510_1.jpg
                src = src.replace(/\/main_photo\/(?:mobile\/)?[^/]*_([0-9][0-9][0-9][0-9])([0-9][0-9])([0-9][0-9])([^/]*)$/, "/news_photo/$1/$2/$3/$1$2$3$4");
            }

            return src;
        }

        if (domain_nosub === "chosun.com" ||
            domain_nosub === "chosunonline.com") {
            // works:
            // http://woman.chosun.com/up_fd/wc_news/2018-01/simg_thumb/1802_292s.jpg
            //   http://woman.chosun.com/up_fd/wc_news/2018-01/simg_org/1802_292s.jpg
            //   http://woman.chosun.com/up_fd/wc_news/2018-01/bimg_org/1802_292.jpg
            // http://woman.chosun.com/up_fd/wc_news/2018-01/simg_org/1802_294s.jpg
            //   http://woman.chosun.com/up_fd/wc_news/2018-01/bimg_org/1802_294.jpg
            // http://woman.chosun.com/up_fd/wc_news/2018-02/simg_org/1802_88s.jpg
            //   http://woman.chosun.com/up_fd/wc_news/2018-02/bimg_org/1802_88.jpg
            // http://woman.chosun.com/up_fd/wc_news/2018-02/simg_org/1802_340s.jpg
            //   http://woman.chosun.com/up_fd/wc_news/2018-02/bimg_org/1802_340.jpg
            // http://woman.chosun.com/up_fd/wc_news/2018-01/simg_org/1802_294s.jpg
            //   http://woman.chosun.com/up_fd/wc_news/2018-01/bimg_org/1802_294.jpg
            // http://woman.chosun.com/up_fd/wc_news/2018-02/simg_org/1802_322s.jpg
            //   http://woman.chosun.com/up_fd/wc_news/2018-02/bimg_org/1802_322.jpg
            // http://ekr.chosunonline.com/site/data/thumb_dir/2018/02/23/2018022301051_1_thumb.jpg
            //   http://ekr.chosunonline.com/site/data/img_dir/2018/02/23/2018022301051_1.jpg
            // http://ekr.chosunonline.com/site/data/thumb_dir/2018/02/21/2018022101757_3_thumb.jpg
            //   http://ekr.chosunonline.com/site/data/img_dir/2018/02/21/2018022101757_3.jpg
            // http://sccdn.chosun.com/news/photobook/201504/13267_scr_201504140000000022741_t.jpg
            //   http://sccdn.chosun.com/news/photobook/201504/13267_201504140000000022741.jpg
            // http://sccdn.chosun.com/news/photobook/201504/13267_2015041400000000000122741_t.jpg
            //   http://sccdn.chosun.com/news/photobook/201504/13267_2015041400000000000122741.jpg
            // http://sccdn.chosun.com/news/photobook/201203/4488_scr_%EB%8D%9C%EB%8D%9C_t.jpg
            //
            // doesn't work:
            // http://woman.chosun.com/up_fd/wc_news/2018-01/simg_org/1801_164s.jpg
            // http://ekr.chosunonline.com/site/data/img_dir/2015/07/16/2015071601601_thumb.jpg
            // large:
            // http://sccdn.chosun.com/news/photobook/201710/23202_2017101301010007001.jpeg
            // http://sccdn.chosun.com/news/photobook/201412/11896_20141201010101000972.jpeg
            // http://sccdn.chosun.com/news/photobook/201607/18084_207777778888816070401010002381.jpeg
            // http://sccdn.chosun.com/news/photobook/201412/11896_2014120101000156100006731.jpg - small
            // http://sccdn.chosun.com/news/photobook/201412/11896_2014120101000155800006701.jpg - ^

            if (domain === "sccdn.chosun.com") {
                return src.replace(/\/([0-9]*_)(?:scr_)?([^._/]*)(?:_t)?(\.[^/.]*)$/, "/$1$2$3");
            }

            return src
                //.replace(/\/simg_(?:thumb|org)\/([^/]*)s(\.[^/.]*)$/, "/bimg_org/$1$2")
                .replace("/simg_thumb/", "/simg_org/")
                .replace(/\/thumb_dir\/(.*)_thumb(\.[^/.]*)$/, "/img_dir/$1$2")
                // http://image.chosun.com/sitedata/thumbnail/201803/08/2018030801755_0_thumb.jpg
                //   http://image.chosun.com/sitedata/image/201803/08/2018030801755_0.jpg
                .replace(/\/thumbnail\/(.*?)(?:_thumb)?(\.[^/.]*)$/, "/image/$1$2");
        }

        // replaced in large rule above
        /*if (domain.indexOf("ph.spotvnews.co.kr") >= 0 && false) {
            return src.replace("/thumbnail/", "/photo/").replace(/([0-9]+_[0-9]+_[0-9]+)_[0-9]+\.([^/]*)$/, "$1.$2");
        }*/

        if (domain === "photo.hankooki.com") {
            // http://photo.hankooki.com/newsphoto/v001/thumbs/2017/06/23/tsjmao20170623113309_O_00_C_1.jpg
            // http://photo.hankooki.com/newsphoto/v001/2017/06/23/sjmao20170623113309_O_00_C_1.jpg

            // http://photo.hankooki.com/arch/thumbs/P/2017/10/25/t20171025182853_P_00_C_1_846.jpg
            // http://photo.hankooki.com/arch/photo/P/2017/10/25/20171025182853_P_00_C_1_846.jpg
            // http://photo.hankooki.com/arch/original/P/2017/10/25/20171025182853_P_00_C_1_846.jpg

            // http://photo.hankooki.com/newsphoto/yonhap/thumbs/2016/05/17/t_20160517121834.jpg
            // http://photo.hankooki.com/newsphoto/yonhap/2016/05/17/20160517121834.jpg

            // http://photo.hankooki.com/newsphoto/v001/thumbs/2018/01/28/20180128000108_1_holic.jpg -- doesn't work
            //   http://photo.hankooki.com/newsphoto/v001/2018/01/27/jay1220180127233802_P_02_C_1.jpg (unrelated url?)

            // http://photo.hankooki.com/newsphoto/v001/thumbs/2014/11/11/tegeriace20141111172610_X_01_C_1.jpg -- doesn't work, tries to go to:
            //   http://photo.hankooki.com/newsphoto/v001/2014/11/11/egeriace20141111172610_X_01_C_1.jpg
            // real:
            //   http://photo.hankooki.com/newsphoto/v001/2014/11/11/wegeriace20141111172610_X_01_C_1.jpg
            newsrc = src.replace("/arch/photo/", "/arch/original/")
                .replace("/arch/thumbs/", "/arch/original/")
                .replace(/(\/newsphoto\/[^/]*\/)thumbs\//, "$1");
                //.replace(/(.*\/)t([0-9]*[^/]*)$/, "$1$2");
            if (newsrc !== src) {
                return newsrc.replace(/(.*\/)t_?([^/]*)$/, "$1$2");
            } else {
                return src;
            }
        }

        if (domain_nosub === "ettoday.net") {
            // https://cdn2.ettoday.net/images/1760/d1760595.jpg
            //   https://cdn2.ettoday.net/images/1760/1760595.jpg
            // https://static.ettoday.net/images/3341/c3341311.jpg -- 400x267
            //   https://static.ettoday.net/images/3341/3341311.jpg -- 5499x3666
            return src.replace(/\/[a-z]*([0-9]*\.[^/]*)$/, "/$1");
        }

        if (domain === "img.mbn.co.kr") {
            // http://img.mbn.co.kr/filewww/news/other/2012/04/30/340200121110.jpg - 5705x2917
            return src.replace(/_s[0-9]+x[0-9]+(\.[^/]*)$/, "$1");
        }

        if ((domain_nosub === "inews24.com" &&
             domain.match(/image[0-9]*\.inews24\.com/)) ||
            // http://inews24.ext3.cache.iwinv.net/image_joy/thumbnail/201804/152292797427_1_203359.jpg
            //   http://inews24.ext3.cache.iwinv.net/image_joy/201804/152292797427_1_203359.jpg
            // http://inews24.cache.iwinv.net/image_joy/thumbnail/201604/1461628592495_1_173610.jpg
            //   http://inews24.cache.iwinv.net/image_joy/201604/1461628592495_1_173610.jpg
            (domain_nosub === "iwinv.net" &&
             domain.match(/inews24\.(?:ext[0-9]+\.)?cache\.iwinv\.net/))) {
            return src.replace("/thumbnail/", "/");
        }

        if (domain === "image-gd.inews24.com") {
            // http://image-gd.inews24.com/image.php?u=/image_joy/201804/1522932288117_1_214943.jpg
            //   http://image-gd.inews24.com/image2.php?u=/image_joy/201804/1522932288117_1_214943.jpg
            //   http://image3.inews24.com/image_joy/201804/1522932288117_1_214943.jpg
            return src.replace(/:\/\/[^/]*\/image[0-9]*\.php\?u=([^&]*).*/, "://image3.inews24.com$1");
        }

        if (domain_nosub === "wowkorea.jp" &&
            (src.indexOf(".wowkorea.jp/img") >= 0 ||
             src.indexOf(".wowkorea.jp/upload") >= 0)) {
            // works:
            // http://kt.wowkorea.jp/img/album/10/54888/94580_l.jpg
            //   http://kt.wowkorea.jp/img/album/10/54888/94580.jpg
            // http://image.wowkorea.jp/upload/news/214660/20180612_cosm_n.jpg
            //   http://image.wowkorea.jp/upload/news/214660/20180612_cosm.jpg
            // http://kt.wowkorea.jp/img/album/8/43853/78804_ss.jpg
            //   http://kt.wowkorea.jp/img/album/8/43853/78804.jpg
            //
            // http://www.wowkorea.jp/upload/news/153102/450_teyon1003.jpg
            //   http://www.wowkorea.jp/upload/news/153102/teyon1003.jpg -- not sure how to make a rule for this
            // doesn't work:
            // http://kt.wowkorea.jp/img/news/3/19899/53692_s.jpg
            //   http://kt.wowkorea.jp/img/news/3/19899/53692_l.jpg - works
            //   http://kt.wowkorea.jp/img/news/3/19899/53692.jpg - 404
            // http://kt.wowkorea.jp/img/news/3/19961/53856_160.jpg
            if (src.indexOf("/img/album/") < 0 &&
                !src.match(/\/upload\/news\/+[0-9]+\//)) {
                return src.replace(/([^/]*_)[a-z0-9]*(\.[^/.]*)$/, "$1l$2");
            }
            newsrc = src.replace(/_(?:[a-z0-9]|ss)(\.[^/.]*)$/, "$1");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nosub === "saostar.vn" &&
            domain.match(/img[0-9]*\.saostar\.vn/)) {
            // https://img.saostar.vn/fb660png_1/2017/11/04/1750083/img_0127.jpg/fbsscover.png
            //   https://img.saostar.vn/2017/11/04/1750083/img_0127.jpg
            newsrc = src
                .replace(/saostar.vn\/fb[0-9]+[^/]*(\/.*\.[^/.]*)\/[^/]*$/, "saostar.vn$1")
                .replace(/saostar.vn\/[a-z][0-9]+\//, "saostar.vn/")
                .replace(/saostar.vn\/[0-9]+x[0-9]+\//, "saostar.vn/");
            if (newsrc !== src)
                return newsrc;
        }

        // keep this?
        if (domain_nosub.match(/^google\./) &&
            src.match(/\/www\.google\.(?:[a-z]+\.)?[a-z]*\/url\?/)) {
            return decodeURIComponent(src.replace(/.*url=([^&]*).*/, "$1"));
        }

        if ((domain_nowww === "lipstickalley.com" ||
             // https://stephenking.com/xf/proxy.php?image=http%3A%2F%2Fimages.askmen.com%2Fphotos%2Fdimension-films-presents-the-world-premiere-of-1408%2F20574.jpg&hash=f8f6f7179d75c0fd0a960ac5e65612a2
             //   http://images.askmen.com/photos/dimension-films-presents-the-world-premiere-of-1408/20574.jpg
             domain_nowww === "stephenking.com" ||
             domain.indexOf("forum.purseblog.com") >= 0) &&
            src.indexOf("/proxy.php?") >= 0) {
            return decodeURIComponent(src.replace(/.*image=([^&]*).*/, "$1"));
        }

        if (domain === "images.askmen.com") {
            // http://images.askmen.com/photos/dimension-films-presents-the-world-premiere-of-1408/20574.jpg
            return {
                url: src,
                head_wrong_contentlength: true
            };
        }

        if ((domain_nosub === "127.net" &&
             domain.indexOf("nosdn.127.net") >= 0) &&
            (src.indexOf("nosdn.127.net/img/") >= 0 ||
             src.indexOf("nosdn.127.net/photo/") >= 0)) { //lofter
            // http://imglf1.nosdn.127.net/img/cVVvSm1kaHhURWlQcVkyQVBzZ2lMRExONjBVS1N1UnZUV3dvQ3BtaFVuYjFuUk9EUG5OcnFnPT0.jpg?imageView&thumbnail=1680x0&quality=96&stripmeta=0&type=jpg%7Cwatermark&type=2&text=wqkg5p6B5ZywIC8ga3lva3VjaGkubG9mdGVyLmNvbQ==&font=bXN5aA==&gravity=southwest&dissolve=30&fontsize=680&dx=32&dy=36&stripmeta=0
            //   http://imglf1.nosdn.127.net/img/cVVvSm1kaHhURWlQcVkyQVBzZ2lMRExONjBVS1N1UnZUV3dvQ3BtaFVuYjFuUk9EUG5OcnFnPT0.jpg
            // http://imglf0.nosdn.127.net/img/cytFZVcyeDNVU2pvR0l0QkdXM0FBUmJuU1paTnVDQnM1UmJ4T3BhNE94WW1BZlVOQ1dLSld3PT0.png?imageView&thumbnail=500x0&quality=96&stripmeta=0&type=jpg
            // http://pic-bucket.nosdn.127.net/photo/0001/2018-01-24/D8SM4CRK00AP0001NOS.jpg?imageView&amp;thumbnail=100y75
            //   http://pic-bucket.nosdn.127.net/photo/0001/2018-01-24/D8SM4CRK00AP0001NOS.jpg
                return {
                    url: src.replace(/\?.*$/, ""),
                    headers: {
                        "Referer": "https://lofter.com"
                    }
                };
        }

        if (domain === "board.makeshop.co.kr") {
            // http://board.makeshop.co.kr/board/premium204/mastideco_image2/mini::20130513094047.jpg
            //   http://board.makeshop.co.kr/board/premium204/mastideco_image2/20130513094047.jpg
            return src.replace(/\/[a-z]*::/, "/");
        }

        if (domain_nosub === "naver.jp" &&
            domain.match(/^rr\.img[0-9]*\.naver\./)) {
            // https://rr.img1.naver.jp/mig?src=http%3A%2F%2Fimgcc.naver.jp%2Fkaze%2Fmission%2FUSER%2F20161018%2F76%2F7776016%2F17%2F600x450x28290423f03522c4ff136cd5.jpg&twidth=414&theight=0&qlt=80&res_format=jpg&op=r
            //   http://imgcc.naver.jp/kaze/mission/USER/20161018/76/7776016/17/600x450x28290423f03522c4ff136cd5.jpg
            //return decodeURIComponent(src.replace(/.*src=([^&]*).*/, "$1"));
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/mig.*?[?&]src=([^&]*).*?$/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);
        }

        if (domain === "imgcc.naver.jp") {
            // http://imgcc.naver.jp/kaze/mission_anm/USER/20141027/15/1773065/0/thumb/450x253x18f52e3379003e23293ac0c3_300_600.gif
            //   http://imgcc.naver.jp/kaze/mission_anm/USER/20141027/15/1773065/0/450x253x18f52e3379003e23293ac0c3.gif
            // http://imgcc.naver.jp/kaze/mission_anm/USER/20141027/15/1773065/0/450x253x18f52e3379003e23293ac0c3.gif/300/600
            //   http://imgcc.naver.jp/kaze/mission_anm/USER/20141027/15/1773065/0/450x253x18f52e3379003e23293ac0c3.gif
            //return src.replace(/\/[0-9]+\/[0-9]+\/*$/, "");
            return src
                .replace(/\/thumb(\/[0-9]+x[0-9]+x[0-9a-f]+)_[0-9]+_[0-9]+(\.[^/.]*)$/, "$1$2")
                .replace(/\/[0-9]+\/[0-9]+\/*(?:[?&].*)?$/, "");
        }

        if (domain === "dimg.donga.com") {
            // http://dimg.donga.com/c/138/175/90/1/wps/NEWS/IMAGE/2018/04/04/89455472.2.jpg
            //   http://dimg.donga.com/wps/NEWS/IMAGE/2018/04/04/89455472.2.jpg
            // http://dimg.donga.com/a/280/60/90/2/wps/NEWS/FEED/Top_Main_Top_2013/89467049.1.thumb.jpg
            //   http://dimg.donga.com/wps/NEWS/FEED/Top_Main_Top_2013/89467049.1.thumb.jpg
            return src
                .replace(/\/[ca]\/(?:[0-9]+\/){4}/, "/")
                .replace(/\/i\/[0-9]+\/[0-9]+\/[0-9]+\//, "/");
        }

        if (domain === "imgpark.donga.com" && src.indexOf("/fileUpload/") >= 0) {
            // http://imgpark.donga.com/mbs/fileUpload/201507/02/55948bb91e89b4e44119.jpg
            return {
                url: src,
                headers: {
                    Referer: "http://mlbpark.donga.com/"
                }
            };
        }

        if ((domain_nosub === "marishe.com" &&
             domain.match(/s[0-9]\.marishe\.com/)) ||
            // https://www.klik.gr/uploads_image/2017/06/19/p1bivfplat1vjv1ls95fr57b10rlt_900.jpg
            //   https://www.klik.gr/uploads_image/2017/06/19/p1bivfplat1vjv1ls95fr57b10rlt.jpg
            (domain_nowww === "klik.gr" && src.indexOf("/uploads_image/") >= 0) ||
            // http://eroticasearch.net/content/pics/ce9/ce9462d41e02e0c73662f316b1ebaf8f_400.jpg
            //   http://eroticasearch.net/content/pics/ce9/ce9462d41e02e0c73662f316b1ebaf8f.jpg
            (domain_nowww === "eroticasearch.net" && src.indexOf("/content/pics/") >= 0) ||
            // http://resource.breakingnews.mn/image/2015/09/30/0p23eruc8h4gu2mi/articleemmawatson167901856201509301039_400.jpg
            //   http://resource.breakingnews.mn/image/2015/09/30/0p23eruc8h4gu2mi/articleemmawatson167901856201509301039.jpg
            domain === "resource.breakingnews.mn") {
            newsrc = src.replace(/(\/[^/]*)_[0-9]+(\.[^/.]*)$/, "$1$2");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nowww === "klik.gr") {
            return {
                url: src,
                can_head: false
            };
        }

        // img77
        /*if (domain.match(/img[0-9]*\.dreamwiz\.com/)) {
            // most tested don't work (anymore?)
            // http://img77.dreamwiz.com/MV/2006/y/yfGjHAz_l.jpg -- 3000x1994
            // http://img77.dreamwiz.com/YTN_IMAGE/20180316/201803161101514477_d.jpg -- 2500x1667
            return src.replace(/(\/[^/]*)_[a-z]\.([^/.]*)$/, "$1_o.$2");
        }*/

        if (domain === "cdn.hk01.com") {
            // https://cdn.hk01.com/di/media/images/1016988/org/95b53d52af36ddfa9103948bdfc9ccdd.jpg/ZfwdPWx-CWi144GhhxOAdNml9EacWur1YaGOe2Ghjns?v=w1920 -- stretched
            //   https://cdn.hk01.com/di/media/images/1016988/org/95b53d52af36ddfa9103948bdfc9ccdd.jpg/ZfwdPWx-CWi144GhhxOAdNml9EacWur1YaGOe2Ghjns
            // https://cdn.hk01.com/di/media/images/1552737/org/b7034991651c8724ee7f02176fcd853b.JPG/h4N9QxvaH15uPPX8Agz_dSIL0ikqT1nBef3OuXn9zrk?v=w1920r16_9
            //   https://cdn.hk01.com/di/media/images/1552737/org/b7034991651c8724ee7f02176fcd853b.JPG/h4N9QxvaH15uPPX8Agz_dSIL0ikqT1nBef3OuXn9zrk
            // https://cdn.hk01.com/media/images/1432611/xlarge/4b37b8fbd88672371e5f090abc2acf59.jpg
            //   https://cdn.hk01.com/media/images/1432611/org/4b37b8fbd88672371e5f090abc2acf59.jpg
            // https://cdn.hk01.com/media/images/1357333/xlarge/43372fd2c8e52bec13601ad123401616.jpg -- stretched
            //   https://cdn.hk01.com/media/images/1357333/org/43372fd2c8e52bec13601ad123401616.jpg
            return src
                .replace(/(\/media\/images\/[^/]*\/)[^/]*\//, "$1org/")
                .replace(/\?.*/, "");
        }

        if (domain_nosub === "sinaimg.cn") {
            // works:
            // http://ss12.sinaimg.cn/orignal/66a6ce75g8b46ba3a373b&690
            // http://ss12.sinaimg.cn/orignal/6bc10695g923b8902976b&690
            // http://ss7.sinaimg.cn/orignal/67a7cd73g8b48c289ae26&690
            // http://ss6.sinaimg.cn/orignal/6b3178f4g92678953d725&690
            // doesn't:
            // http://ww4.sinaimg.cn/large/ad769c8bgy1fnaovhjp4rj21m62iob2d.jpg
            //   http://ww4.sinaimg.cn/woriginal/ad769c8bgy1fnaovhjp4rj21m62iob2d.jpg - works
            // http://wx3.sinaimg.cn/large/71080fe4gy1fehxmeusddj21kw2ddb2a.jpg
            // https://wxt.sinaimg.cn/large/006Qyga5ly1fnsl8inznlj31ww2pgqv8.jpg
            //
            // http://k.sinaimg.cn/n/ent/transform/w150h100/20180227/Mf6R-fyrwsqi6927544.jpg/w150h100f1t0l0syf.png
            //   http://n.sinaimg.cn/sinacn/w603h580/20180227/b993-fyrwsqi5950343.jpg
            // http://n.sinaimg.cn/ent/transform/w500h750/20180206/FzeL-fyrhcqz0888399.jpg
            //   http://k.sinaimg.cn/ent/transform/w500h750/20180206/FzeL-fyrhcqz0888399.jpg - doesn't work (bad request)
            //   http://n.sinaimg.cn/sinacn/w500h750/20180206/FzeL-fyrhcqz0888399.jpg - doesn't work
            //
            // http://n.sinaimg.cn/translate/w750h484/20180206/c8U1-fyrhcqy9899138.jpg
            //   http://n.sinaimg.cn/transform/w750h484/20180206/c8U1-fyrhcqy9899138.jpg - doesn't work
            //
            // http://n.sinaimg.cn/translate/20170819/QwU0-fykcpru8486163.jpg
            //
            // http://n.sinaimg.cn/ent/4_ori/upload/a57892fc/w2048h3072/20180217/zPxq-fyrpeif2120125.jpg
            //
            // https://tc.sinaimg.cn/maxwidth.800/tc.service.weibo.com/img_mp_itc_cn/8236ed1acca6f9b1f2d57a59cb5088cf.jpg
            //   https://tc.sinaimg.cn/original/tc.service.weibo.com/img_mp_itc_cn/8236ed1acca6f9b1f2d57a59cb5088cf.jpg -- 403 if head
            if (src.match(/:\/\/[^/]*\/max(?:width|height)\.[0-9]+\//)) {
                return {
                    url: src.replace(/(:\/\/[^/]*\/)[^/]*\//, "$1original/"),
                    can_head: false
                };
            }

            if (domain.match(/^ss/)) {
                src = src.replace(/\.sinaimg\.cn\/[^/]*\/([^/]*)\/*$/, ".sinaimg.cn/orignal/$1");
            } else {
                src = src.replace(/\.sinaimg\.cn\/[^/]*\/([^/]*)\/*$/, ".sinaimg.cn/large/$1");
            }

            if (domain.match(/^n\./)) {
                // http://n.sinaimg.cn/ent/4_img/upload/75913a59/20170522/iHLB-fyfkzhs8250377.jpg
                //   http://n.sinaimg.cn/ent/4_ori/upload/75913a59/20170522/iHLB-fyfkzhs8250377.jpg
                newsrc = src.replace(/(\/ent\/[0-9]+_)img(\/upload\/)/, "$1ori$2");
                if (newsrc !== src)
                    return newsrc;
            }

            // http://www.sinaimg.cn/dy/slidenews/4_t500/2014_15/704_1283534_165508.jpg
            //   http://www.sinaimg.cn/dy/slidenews/4_img/2014_15/704_1283534_165508.jpg
            return src.replace(/\/slidenews\/([^/_]*)_[^/_]*\//, "/slidenews/$1_img/"); // there's also _ori, but it seems to be smaller?
        }

        if (domain_nosub === "sina.com.cn" && domain.match(/^static[0-9]\.photo\.sina\.com\.cn/)) {
            // http://static7.photo.sina.com.cn/medium/49d0afb2g87b3e7e7a066&690
            //   http://ss7.sinaimg.cn/medium/49d0afb2g87b3e7e7a066&690
            //   http://ss7.sinaimg.cn/orignal/49d0afb2g87b3e7e7a066&690
            return src.replace(/:\/\/static([0-9]*)\.photo\.sina\.com\.cn\//, "://ss$1.sinaimg.cn/");
        }

        if (domain === "thumbnail.egloos.net" ||
            // http://thumb.egloos.net/460x0/http://pds25.egloos.com/pds/201208/22/41/f0095041_503490baddcc4.jpg
            //   http://pds25.egloos.com/pds/201208/22/41/f0095041_503490baddcc4.jpg
            domain === "thumb.egloos.net") {
            // http://thumbnail.egloos.net/600x0/http://pds27.egloos.com/pds/201802/20/90/e0060990_5a8bc59b9b6c5.jpg
            //   http://pds27.egloos.com/pds/201802/20/90/e0060990_5a8bc59b9b6c5.jpg
            return src.replace(/^[a-z]+:\/\/thumb(?:nail)?\.egloos\.net\/[^/]*\/*/, "");
        }

        if (domain === "k.kakaocdn.net") {
            // https://k.kakaocdn.net/dn/YRLG1/btqfOF1cFrB/OgpuqdEHB0GR3FmuwUHMtK/img_l.jpg -- 800x1200
            //   https://k.kakaocdn.net/dn/YRLG1/btqfOF1cFrB/OgpuqdEHB0GR3FmuwUHMtK/img.jpg -- 3000x4500
            return src.replace(/\/img_[a-z]*\.([^./]*)$/, "/img.$1");
        }

        if (domain === "images.sportskhan.net" ||
            // http://img.khan.co.kr/news/2018/08/13/l_2018081401000000000117731.jpg
            //   http://img.khan.co.kr/news/2018/08/13/2018081401000000000117731.jpg
            domain == "img.khan.co.kr") {
            return src
            // http://images.sportskhan.net/article/r/155x155/2016/04/25/l_2016042502001091100264931.jpg
            //   http://images.sportskhan.net/article/2016/04/25/l_2016042502001091100264931.jpg
                .replace(/\/r\/[0-9]+x[0-9]+\//, "/")
            // http://images.sportskhan.net/article/2016/04/25/l_2016042502001091100264931.jpg
            //   http://images.sportskhan.net/article/2016/04/25/2016042502001091100264931.jpg
                .replace(/\/[a-z]*_([0-9]+\.[a-z0-9A-Z]*)$/, "/$1")
            // http://images.sportskhan.net/spkn/ranking/c/94x94/3100/310005/20180904135417_31000501.jpeg
            //   http://images.sportskhan.net/spkn/ranking/3100/310005/20180904135417_31000501.jpeg
                .replace(/\/c\/[0-9]*x[0-9]*\//, "/")
            // http://img.khan.co.kr/news/2011/01/25/20110125.01200199991308.03S.jpg
            //   http://img.khan.co.kr/news/2011/01/25/20110125.01200199991308.03L.jpg -- L, M, S (tested all uppercase, lowercase)
                .replace(/(\/news\/[0-9]{4}\/[0-9]{2}\/[0-9]{2}\/[0-9]{8}\.[0-9]+\.[0-9]+)[A-Z](\.[^/.]*)$/, "$1L$2")
            // http://images.sportskhan.net/photodb/c/85x85/16/2017/10/25/GettyImages-865606556_594_screen.jpg
            //   http://images.sportskhan.net/PhotoDB/16/2017/10/25/GettyImages-865606556_594_screen.jpg
                .replace(/\/photodb\//, "/PhotoDB/");
        }

        if (domain_nosub === "sbs.co.kr" &&
            domain.match(/^img[0-9]*\.sbs\.co\.kr/)) {
            // http://img.sbs.co.kr/sbscnbc/upload/2017/11/06/10000590366_700.jpg
            //   http://img.sbs.co.kr/sbscnbc/upload/2017/11/06/10000590366.jpg
            newsrc = src.replace(/(\/[0-9]+)_[0-9]+\.([a-z0-9A-Z]*)$/, "$1.$2");
            if (newsrc !== src)
                return newsrc;

            // http://img2.sbs.co.kr/img/sbs_cms/SR/2017/06/26/SR88942637_w640_h360.jpg
            //   http://img2.sbs.co.kr/img/sbs_cms/SR/2017/06/26/SR88942637_ori.jpg
            return src.replace(/(\/[^_]*)_[^/.]*(\.[^/.]*)$/, "$1_ori$2");
        }

        if (domain === "image.board.sbs.co.kr") {
            // http://image.board.sbs.co.kr/2018/02/02/h191517549706907-600.jpg
            //   http://image.board.sbs.co.kr/2018/02/02/h191517549706907.jpg
            return src.replace(/-[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "edaily.co.kr" &&
            domain.indexOf("image.edaily.co.kr") >= 0 ||
            domain.indexOf("img.edaily.co.kr") >= 0) {
            // http://spnimage.edaily.co.kr/images/Photo/files/NP/S/2018/02/PS18021400011h.jpg
            // http://image.edaily.co.kr/images/Photo/files/NP/S/2018/02/PS18021100248t.jpg
            // (none, g), b, t, h, s, m
            // http://img.edaily.co.kr/images/photo/files/NP/S/2018/04/b_5ACD63A4B813DB7E7DBDBA63.jpg
            //   http://img.edaily.co.kr/images/photo/files/NP/S/2018/04/5ACD63A4B813DB7E7DBDBA63.jpg
            // others:
            // http://www.edaily.co.kr/news/news_detail.asp?newsId=01203766619110520&mediaCodeNo=257
            //  http://image.edaily.co.kr/images/photo/files/NP/S/2018/02/PS18021400103.jpg (original?)
            //  http://image.edaily.co.kr/images/photo/files/HN/H/2018/02/HNE01203766619110520_LV1.jpg - zoomed in
            //  http://image.edaily.co.kr/images/photo/files/HN/H/2018/02/HNE01203766619110520.jpg - not zoomed in, but cropped
            // http://image.edaily.co.kr/images/photo/files/NP/S/2016/04/PS16040100068.jpg - 3278x4918

            // http://edaily.co.kr/news/news_detail.asp?newsId=02059846615960080&mediaCodeNo=257
            //  http://image.edaily.co.kr/images/photo/files/NP/S/2017/06/PS17060900211.jpg
            //
            //    http://beautyin.edaily.co.kr/read/news.asp?newsid=329216886615960080
            //     http://superdeskapi.edaily.co.kr/api/upload/5939e0ffb813db52b1fb81aa/raw?_schema=http
            return src
                .replace(/\/[a-z]_([A-Z0-9]+)\.([a-z0-9A-Z]*)$/, "/$1.$2")
                .replace(/(\/[A-Z0-9]+)[a-z]\.([a-z0-9A-Z]*)$/, "$1.$2");
        }

        // cloudinary
        // /master/master/ is another possible alternative
        if (domain === "media.glamour.com" ||
            // https://media.glamour.com/photos/58c420d33b757b7cc97d0a5f/master/w_644,c_limit/emma-watson.jpg

            // https://assets.teenvogue.com/photos/56c648746d38be8a461b4c31/master/pass/GettyImages-104044913_master.jpg
            domain === "assets.teenvogue.com" ||
            // https://assets.vogue.com/photos/55c651b108298d8be2265985/16:9/pass/00010fullscreen.jpg
            domain === "assets.vogue.com" ||
            // http://media.vanityfair.com/photos/58a77812c41f737fae527fab/16:9/w_1200,h_630,c_limit/t-march-issue-ed-letter-trump.jpg
            domain === "media.vanityfair.com" ||
            // http://media.gq.com/photos/58eb8e4c8e4ae708183f9291/3:2/w_300/Stephen-Curry-0517-GQ-FECU02-01.jpg
            domain === "media.gq.com" ||
            // https://media.wmagazine.com/photos/5b2fa4640008757085e61704/1:1/w_767/GettyImages-982174754.jpg
            domain === "media.wmagazine.com" ||
            // https://media.self.com/photos/5b5a606cf658c67200f6a772/4:3/w_570/SELF%2520film-139.jpg
            domain === "media.self.com" ||
            // https://media.pitchfork.com/photos/5931ce6dd13a3d6b24765f82/2:1/w_790/fd0304ef.jpeg
            domain === "media.pitchfork.com" ||
            // https://media.wired.com/photos/5b8837d22997aa2df18d9970/16:9/w_2400,c_limit/roomba.jpg
            domain === "media.wired.com" ||
            // https://media.golfdigest.com/photos/5a7498e5b9a33161e3689aa9/master/w_780,c_limit/180202-sb-party.jpg
            domain === "media.golfdigest.com" ||
            // https://media.architecturaldigest.com/photos/56380571a6f997a353b888a2/master/w_640,c_limit/worlds-best-stained-glass-windows-13-10.jpg
            domain === "media.architecturaldigest.com" ||
            // https://media.cntraveler.com/photos/59bb6a56e35d8f08044a32cf/16:9/pass/Rakotzbrucke-GettyImages-538162756.jpg
            // http://media.cntraveler.com/photos/59305e5611e6e853c33e7587/master/w_1440,c_limit/car-free-halibut-cove-alaska-GettyImages-496660709.jpg
            domain === "media.cntraveler.com" ||
            // https://media.allure.com/photos/5771af392554df47220a75cb/3:4/w_767/beauty-trends-blogs-daily-beauty-reporter-2016-05-19-selena-gomez-hair.jpg
            domain === "media.allure.com" ||
            src.match(/:\/\/[^/]*\/photos\/[0-9a-f]{24}\/[^/]*\/[^/]*\/[^/]*$/)) {
            return src.replace(/\/[^/]*\/[^/]*\/([^/]*)$/, "/original/original/$1");
        }

        if (domain_nosub === "cloudinary.com" ||
            // http://images.playmates.com/playboy-digital/image/fetch/q_80/http://images.contentful.com/l7es9q9kzr9z/KVC2bUAzyUkW6KaMgGkeA/2f45f07b331a60fc360ff8d641a29d7a/778_KimberlyMcArthur_15.jpg
            //   http://images.contentful.com/l7es9q9kzr9z/KVC2bUAzyUkW6KaMgGkeA/2f45f07b331a60fc360ff8d641a29d7a/778_KimberlyMcArthur_15.jpg
            domain === "images.playmates.com" ||
            // https://images.playboy.com/playboy-digital/image/fetch/s--s1yV9nz0--/c_fit,h_1024,q_80,w_1024/http://images-origin.playboy.com/ogz4nxetbde6/3CJdCBvUEU2qaE6E00CYQU/a8277fb2808ea265a219036c150c4ffe/24_Dodger.jpg
            // https://images.playboy.com/playboy-digital/image/fetch/s--82ZXSENj--/c_fit,h_1024,q_80,w_1024%2Fhttp%3A%2F%2Fimages-origin.playboy.com%2Fogz4nxetbde6%2F5hBHszaLoWia0AGcMQQOKs%2F84892f7ff68f2755536203b369398814%2F04_Dodger.jpg
            //   http://images-origin.playboy.com/ogz4nxetbde6/5hBHszaLoWia0AGcMQQOKs/84892f7ff68f2755536203b369398814/04_Dodger.jpg
            domain === "images.playboy.com" ||
            domain === "images.taboola.com") {
            // https://res.cloudinary.com/emazecom/image/fetch/c_limit,a_ignore,w_320,h_200/https%3A%2F%2Fimg-aws.ehowcdn.com%2F877x500p%2Fs3.amazonaws.com%2Fcme_public_images%2Fwww_ehow_com%2Fi.ehow.com%2Fimages%2Fa04%2Fbd%2Fic%2Fchemical-energy-work-3.1-800x800.jpg
            // https://images.taboola.com/taboola/image/fetch/f_jpg%2Cq_auto%2Cc_fill%2Cg_faces:auto%2Ce_sharpen/https%3A%2F%2Fwww.gannett-cdn.com%2F-mm-%2F2e56892f6a349ad47192b530425d443fb365e5e9%2Fr%3Dx1803%26c%3D3200x1800%2Fhttps%2Fmedia.gannett-cdn.com%2F37861007001%2F37861007001_5735420050001_5735409691001-vs.jpg%3FpubId%3D37861007001
            // https://res.cloudinary.com/emazecom/image/fetch/c_limit,a_ignore,w_320,h_200/http%3A%2F%2Fcdn.expansion.mx%2Fdims4%2Fdefault%2F5227468%2F2147483647%2Fthumbnail%2F850x478%255E%2Fquality%2F75%2F%3Furl%3Dhttps%253A%252F%252Fcdn.expansion.mx%252Fmedia%252F2010%252F06%252F08%252Fobreros-chinos-trabajadores-china.jpg
            if (src.search(/:\/\/[^/]*\/[^/]*\/image\/fetch\//) >= 0) {
                newsrc = src.replace(/.*?:\/\/[^/]*\/[^/]*\/image\/fetch\/(?:.*?(?:\/|%2F))?([^/%]*(?::|%3A).*)/, "$1");
                if (newsrc.match(/^[^/:]*%3A/))
                    newsrc = decodeURIComponent(newsrc);
                return newsrc;
            }

            // https://the-hollywood-gossip-res.cloudinary.com/iu/s--xSziJrCi--/t_v_xlarge_l/cs_srgb,f_auto,fl_strip_profile.lossy,q_auto:420/v1409168696/video/victoria-justice-twerks-dances-like-nicki-minaj.png
            //   https://the-hollywood-gossip-res.cloudinary.com/iu/v1409168696/video/victoria-justice-twerks-dances-like-nicki-minaj.png
            newsrc = src.replace(/(\/iu\/[^/]*)\/.*?(\/v[0-9]*\/)/, "$1$2");
            if (newsrc !== src)
                return newsrc;
        }

        // https://res.cloudinary.com/beamly/image/upload/s--Ayyiome3--/c_fill,g_face,q_70,w_479/f_jpg/v1/news/sites/6/2014/11/Nick-Hewer-The-Apprentice.jpg
        //   https://res.cloudinary.com/beamly/image/upload/v1/news/sites/6/2014/11/Nick-Hewer-The-Apprentice.jpg
        //   https://res.cloudinary.com/beamly/image/upload/news/sites/6/2014/11/Nick-Hewer-The-Apprentice.jpg
        // https://res.cloudinary.com/beamly/image/upload/s--pMOefc2U--/c_fill,g_face,q_70,w_1160/f_jpg/v1/news/sites/6/2014/05/LuisaSwimsuit621.jpg
        //   https://res.cloudinary.com/beamly/image/upload/v1/news/sites/6/2014/05/LuisaSwimsuit621.jpg
        // https://res.cloudinary.com/beamly/image/upload/s--1uSHUtr1--/c_fill,g_face,q_70,w_1160/f_jpg/v1/news/sites/6/2013/12/o-katie-hopkins-570.jpg
        //   https://res.cloudinary.com/beamly/image/upload/v1/news/sites/6/2013/12/o-katie-hopkins-570.jpg
        // http://thefader-res.cloudinary.com/private_images/w_1440,c_limit,f_auto,q_auto:best/Badgyal5RGB_wbgyon/bad-gyal-nicest-cocky-interview-dancehall-catalan.jpg
        //   http://thefader-res.cloudinary.com/private_images/c_limit/Badgyal5RGB_wbgyon/bad-gyal-nicest-cocky-interview-dancehall-catalan.jpg
        // https://res.cloudinary.com/dk-find-out/image/upload/q_80,w_1920,f_auto/MA_00079563_yvu84f.jpg
        // https://res.cloudinary.com/jerrick/image/upload/p7jbqvi0aoxm4mdn3x6x
        // https://talenthouse-res.cloudinary.com/image/upload/c_limit,f_auto,fl_progressive,h_2048,w_2048/v1457507984/user-555017/submissions/a1kqddzzmsoyjxh2mkks.jpg
        //   https://talenthouse-res.cloudinary.com/image/upload/c_limit,f_auto,fl_progressive,h_2048,w_2048/user-555017/submissions/a1kqddzzmsoyjxh2mkks.jpg
        //   https://talenthouse-res.cloudinary.com/image/upload/v1457507984/user-555017/submissions/a1kqddzzmsoyjxh2mkks.jpg
        //   https://talenthouse-res.cloudinary.com/image/upload/user-555017/submissions/a1kqddzzmsoyjxh2mkks.jpg
        // https://nordot-res.cloudinary.com/t_size_l/ch/images/359126053920392289/origin_1.jpg
        //   https://nordot-res.cloudinary.com/ch/images/359126053920392289/origin_1.jpg
        // https://the-hollywood-gossip-res.cloudinary.com/iu/s--xSziJrCi--/t_v_xlarge_l/cs_srgb,f_auto,fl_strip_profile.lossy,q_auto:420/v1409168696/video/victoria-justice-twerks-dances-like-nicki-minaj.png
        // http://res-4.cloudinary.com/uan/image/private/c_fill,d_event_default.jpg,g_north,h_640,q_80,w_1280/jzigjdloajy6wzbzqjk1.jpg
        //   http://res-4.cloudinary.com/uan/image/private/c_limit/jzigjdloajy6wzbzqjk1.jpg
        // https://res.cloudinary.com/teepublic/image/private/s--AcQdRwqc--/t_Resized%20Artwork/c_fit,g_north_west,h_1054,w_1054/co_ffffff,e_outline:53/co_ffffff,e_outline:inner_fill:53/co_bbbbbb,e_outline:3:1000/c_mpad,g_center,h_1260,w_1260/b_rgb:eeeeee/c_limit,f_jpg,h_630,q_90,w_630/v1518936493/production/designs/2373946_0.jpg
        if (domain_nosub === "cloudinary.com" &&
            (domain.indexOf("res.cloudinary.com") >= 0 ||
             domain.match(/res-[0-9]*\.cloudinary\.com/))) {
            newsrc = src
                // depends on repetition
                .replace(/\/image\/upload\/s\-\-[^/]*\-\-\//, "/image/upload/")
                .replace(/\/iu\/s\-\-[^/]*\-\-\//, "/iu/")
                .replace(/\/image\/upload\/[^/]*_[^/]*\//, "/image/upload/")
                .replace(/\/image\/upload\/v[0-9]+\//, "/image/upload/")
                //.replace(/(\/image\/upload\/)(?:(?:.*?\/?(v1\/))|(?:[^/]*\/))/, "$1$2")
                .replace(/(\/private_images\/)[^/]*\//, "$1c_limit/")
                .replace(/(\/image\/private\/)[^s][^-][^/]*\//, "$1c_limit/")
                .replace(/(:\/\/[^/]*\/)[^/]*\/(ch\/images\/[0-9]+\/[^/]*$)/, "$1$2");
            if (newsrc !== src) {
                return newsrc;
            }
        }

        if (domain === "images.complex.com") {
            // https://images.complex.com/complex/images/c_crop,h_2437,w_3289,x_0,y_1067/c_limit,w_680/fl_lossy,pg_1,q_auto/gc123hobhudxx063ak8v/converse-yung-lean-one-star
            //   https://images.complex.com/complex/images/gc123hobhudxx063ak8v/converse-yung-lean-one-star
            // https://images.complex.com/complex/image/upload/c_limit,w_680/fl_lossy,pg_1,q_auto/qh1ve8ncxzxlfiy9aauw.jpg
            //   https://images.complex.com/complex/image/upload/qh1ve8ncxzxlfiy9aauw.jpg
            // https://images.complex.com/complex/images/c_scale,w_1100/fl_lossy,pg_1,q_auto/blwjl76jv2vcqdgd3sqy/bella-thorne
            //   https://images.complex.com/complex/images/blwjl76jv2vcqdgd3sqy/bella-thorne
            // http://images.complex.com/complex/image/upload/t_article_image/ckxhi0lpw2jsvm3rx3f4.jpg
            //   http://images.complex.com/complex/image/upload/ckxhi0lpw2jsvm3rx3f4.jpg
            // https://images.complex.com/complex/images/c_scale,w_1100/fl_lossy,pg_1,q_auto/brfqstj5jihhzr9eu1bw/bella-thorne
            //   https://images.complex.com/complex/images/brfqstj5jihhzr9eu1bw/bella-thorne
            return src.replace(/\/(images|image\/upload)\/[^/]*_[^/]*\//, "/$1/");
        }

        // https://images.spot.im/image/upload/q_70,fl_lossy,dpr_1.0,h_300,w_320,c_fill,g_face/v200/production/watfc8itl4hcgavprfku
        //   https://images.spot.im/image/upload/production/watfc8itl4hcgavprfku
        if (domain === "images.spot.im" ||
            // https://fashionista.com/.image/ar_16:9%2Cc_fill%2Ccs_srgb%2Cg_faces:center%2Cq_80%2Cw_620/MTQyNjI1MjYyNTc4NzA1NzM0/emma-watson-promojpg.jpg
            // https://fashionista.com/.image/t_share/MTQ2Njg0NzA2NzUzMDk1NTQ3/gettyimages-672499332.jpg
            domain === "fashionista.com" ||
            // http://images.pigeonsandplanes.com/images/c_crop,h_2268,w_3024,x_0,y_330/c_limit,f_auto,fl_lossy,q_auto,w_1030/obk4degjo35h2jzuwyd7/opal-press-2017
            domain === "images.pigeonsandplanes.com" ||
            // https://images.sftcdn.net/images/t_optimized,f_auto/p/2fbcf826-96d0-11e6-ac58-00163ec9f5fa/62785002/gang-beasts-screenshot.jpg
            domain === "images.sftcdn.net" ||
            // http://cdn.primedia.co.za/primedia-broadcasting/image/upload/c_fill,h_289,q_70,w_463/o0nu1bpsbgpfgvwa7vmj
            domain === "cdn.primedia.co.za" ||
            // https://www.maxim.com/.image/c_limit%2Ccs_srgb%2Cq_80%2Cw_960/MTUzMzQ0MzA2MTQzNTAzNzUz/harley-davidson-livewire3.webp
            domain === "www.maxim.com" ||
            // https://img.thedailybeast.com/image/upload/c_crop,d_placeholder_euli9k,h_1439,w_2560,x_0,y_0/dpr_2.0/c_limit,w_740/fl_lossy,q_auto/v1492195023/articles/2014/10/19/the-world-s-most-beautiful-boat-yours-for-half-a-billion-dollars/141018-teeman-star-yacht-tease_tlw0nl
            domain === "img.thedailybeast.com" ||
            // https://alibaba.kumpar.com/kumpar/image/upload/h_153,w_273,c_fill,ar_16:9,g_face,f_jpg,q_auto,fl_progressive,fl_lossy/hzwutxv6kqhrj3grgbtf.jpg
            domain === "alibaba.kumpar.com" ||
            // https://5b0988e595225.cdn.sohucs.com/q_70,c_zoom,w_640/images/20180121/1fad12f07c90464295f05598305a08ad.jpeg
            domain === "5b0988e595225.cdn.sohucs.com" ||
            // nano defender blocks this?
            // https://images-cdn.moviepilot.com/images/c_fill,h_1800,w_2897/t_mp_quality/vg7z3yhfbklgnnlki3cs/angelina-jolie-s-next-project-is-close-to-her-heart-and-her-son-maddox-will-be-involved-530390.jpg
            domain === "images-cdn.moviepilot.com" ||
            // http://img.playbuzz.com/image/upload/f_auto,fl_lossy,q_auto/cdn/a205ab41-8564-4ed6-8bc2-42d742b284f0/de57f9d2-be24-43e8-910a-c972d8cf6cb8.jpg
            domain === "img.playbuzz.com" ||
            // https://images.discerningassets.com/image/upload/c_scale,h_44,w_90/v1424385252/ahmf3bignioajopkklpo.jpg
            domain === "images.discerningassets.com" ||
            // https://images.radio-canada.ca/q_auto,w_310/v1/ici-info/16x9/fusee-space-tsss.jpg
            domain === "images.radio-canada.ca" ||
            // https://img.wcdn.co.il/f_auto,w_100/2/0/4/7/2047784-46.jpg
            //   https://img.wcdn.co.il/2/0/4/7/2047784-46.jpg
            domain === "img.wcdn.co.il" ||
            // https://images.haarets.co.il/image/upload/w_2178,h_1267,x_22,y_99,c_crop,g_north_west/w_468,h_272,q_auto,c_fill,f_auto/fl_any_format.preserve_transparency.progressive:none/v1531586984/1.6270687.637195137.jpg
            //   https://images.haarets.co.il/image/upload/fl_any_format.preserve_transparency.progressive:none/1.6270687.637195137.jpg
            //   https://images.haarets.co.il/image/upload/1.6270687.637195137.jpg
            domain === "images.haarets.co.il" ||
            // https://images.cdn.yle.fi/image/upload/fl_keep_iptc,f_auto,fl_progressive/q_88/w_1600,h_900,c_fill,g_faces/w_500/v1531638823/13-1-50005334-1531638819357.jpg
            //   https://images.cdn.yle.fi/image/upload/fl_keep_iptc,f_auto,fl_progressive/13-1-50005334-1531638819357.jpg
            //   https://images.cdn.yle.fi/image/upload/13-1-50005334-1531638819357.jpg
            domain === "images.cdn.yle.fi" ||
            // https://sol.no/s/img/t_sol-forty-v2,w_490/solmediaCloudify/giwkcu7lqlluohdmbfcn.jpg
            //   https://sol.no/s/img/solmediaCloudify/giwkcu7lqlluohdmbfcn.jpg
            (domain_nowww === "sol.no" && src.indexOf("/img/") >= 0)||
            // https://prof.prepics-cdn.com/image/upload/c_fit,w_480/v1514146939/prcm_news-gazo-129019-3.jpg
            //   https://prof.prepics-cdn.com/image/upload/prcm_news-gazo-129019-3.jpg
            (domain === "prof.prepics-cdn.com" && src.indexOf("/image/upload/") >= 0) ||
            // https://images.ezvid.com/image/upload/fl_immutable_cache/c_limit,f_auto,h_400,w_400,q_auto:eco/rhnqlnvwkb39gukug44z
            //   https://images.ezvid.com/image/upload/fl_immutable_cache/rhnqlnvwkb39gukug44z
            domain === "images.ezvid.com" ||
            // https://img.peerspace.com/image/upload/c_crop,g_custom/g_auto,c_fill,q_auto:eco,f_auto,fl_progressive:steep,w_169,h_100/stoszz7hp3jjbwyrhyeb
            //   https://img.peerspace.com/image/upload/stoszz7hp3jjbwyrhyeb
            domain === "img.peerspace.com" ||
            // https://dhgywazgeek0d.cloudfront.net/watcha/image/upload/c_fill,h_400,q_80,w_280/v1520472661/t1f98e-142589.jpg
            //   https://dhgywazgeek0d.cloudfront.net/watcha/image/upload/t1f98e-142589.jpg
            domain === "dhgywazgeek0d.cloudfront.net" ||
            // https://planet-sports-res.cloudinary.com/images/q_80,f_auto,dpr_2.0,d_planetsports:products:nopic.jpg/planetsports/products/46867500_00/rip-curl-fiesta-bandeau-bikini-set-women-black.jpg
            //   https://planet-sports-res.cloudinary.com/images/planetsports/products/46867500_00/rip-curl-fiesta-bandeau-bikini-set-women-black.jpg
            (domain_nosub === "cloudinary.com" && domain.indexOf("res.cloudinary.com") >= 0 && src.indexOf("/images/") >= 0) ||
            // https://images.moviepilot.com/images/c_limit,q_auto:good,w_600/uom2udz4ogmkncouu83q/beauty-and-the-beast-credit-disney.jpg
            // https://images.moviepilot.com/image/upload/c_fill,h_64,q_auto,w_64/lpgwdrrgc3m8duvg7zt2.jpg
            domain === "images.moviepilot.com") {
            return src
                .replace(/%2C/g, ",")
                .replace(/\/[a-z]+_[^/_,]+(?:,[^/]*)?\//, "/")
                .replace(/\/fl_any_format\.[^/]*\//, "/")
                .replace(/\/fl_keep_iptc[^/]*\//, "/")
                .replace("/t_mp_quality/", "/")
                .replace(/\/v[0-9]+\//, "/");
        }

        if (domain === "image.kkday.com") {
            // https://image.kkday.com/image/get/w_1900%2Cc_fit/s1.kkday.com/product_17911/20170926035641_Kii80/jpg
            //   https://image.kkday.com/image/get/s1.kkday.com/product_17911/20170926035641_Kii80/jpg
            return src.replace(/\/image\/get\/[^/]*(?:%2C|,)[^/]*\//, "/image/get/");
        }

        if (domain === "images.fastcompany.net" ||
            // https://i.kinja-img.com/gawker-media/image/upload/s--aj1fB409--/c_fill,f_auto,fl_progressive,g_center,h_675,q_80,w_1200/181f6al0l60gjjpg.jpg -- stretched, cropped
            //   https://i.kinja-img.com/gawker-media/image/upload/181f6al0l60gjjpg.jpg
            domain === "i.kinja-img.com" ||
            // http://dwgyu36up6iuz.cloudfront.net/heru80fdn/image/upload/c_scale,h_315,w_560/g_south_east,l_newsletter_play_button_overlay,w_100,x_11,y_11/g_north_west,l_circle_brand_overlay_vanityfair,w_80,x_11,y_11/c_fill,d_placeholder_thescene.jpg,fl_progressive,g_center,q_80/v1426695217/vanityfair_vf-confidential-psych-of-a-psychopath-legend-with-a-bullet.jpg
            //   http://dwgyu36up6iuz.cloudfront.net/heru80fdn/image/upload/v1426695217/vanityfair_vf-confidential-psych-of-a-psychopath-legend-with-a-bullet.jpg
            domain === "dwgyu36up6iuz.cloudfront.net") {
            // https://images.fastcompany.net/image/upload/w_1280,f_auto,q_auto,fl_lossy/wp-cms/uploads/2018/04/3-braille-neue-combines-letters-you-can-touch-with-letters-you-can-see-1.jpg
            //   https://images.fastcompany.net/image/upload/wp-cms/uploads/2018/04/3-braille-neue-combines-letters-you-can-touch-with-letters-you-can-see-1.jpg
            return src.replace(/\/image\/upload\/[a-z]l?[_-][^/]*\//, "/image/upload/");
        }

        if (domain === "cdn.skim.gs") {
            // http://cdn.skim.gs/image/upload/c_fill,dpr_1.0,f_auto,fl_lossy,q_auto,w_940/v1456338060/msi/fc8_k4lgbp.jpg -- 940x1413 (stretched)
            //   http://cdn.skim.gs/image/upload/v1456338060/msi/fc8_k4lgbp.jpg -- 600x902
            return src
                .replace(/\/image\/upload\/[^/]*_[^/]*\//, "/image/upload/")
                .replace(/\/images\/[^/]*_[^/]*\//, "/images/");
        }

        if (((domain_nosub === "biography.com" ||
              domain === "www.guitarworld.com" ||
              domain === "www.guitaraficionado.com" ||
              domain === "www.psneurope.com") &&
             src.indexOf("/.image/") >= 0) ||
            src.match(/:\/\/[^/]*\/\.image\/[^/]*_[^/]*\/[A-Za-z-0-9]{24}\/[^/]*$/)) {
            // https://www.biography.com/.image/c_limit%2Ccs_srgb%2Cq_80%2Cw_960/MTI2NDQwNDA2NTg5MTUwNDgy/ariana-grande-shutterstock_213445195-600x487jpg.webp
            //   https://www.biography.com/.image/MTI2NDQwNDA2NTg5MTUwNDgy/ariana-grande-shutterstock_213445195-600x487jpg.webp
            // https://www.guitarworld.com/.image/t_share/MTUxNDQ0NTk1MTMyMDgxNDA3/keithrichardsgettyimages-71684054.jpg
            //   https://www.guitarworld.com/.image//MTUxNDQ0NTk1MTMyMDgxNDA3/keithrichardsgettyimages-71684054.jpg
            // https://www.guitarworld.com/.image/ar_8:10%2Cc_fill%2Ccs_srgb%2Cg_faces:center%2Cq_80%2Cw_620/MTUwNjEyNDY4MDM2MzQ3MjU2/keith_richards_2jpg.jpg
            //   https://www.guitarworld.com/.image//MTUwNjEyNDY4MDM2MzQ3MjU2/keith_richards_2jpg.jpg
            // https://www.psneurope.com/.image/c_limit%2Ccs_srgb%2Cq_80%2Cw_482/MTUwNjU0MjczNjQ2NjM0NjU3/vintage-studios-web.webp
            //   https://www.psneurope.com/.image/MTUwNjU0MjczNjQ2NjM0NjU3/vintage-studios-web.webp
            return src.replace(/(\/.image)\/[^/]*(\/[^/]*\/[^/]*)$/, "$1$2");
        }

        if (domain_nosub === "popsugar-assets.com" ||
            domain_nosub === "onsugar.com") {
            // https://media1.popsugar-assets.com/files/thumbor/Aq5Tn8-7kqPSJs4U0_QaYoM6x8Q/fit-in/1024x1024/filters:format_auto-!!-:strip_icc-!!-/2015/03/30/647/n/1922564/ccc1eafd_edit_img_cover_file_864129_1397566805/i/Emma-Watson-Best-Red-Carpet-Looks.png
            //   https://media1.popsugar-assets.com/files/2015/03/30/647/n/1922564/ccc1eafd_edit_img_cover_file_864129_1397566805/i/Emma-Watson-Best-Red-Carpet-Looks.png
            // https://media1.popsugar-assets.com/files/thumbor/1ktKvFdaPtIVjrL085ZgDu-0IUM/160x160/filters:format_auto-!!-:strip_icc-!!-:sharpen-!1,0,true!-/2014/04/09/959/n/1922564/d006b9f456c00f56_478466321_10/i/Emma-Watson-Wes-Gordon-2014-Noah-Germany-Premiere.jpg
            //   https://media1.popsugar-assets.com/files/2014/04/09/959/n/1922564/d006b9f456c00f56_478466321_10/i/Emma-Watson-Wes-Gordon-2014-Noah-Germany-Premiere.jpg
            // http://media1.popsugar-assets.com/files/thumbor/hEi29uVq6ywnKLkB2konCS2CMJI=/fit-in/2048xorig/2016/05/22/156/n/1922398/c7b25a8fd8aaab98_GettyImages-533596620/i/Mila-Kunis-Ashton-Kutcher-Billboard-Music-Awards-2016.jpg
            //   http://media1.popsugar-assets.com/files/2016/05/22/156/n/1922398/c7b25a8fd8aaab98_GettyImages-533596620/i/Mila-Kunis-Ashton-Kutcher-Billboard-Music-Awards-2016.jpg
            newsrc = src.replace(/\/thumbor\/[^/]*\/(?:fit-in\/)?[^/]*\/(?:filters:[^/]*\/)?/, "/");
            if (newsrc !== src)
                return newsrc;

            // http://media1.popsugar-assets.com/files/2013/02/08/2/192/1922398/13bc50e021acd58e_wenn10840119.xxxlarge/i/Spring-Breakers-Berlin-Red-Carpet-Premiere-Pictures.jpg
            //   http://media1.popsugar-assets.com/files/2013/02/08/2/192/1922398/13bc50e021acd58e_wenn10840119/i/Spring-Breakers-Berlin-Red-Carpet-Premiere-Pictures.jpg
            // https://media1.popsugar-assets.com/files/2015/09/02/221/n/37139775/d391fe8f30364ef0_15._2007_GettyImages-81449203/i/Selena-Gomez.jpg
            // http://media4.onsugar.com/files/2013/12/16/757/n/1922398/1f2e71247e26b096_Twoimageskinnyheadshot_R.jpg.xlarge/i/Gisele-Bundchen-Wearing-Bikini-Miami.jpg
            //   http://media4.onsugar.com/files/2013/12/16/757/n/1922398/1f2e71247e26b096_Twoimageskinnyheadshot_R/i/Gisele-Bundchen-Wearing-Bikini-Miami.jpg
            // http://media1.popsugar-assets.com/files/2014/04/09/009/n/1922441/9933a3baeee323df_141827630.xxxlarge_2x/i/Dog-Thinks-Parade-All-Him.jpg
            //   http://media1.popsugar-assets.com/files/2014/04/09/009/n/1922441/9933a3baeee323df_141827630/i/Dog-Thinks-Parade-All-Him.jpg
            // http://media1.popsugar-assets.com/files/2011/01/02/4/192/1922564/bacd60f46322150a_105266939.xxxlarge/i/Scarlett-Johansson-2004.jpg
            //   http://media1.popsugar-assets.com/files/2011/01/02/4/192/1922564/bacd60f46322150a_105266939/i/Scarlett-Johansson-2004.jpg
            // https://media1.popsugar-assets.com/files/2013/01/03/4/192/1922398/079410d93cbf965d_89387PCN_Banks44._original_wm/i/Elizabeth-Banks-Filming-Walk-Shame-Yellow-Dress.jpg
            //   https://media1.popsugar-assets.com/files/2013/01/03/4/192/1922398/079410d93cbf965d_89387PCN_Banks44/i/Elizabeth-Banks-Filming-Walk-Shame-Yellow-Dress.jpg
            // http://media2.popsugar-assets.com/files/2013/01/03/4/192/1922398/079410d93cbf965d_89387PCN_Banks44.xxxlarge_wm/i/Elizabeth-Banks-Filming-Walk-Shame-Yellow-Dress.jpg
            //   http://media2.popsugar-assets.com/files/2013/01/03/4/192/1922398/079410d93cbf965d_89387PCN_Banks44/i/Elizabeth-Banks-Filming-Walk-Shame-Yellow-Dress.jpg
            // http://media1.onsugar.com/files/2013/01/03/4/192/1922398/8aedd815f4d135be_89387PCN_Banks38.preview_wm/i/Elizabeth-Banks-Filming-Walk-Shame-Yellow-Dress.jpg
            //   http://media1.onsugar.com/files/2013/01/03/4/192/1922398/8aedd815f4d135be_89387PCN_Banks38/i/Elizabeth-Banks-Filming-Walk-Shame-Yellow-Dress.jpg
            // doesn't work:
            // http://media3.popsugar-assets.com/files/2013/09/16/795/n/1922564/b962955383f6b80f_1592163256t6a65.xxxlarge_2x/i/Emma-Watson-all-legs-sexy-Peter-Pilotto-cutout-minidress.jpg
            //   http://media3.popsugar-assets.com/files/2013/09/16/795/n/1922564/b962955383f6b80f_1592163256t6a65/i/Emma-Watson-all-legs-sexy-Peter-Pilotto-cutout-minidress.jpg -- doesn't work (403)
            // http://media4.popsugar-assets.com/files/2015/12/14/081/n/1922398/74d22b8d4b738d72_GettyImages-491215020E3065m.xxxlarge.jpg
            //   http://media4.popsugar-assets.com/files/2015/12/14/081/n/1922398/74d22b8d4b738d72_GettyImages-491215020E3065m.jpg -- doesn't work
            //   http://media4.popsugar-assets.com/files/2015/12/14/081/n/1922398/74d22b8d4b738d72_GettyImages-491215020E3065m.xxxlarge/i/a.jpg -- works
            //   http://media4.popsugar-assets.com/files/2015/12/14/081/n/1922398/74d22b8d4b738d72_GettyImages-491215020E3065m/i/a.jpg -- doesn't work
            //   http://media4.popsugar-assets.com/files/2015/12/14/081/n/1922398/74d22b8d4b738d72_GettyImages-491215020E3065/i/a.jpg -- doesn't work
            newsrc = src.replace(/\.(?:[a-z]*|_original)(?:_(?:[0-9x]+|wm))?(\/i\/[^/]*)$/, "$1");
            if (newsrc !== src)
                return newsrc;

            // https://media1.popsugar-assets.com/files/2010/08/34/3/301/3019466/36cde93e8d75bf68_HeidiMont_Denis_60124316_Max.preview.jpeg
            //   https://media1.popsugar-assets.com/files/2010/08/34/3/301/3019466/36cde93e8d75bf68_HeidiMont_Denis_60124316_Max.jpeg
            return src.replace(/\.preview(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "ceros.com" && domain.match(/^media[-.]/)) {
            // https://media-s3-us-east-1.ceros.com/popsugar/images/2018/08/17/73bd83a889f54cc67731a00623f5a1ca/ps18-cotton-np2-forceros.jpg?imageOpt=1&fit=bounds&width=1962
            //   https://media-s3-us-east-1.ceros.com/popsugar/images/2018/08/17/73bd83a889f54cc67731a00623f5a1ca/ps18-cotton-np2-forceros.jpg
            newsrc = src.replace(/\?.*/, "");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain === "elleuk.cdnds.net") {
            // http://elleuk.cdnds.net/15/37/980x1306/980x1306--29f8-11e6-9cdd-21395b3400d9-assets-elleuk-com-gallery-16644-1365760633-emma-watson-january-2013-jpg.jpg
            //   http://assets.elleuk.com/gallery/16644/1365760633-emma-watson-january-2013.jpg
            //
            // http://elleuk.cdnds.net/15/37/768x1024/768x1024-d38b1ahttp-s3-eu-west-1-amazonaws-com-ee-elleuk-2-emma-watson-december-2014-cover-star-composite-jpg.jpg
            // http://s3-eu-west-1.amazonaws.com/ee-elleuk/Hailey-Baldwin-Topshop-unique-RS15-0515-Imaxtree.jpg
            // problem: capitalized
            newsrc = src.replace(/:\/\/.*\/[^/]*assets-elleuk-com-gallery-([0-9]*)-([^/]*)-([^-/.]*)\.[^-/.]*$/, "://assets.elleuk.com/gallery/$1/$2.$3");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nosub === "cdnds.net" &&
            //!src.match(/\/gallery_[^/]*$/) &&
            !src.match(/\/[0-9]*x[0-9]*-[^/]*$/)) {
            //domain.indexOf("esquireuk.cdnds.net") < 0 &&
            //domain.indexOf("digitalspyuk.cdnds.net") < 0

            // doesn't work:
            // http://digitalspyuk.cdnds.net/14/42/768x512/gallery_7065877-low_res-.jpg
            //   http://digitalspyuk.cdnds.net/14/42/1600x1067/gallery_7065877-low_res-.jpg
            //   http://digitalspyuk.cdnds.net/14/42/7065877-low_res-.jpg -- works
            // http://digitalspyuk.cdnds.net/11/51/768x512/gallery_tv_countdown_nick_hewer_2.jpg
            //   http://digitalspyuk.cdnds.net/11/51/gallery_tv_countdown_nick_hewer_2.jpg
            //   http://digitalspyuk.cdnds.net/11/51/tv_countdown_nick_hewer_2.jpg -- works
            // http://digitalspyuk.cdnds.net/13/40/980x1470/gallery_emma-watson.jpg
            //   http://digitalspyuk.cdnds.net/13/40/emma-watson.jpg -- works
            //
            // works:
            // http://digitalspyuk.cdnds.net/16/47/980x490/landscape-1479890677-gettyimages-108378197.jpg
            //   http://digitalspyuk.cdnds.net/16/47/landscape-1479890677-gettyimages-108378197.jpg
            //   http://digitalspyuk.cdnds.net/16/47/1479890677-gettyimages-108378197.jpg
            // http://elleuk.cdnds.net/17/06/1600x900/hd-aspect-1486581368-emma-web.jpg
            //   http://elleuk.cdnds.net/17/06/hd-aspect-1486581368-emma-web.jpg
            //   http://elleuk.cdnds.net/17/06/1486581368-emma-web.jpg
            // http://cosmouk.cdnds.net/14/51/980x490/nrm_1418985628-nick-hewer-quits-apprentice.jpg?resize=768:*
            //   http://cosmouk.cdnds.net/14/51/nrm_1418985628-nick-hewer-quits-apprentice.jpg?resize=768:*
            // http://elleuk.cdnds.net/17/25/480x719/gallery-1498212018-emmawatsonlouisvuitton.jpg
            //   http://elleuk.cdnds.net/17/25/gallery-1498212018-emmawatsonlouisvuitton.jpg
            //   http://elleuk.cdnds.net/17/25/1498212018-emmawatsonlouisvuitton.jpg
            // http://digitalspyuk.cdnds.net/18/05/landscape-1517275491-cameron1.jpg
            //   http://digitalspyuk.cdnds.net/18/05/1517275491-cameron1.jpg
            newsrc = src
                .replace(/\/[0-9]+x[0-9]+\/gallery_/, "/")
                .replace(/\/[0-9]+x[0-9]+\/([^/]*)$/, "/$1")
                .replace(/\/(?:landscape|hd-aspect|gallery)-([^/]*)$/, "/$1")
                .replace(/(\/[^/]*)\?[^/]*$/, "$1");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain === "redonline.cdnds.net") {
            // http://redonline.cdnds.net/main/gallery/21794/grammy-awards-2016-taylor-swift__portrait.jpg
            //   http://redonline.cdnds.net/main/gallery/21794/grammy-awards-2016-taylor-swift.jpg
            return src.replace(/__[a-z]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "img.usmagazine.com") {
            // http://img.usmagazine.com/660-width/matthew-clines-624d28c3-5401-4041-9b40-1f25c25bf397.jpg
            //   http://img.usmagazine.com/matthew-clines-624d28c3-5401-4041-9b40-1f25c25bf397.jpg
            return src.replace(/(.*?[^:])\/[0-9]*-[^/]*\//, "$1/");
        }

        if (domain_nosub === "gannett-cdn.com" &&
            src.indexOf("/-mm-/") >= 0) {
            // https://www.gannett-cdn.com/-mm-/2e56892f6a349ad47192b530425d443fb365e5e9/r=x1803&c=3200x1800/https/media.gannett-cdn.com/35547429001/35547429001_5727574988001_5727573873001-vs.jpg?pubId=35547429001
            //   https://media.gannett-cdn.com/35547429001/35547429001_5727574988001_5727573873001-vs.jpg
            // https://www.gannett-cdn.com/-mm-/2eab0172f87f63087b9b90322b67744820df1d8d/c=0-230-4565-2809&r=x1683&c=3200x1680/local/-/media/2018/02/27/USATODAY/USATODAY/636553489293713705-AFP-AFP-10H1QY-97704432.JPG
            //   https://www.gannett-cdn.com/media/2018/02/27/USATODAY/USATODAY/636553489293713705-AFP-AFP-10H1QY-97704432.JPG
            newsrc = src.replace(/.*?\/-mm-\/[0-9a-f]*\/[^/]*\/(http[^/]*)\/(.*)$/, "$1://$2");
            if (newsrc !== src)
                return newsrc;

            return src.replace(/\/-mm-\/.*?\/-\//, "/");
        }

        if (domain_nosub === "aolcdn.com") {
            var regex1 = /.*image_uri=([^&]*).*/;

            if (src.match(regex1)) {
                // https://o.aolcdn.com/images/dims?thumbnail=640%2C420&quality=75&format=jpg&image_uri=https%3A%2F%2Faol-releases-assets-production.s3.amazonaws.com%2Fgenerator%2F07A13DEB.jpg&client=cbc79c14efcebee57402&signature=09ed437d01bfde0d182a609c759f58006578aa3a
                //   https://aol-releases-assets-production.s3.amazonaws.com/generator/07A13DEB.jpg
                // https://o.aolcdn.com/images/dims?resize=1200%2C630&amp;crop=1200%2C630%2C0%2C0&amp;quality=80&amp;image_uri=https%3A%2F%2Fimg.vidible.tv%2Fprod%2F2018-07%2F03%2F5b3bcb63158f855373e8f026%2F5b3bcc4d802b9473f9df3077_o_U_v1.jpg&amp;client=cbc79c14efcebee57402&amp;signature=358c49852d6c8cdd678cc7dea0ad0995c5f7d224
                //   https://img.vidible.tv/prod/2018-07/03/5b3bcb63158f855373e8f026/5b3bcc4d802b9473f9df3077_o_U_v1.jpg
                newsrc = decodeURIComponent(src.replace(/.*image_uri=([^&]*).*/, "$1"));
            } else if (src.match(/.*o\.aolcdn\.com\/images\//)) {
                // https://o.aolcdn.com/images/dims3/GLOB/legacy_thumbnail/1028x675/format/jpg/quality/85/http%3A%2F%2Fo.aolcdn.com%2Fhss%2Fstorage%2Fmidas%2F652aa88cb26c6aafe4dca4eef405c15%2F205409332%2FScreen%2BShot%2B2017-06-23%2Bat%2B2.36.37%2BPM.png
                //   http://o.aolcdn.com/hss/storage/midas/652aa88cb26c6aafe4dca4eef405c15/205409332/Screen+Shot+2017-06-23+at+2.36.37+PM.png
                newsrc = decodeURIComponent(src).replace(/.*o\.aolcdn\.com\/images\/[^:]*\/([^:/]*:.*)/, "$1");
            } else if (src.match(/^[a-z]+:\/\/[^/]*\/hss\/storage\/midas\//)) {
                // https://s.aolcdn.com/hss/storage/midas/668dd572f108685386710ff09bb15f2a/205350917/1280_selena_gomez_the_weeknd_carbone_backgrid_BGUS_879674_007.jpg
                //   https://s.aolcdn.com/hss/storage/midas/668dd572f108685386710ff09bb15f2a/205350917/selena_gomez_the_weeknd_carbone_backgrid_BGUS_879674_007.jpg
                return src.replace(/\/[0-9]+_([^/]*)$/, "/$1");
            }

            if (newsrc && newsrc !== src)
                return newsrc;
        }

        if (domain === "imagesvc.timeincapp.com") {
            // http://imagesvc.timeincapp.com/v3/foundry/image/?q=70&w=1440&url=https%3A%2F%2Ftimedotcom.files.wordpress.com%2F2017%2F11%2Fcolumbia-1.jpg%3Fquality%3D85
            //   https://timedotcom.files.wordpress.com/2017/11/columbia-1.jpg
            return decodeURIComponent(src.replace(/.*image\/?\?.*url=([^&]*).*/, "$1"));
        }

        /*if (domain.indexOf(".photoshelter.com") >= 0) {
          return src.replace(/\/s\/[0-9]*\/[0-9]*\//, "/");
          }*/

        if (domain_nosub === "photoshelter.com") {
            // http://c.photoshelter.com/img-get/I00002_.IhMQAZEg/t/200/I00002_.IhMQAZEg.jpg
            //   https://ssl.c.photoshelter.com/img-get/I00002_.IhMQAZEg/s/700/SHM-Spider-Man-Homecoming-Prem-28062017-001.jpg
            //   https://ssl.c.photoshelter.com/img-get2/I00002_.IhMQAZEg/fit=4000x4000/SHM-Spider-Man-Homecoming-Prem-28062017-001.jpg
            //   https://ssl.c.photoshelter.com/img-get2/I00002_.IhMQAZEg/fit=99999999999/SHM-Spider-Man-Homecoming-Prem-28062017-001.jpg
            // https://ssl.c.photoshelter.com/img-get2/I00007dPXW9BAIiU/sec=wd0sd0oe0lwe0ms1000ed20170311lyHGYvV7mWMka15/fit=2040x2040/Rutgers-womens-rowing-team-works-out-on-the-Raritan-River.jpg -- 2040x1357
            //   https://ssl.c.photoshelter.com/img-get2/I00007dPXW9BAIiU/fit=4000x4000/Rutgers-womens-rowing-team-works-out-on-the-Raritan-River.jpg
            // https://culver.photoshelter.com/asset-get/A0000N3HQ83lQtzA/20160913_325_RS-0.jpg -- 5000x3333
            // https://ssl.c.photoshelter.com/img-get/I0000sljp0JcarNs/pak05lhecop-57.jpg -- 500x332
            // https://ssl.c.photoshelter.com/img-get/I0000x_JQ_qY2rhs/s/750/750/1678-James-Brown-11-and-Tomi-Rae-Hynie-Brown-and-Martha-Stewart.jpg
            //   https://ssl.c.photoshelter.com/img-get2/I0000x_JQ_qY2rhs/fit=99999999999/1678-James-Brown-11-and-Tomi-Rae-Hynie-Brown-and-Martha-Stewart.jpg
            return src
                .replace(/\/img-get2\/([^/]*)\/(?:[a-z]+=[^/]*\/)*([^/]*)$/, "/img-get2/$1/fit=99999999999/$2")
                .replace(/\/img-get\/([^/]*)(?:\/[ts]\/[0-9]+\/(?:[0-9]+\/)?)?([^/]*)$/, "/img-get2/$1/fit=99999999999/$2");
        }

        if (domain_nowww === "celebzz.com" &&
            src.indexOf("/wp-content/uploads/") >= 0) {
            // http://www.celebzz.com/wp-content/uploads/2018/03/jenna-ortega-at-ready-player-one-premiere-at-dolby-theatre-in-hollywood-21_thumbnail.jpg
            //   http://www.celebzz.com/wp-content/uploads/2018/03/jenna-ortega-at-ready-player-one-premiere-at-dolby-theatre-in-hollywood-21.jpg
            newsrc = src.replace(/_thumbnail(\.[^/.]*)$/, "$1");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nosub === "images-amazon.com" ||
            // http://ec2.images-amazon.com/images/I/81IotHEYjBL._AA1417_.jpg
            //   http://ec2.images-amazon.com/images/I/81IotHEYjBL.jpg

            // https://images-na.ssl-images-amazon.com/images/I/B1GLFkULdTS._CR0,0,3840,2880_._SL1000_.png
            //   https://images-na.ssl-images-amazon.com/images/I/B1GLFkULdTS.png
            // https://images-na.ssl-images-amazon.com/images/I/81yxJ9lr5vL.AC_SL1500_.jpg -- no ._
            //   https://images-na.ssl-images-amazon.com/images/I/81yxJ9lr5vL.jpg
            // https://images-eu.ssl-images-amazon.com/images/I/41TMMGD0XZL._SL500_AC_SS350_.jpg
            //   https://images-eu.ssl-images-amazon.com/images/I/41TMMGD0XZL.jpg
            domain_nosub === "ssl-images-amazon.com" ||
            // https://m.media-amazon.com/images/I/61rtKO6VrUL._SL500_.jpg
            //   https://m.media-amazon.com/images/I/61rtKO6VrUL.jpg
            domain_nosub === "media-amazon.com" ||
            // https://ia.media-imdb.com/images/M/MV5BNjA1NDYwMDQ3MF5BMl5BanBnXkFtZTcwOTYyNDQ0MQ@@._V1_UY268_CR1,0,182,268_AL_.jpg
            //   https://ia.media-imdb.com/images/M/MV5BNjA1NDYwMDQ3MF5BMl5BanBnXkFtZTcwOTYyNDQ0MQ@@.jpg
            // https://ia.media-imdb.com/images/M/MV5BMTU2NDI2YjktYjYxMy00OGIwLWEzMjktNzEzNzA4YzVmZGRjXkEyXkFqcGdeQXVyNDU4MDk4OA@@._V1_UY317_CR51,0,214,317_AL_.jpg
            //   https://ia.media-imdb.com/images/M/MV5BMTU2NDI2YjktYjYxMy00OGIwLWEzMjktNzEzNzA4YzVmZGRjXkEyXkFqcGdeQXVyNDU4MDk4OA@@.jpg
            domain_nosub === "media-imdb.com" ||
            // https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/users/1497668011i/22813064._UX100_CR0,0,100,100_.jpg
            //   https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/users/1497668011i/22813064.jpg
            domain === "i.gr-assets.com") {
            return {
                //url: src.replace(/\._[^/]*\.([^./]*)$/, "._.$1"),
                url: src.replace(/\.[^/]*\.([^./]*)$/, ".$1"), // for now this seems to work for all images
                always_ok: true,
                can_head: false
            };
        }

        if (domain_nosub === "otapol.jp") {
            // http://otapol.jp/img/amazon/size130/41CUQ4yXvwL.jpg
            //   https://images-na.ssl-images-amazon.com/images/I/41CUQ4yXvwL.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/img\/amazon\/size[0-9]+\/([^/]*)$/,
                                 "https://images-na.ssl-images-amazon.com/images/I/$1");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nowww === "movpins.com") {
            // http://www.movpins.com/big/MV5BMjgxMzU1NDcxNV5BMl5BanBnXkFtZTgwODMzMjEyNTE@.__UY268_CR1,0,182,268_AL/stefanie-scott-at-event-of-insidious:-chapter-3-(2015)-large-picture.jpg
            //   https://ia.media-imdb.com/images/M/MV5BMjgxMzU1NDcxNV5BMl5BanBnXkFtZTgwODMzMjEyNTE@.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/[a-z]+\/+(.)([a-zA-Z0-9]+(?:@+)?)(?:\.[^/]*)?\/[^/]*(\.[^/.]*)$/,
                               "https://ia.media-imdb.com/images/$1/$1$2$3");
        }

        /*if (domain.indexOf("cdn-img.instyle.com") >= 0) {
          return src.replace(/(\/files\/styles\/)[^/]*(\/public)/, "$1original$2");
          }

          if (domain.indexOf("static.independent.co.uk") >= 0) {
          return src.replace(/(\/styles\/)story_[^/]*(\/public)/, "$1story_large$2");
          }*/

        // drupal
        // https://italyxp.com/sites/default/files/mediaitalyxp/vesuvius.jpg?width=820&height=620&iframe=true
        // https://www.windowscentral.com/sites/wpcentral.com/files/styles/xlarge_wm_brw/public/field/image/2018/03/surviving-mars-hero.jpg?itok=4_uW-AOb
        //   https://www.windowscentral.com/sites/wpcentral.com/files/field/image/2018/03/surviving-mars-hero.jpg -- different image
        if (domain === "cdn-img.instyle.com" ||
            // https://cdn-img.instyle.com/sites/default/files/styles/684xflex/public/images/2016/07/071616-blake-lively-lead.jpg?itok=MFWx_-rR
            //   https://cdn-img.instyle.com/sites/default/files/images/2016/07/071616-blake-lively-lead.jpg

            // https://static.independent.co.uk/s3fs-public/styles/story_large/public/thumbnails/image/2016/02/20/20/21-LGBT-MPs-TeriPeng.jpg
            //   https://static.independent.co.uk/s3fs-public/thumbnails/image/2016/02/20/20/21-LGBT-MPs-TeriPeng.jpg
            domain === "static.independent.co.uk" ||
            // https://static.standard.co.uk/s3fs-public/thumbnails/image/2017/04/21/09/graham-norton-harry-styles-2.jpg?w968
            //   https://static.standard.co.uk/s3fs-public/thumbnails/image/2017/04/21/09/graham-norton-harry-styles-2.jpg -- 1500x1000
            // https://static.standard.co.uk/s3fs-public/styles/story_large/public/thumbnails/image/2018/06/22/14/summerdresses.jpg
            //   https://static.standard.co.uk/s3fs-public/thumbnails/image/2018/06/22/14/summerdresses.jpg
            domain === "static.standard.co.uk" ||
            /*domain.indexOf("www.billboard.com") >= 0 ||
              domain.indexOf("www.harpersbazaararabia.com") >= 0 ||
              domain.indexOf("www.etonline.com") >= 0 ||*/
            domain === "o.oystermag.com" ||
            /*domain.indexOf("www.metro.us") >= 0 ||
              domain.indexOf("www.mtv.co.uk") >= 0 ||
              domain.indexOf("www.grammy.com") >= 0 ||*/
            // https://cdn1.thr.com/sites/default/files/imagecache/scale_crop_768_433/2017/08/shot_02_-_warren_solo_00220-h_2017_thr.jpg
            //   https://cdn1.thr.com/sites/default/files/2017/08/shot_02_-_warren_solo_00220-h_2017_thr.jpg
            (domain_nosub === "thr.com" && domain.match(/cdn[0-9]*\.thr\.com/)) ||
            // http://cdnau.ibtimes.com/sites/au.ibtimes.com/files/styles/v2_article_large/public/2016/02/23/kendall-jenner.jpg
            //   http://cdnau.ibtimes.com/sites/au.ibtimes.com/files/2016/02/23/kendall-jenner.jpg
            domain.match(/s[0-9]*\.ibtimes\.com/) ||
            // https://www.standard.co.uk/s3fs-public/styles/hero_tablet/public/thumbnails/image/2014/11/18/15/nickhewer4.jpg
            //   https://www.standard.co.uk/s3fs-public/thumbnails/image/2014/11/18/15/nickhewer4.jpg
            //
            // https://www.standard.co.uk/s3fs-public/image/2014/11/18/15/nickhewer4.jpg
            // is redirected to:
            // http://www.standard.co.uk/s3/files/image/2014/11/18/15/nickhewer4.jpg
            // which is not found
            // but replacing /s3fs-public/ to /s3/files/ doesn't work
            //domain === "www.standard.co.uk" ||
            // https://media.pri.org/s3fs-public/styles/story_main/public/story/images/coco-movie.jpg?itok=Uo82G_FI
            //   https://media.pri.org/s3fs-public/story/images/coco-movie.jpg
            src.match(/\/s3fs-public\/styles\/[^/]*\/public\//) ||
            domain === "media.pri.org" ||
            // https://www.wwe.com/f/styles/gallery_img_l/public/all/2018/06/101_Tokyo_06282018hm_2329--f4c8f1052cba83a4a8b3f05905330617.jpg
            domain === "www.wwe.com" ||
            // https://akm-img-a-in.tosshub.com/indiatoday/styles/video_landing_page_170_x_127/public/images/photogallery/201807/ambani_party.jpeg?XzEToHYNGMQ8GE4HVzpMci7KFJEe2wYe
            domain === "akm-img-a-in.tosshub.com" ||
            // https://cdn.9razia.de/f/styles/facebook/public/media/gallery/2016-05-26/rihanna_red.jpg
            //   https://cdn.9razia.de/f/media/gallery/2016-05-26/rihanna_red.jpg
            domain === "cdn.9razia.de" ||
            // https://www.bravo.de/assets/styles/teaserimage_200x200/public/field/image/on_gettyimages-521255466.jpg?itok=NwumyGri
            //   https://www.bravo.de/assets/field/image/on_gettyimages-521255466.jpg
            domain_nowww === "bravo.de" ||
            // https://static.reservationvacances.com/reservationvacances/public/styles/mg_thumb_1/public/2018-02/poster-tour-eiffel-jour-nuit.jpg?itok=sVDUxLws
            //   https://static.reservationvacances.com/reservationvacances/public/2018-02/poster-tour-eiffel-jour-nuit.jpg
            domain === "static.reservationvacances.com" ||
            // http://cdn.whodoyouthinkyouaremagazine.com/sites/default/files/imagecache/623px_wide/episode/hewer500.jpg
            //   http://cdn.whodoyouthinkyouaremagazine.com/sites/default/files/episode/hewer500.jpg
            src.match(/\/sites\/[^/]*\/files\/styles\/[^/]*/) ||
            src.match(/\/sites\/[^/]*\/files\/[^/]*\/styles\/[^/]*/) ||
            // https://cdn2.benzinga.com/files/imagecache/1024x768xUP/images/story/2012/rihanna.jpg
            // http://mobile.dlisted.com/files/imagecache/photo-preview-mobile/files/hotslutweeknorwoodyoung.jpg
            //   http://i.dlisted.com/files/hotslutweeknorwoodyoung.jpg
            src.match(/(?:\/sites\/[^/]*)?\/files\/imagecache\/[^/]*/) ||
            // http://shakespearestaging.berkeley.edu/system/files/styles/large/private/images/titus-andronicus-the-old-globe-2006-2109.jpg?itok=zmPfmjYs
            src.search(/\/files\/styles\/[^/]*\/(?:public|private)\//) >= 0 ||
            // https://www.straight.com/files/v3/styles/gs_large/public/2013/09/MUS_Nostalghia_2386.jpg
            //   https://www.straight.com/files/v3/2013/09/MUS_Nostalghia_2386.jpg
            src.search(/\/files\/[^/]*\/styles\/[^/]*\/(?:public|private)\//) >= 0) {

            newsrc = src
                .replace(/\/styles\/.*?\/(?:public|private)\//, "/")
                .replace(/\/imagecache\/[^/]*\/(?:files\/)?/, "/")
                .replace(/\?.*$/, "");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nowww === "etonline.com") {
            // https://www.etonline.com/sites/default/files/styles/max_970x546/public/images/2014-11/640_mike_myers_458987658.jpg?itok=Z5VnvwQ1
            return {
                url: src,
                head_wrong_contentlength: true
            };
        }

        if (domain === "cdn.okmag.de" ||
            // https://cdn.9razia.de/s/fotostrecke__slider/public/media/gallery/2016-05-26/rihanna_red.jpg
            //   https://cdn.9razia.de/media/gallery/2016-05-26/rihanna_red.jpg
            domain === "cdn.9razia.de") {
            // https://cdn.okmag.de/s/article_main/public/media/gallery/2015/08/19/emily-ratajkowski-promotour_good_morning_america.jpg
            //   https://cdn.okmag.de/media/gallery/2015/08/19/emily-ratajkowski-promotour_good_morning_america.jpg
            return src.replace(/(:\/\/[^/]*\/)s\/[^/]*\/public\/(media\/)/, "$1$2");
        }

        if (domain === "img.elcomercio.pe" ||
            // https://www.elpais.com.co/files/article_graphic_small_inset/uploads/2018/08/06/5b686285870b6.jpeg
            //   https://www.elpais.com.co/uploads/2018/08/06/5b686285870b6.jpeg
            domain_nowww === "elpais.com.co") {
            // https://img.elcomercio.pe/files/article_main/uploads/2018/07/13/5b48b97d53da2.jpeg
            //   https://img.elcomercio.pe/uploads/2018/07/13/5b48b97d53da2.jpeg
            return src.replace(/\/files\/[^/]*\/uploads\//, "/uploads/");
        }

        if (domain_nowww === "trbimg.com") {
            return src.replace(/\/[0-9]*\/[0-9]*x[0-9]*\/*$/, "/").replace(/\/[0-9]*\/*$/, "/");
        }

        if ((domain_nosub === "blogspot.com" && domain.indexOf(".bp.blogspot.com") >= 0) ||
            // https://4.bp.blogspot.com/-1ndmEdQX3AM/Tv04FWJ3kTI/AAAAAAAAAzg/P-WNaJRST6Q/s400/Bookworm%2B3.jpg?ssl=1
            //   https://4.bp.blogspot.com/-1ndmEdQX3AM/Tv04FWJ3kTI/AAAAAAAAAzg/P-WNaJRST6Q/s0/Bookworm%2B3.jpg=s0?imgmax=0

            (domain_nosub === "googleusercontent.com" &&
             // https://lh3.googleusercontent.com/qAhRBhfciCcosUoYHPJr5WtNYSJ81vpSqcQwbQitZtsR3mB2aCUj7J5LvhJOCfWn-CWqiLB18SyTr1VJvm_HI7B72opIAMZiZvg=w9999-h9999
             //   https://lh3.googleusercontent.com/qAhRBhfciCcosUoYHPJr5WtNYSJ81vpSqcQwbQitZtsR3mB2aCUj7J5LvhJOCfWn-CWqiLB18SyTr1VJvm_HI7B72opIAMZiZvg=s0?imgmax=0
             // https://lh3.googleusercontent.com/j7RWveJMFLh5TNHWRRvQnTpwFF3Xzz-mZd8ff-2PmKGIycRxZkUaOmf14g7wIj7D5x2ci1d6DbstteRtb9GN5OXF6ozB32KIY0HUtXFKnN48A1DaxnV-7Nk3YoGbI5ITVJiHA6HyN1cGo_djsw
             //   https://lh3.googleusercontent.com/j7RWveJMFLh5TNHWRRvQnTpwFF3Xzz-mZd8ff-2PmKGIycRxZkUaOmf14g7wIj7D5x2ci1d6DbstteRtb9GN5OXF6ozB32KIY0HUtXFKnN48A1DaxnV-7Nk3YoGbI5ITVJiHA6HyN1cGo_djsw=s0?imgmax=0
             (domain.match(/^lh[0-9]\.googleusercontent\.com/) ||
              // https://ci3.googleusercontent.com/proxy/5wDs0lW9VwiJ9VuY3yV6TxZcSB2RQa7HcEWfwi_2elR976_QTHuRO464NJr1plEnsJc25ug3XZs1Xuw7TcVfvp6o-djvrmsHNobTAE13jxqHLm_IcCSl5KV924zY=w530-h300-p
              //   https://ci3.googleusercontent.com/proxy/5wDs0lW9VwiJ9VuY3yV6TxZcSB2RQa7HcEWfwi_2elR976_QTHuRO464NJr1plEnsJc25ug3XZs1Xuw7TcVfvp6o-djvrmsHNobTAE13jxqHLm_IcCSl5KV924zY=s0?imgmax=0
              domain.match(/^ci[0-9]\.googleusercontent\.com/))) ||
            // https://d2yal1mtmg1ts6.cloudfront.net/iFkddP_wLWySXrHXQ9oDom9utMCj3_9wsPjLcT3mipityCgMxnuspjAL5mejAeAQFA=h350-r
            //   https://d2yal1mtmg1ts6.cloudfront.net/iFkddP_wLWySXrHXQ9oDom9utMCj3_9wsPjLcT3mipityCgMxnuspjAL5mejAeAQFA=s0?imgmax=0
            domain === "d2yal1mtmg1ts6.cloudfront.net" ||
            // http://bp0.blogger.com/_sBBi-c1S7gU/SD5OZiDWDnI/AAAAAAAAFNc/3-cwL7frca0/s400/Copy+of+milla-jovovich-2.jpg
            //   https://1.bp.blogspot.com/_sBBi-c1S7gU/SD5OZiDWDnI/AAAAAAAAFNc/3-cwL7frca0/s0/Copy+of+milla-jovovich-2.jpg=s0?imgmax=0
            (domain_nosub === "blogger.com" && domain.match(/^bp[0-9]*\.blogger\.com/)) ||
            // http://lh4.ggpht.com/__zoKJ77EvEc/TO-9wdVTcwI/AAAAAAAAJEA/SbyR-4a03S0/dekotora%20%289%29%5B2%5D.jpg?imgmax=800 -- larger than s0?
            //   http://lh4.ggpht.com/__zoKJ77EvEc/TO-9wdVTcwI/AAAAAAAAJEA/SbyR-4a03S0/dekotora%20%289%29%5B2%5D.jpg=s0?imgmax=0 -- same size
            domain_nosub === "ggpht.com") {
            return src
                .replace(/#.*$/, "")
                .replace(/\?.*$/, "")
                .replace(/\/[swh][0-9]*(-[^/]*]*)?\/([^/]*)$/, "/s0/$2")
                .replace(/(=[^/]*)?$/, "=s0?imgmax=0");
        }

        if (domain_nosub === "googleusercontent.com" &&
            domain.indexOf("opensocial.googleusercontent.com") >= 0) {
            // https://images-blogger-opensocial.googleusercontent.com/gadgets/proxy?url=http%3A%2F%2F1.bp.blogspot.com%2F-jdpU1PhmEgg%2FU2lBLnp50QI%2FAAAAAAAAChs%2FUu01Lvq-2xc%2Fs1600%2Frihanna%2Bmccartney.jpg&container=blogger&gadget=a&rewriteMime=image%2F*
            //   http://1.bp.blogspot.com/-jdpU1PhmEgg/U2lBLnp50QI/AAAAAAAAChs/Uu01Lvq-2xc/s1600/rihanna+mccartney.jpg
            // http://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?container=focus&gadget=a&no_expand=1&resize_w=0&rewriteMime=image/*&url=http%3A%2F%2Fs5.mgimgcdn.com%2Fmangakakalot%2Fb1%2Fblack_rock_shooter_innocent_soul%2Fchapter_1%2F49.jpg
            //   http://s5.mgimgcdn.com/mangakakalot/b1/black_rock_shooter_innocent_soul/chapter_1/49.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/gadgets\/proxy.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        /*if (domain === "images.thestar.com") {
            // https://images.thestar.com/-ZOPF3_-dhsPDK5diZsl7k2AWyE=/1086x724/smart/filters:cb(1533380883140)/https://www.thestar.com/content/dam/thestar/opinion/contributors/2018/08/02/mall-is-wrong-about-use-of-captured-images/rpjeatoncameras04.jpg
            //   https://www.thestar.com/content/dam/thestar/opinion/contributors/2018/08/02/mall-is-wrong-about-use-of-captured-images/rpjeatoncameras04.jpg
            newsrc = src.replace(/(\/[^/.]*\.[^/.]*)\.[^/]*$/, "$1");
            if (newsrc !== src)
                return newsrc;
                }*/

        if (domain === "cdn.narcity.com" ||
            // https://www.narcity.com/u/2018/01/11/e4b085930cc3bcc2a07ebab04580eadd81a0c6e0.jpg_1200x630.jpg
            //   https://www.narcity.com/u/2018/01/11/e4b085930cc3bcc2a07ebab04580eadd81a0c6e0.jpg
            domain_nowww === "narcity.com") {
            // https://cdn.narcity.com/uploads/288430_2f9bf6228fb968d30f49e19268da5c3719d76d74.jpg_facebook.jpg -- stretched?
            //   https://cdn.narcity.com/uploads/288430_2f9bf6228fb968d30f49e19268da5c3719d76d74.jpg
            // https://cdn.narcity.com/u/2018/01/24/a84af3e5ab19eb3af3688b2e4ec6f768801df3fc.jpg_1200x630.jpg
            //   https://cdn.narcity.com/u/2018/01/24/a84af3e5ab19eb3af3688b2e4ec6f768801df3fc.jpg
            return src.replace(/(\/[^/.]*\.[^/._]*)_[^/]*$/, "$1");
        }

        if (domain === "images.vanityfair.it") {
            // https://images.vanityfair.it/gallery/92363/Mid/190f628a-c665-4b01-a73d-5a230ad8b3b6.jpg
            //   https://images.vanityfair.it/gallery/92363/Original/190f628a-c665-4b01-a73d-5a230ad8b3b6.jpg
            return src.replace(/(\/gallery\/[0-9]*\/)[^/]*\//, "$1Original/");
        }

        if (domain_nosub === "r29static.com") {
            // http://s1.r29static.com//bin/entry/812/0,12,460,552/0x864,80/1207816/image.jpg -- stretched
            //   https://s1.r29static.com//bin/entry/812/x,100/1207816/image.jpg
            // https://s1.r29static.com//bin/public/e32/0,0,2000,2400/720x864,80/1573061/image.jpg
            //   https://s1.r29static.com//bin/entry/e32/x,100/1573061/image.jpg
            //   https://s1.r29static.com//bin/public/e32/x,100/1573061/image.jpg
            // https://s1.r29static.com//bin/entry/a34/340x408,80/1970977/image.jpg
            //   https://s1.r29static.com//bin/entry/a34/x,100/1970977/image.jpg
            // 0x0,100 and x,100 both work
            return src.replace(/(\/bin\/(?:entry|public)\/[^/]*)\/(?:[0-9]+,[0-9]+,[0-9]+,[0-9]+\/)?[^/]*(?:,[^/]*)?\/([^,]*)$/, "$1/x,100/$2");
        }

        if (domain === "img.huffingtonpost.com") {
            // http://img.huffingtonpost.com/asset/5936853f2200003d00c6c785.png
            // http://img.huffingtonpost.com/asset/5a6b56b02d00004900942e4e.jpeg
            return src
            // http://img.huffingtonpost.com//asset/scaleFit_630_noupscale/55a658581200002b001348b0.jpeg
            //   http://img.huffingtonpost.com//asset/55a658581200002b001348b0.jpeg
                .replace(/\/asset\/[^/]*\/([^/.]*\.[^/.]*)$/, "/asset/$1")
            // https://img.huffingtonpost.com/asset/5b670cbb2000009f00378f9a.jpeg?cache=aklfxnevww&ops=1910_1000
            //   https://img.huffingtonpost.com/asset/5b670cbb2000009f00378f9a.jpeg
                .replace(/\?[^/]*$/, "");
        }

        if (domain === "images.huffingtonpost.com" ||
            // http://www.kisax.com/images/Samantha-Mumba/Samantha-Mumba-3-thumb.JPG
            //   http://www.kisax.com/images/Samantha-Mumba/Samantha-Mumba-3.JPG
            (domain_nowww === "kisax.com" && src.indexOf("/images/") >= 0) ||
            // http://www.womansdiary.gr/articles/1686/774bb14b-4d63-4969-adc4-06322e6b852f-thumb.jpg
            //   http://www.womansdiary.gr/articles/1686/774bb14b-4d63-4969-adc4-06322e6b852f.jpg
            (domain === "www.womansdiary.gr" && src.match(/\/articles\/[0-9]+\/[-0-9a-f]+-thumb/))) {
            // https://images.huffingtonpost.com/2015-12-15-1450212883-2879887-356670f8740946d741c648b23_villarufologardensravellocampaniaitalycrgetty-thumb.jpg
            //   https://images.huffingtonpost.com/2015-12-15-1450212883-2879887-356670f8740946d741c648b23_villarufologardensravellocampaniaitalycrgetty.jpg
            return src.replace(/-thumb(\.[^/.]*)$/, "$1");
        }

        if (domain === "i.huffpost.com" ||
            domain === "s-i.huffpost.com") {
            // https://i.huffpost.com/gen/1557988/thumbs/o-EMMA-570.jpg
            // https://i.huffpost.com/gen/1557988/images/o-EMMA-570.jpg
            // https://i.huffpost.com/gen/3142438/images/o-LORD-SUGAR-570.jpg
            // https://i.huffpost.com/gen/4681756/thumbs/o-601718112-900.jpg
            // https://i.huffpost.com/gen/4681864/thumbs/o-601718288-900.jpg?2
            // https://s-i.huffpost.com/gen/4681864/original.jpg
            // https://i.huffpost.com/gen/3217980/images/n-JAZMIN-GRACE-GRIMALDI-628x314.jpg
            // https://i.huffpost.com/gen/816377/original.jpg

            // http://i.huffpost.com/gadgets/slideshows/331487/slide_331487_3313386_free.jpg
            // http://i.huffpost.com/gadgets/slideshows/331487/slide_331487_3313616_free.jpg
            // http://i.huffpost.com/gadgets/slideshows/366854/slide_366854_4186736_compressed.jpg
            // http://i.huffpost.com/gadgets/slideshows/278815/slide_278815_2063217_original.jpg
            return src
                .replace(/(\/gadgets\/slideshows\/[0-9]*\/slide_[^/]*_)[a-z]*(\.[^/.]*)$/, "$1original$2")
                .replace(/(\/gen\/[0-9]*\/).*(\.[^/.?]*)(?:\?[^/]*)?$/, "$1original$2");
        }

        if ((domain_nosub === "washingtonpost.com" ||
             // https://c.o0bg.com/rf/image_371w/Boston/2011-2020/2018/01/03/BostonGlobe.com/Arts/Images/AFP_V03Q8.jpg
             domain === "c.o0bg.com" ||
             // https://www.statesman.com/rf/image_md/Pub/p9/AJC/Blog/Diehards/2018/04/05/Images/240866_GettyImages-872925824_sndecp.jpg
             domain === "www.statesman.com" ||
             // https://www.myajc.com/rf/image_lowres/Pub/p6/CmgSharedContent/2015/05/18/Images/photos.medleyphoto.7287170.jpg
             domain === "www.myajc.com" ||
             // http://www.lastampa.it/rf/image_lowres/Pub/p4/2018/03/09/Tecnologia/Foto/RitagliWeb/Mario%20Day1-15627-U11012767847446UFI-U11012767847446WcE-1400x788%40LaStampa.it.jpg
             domain === "www.lastampa.it" ||
             // https://www.whio.com/rf/image_md/Pub/p7/CmgSharedContent/2016/08/01/Images/photos.medleyphoto.10777077.jpg
             domain === "www.whio.com" ||
             // https://www.daytondailynews.com/rf/image_lowres/Pub/p7/CmgSharedContent/2016/08/01/Images/photos.medleyphoto.10777077.jpg
             domain === "www.daytondailynews.com" ||
             // https://www.livemint.com/rf/Image-621x414/LiveMint/Period1/2012/09/28/Photos/currency--621x414.jpg
             //   https://www.livemint.com/rw/LiveMint/Period1/2012/09/28/Photos/currency--621x414.jpg
             domain_nowww === "livemint.com" ||
             domain === "www.hindustantimes.com") &&
            src.indexOf("/rf/") >= 0) {
            // test: https://img.washingtonpost.com/rf/image_1483w/2010-2019/Wires/Online/2017-11-21/AP/Images/Music_Taylor_Swift_36357.jpg
            // error: Query String : src=http://www.washingtonpost.com/rw/2010-2019/Wires/Online/2017-11-21/AP/Images/Music_Taylor_Swift_36357.jpg&w=1483
            // real: https://img.washingtonpost.com/rf/image_1484w/2010-2019/Wires/Online/2017-11-21/AP/Images/Music_Taylor_Swift_36357.jpg-ced9a.jpg?uuid=TiTSis5fEeeoe0fxS3MWKg

            // https://www.washingtonpost.com/rf/image_480x320/2010-2019/WashingtonPost/2018/01/26/Foreign/Images/AFP_XY105.jpg?t=20170517a
            //   https://www.washingtonpost.com/rw/2010-2019/WashingtonPost/2018/01/26/Foreign/Images/AFP_XY105.jpg

            // https://www.hindustantimes.com/rf/image_size_960x540/HT/p2/2018/01/08/Pictures/susan-sarandon-watson-clemente-marai-larasi-emma_f6e96a02-f475-11e7-95e6-04e0a17510b6.jpg - stretched
            //   https://www.hindustantimes.com/rf/image/HT/p2/2018/01/08/Pictures/susan-sarandon-watson-clemente-marai-larasi-emma_f6e96a02-f475-11e7-95e6-04e0a17510b6.jpg
            // https://www.hindustantimes.com/rf/image_size_90x90/HT/p2/2018/01/27/Pictures/parliament-session_d792b3aa-037c-11e8-8651-33050e64100a.jpg
            //   https://www.hindustantimes.com/rf/image/HT/p2/2018/01/27/Pictures/parliament-session_d792b3aa-037c-11e8-8651-33050e64100a.jpg
            // https://www.hindustantimes.com/rf/image_size_960x540/HT/p2/2018/01/27/Pictures/parliament-session_d146b4e2-037c-11e8-8651-33050e64100a.jpg
            //   https://www.hindustantimes.com/rf/image/HT/p2/2018/01/27/Pictures/parliament-session_d146b4e2-037c-11e8-8651-33050e64100a.jpg
            // https://www.hindustantimes.com/rf/image_size_960x540/HT/p2/2018/01/08/Pictures/emma-watson_af695f5c-f475-11e7-95e6-04e0a17510b6.jpg
            //   https://www.hindustantimes.com/rf/image/HT/p2/2018/01/08/Pictures/emma-watson_af695f5c-f475-11e7-95e6-04e0a17510b6.jpg
            //   https://www.hindustantimes.com/rw/HT/p2/2018/01/08/Pictures/emma-watson_af695f5c-f475-11e7-95e6-04e0a17510b6.jpg

            // return src.replace(/\/image_size_[0-9]+x[0-9]+\//, "/image/");
            newsrc = src.replace(/(.*?:\/\/[^/]*\/)rf\/[^/]*\/(.*)$/, "$1rw/$2").replace(/[?&][^/]*$/, "");
            if (newsrc !== src) {
                return newsrc;
            }

            // replaced by a generic one
            //return src.replace(/.*\/wp-apps\/imrs\.php\?[^/]*src=/, "");
        }

        // why was this separate?
        /*if (domain_nowww === "livemint.com" && false) {
            // https://www.livemint.com/rf/Image-621x414/LiveMint/Period1/2012/09/28/Photos/currency--621x414.jpg
            //   https://www.livemint.com/rw/LiveMint/Period1/2012/09/28/Photos/currency--621x414.jpg
            return src.replace(/\/rf\/[^/]*\/(.*)$/, "/rw/$1");
        }*/

        if (domain_nosub === "foxnews.com" &&
            domain.match(/^a[0-9]*\.foxnews\.com/)) {
            // http://a57.foxnews.com/images.foxnews.com/content/fox-news/world/2017/11/15/firefighters-in-thailands-capital-on-front-line-citys-fight-against-snakes/_jcr_content/par/featured_image/media-0.img.jpg/931/524/1510749948281.jpg?ve=1&tl=1
            // down for now?
            //console_log(src.replace(/.*\/a[0-9]*\.foxnews\.com\/(.*).*/, "$1"));
            if (src.replace(/.*\/a[0-9]*\.foxnews\.com\/([^/]*).*/, "$1") !== "images.foxnews.com") {
                return src.replace(/.*\/a[0-9]*\.foxnews\.com\/(.*)\/[0-9]+\/[0-9]+\/([^/]*)$/, "http://$1/$2");
            }
            return src.replace(/(\/a[0-9]*\.foxnews\.com\/.*)\/[0-9]+\/[0-9]+\/([^/?]*)(?:\?.*)?$/, "$1/0/0/$2");
        }

        if (domain === "cdn.cliqueinc.com" ||
            // http://cliqueimg.com/cache/posts/185680/threes-a-trend-super-sequins-bring-a-sexy-edge-to-the-oscars-1677261-1456708645.640x0c.jpg
            //   http://cliqueimg.com/cache/posts/185680/threes-a-trend-super-sequins-bring-a-sexy-edge-to-the-oscars-1677261-1456708645.jpg
            //   http://cliqueimg.com/posts/185680/threes-a-trend-super-sequins-bring-a-sexy-edge-to-the-oscars-1677261-1456708645.jpg
            // http://cliqueimg.com/cache/posts/img/uploads/current/images/0/70/213/main.original.600x0c.jpg
            //   http://cliqueimg.com/cache/posts/img/uploads/current/images/0/70/213/main.original.jpg
            // http://cliqueimg.com/posts/img/uploads/current/images/0/174/782/promo.original.600x0.jpg
            //   http://cliqueimg.com/posts/img/uploads/current/images/0/174/782/promo.original.jpg
            domain_nosub === "cliqueimg.com") {
            // https://cdn.cliqueinc.com/posts/img/uploads/current/images/0/39/490/main.original.640x0c.jpg
            //   https://cdn.cliqueinc.com/posts/img/uploads/current/images/0/39/490/main.original.jpg
            return src
                .replace(/(\/[^/]*)\.[0-9]*x[0-9]*[^/.]*\.([^./]*)$/, "$1.$2")
                .replace(/\/cache\/posts\//, "/posts/");
            //return src.replace(/(\/[a-z]+)\.[a-z]+(?:\.[^/.]*)(\.[^/.]*)$/, "$1.original$2");
        }

        if (domain_nosub === "hubstatic.com") {
            return src.replace(/_[^_/.]*\.([^/.]*)$/, ".$1");
        }

        // disabling due to recent ig updates
        if ((domain.indexOf("cdninstagram.com") >= 0 ||
             domain.match(/^instagram\..*\.fbcdn\.net/)) && false) {
            var urlstart = protocol + "://" + domain + "/";
            var has_t = false;
            for (i = 0; i < splitted.length; i++) {
                splitted[i] = splitted[i].replace(/\?.*$/, "");
                if (splitted[i].match(/^t[0-9]+\.[0-9]+-[0-9]+$/)) {
                    urlstart += splitted[i] + "/";
                    has_t = true;
                } else if (splitted[i].match(/^[0-9_]*_[a-z]+\.[a-z0-9]+$/)) {
                    if (!has_t) {
                        urlstart += "/";
                    }

                    urlstart += splitted[i];
                }
            }
            return urlstart;
        }

        if ((domain === "pbs.twimg.com" &&
             src.indexOf("pbs.twimg.com/media/") >= 0) ||
            (domain === "ton.twitter.com" &&
             src.indexOf("/ton/data/dm/") >= 0)) {
            // use ?name=orig instead of :orig, see:
            //   https://github.com/qsniyg/maxurl/issues/2

            // https://pbs.twimg.com/media/DWREhilXkAAcafr?format=jpg&name=small
            //   https://pbs.twimg.com/media/DWREhilXkAAcafr.jpg:orig
            //   https://pbs.twimg.com/media/DWREhilXkAAcafr?format=jpg&name=orig
            //   https://pbs.twimg.com/media/DWREhilXkAAcafr.jpg?name=orig
            // https://pbs.twimg.com/media/DWO61F5X4AISSsF?format=jpg
            //   https://pbs.twimg.com/media/DWO61F5X4AISSsF.jpg:orig
            //   https://pbs.twimg.com/media/DWO61F5X4AISSsF?format=jpg&name=orig
            // https://pbs.twimg.com/media/Dbxmq4BV4AA2ozg.jpg:orig
            //   https://pbs.twimg.com/media/Dbxmq4BV4AA2ozg.jpg?name=orig
            // https://pbs.twimg.com/media/DdxPc2eU0AAED8b.jpg:thumb
            //   https://pbs.twimg.com/media/DdxPc2eU0AAED8b.jpg?name=orig
            // https://pbs.twimg.com/media/DhI2IjaU8AAzEFA.jpg?format=jpg&name=orig
            //   https://pbs.twimg.com/media/DhI2IjaU8AAzEFA.jpg?name=orig
            // https://pbs.twimg.com/media/DhbrylaVAAYlrss?format=png
            //   https://pbs.twimg.com/media/DhbrylaVAAYlrss.jpg?name=orig
            // https://pbs.twimg.com/media/DhqeJS2UcAAo7fr.png
            //   https://pbs.twimg.com/media/DhqeJS2UcAAo7fr.jpg
            //   https://pbs.twimg.com/media/DhqeJS2UcAAo7fr.jpg?name=orig -- doesn't work
            //   https://pbs.twimg.com/media/DhqeJS2UcAAo7fr.png?name=orig -- works
            newsrc = src
                .replace(/(\/[^?&.]*)(?:\.[^/.?&]*)?([^/]*)[?&]format=([^&]*)/, "$1.$3$2")
                .replace(/(\/[^?&]*)[?&][^/]*$/, "$1")
                .replace(/(:[^/]*)?$/, ":orig")
                //.replace(/\.([^/.:]*)(?::[^/.]*)$/, "?format=$1&name=orig")
                .replace(/\.([^/.:]*)(?::[^/.]*)$/, ".$1?name=orig");
            if (newsrc !== src) {
                if (newsrc.match(/\.png(\?.*)?$/)) {
                    return [newsrc, newsrc.replace(/\.png(\?.*)?$/, ".jpg$1")];
                } else {
                    return newsrc;
                }
            }
        }

        if (domain === "pbs.twimg.com" &&
            src.indexOf("pbs.twimg.com/profile_images/") >= 0) {
            // https://pbs.twimg.com/profile_images/539057632435122178/1_MUcoAZ_bigger.jpeg
            //return src.replace(/_[a-zA-Z0-9]+\.([^/_]*)$/, "\.$1");
            return src
                .replace(/_bigger\.([^/_]*)$/, "\.$1")
                .replace(/_normal\.([^/_]*)$/, "\.$1")
                .replace(/_[0-9]+x[0-9]+\.([^/_]*)$/, "\.$1");
        }

        if (domain === "pbs.twimg.com" &&
            src.indexOf("pbs.twimg.com/card_img/") >= 0) {
            // https://pbs.twimg.com/card_img/958636711470223361/S0DycGGB?format=jpg&name=600x314
            //   https://pbs.twimg.com/card_img/958636711470223361/S0DycGGB?format=jpg&name=orig
            return src.replace(/(\?[^/]*&?name=)[^&/]*([^/]*)$/, "$1orig$2");
        }

        if (domain === "pbs.twimg.com" &&
            src.indexOf("pbs.twimg.com/profile_banners/") >= 0) {
            // https://pbs.twimg.com/profile_banners/811769379020947458/1503413326/1500x500 -- stretched
            //   https://pbs.twimg.com/profile_banners/811769379020947458/1503413326
            return src.replace(/\/[0-9]+x[0-9]+$/, "");
        }

        // disabling because too many urls are broken
        /*if (domain.indexOf("ytimg.googleusercontent.com") >= 0 ||
            domain.indexOf("i.ytimg.com") >= 0 ||
            domain.indexOf("img.youtube.com") >= 0) {
            // doesn't work for some urls:
            // https://i.ytimg.com/vi/o-gVbQHG0Ck/hqdefault.jpg
            return src.replace(/\/[^/]*$/, "/maxresdefault.jpg");
        }*/

        if (domain === "image.bugsm.co.kr") {
            // blank image: (?version= doesn't impact)
            // https://image.bugsm.co.kr/artist/images/200/200498/20049877.jpg?version=20180108002103
            //   https://image.bugsm.co.kr/artist/images/0/200498/20049877.jpg
            //   https://image.bugsm.co.kr/artist/images/original/200498/20049877.jpg -- same
            //
            // non-blank image:
            // https://image.bugsm.co.kr/album/images/170/201403/20140343.jpg
            //   https://image.bugsm.co.kr/album/images/0/201403/20140343.jpg
            //
            // http://image.bugsm.co.kr/artist/images/original/801326/80132659.jpg
            return src.replace(/\/images\/[0-9]*\//, "/images/original/").replace(/\?.*$/, "");
        }

        if (domain_nosub === "wp.com" &&
            domain.match(/i[0-9]\.wp\.com/)) {
            // https://i1.wp.com/img-aws.ehowcdn.com/default/cme/cme_public_images/www_ehow_com/photos.demandstudios.com/getty/article/240/3/178773543_XS.jpg?resize=400%2C267
            //   http://photos.demandstudios.com/getty/article/240/3/178773543.jpg
            // http://i0.wp.com/mmsns.qpic.cn/mmsns/7KE858KbWtJWJFCnub4OrBAHial0SicILILia7G2I1h6VwXG5cWSWpnPQ/0 -- redirect error, but works
            return src.replace(/.*\/i[0-9]\.wp\.com\/(.*?)(?:\?.*)?$/, "http://$1");
        }

        if (domain === "imagesmtv-a.akamaihd.net" && false) {
            // http://imagesmtv-a.akamaihd.net/uri/mgid:file:http:shared:mtv.com/news/wp-content/uploads/2016/09/Guess-whooooooo-1473944872.jpg
            //   http://mtv.com/news/wp-content/uploads/2016/09/Guess-whooooooo-1473944872.jpg -- doesn't exist
            //   http://imagesmtv-a.akamaihd.net/news/wp-content/uploads/2016/09/Guess-whooooooo-1473944872.jpg -- works
            return src.replace(/.*\/uri\/([a-z:]*:)?/, "http://");
        }

        if (domain === "img.voi.pmdstatic.net" ||
            // https is not supported
            // http://img.voi.pmdstatic.net/fit/http.3A.2F.2Fprd2-bone-image.2Es3-website-eu-west-1.2Eamazonaws.2Ecom.2Fvoi.2F2018.2F09.2F05.2Ff6deca2b-fea8-4f1b-8045-fa30eb8515df.2Ejpeg/565x317/quality/80/pamela-anderson-decouvrez-qui-sera-son-partenaire-dans-danse-avec-les-stars-9.jpg
            //   http://prd2-bone-image.s3-website-eu-west-1.amazonaws.com/voi/2018/09/05/f6deca2b-fea8-4f1b-8045-fa30eb8515df.jpeg

            // https://voi.img.pmdstatic.net/fit/http.3A.2F.2Fprd2-bone-image.2Es3-website-eu-west-1.2Eamazonaws.2Ecom.2Fvoi.2F2018.2F09.2F05.2Ff6deca2b-fea8-4f1b-8045-fa30eb8515df.2Ejpeg/565x317/quality/80/pamela-anderson-decouvrez-qui-sera-son-partenaire-dans-danse-avec-les-stars-9.jpg
            //   http://prd2-bone-image.s3-website-eu-west-1.amazonaws.com/voi/2018/09/05/f6deca2b-fea8-4f1b-8045-fa30eb8515df.jpeg
            domain === "voi.img.pmdstatic.net") {
            var base = src.replace(/.*\/fit\/([^/]*)\/.*/, "$1");
            base = base.replace(/\./g, "%");
            base = decodeURIComponent(base);
            return base;
        }

        if (domain === "dynaimage.cdn.cnn.com") {
            // https://dynaimage.cdn.cnn.com/cnn/q_auto,w_672,c_fill/http%3A%2F%2Fcdn.cnn.com%2Fcnnnext%2Fdam%2Fassets%2F170428012205-28-met-gala-kurkova.jpg
            //   http://cdn.cnn.com/cnnnext/dam/assets/170428012205-28-met-gala-kurkova.jpg
            return decodeURIComponent(src.replace(/.*\/cnn\/[^/]*\//, ""));
        }

        // http://wcmimages.ottawasun.com/images?url=http://storage.ottawasun.com/v1/dynamic_resize/sws_path/suns-prod-images/1297804218043_ORIGINAL.jpg%3Fsize=520x&w=840&h=630
        //   http://storage.ottawasun.com/v1/dynamic_resize/sws_path/suns-prod-images/1297804218043_ORIGINAL.jpg?size=520x -- broken, but 520x520 works
        if (domain === "wcmimages.ottawasun.com" ||
            // http://wcmimages.torontosun.com/images?url=http://postmediatorontosun.files.wordpress.com/2017/12/ts20171211vh16159.jpg&w=840&h=630
            //   https://postmediatorontosun.files.wordpress.com/2017/12/ts20171211vh16159.jpg
            domain === "wcmimages.torontosun.com" ||
            // http://wcmimages.winnipegsun.com/images?url=http://storage.winnipegsun.com/v1/dynamic_resize/sws_path/suns-prod-images/1297974096773_ORIGINAL.jpg%3Fsize=520x&w=840&h=630
            //   http://storage.winnipegsun.com/v1/suns-prod-images/1297974096773_ORIGINAL.jpg
            domain === "wcmimages.winnipegsun.com" ||
            // http://wcmimages.edmontonjournal.com/images?url=https://postmediaedmontonjournal2.files.wordpress.com/2017/10/1014-you-black-hole8057-jpg.jpg&w=107&h=80
            //   https://postmediaedmontonjournal2.files.wordpress.com/2017/10/1014-you-black-hole8057-jpg.jpg
            domain === "wcmimages.edmontonjournal.com" ||
            src.match(/^[a-z]+:\/\/wcmimages\.[^/]*\/images\?url=http/)) {
            //return decodeURIComponent(src.replace(/.*\/images\?[^/]*url=/, ""));
            //return src.replace(/.*\/images\?url=([^&]*).*/, "$1");
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/images.*?[?&]url=([^&]*).*/, "$1"));
        }

        // moved to thumbor section
        if (domain === "i.amz.mshcdn.com" && false) {
            // https://i.amz.mshcdn.com/S4Fr7rEpLL-QZnU3bsNT5ORJzYQ=/364x130/https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com%2Fuploads%2Fstory%2Fthumbnail%2F73835%2Fd72a8d3f-baf0-4132-b6f9-358d27d1c0c9.JPG
            //   https://blueprint-api-production.s3.amazonaws.com/uploads/story/thumbnail/73835/d72a8d3f-baf0-4132-b6f9-358d27d1c0c9.JPG
            // https://i.amz.mshcdn.com/vWTWthC534bzcGDk15NwrBy-dd4=/fit-in/1200x9600/https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com%2Fuploads%2Fcard%2Fimage%2F54484%2FGettyImages-520238014.jpg
            // doesn't work:
            // https://i.amz.mshcdn.com/gXMzg2Z3xmXPa7EhIYOuwMmUu6M=/950x534/filters:quality(90)/2014%2F11%2F02%2F05%2Frihanna.40a2d.jpg
            //return decodeURIComponent(src.replace(/.*i\.amz\.mshcdn\.com\/[^/]*\/[^/]*\/[^/]*\/([^/]*).*/, "$1"));
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/[^/]*=\/[0-9]+x[0-9]+\/(?:filters:[^/]*\/)?(https?(?:%3A|:\/\/))/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);
        }

        if ((domain_nosub === "yimg.com" && domain.match(/^[sl][0-9]*\.yimg\.com/)) ||
            // https://movies.yahoo.com.tw/y/r/w520/bt/api/res/1.2/7CVvg8ycHHyQQhIFbt0eFw--~A/YXBwaWQ9dHdhYnVuZXdzO2ZpPWZpbGw7dz0xMzY1O2g9MjA0ODs-/http://media.zenfs.com/en/homerun/feed_manager_auto_publish_494/a292a5af4b414a75fc4aa1d0762bc2f2
            //   http://media.zenfs.com/en/homerun/feed_manager_auto_publish_494/a292a5af4b414a75fc4aa1d0762bc2f2
           domain_nosub === "yahoo.com.tw") {
            // http://l.yimg.com/bt/api/res/1.2/YIgTLkK5SkGYHzqDt4_e8Q--/YXBwaWQ9eW5ld3M7cT04NQ--/http:/mit.zenfs.com/316/2011/11/T-ZUCKERBERG_AP.jpg
            //   http://mit.zenfs.com/316/2011/11/T-ZUCKERBERG_AP.jpg
            // https://s.yimg.com/uu/api/res/1.2/dO0cMruL5vXOYMSnK577KQ--~B/aD03OTg7dz0xMzMwO3NtPTE7YXBwaWQ9eXRhY2h5b24-/https://s.yimg.com/cd/resizer/2.0/FIT_TO_WIDTH-w1330/a8b0bce04276cee4a1a80ea615a18c6e087e3b28.jpg
            //   https://s.yimg.com/cd/resizer/2.0/FIT_TO_WIDTH-w1330/a8b0bce04276cee4a1a80ea615a18c6e087e3b28.jpg
            // https://s.yimg.com/ny/api/res/1.2/guu198chJ6n8wlBLHhuLtg--/YXBwaWQ9aGlnaGxhbmRlcjtzbT0xO3c9NDUwO2g9MzAwO2lsPXBsYW5l/http://media.zenfs.com/en_us/News/Reuters/2017-03-17T012117Z_1_LYNXMPED2G03G_RTROPTP_2_PEOPLE-EMMAWATSON.JPG.cf.jpg
            //   http://media.zenfs.com/en_us/News/Reuters/2017-03-17T012117Z_1_LYNXMPED2G03G_RTROPTP_2_PEOPLE-EMMAWATSON.JPG
            // https://s.yimg.com/uu/api/res/1.2/1aGXhnnFE3EBXf7EvkNT6w--~B/Zmk9c3RyaW07aD0xNjA7cHlvZmY9MDtxPTgwO3c9MzQwO3NtPTE7YXBwaWQ9eXRhY2h5b24-/https://media.zenfs.com/creatr-images/GLB/2018-06-15/acf56170-70a4-11e8-ad9e-1f5591b0f4d1_trump-kim-new.jpg.cf.webp
            //   https://media.zenfs.com/creatr-images/GLB/2018-06-15/acf56170-70a4-11e8-ad9e-1f5591b0f4d1_trump-kim-new.jpg
            // http://l2.yimg.com/bt/api/res/1.2/K9XINOdK8vorcF7Ed__x2g--/YXBwaWQ9eW5ld3M7cT04NTt3PTMxMA--/http://media.zenfs.com/en-US/blogs/partner/emma_watson_bling_ring.jpg
            //   http://media.zenfs.com/en-US/blogs/partner/emma_watson_bling_ring.jpg
            // https://s.yimg.com/ny/api/res/1.2/i7vByicVXw.SMw0TEmwy5Q--~A/YXBwaWQ9aGlnaGxhbmRlcjtzbT0xO3c9ODAw/http://media.zenfs.com/en/homerun/feed_manager_auto_publish_494/e1f72d9e2dc10d66297f7241501c98bd
            //   https://media.zenfs.com/en/homerun/feed_manager_auto_publish_494/e1f72d9e2dc10d66297f7241501c98bd
            return src
                .replace(/.*\/[^/]*\/api\/res\/[^/]*\/[^/]*\/[^/]*\/(.*?)(?:\.cf\.(?:jpg|webp))?$/, "$1")
                .replace(/^([a-z]*:\/)([^/])/, "$1/$2");
        }

        if (domain === "image.iol.co.za") {
            // https://image.iol.co.za/image/1/process/620x349?source=https://inm-baobab-prod-eu-west-1.s3.amazonaws.com/public/inm/media/2017/12/28/iol/665/18156546_10155339323235555_1085978007028663507_o.jpg
            //   https://inm-baobab-prod-eu-west-1.s3.amazonaws.com/public/inm/media/2017/12/28/iol/665/18156546_10155339323235555_1085978007028663507_o.jpg
            return decodeURIComponent(src.replace(/.*\/process\/.*\?.*source=([^&]*).*/, "$1"));
        }

        // moved to thumbor section
        /*if (domain.indexOf("imageresizer.static9.net.au") >= 0) {
            //return decodeURIComponent(src.replace(/.*imageresizer\.static9\.net\.au\/[^=/]*=\/[0-9]+x[0-9]+\//, ""));
            return decodeURIComponent(src.replace(/.*imageresizer\.static9\.net\.au\/.*?\/([^/.?&]*%3A%2F%2F)/, "$1"));
        }*/

        if (domain_nosub === "squarespace.com" &&
            domain.match(/^static[0-9]*\.squarespace\.com/)) {
            // https://static1.squarespace.com/static/56e08f834c2f850f604de326/5aa3c6d141920255c00dfa67/5aa3c705652dea7e55277e8f/1520682759079/POR_Stylist_Letitia+Wright_1.jpg?format=500w
            //   https://static1.squarespace.com/static/56e08f834c2f850f604de326/5aa3c6d141920255c00dfa67/5aa3c705652dea7e55277e8f/1520682759079/POR_Stylist_Letitia+Wright_1.jpg?format=original
            newsrc = src.replace(/(\?[^/]*)?$/, "?format=original");
            if (newsrc !== src)
                return {
                    url: newsrc,
                    head_wrong_contentlength: true
                };
        }

        // /wp/uploads:
        // http://ksassets.timeincuk.net/wp/uploads/sites/46/2017/02/oscars.jpg
        if ((domain_nosub === "wordpress.com" && domain.indexOf(".files.wordpress.com") >= 0) ||
            //domain.indexOf("typeset-beta.imgix.net") >= 0 ||

            // what about pngs? shouldn't this be replaced to ?fm=png?
            // https://nylon-img.imgix.net/featured_images/attachments/000/008/458/original/Emma_Watson_Gravity_Premieres_NYC_Part_4_uWbHv1Bg6Owx.jpg?auto=format&ch=Width%2CDPR&q=75&w=640&ixlib=js-1.1.1&s=1587e8684f7fef1feac6d703480a760b
            ((domain_nosub === "imgix.net" ||
              // https://imgix.bustle.com/uploads/getty/2018/3/14/a38ca3e6-056e-4aef-9c2b-1b00a134d7be-getty-917851058.jpg?w=970&h=582&fit=crop&crop=faces&auto=format&q=70
              domain === "imgix.bustle.com" ||
              // https://imgix.ovp.tv2.dk/s/73/45137373-da3fa00af722541b2a7b64cdb7847f0c.jpeg?auto=format%2Ccompress&fit=min&crop=top&w=200
              domain === "imgix.ovp.tv2.dk" ||
              // https://imgix.elitedaily.com/elite-daily/2015/12/06102252/elitedaily-fox-xfiles.jpg?w=945&h=574&auto=format&q=70&fit=crop&crop=faces
              domain === "imgix.elitedaily.com" ||
              // https://imgix.thezoereport.com/zoe-report/2017/11/margot-robbie-style-versace-gold-gown-web.jpg?w=640&fit=max&auto=format&q=70
              domain === "imgix.thezoereport.com" ||
              // https://imgix.romper.com/2016/8/22/584902004.jpg?w=640&fit=max&auto=format&q=70
              domain === "imgix.romper.com")
             && !src.match(/[?&]s=[^/]*$/)) ||

            // http://hmg-prod.s3.amazonaws.com/images/bgus-1060427-037-1-1510856807.jpg
            // http://s3.amazonaws.com/hmg-prod/images/bgus-1060427-037-1-1510856807.jpg
            amazon_container === "hmg-prod" ||
            // https://blogs-images.forbes.com/niallmccarthy/files/2017/11/20171114_Cigarettes.jpg?width=960
            domain === "blogs-images.forbes.com" ||
            // https://images-production.global.ssl.fastly.net/uploads/images/file/47918/jonah-hill-2015-vs-2017.jpg?auto=compress&fit=crop&h=727&q=55&w=750
            domain === "images-production.global.ssl.fastly.net" ||
            // https://images-production.freetls.fastly.net/uploads/photos/file/116888/selena-gomez-no-bra-2015.jpg?auto=compress&crop=top&fit=max&q=55&w=750
            domain === "images-production.freetls.fastly.net" ||
            //domain.indexOf("typeset-beta.imgix.net") >= 0 ||
            //domain.indexOf("cosmouk.cdnds.net") >= 0 ||
            // http://esquireuk.cdnds.net/15/37/2048x2730/2048x2730-felicity-jones-oscars-43-jpg-fe5ebdf1.jpg?resize=768:*
            domain_nosub === "cdnds.net" ||
            /*domain.indexOf("hbz.h-cdn.co") >= 0 ||
              domain.indexOf("cos.h-cdn.co") >= 0 ||*/
            domain_nosub === "h-cdn.co" ||
            // http://cdn.newsapi.com.au/image/v1/00f120191891d8b371ae91eba6290c76?width=316
            domain === "cdn.newsapi.com.au" ||
            // https://images.indianexpress.com/2018/09/feat1.jpg?w=450
            domain === "images.indianexpress.com" ||
            // can't find a test case
            domain === "images.contentful.com" ||
            // http://imagesmtv-a.akamaihd.net/uri/mgid:file:http:shared:mtv.com/news/wp-content/uploads/2016/03/Spy-Kids-1459273031.jpg?quality=.8&height=400&wid
            domain === "imagesmtv-a.akamaihd.net" ||
            // https://d.ibtimes.co.uk/en/full/435849/anjem-choudary-shariah-project-protest-brick-lane-pic-ibtimes-co-uk.jpg?w=720&e=f9b092054c209d993bb1be7d435f293a
            domain === "d.ibtimes.co.uk" ||
            // http://akns-images.eonline.com/eol_images/Entire_Site/2014519/rs_300x300-140619060824-600.Harry-Potter-Cast-JR-61914.jpg
            // http://akns-images.eonline.com/eol_images/Entire_Site/2014519/rs_1024x759-140619060822-1024.Harry-Potter-Cast-JR-61914.jpg
            domain === "akns-images.eonline.com" ||
            /*domain.indexOf("www.telegraph.co.uk") >= 0 ||
            // http://subscriber.telegraph.co.uk/content/dam/news/2018/01/08/GettyImages-862428716_trans_NvBQzQNjv4BqZgEkZX3M936N5BQK4Va8RWtT0gK_6EfZT336f62EI5U.jpg?imwidth=480
            domain === "subscriber.telegraph.co.uk" ||
            // https://secure.aws.telegraph.co.uk/content/dam/wellbeing/2016/12/28/graham5_trans_NvBQzQNjv4BqNyaloxhBNUSEitvcqmzeaNrVK9LoR4c_wZH1EhIay9c.jpg?imwidth=480
            domain.indexOf("aws.telegraph.co.uk") >= 0 ||*/
            (domain_nosub === "telegraph.co.uk" && src.indexOf("/content/dam/") >= 0) ||
            // https://img.buzzfeed.com/thumbnailer-prod-us-east-1/video-api/assets/175593.jpg?output-format=auto&output-quality=auto&resize=625:*
            domain === "img.buzzfeed.com" ||
            // doesn't work with google's referrer
            // http://p3.music.126.net/MsiMKqHKy4xHxpLHngSuYQ==/19145795975058896.jpg?param=200y200
            (domain_nosub === "126.net" && domain.match(/^p[0-9]*\.music\.126\.net/)) ||
            // https://stat.profile.ameba.jp/profile_images/20180312/04/0d/ir/j/o03980600p_1520796916426_wiwja.jpg?cat=248
            domain === "stat.profile.ameba.jp" ||
            // https://stat.ameba.jp/user_images/20180222/17/kirarinfairy/75/1c/j/o0414060014136605494.jpg?caw=200
            domain === "stat.ameba.jp" ||
            // http://image.uczzd.cn/5758462716763402626.jpg?id=0&width=480
            domain === "image.uczzd.cn" ||
            // http://img.danawa.com/prod_img/500000/803/712/img/1712803_1.jpg?shrink=500:500&_v=20150119135203
            domain === "img.danawa.com" ||
            // https://img-www.tf-cdn.com/movie/2/dont-worry-he-wont-get-far-on-foot-2018.jpeg?_v=20180709235653&w=1024&h=512&dpr=1&auto=compress&fm=pjpg&fit=crop&crop=faces%2Ctop
            domain === "img-www.tf-cdn.com"||
            // https://6.viki.io/image/85db05c96d2c4a4ba4d6d2fa9798281c.jpeg?x=b&a=0x0&s=460x268&e=t&f=t&cb=1
            domain_nosub === "viki.io" ||
            // https://avatars2.githubusercontent.com/u/1?s=400&v=4
            (domain_nosub === "githubusercontent.com" && domain.match(/^avatars[0-9]*\./)) ||
            // https://bloximages.newyork1.vip.townnews.com/heraldmailmedia.com/content/tncms/assets/v3/editorial/1/9a/19a45cfe-354a-11e3-939d-001a4bcf6878/5800f2836b369.image.jpg?resize=1200%2C675
            (domain_nosub === "townnews.com" && domain.match(/bloximages\..*vip\.townnews\.com/)) ||
            //domain === "bloximages.newyork1.vip.townnews.com" ||
            domain === "asset.wsj.net" ||
            // https://images.wsj.net/im-20887?width=1260&aspect_ratio=1.5
            domain === "images.wsj.net" ||
            domain === "steamuserimages-a.akamaihd.net" ||
            // haven't tested, but it's imgix
            /*domain === "image.assets.pressassociation.io" ||
            // https://content.assets.pressassociation.io/2018/02/06210749/1324f25e-1b19-4315-9420-e8e027475cf2.jpg?rect=0,183,2355,1325&ext=.jpg
            domain === "content.assets.pressassociation.io" ||*/
            (domain_nosub === "pressassociation.io" && domain.match(/\.assets\.pressassociation\.io$/)) ||
            // http://media.immediate.co.uk/volatile/sites/3/2012/05/13874.jpg?quality=90&lb=620,413&background=white
            domain === "media.immediate.co.uk" ||
            // https://images.immediate.co.uk/volatile/sites/3/2018/03/Emma-Watson-Oscars-tattoo-25baac2.jpg?quality=10&lb=620,413&background=white
            domain === "images.immediate.co.uk" ||
            // https://cdn.heatworld.com/one/lifestyle-images/celebrity/58357d749f0e322331739515/Screen%20Shot%202016-10-06%20at%2014.43.52.png?quality=50&width=960&ratio=16-9&resizeStyle=aspectfill&format=jpg
            domain === "cdn.heatworld.com" ||
            // https://www.thetimes.co.uk/imageserver/image/methode%2Fsundaytimes%2Fprodmigration%2Fweb%2Fbin%2F1ed9d88f-d652-4563-8d8b-fcbad22a1d0a.jpg?crop=1024%2C683%2C0%2C0&resize=685
            (domain === "www.thetimes.co.uk" && src.indexOf("/imageserver/") >= 0) ||
            // http://feeds.thetimes.co.uk/web/imageserver/imageserver/image/methode%2Ftimes%2Fprod%2Fweb%2Fbin%2F851fb466-202d-11e7-ba28-54204ca551ca.jpg?crop=1500,844,0,38
            (domain === "feeds.thetimes.co.uk" && src.indexOf("/imageserver/") >= 0) ||
            // http://static.ok.co.uk/media/images/625x417_ct/737562_nick_hewer_9ab914ab8a82c5effdb695a41741ab84.jpg?w=900
            domain === "static.ok.co.uk" ||
            // https://media.gettyimages.com/photos/nick-hewer-arriving-for-the-2012-arqiva-british-academy-television-picture-id848052898?k=6&m=848052898&s=612x612&w=0&h=4QnBTCuNyp6nYhAumGR6k9gqH3iYagsnqkDo0ouGnts=
            // adds watermark
            //domain === "media.gettyimages.com" ||
            // https://media.planetradio.co.uk/one/radio-legacy/52/fd06b/a5054/18c3c/83efe/bd389/d74d2/nickhewer.png?quality=80&width=960&ratio=16-9&resizeStyle=aspectfill&format=jpg
            domain === "media.planetradio.co.uk" ||
            // https://media.npr.org/assets/artslife/arts/2010/10/keith-richards/keith-richards_wide-68d0d5994c72c50de849d27e7c75519f2c832fc8.jpg?s=1400
            domain === "media.npr.org" ||
            // http://assets.teamrock.com/image/1cfd675c-33c9-4081-a27f-3f41abc88b69?w=800
            domain === "assets.teamrock.com" ||
            // https://media2.woopic.com/api/v1/images/156%2FS6N4g%2Fles-revoltes-rencontre-avec-simon-leclere-et-solene-rigot%7Cx240-WfM.jpg?format=300x175&facedetect=1&quality=85
            (domain_nosub === "woopic.com" && domain.match(/^media[0-9]\.woopic\.com/)) ||
            // http://md1.libe.com/photo/357188-de-gauche-a-droite-louise-grinberg-yara-pilartz-roxane-duran-solene-rigot-et-juliette-darche.jpg?modified_at=1322675617&width=975 -- redirects to the pattern below
            (domain_nosub === "libe.com" && domain.match(/^md[0-9]\.libe\.com/)) ||
            // http://medias.liberation.fr/photo/357188-de-gauche-a-droite-louise-grinberg-yara-pilartz-roxane-duran-solene-rigot-et-juliette-darche.jpg?modified_at=1322675617&width=975
            domain === "medias.liberation.fr" ||
            // https://cdn.graziadaily.co.uk/one/lifestyle-images/celebrity/58bbdf7709f46d350a06910e/GettyImages-647330302.jpg?quality=50&width=960&ratio=16-9&resizeStyle=aspectfill&format=jpg
            domain === "cdn.graziadaily.co.uk" ||
            // https://regmedia.co.uk/2016/08/03/newsboy.jpg?x=442&y=293&crop=1
            domain === "regmedia.co.uk" ||
            // https://imageservice.nordjyske.dk/images/nordjyske.story/2012_05_12/961b43d2-64b8-47df-8c37-1c0e73565fb0.jpg?w=624&mode=crop&scale=both
            domain === "imageservice.nordjyske.dk" ||
            domain === "wac.450f.edgecastcdn.net" ||
            // http://www.gosoutheast.com/images/2015/9/29/Tony_Anderson-150917-JR.jpg?width=300
            (domain === "www.gosoutheast.com" && src.indexOf("/images/") >= 0) ||
            // http://itpro.nikkeibp.co.jp/atcl/column/17/010900605/011000014/ph01.jpg?__scale=w:450,h:501&_sh=0e0c309803
            //(domain === "itpro.nikkeibp.co.jp" && src.toLowerCase().match(/\.(?:jpg|png)$/)) ||
            // http://trendy.nikkeibp.co.jp/atcl/column/17/011800066/020900003/01.jpg?__scale=w:400,h:267&_sh=08d0b10ff0
            // http://wol.nikkeibp.co.jp/atcl/column/15/011500044/021300142/icon_m.jpg?__scale=w:214,h:147&_sh=0820dc0240
            (domain_nosub === "nikkeibp.co.jp" && src.toLowerCase().match(/\.(?:jpg|png)/)) ||
            // http://s-a4.best.gg/rosters/players/default2.png?image=c_fill,g_south,h_90,w_90
            (domain_nosub === "best.gg" && domain.match(/s-a[0-9]*\.best\.gg/)) ||
            // https://i5.walmartimages.com/asr/5375d30c-11a2-4725-a32d-cb59da53b5a5_1.20c1f4d2ccae8f4840ae88be99babb3e.jpeg?odnHeight=450&odnWidth=450&odnBg=FFFFFF
            (domain_nosub === "walmartimages.com" && domain.match(/i[0-9]*\.walmartimages\.com/)) ||
            // https://nails.newsela.com/s3/newsela-media/article_media/2017/10/elem-hogwarts-express-rescue-fa623e3b.jpg?crop=0,139,1366,907&height=497&width=885
            domain === "nails.newsela.com" ||
            // http://ojsfile.ohmynews.com/CT_T_IMG/2018/0201/IE002279450_APP.jpg?2034
            domain === "ojsfile.ohmynews.com" ||
            // https://lumiere-a.akamaihd.net/v1/images/image_4cca1969.jpeg?region=0,0,512,288
            domain === "lumiere-a.akamaihd.net" ||
            // http://www.xxlmag.com/files/2018/02/Iggy-Azalea-interview.jpeg?w=980&q=75
            // http://xxlmag.com/files/2018/02/Iggy-Azalea-interview.jpeg?w=980&q=75
            domain_nowww === "xxlmag.com" ||
            // https://static01.nyt.com/images/2018/02/03/arts/03playlist/merlin_123145877_5ed2acde-72d5-4afb-a19a-93dbc29b5d2f-superJumbo.jpg?quality=100&auto=webp
            (domain_nosub === "nyt.com" && domain.match(/^static[0-9]*\.nyt\.com/)) ||
            // https://video-images.vice.com/articles/592ed99499168942accbdf39/lede/1496243427040-BadGyal_JavierRuiz_2.jpeg?crop=1xw:0.4212xh;0xw,0.3534xh&resize=1200:*
            // https://i-d-images.vice.com/images/2016/07/29/club-marab-cierra-su-temporada-con-bad-gyal-la-princesa-del-trap-cataln-body-image-1469779091.jpg?crop=1xw:0.5625xh;center,center&resize=0:*
            (domain_nosub === "vice.com" && domain.match(/-images\.vice\.com$/)) ||
            // https://i.imgur.com/ajsLfCa_d.jpg?maxwidth=520&shape=thumb&fidelity=high
            domain === "i.imgur.com" ||
            // https://media.discordapp.net/attachments/170399623859404800/411963827412795394/CdynalsW4AQYsgy.png?width=223&height=300
            domain === "media.discordapp.net" ||
            // https://images.discordapp.net/.eJwFwcsRgyAQANBeKIDltwIWkB48IjKgo4FhN6dMes97X_GZt1hFYx60Ahwn5T4PSdxnqkXW3utd0jhJ5v5AYk65PeXNBAaVDSF6ZVR0WitvwGrEBbVzyvsQ7eIMvPYWM27yGlX8_v3wIf4.2PoWG1MegEuQyuPigedqzEcwm7Y?width=462&height=600
            domain === "images.discordapp.net" ||
            // https://images.theconversation.com/files/159874/original/image-20170308-14932-n1fsc6.jpg?ixlib=rb-1.1.0&q=45&auto=format&w=1000&fit=clip
            domain === "images.theconversation.com" ||
            // https://www.rspb.org.uk/globalassets/images/birds-and-wildlife/non-bird-species-illustrations/grey-squirrel_1200x675.jpg?preset=landscape_mobile
            (domain === "www.rspb.org.uk" && src.indexOf("/globalassets/") >= 0) ||
            // http://media.beliefnet.com/~/media/photos/inspiration/galleries/20-most-beautiful-places-in-the-world/tunnel_of_love_ukraine.jpg?as=1&w=400
            domain === "media.beliefnet.com" ||
            // http://img.cdn2.vietnamnet.vn/Images/english/2017/11/10/09/20171110093351-sez.jpg?w=80&h=45
            (domain_nosub === "vietnamnet.vn" && domain.match(/img\.cdn[0-9]*\.vietnamnet\.vn/)) ||
            // http://img.cdn2.vietnamnet.vn/Images/english/2018/05/23/09/20180523095208-3.jpg?w=80&h=45
            //domain.match(/img\.cdn[0-9]*\.vietnamnet\.vn/) ||
            // https://i.gadgets360cdn.com/large/tara_main_1511903994721.jpg?output-quality=70&output-format=webp
            domain === "i.gadgets360cdn.com" ||
            // https://i.ndtvimg.com/video/images/vod/medium/2018-02/big_478201_1517848813.jpg?downsize=298:224&output-quality=70&output-format=webp
            domain === "i.ndtvimg.com" ||
            // https://d3lp4xedbqa8a5.cloudfront.net/s3/digital-cougar-assets/Now/2018/02/16/44694/Healthy-pizza.jpg?width=132&height=107&mode=crop&scale=both&anchor=middlecenter&quality=85
            domain === "d3lp4xedbqa8a5.cloudfront.net" ||
            // https://brnow.org/getattachment/cc67f65b-b0b7-4365-abd5-258e4e1c1680?maxsidesize=50
            (domain === "brnow.org" && src.indexOf("/getattachment/") >= 0) ||
            // https://p3.ssl.cdn.btime.com/t01b3d8cb1040fbe0ba.jpg?size=730x1110
            (domain_nosub === "btime.com" && domain.match(/p[0-9]*\.(?:ssl\.)?cdn\.btime\.com/)) ||
            // http://images.twistmagazine.com/uploads/images/file/21604/sabrina-carpenter-selfie.jpg?fit=crop&h=666&w=500
            domain === "images.twistmagazine.com" ||
            // https://sites.google.com/site/faustrolemodel/_/rsrc/1427391714266/sabrina-carpenter/452204682.jpg?height=400&width=331
            domain === "sites.google.com" ||
            // https://images.pexels.com/photos/68147/waterfall-thac-dray-nur-buon-me-thuot-daklak-68147.jpeg?h=350&auto=compress&cs=tinysrgb
            domain === "images.pexels.com" ||
            // https://images.unsplash.com/photo-1503320748329-9455bea97a68?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=324bf91b29fb196d6aefb2f4806d04c0&auto=format&fit=crop&w=1000&q=60
            domain === "images.unsplash.com" ||
            // tshop will automatically be replaced to shop
            // https://tshop.r10s.jp/book/cabinet/3966/4907953093966.jpg?fitin=200:300&composite-to=*,*|200:300
            //   https://shop.r10s.jp/book/cabinet/3966/4907953093966.jpg
            domain === "tshop.r10s.jp" ||
            // https://rakuma.r10s.jp/d/strg/ctrl/25/af89f9418a6f8fc899e2e0a280d79acd0c274d16.79.1.25.2.jpg?fit=inside%7C300%3A300
            domain === "rakuma.r10s.jp" ||
            // https://image.thanhnien.vn/Uploaded/phinp/2018_02_19/thumnail-bi-mat-tuan-anh_cms_VOVN.jpg?width=178&height=100&crop=auto&scale=both
            domain === "image.thanhnien.vn" ||
            // http://static.netlife.vn//2017/11/07/14/43/sao-han-trong-1-tuan-tara-den-viet-nam-2-lan_1.jpg?maxwidth=480
            domain === "static.netlife.vn" ||
            // http://rs.phunuonline.com.vn/staticFile/Subject/2018/02/14/7391244/unnamed_182138203.png?w=51&h=32
            domain === "rs.phunuonline.com.vn" ||
            // https://images.nbcolympics.com/www.nbcolympics.com/field_image/22February2018/shuster_smile.jpg?impolicy=960x540_rectangle
            domain === "images.nbcolympics.com" ||
            // https://compote.slate.com/images/4e1e4179-fb17-436b-a890-1a4fdb417d45.jpeg?width=1180&offset=0x0&rect=1560x1040&height=842
            domain === "compote.slate.com" ||
            // https://media.gannett-cdn.com/29906170001/29906170001_5720100432001_5720093419001-vs.jpg?pubId=29906170001&quality=10
            //domain === "media.gannett-cdn.com" ||
            // https://www.gannett-cdn.com/media/2016/04/15/USATODAY/USATODAY/635963424849581175-GTY-463036250-70683098.JPG?width=299&height=168&fit=bounds
            domain_nosub === "gannett-cdn.com" ||
            // http://www.rdfm-radio.fr/medias/images/media.nrj.fr-2f436x327-2f2017-2f11-2fbiographie-de-mc-fioti-484.jpg?fx=c_180_180 -- dead?
            (domain_nowww === "rdfm-radio.fr" && src.indexOf("/medias/") >= 0) ||
            // http://image-api.nrj.fr/02_5a02579e3cb49.png?w=730&h=410
            domain === "image-api.nrj.fr" ||
            // http://api.hdwallpapers5k.com/resource/fileuploads/photos/albums/1400/5382c527-5081-4bf4-8b2b-25ea11356bf4.jpeg?quality=100&w=2560&h=2560&mode=crop
            domain === "api.hdwallpapers5k.com" ||
            // http://images.en.koreaportal.com/data/images/full/14639/rita-ora.jpg?w=600
            (domain_nosub === "koreaportal.com" && domain.match(/images\.[^.]*\.koreaportal\.com/)) ||
            // http://www.officialcharts.com/media/653733/taylor-swift-press-image-1100.jpg?width=796&mode=stretch
            (domain === "www.officialcharts.com" && src.indexOf("/media/") >= 0) ||
            // https://citywonders.com/media/11395/mt-vesuvius-crater.jpg?anchor=center&mode=crop&quality=65&width=1200&height=900
            (domain === "citywonders.com" && src.indexOf("/media/") >= 0) ||
            // http://pix10.agoda.net/hotelImages/519/519394/519394_14031416100018704350.jpg?s=1024x768
            (domain_nosub === "agoda.net" && domain.match(/pix[0-9]*\.agoda\.net/)) ||
            // https://images.pottermore.com/bxd3o8b291gf/1FC5pSmkSg44SMew0osm4Y/afb1fbf505eaf4c6a398b80ca075e014/DracoMalfoy_WB_F6_DracoMalfoyOnBathroomFloorHarryStanding_Still_080615_Land.jpg?w=1330&q=85
            domain === "images.pottermore.com" ||
            // https://www.google.com/s2/u/0/photos/public/AIbEiAIAAABECKjC6cfB5MXfkQEiC3ZjYXJkX3Bob3RvKig5NThhYjU1NjkzZGJkOTBmY2ZhZDAyYjE4NThjZjlmMzZmY2ZiZGY3MAHuuVSn2yIIP3390PZse6G3donZOg?sz=50
            (domain === "www.google.com" && src.match(/\/photos\/public\/[^/]*$/)) ||
            // https://images.streamable.com/east/image/pqxns_first.jpg?height=100
            domain === "images.streamable.com" ||
            // https://cdn.amebaowndme.com/madrid-prd/madrid-web/images/sites/121508/7b13cca970a6eae1f46625638213900b_3a2cc2bd26844834e05b77f95b7500b7.jpg?width=724
            domain === "cdn.amebaowndme.com" ||
            // http://www.kaixian.tv/gd/d/file/201803/13/6b65c9bc4e0128a92a0e9fc0aa2d2d2d.jpg?imageView&thumbnail=100y75
            (domain === "www.kaixian.tv" && src.indexOf("/file/") >= 0) ||
            // http://pic-bucket.nosdn.127.net/photo/0001/2018-01-24/D8SM4CRK00AP0001NOS.jpg?imageView&amp;thumbnail=100y75
            // forbidden with referrer
            // http://imglf6.nosdn.127.net/img/NStLVUtLYlBtSm9PTWJqMmpEVXF5N2pSL1U1a2I5SjhTdG50QzNMRHljblFlV1VQeUtGVUJ3PT0.jpg?imageView&thumbnail=1680x0&quality=96&stripmeta=0&type=jpg
            //(domain.indexOf("nosdn.127.net") >= 0 && src.indexOf("/photo/") >= 0) ||
            // https://sumo.cdn.tv2.no/imageapi/v2/img/58aff90284ae6c3cc0945755-1519386606657?width=1920&height=1080&location=list
            (domain === "sumo.cdn.tv2.no" && src.indexOf("/imageapi/") >= 0) ||
            // https://media.missguided.com/s/missguided/L4227488_set/1/brown-square-back-thong-swimsuit.jpg?$category-page__grid--1x$
            domain === "media.missguided.com" ||
            // https://photo.venus.com/im/V1092-COB_V2362-COB.0288.s.jpg?preset=product
            domain === "photo.venus.com" ||
            // https://cdn-images.prettylittlething.com/c/4/f/f/c4ffac27c350089f9cb5214a68bad59c7a943bb5_CLW1289_1.JPG?imwidth=60
            domain === "cdn-images.prettylittlething.com" ||
            // http://www.oxfordmail.co.uk/resources/images/4817793.jpg?display=1&htype=0&type=responsive-gallery
            (domain === "www.oxfordmail.co.uk" && src.indexOf("/resources/") >= 0) ||
            // http://popcrush.com/files/2014/07/EmmaWatson1.jpg?w=980&q=75
            (domain === "popcrush.com" && src.indexOf("/files/") >= 0) ||
            // http://screencrush.com/files/2013/03/50_shades_of_grey_emma_watson.jpg?w=980&q=75
            (domain === "screencrush.com" && src.indexOf("/files/") >= 0) ||
            // http://assets.cougar.nineentertainment.com.au/assets/Dolly/2014/03/20/52622/3.jpg?mode=max&quality=80&width=1024
            (domain_nosub === "nineentertainment.com.au" && domain.match(/assets\.[^.]*\.nineentertainment\.com\.au/)) ||
            // https://www.thenational.ae/image/policy:1.479136:1499670177/image/jpeg.jpg?f=16x9&w=1024&$p$f$w=2589da4
            (domain === "www.thenational.ae" && src.indexOf("/image/") >= 0) ||
            // https://s3.kh1.co/80e0569ad275cc700a5b9bee37447bd432a63ced.jpg?m=thumb&w=400&h=560
            (domain_nosub === "kh1.co" && domain.match(/s[0-9]*\.kh1\.co/)) ||
            // https://uploads.disquscdn.com/images/9b96ed95917fe3b747f0b441246985a838e3e0b370607817a540b4a40119b9a6.gif?w=800&h=253
            domain === "uploads.disquscdn.com" ||
            // https://www.voidu.com/content/products/gallery/99832a851b23b8a91f296adac...-20180216101631.jpg?width=1140&height=450&mode=crop&scale=both
            // https://voidu.com/content/products/gallery/99832a851b23b8a91f296adac...-20180216101631.jpg?width=1140&height=450&mode=crop&scale=both
            (domain_nowww === "voidu.com" && src.indexOf("/gallery/") >= 0) ||
            // https://store.playstation.com/store/api/chihiro/00_09_000/container/US/en/99/UP4139-CUSA10160_00-SURVIVINGMARSFCE//image?_version=00_09_000&platform=chihiro&w=720&h=720&bg_color=000000&opacity=100
            (domain === "store.playstation.com" && src.indexOf("/image?") >= 0) ||
            // https://images.interactives.dk/cdn-connect/98f5b7864bfb4efba3e65b9d0c983122.jpg?auto=compress&ch=Width%2CDPR&ixjsv=2.2.4&w=750
            domain === "images.interactives.dk" ||
            // https://toyo-arhxo0vh6d1oh9i0c.stackpathdns.com/media/1200/xl-hero-tire-pr-ra1.jpg?quality=10
            // https://toyo-arhxo0vh6d1oh9i0c.stackpathdns.com/media/1908/xl-pxr8r-hero-740x740.jpg?anchor=center&mode=crop&quality=90&width=470&rnd=131206940370000000
            domain === "toyo-arhxo0vh6d1oh9i0c.stackpathdns.com" ||
            // http://www.zmonline.com/media/17805975/pussycat.jpg?mode=crop&width=620&height=349&quality=60&scale=both
            (domain === "www.zmonline.com" && src.indexOf("/media/") >= 0) ||
            // https://img-s-msn-com.akamaized.net/tenant/amp/entityid/AAtV5nt.img?h=328&w=270&m=6&q=60&o=f&l=f&x=277&y=235
            domain === "img-s-msn-com.akamaized.net" ||
            // http://www.heraldscotland.com/resources/images/5792318.jpg?display=1&htype=0&type=responsive-gallery
            // http://heraldscotland.com/resources/images/5792318.jpg?display=1&htype=0&type=responsive-gallery
            (domain_nowww === "heraldscotland.com" && src.indexOf("/resources/images/") >= 0) ||
            // https://cdn.instructables.com/ORIG/FLU/3BAI/JF8IWE1M/FLU3BAIJF8IWE1M.jpg?width=400&crop=3:2
            domain === "cdn.instructables.com" ||
            // http://images.performgroup.com/di/library/sporting_news/a5/be/edmonton-oilers-getty-images-041102017-ftrjpg_jt08mu2eqgwn1xr30wgvpqdzv.jpg?t=1619857107&w=960&quality=70
            domain === "images.performgroup.com" ||
            // http://media.playmobil.com/i/playmobil/9022_product_detail?locale=en-US,en,*&$pdp_product_main_xl$
            domain === "media.playmobil.com" ||
            // https://img.crocdn.co.uk/images/products2/pl/00/00/00/38/pl0000003849.jpg?width=940&height=940
            domain === "img.crocdn.co.uk" ||
            // http://www.calgaryherald.com/life/cms/binary/6748001.jpg?size=sw620x65
            (domain === "www.calgaryherald.com" && src.indexOf("/cms/") >= 0) ||
            // http://www.montrealgazette.com/cms/binary/8317804.jpg?size=640x420
            (domain_nowww === "montrealgazette.com" && src.indexOf("/cms/") >= 0) ||
            // https://m2.ikea.com/images/pokoj-dziecka-z-niebieskimi-scianami-i-monochromatyczna-posc-919afda5ac9e85ba681cd2e3e698e893.jpg?f=l
            (domain_nosub === "ikea.com" && src.indexOf("/images/") >= 0) ||
            // https://colorwallpaper.net/img/2018/01/pashion-with-a-fashion.jpg?w=544&h=967&fit=stretch
            (domain === "colorwallpaper.net" && src.indexOf("/img/") >= 0) ||
            // https://img.cache.vevo.com/thumb/cms/6adeb8f9fb65d67e94044181f4e102c6/281x159.jpg?resize=fit&remove_borders=true
            domain === "img.cache.vevo.com" ||
            // https://drop.ndtv.com/albums/uploadedpics/small/vivo_v9_youth_small_636598304295938786.jpg?downsize=120:90&output-quality=70&output-format=webp
            (domain === "drop.ndtv.com" && src.indexOf("/albums/") >= 0) ||
            // http://kr.images.christianitydaily.com/data/images/full/107742/97.jpg?w=304&h=152&l=50&t=40
            (domain_nosub === "christiandaily.com" && domain.indexOf("images.christianitydaily.com") >= 0) ||
            // http://images.christiandaily.co.kr/data/images/full/50674/image.jpg?w=600
            (domain_nosub === "christiandaily.co.kr" && domain.indexOf("images.christiandaily.co.kr") >= 0) ||
            // http://images.christiantoday.co.kr/data/images/full/292467/image.png?w=600
            domain === "images.christiantoday.co.kr" ||
            // https://blogimg.goo.ne.jp/cnv/v1/user_image/5d/9d/e2b49057338c93324e0f70dd6fc4be03.jpg?dw=110,dh=110,cw=110,ch=110,q=90,da=s,ds=s
            domain === "blogimg.goo.ne.jp" ||
            // https://cdn.clien.net/web/api/file/F01/6848785/5a32dafe05c22a.jpg?w=780&h=30000
            domain === "cdn.clien.net" ||
            // https://s1.imgs.cc/img/aaaaaRmUn.jpg?_w=500
            (domain_nosub === "imgs.cc" && domain.match(/s[0-9]*\.imgs\.cc/)) ||
            // https://ssl-stat.amebame.com/pub/content/8265872137/user/article/unknown/unknown/376668982082606877/6af49eccc7dd77e2b3bde8002f6be55c/uploaded.png?width=546
            // https://stat.amebame.com/pub/content/8265872137/user/article/unknown/unknown/376668982082606877/6af49eccc7dd77e2b3bde8002f6be55c/uploaded.png?width=546
            (domain_nosub === "amebame.com" && domain.indexOf("stat.amebame.com") >= 0) ||
            // https://i.iheart.com/v3/re/new_assets/5a91863a79b810a683361620?ops=fit(770%2C385)
            domain === "i.iheart.com" ||
            // https://cdn-hit.scadigital.io/media/10650/justin-bieber-selena-gomez.jpg?preset=MainImage
            domain === "cdn-hit.scadigital.io" ||
            // https://displate.com/displates/2018-01-13/2301ff8c98beecd3d095944ba5ec5952_544fe5884a2b74dba13a63a9a50cb48c.jpg?w=280&h=392
            (domain === "displate.com" && src.indexOf("/displates/") >= 0) ||
            // https://cdn56.picsart.com/169599975000202.jpeg?r1024x1024
            (domain_nosub === "picsart.com" && domain.match(/cdn[0-9]*\.picsart\.com/)) ||
            // https://cdn.ndtv.com/tech/gadgets/Electronic_Arts_Dragon_Age_Inquisition_Cover.jpg?output-quality=10
            domain === "cdn.ndtv.com" ||
            // https://assets-a1.kompasiana.com/images/avatar/13267750-10207923832071268-7573729854263131153-n-57aeadc0d89373090f9eb6eb.jpg?t=t&v=70&x=70
            (domain_nosub === "kompasiana.com" && domain.match(/assets(?:-[a-z][0-9])?\.kompasiana\.com/)) ||
            // https://images.popbuzz.com/images/2126?crop=1_1&width=200&signature=CbNpTNT994BxnDA7v5idqFKtsOs=
            domain === "images.popbuzz.com" ||
            // https://i1.adis.ws/i/Marc_Jacobs/friends_dovecameron_beautyconfestival_spring17?w=800&qlt=70&img404=NOIMAGEMEDIUM
            (domain_nosub === "adis.ws" && domain.match(/i[0-9]*\.adis\.ws/)) ||
            // http://images2.9c9media.com/image_asset/2017_6_18_79194164-a321-4264-a5e3-f641dad7e65b_png_1920x1080.jpg?size=400
            (domain_nosub === "9c9media.com" && domain.match(/^images[0-9]*\.9c9media\.com/)) ||
            // http://img1-azcdn.newser.com/image/1180030-0-20180515094436.jpeg?width=76&height=76&crop=yes
            (domain_nosub === "newser.com" && domain.match(/img[0-9]*(?:-[a-z]+)?\.newser\.com/)) ||
            // http://images.m-magazine.com/uploads/posts/image/62933/dove-cameron-descendants-doll.jpg?crop=top&fit=clip&h=500&w=698
            domain === "images.m-magazine.com" ||
            // https://www.zoom.co.uk/assets/images/0/0/2/4/4/mm00244615.jpg?width=208
            domain === "www.zoom.co.uk" ||
            // https://ctd-thechristianpost.netdna-ssl.com/en/full/21939/a-thief-in-the-night.jpg?w=400&h=608
            domain === "ctd-thechristianpost.netdna-ssl.com" ||
            // https://img.vidible.tv/prod/2017-06/19/59481cb6f3bdc95f62ebf5bf/59481cb56709846d28c25ea1_o_F_v0.jpg?w=1440&h=900 -- upscaled
            domain === "img.vidible.tv" ||
            // http://images.es.j-14.com/uploads/posts/image/67560/dove-cameron-new-music.jpg?crop=top&fit=clip&h=900&w=2000 -- upscaled
            (domain_nosub === "j-14.com" && domain.match(/images\.(?:[a-z]+\.)?j-14\.com/)) ||
            // https://cdn.abcotvs.com/dip/images/3174795_030418aposcarsredcarpetronan.jpg?w=120&r=16:9
            domain === "cdn.abcotvs.com" ||
            // http://www.tasteofcountry.com/files/2018/04/ACM-RC-Pictures.jpg?w=980&q=75
            (domain_nowww === "tasteofcountry.com" && src.indexOf("/files/") >= 0) ||
            // https://images.thewest.com.au/publication/B88845233Z/1527064708921_GEP1KTC2C.2-2.jpg?imwidth=640&impolicy=.auto
            domain === "images.thewest.com.au" ||
            // https://cdn1.ntv.com.tr/gorsel/sanat/izlemeniz-gereken-100-anime/izlemeniz-gereken-100-anime,cZEsQuQhvUqIlKd_mSoGvw.jpg?w=960&mode=max&v=20100504143043000
            (domain_nosub === "ntv.com.tr" && domain.match(/cdn[0-9]*\.ntv\.com\.tr/)) ||
            // https://img6.hotnessrater.com/3892309/cailin-russo.jpg?w=200&h=300
            (domain_nosub === "hotnessrater.com" && domain.match(/img[0-9]*\.hotnessrater\.com/)) ||
            // http://www.starcrush.com/files/2012/11/AnnaSophia-Robb.jpg?w=980&q=75
            domain_nowww === "starcrush.com" ||
            // https://www.chrichri.dk/media/11430/11.jpeg?width=634&height=1004
            (domain === "www.chrichri.dk" && src.indexOf("/media/") >= 0) ||
            // https://www.rightstufanime.com/images/productImages/816546020668_anime-anohana-the-flower-we-saw-that-day-tv-series-box-set-blu-ray-primary.jpg?resizeid=4&resizeh=100&resizew=60
            (domain === "www.rightstufanime.com" && src.indexOf("/images/") >= 0) ||
            // https://assets.bigcartel.com/product_images/203868677/ANOHANA+SITE.jpg?auto=format&fit=max&w=1500
            domain === "assets.bigcartel.com" ||
            // http://www.thenorthernecho.co.uk/resources/images/7672541.jpg?display=1&htype=0&type=responsive-gallery
            (domain === "www.thenorthernecho.co.uk" && src.indexOf("/resources/images/") >= 0) ||
            // http://binaryapi.ap.org/2df5c8e3642d4183a08cf802c2dd50b1/preview/AP13344549840.jpg?wm=api&ver=0
            domain === "binaryapi.ap.org" ||
            // https://images.8tracks.com/cover/i/000/618/338/hive_mind_cover-4092.jpg?rect=0,0,500,500&q=98&fm=jpg&fit=max&w=320&h=320
            domain === "images.8tracks.com" ||
            // http://cdn2.spoilercat.com/ac/a/christopher-nolan-53c9cd8d5bbe5d40048c7003.jpeg?s=640x0 -- upscaled
            (domain_nosub === "spoilercat.com" && domain.match(/cdn[0-9]*\.spoilercat\.com/)) ||
            // https://www.mumbailive.com/images/news/Christopher_1514973032318.jpg?w=205
            (domain === "www.mumbailive.com" && src.indexOf("/images/") >= 0) ||
            // https://static.juksy.com/files/articles/68423/59704be703149.png?m=widen&i=600&q=75
            domain === "static.juksy.com" ||
            // http://img.reblog.hu/blogs/28942/christophere8d6.jpg?w=640
            domain === "img.reblog.hu" ||
            // http://www.thefw.com/files/2012/11/tumblr_ls6ujhB6wV1qfq9oxo1_5001.jpg?w=980&q=75 -- stretched
            (domain_nowww === "thefw.com" && src.indexOf("/files/") >= 0) ||
            // https://img.csfd.cz/files/images/creator/photos/160/654/160654750_730831.jpg?w100h132crop
            domain === "img.csfd.cz" ||
            // http://img.timesnownews.com/2_1518716279__rend_1_1.jpg?d=300x225
            domain === "img.timesnownews.com" ||
            // https://img.siksinhot.com/place/1487044026161009.jpg?w=508&h=412&c=Y
            domain === "img.siksinhot.com" ||
            // https://mp-seoul-image-production-s3.mangoplate.com/keyword_search/meta/pictures/19bmu--ycm0atk5q.png?fit=around|600:400&crop=600:400;*,*&output-format=jpg&output-quality=80
            domain === "mp-seoul-image-production-s3.mangoplate.com" ||
            // http://api.theweek.com/sites/default/files/sbr070118dAPR.jpg?resize=807x807
            domain === "api.theweek.com" ||
            // https://i.smalljoys.me/2018/02/kpop-girls-generation-popularity_2017112803570_0.jpg?w=300&ssl=1&strip=all
            domain === "i.smalljoys.me" ||
            // https://t1.huanqiu.cn/98c0e4cbd2b91f316105adef408fb21b.jpg?w=150
            (domain_nosub === "huanqiu.cn" && domain.match(/t[0-9]*\.huanqiu.cn/)) ||
            // https://www.radiotimes.com/uploads/images/original/140622.d01d7e34-379c-4bcd-9a84-4caea87320db.jpg?width=426&height=256&mode=crop&quality=60
            (domain_nowww === "radiotimes.com" && src.indexOf("/uploads/") >= 0) ||
            // https://hypebeast.com/image/2018/07/kaws-companion-sculpture-gwanggyo-ipark-0.jpg?q=90
            (domain === "hypebeast.com" && src.indexOf("/image/") >= 0) ||
            // https://dramaguru.net/images/actors/amar_khan_645.jpeg?w=315&h=350&fit=crop-top
            (domain === "dramaguru.net" && src.indexOf("/images/") >= 0) ||
            // http://sos.vfan.vlive.tv/b/2jfi2j/8_187Ud018svc1i6cch4stmk9h_flwfzl.jpeg?type=e640
            domain === "sos.vfan.vlive.tv" ||
            // https://img.journalmedia.ie/article/3622641?width=1366&version=3622995
            (domain_nosub === "journalmedia.ie" && domain.match(/^img[0-9]*\./)) ||
            // http://img2.thejournal.ie/inline/3749439/original?width=200&version=3749439
            (domain_nosub === "thejournal.ie" && domain.match(/^img[0-9]*\./)) ||
            // http://external.polskieradio.pl/files/75762f5c-6ae2-40f2-b06d-bbc45beaa6d5.file?format=136x81
            (domain === "external.polskieradio.pl" && src.indexOf("/files/") >= 0) ||
            // https://bbd-1tmxd3aba43noa.stackpathdns.com/data/images/full/196632/adorable-cats-jpg.jpg?w=300
            domain === "bbd-1tmxd3aba43noa.stackpathdns.com" ||
            // https://thumb.netz.id/image/2018/06/29/4a093f0c3ce6da7948cb456893cbb926.jpg?w=600
            domain === "thumb.netz.id" ||
            // https://us-east-1.tchyn.io/snopes-production/uploads/2018/04/kkk_feature.jpg?resize=865,452
            (domain_nosub === "tchyn.io" && src.indexOf("/snopes-production/uploads/") >= 0) ||
            // http://img.diply.com/article-images/a/884c637e-7288-480a-a2df-543ff15ae971.jpg?impolicy=mobile
            domain === "img.diply.com" ||
            // https://img-mdpr.freetls.fastly.net/article/Wf7O/nm/Wf7Oi0E0-_n8CRBG4lyiHeFarklxrewLePLfp6cFSf0.jpg?width=250&enable=upscale&crop=250:250,offset-y0&auto=webp&quality=50
            domain === "img-mdpr.freetls.fastly.net" ||
            // https://cdn-assets.ziniopro.com/var/site_877/storage/images/media2/cover187/440239-1-eng-US/cover2.jpg?w=200
            domain === "cdn-assets.ziniopro.com" ||
            // https://netherlands-grlk5lagedl.stackpathdns.com/production/netherlands/images/1526305860593210-Julianne-Moore-in-Givenchy-.jpg?w=802&h=720&fit=clip&fm=pjpg&auto=compress
            domain === "netherlands-grlk5lagedl.stackpathdns.com" ||
            // https://russia-grlk5lagedl.stackpathdns.com/production/russia/images/1526119976681968-c0da67fdb8b-1524024352.jpg?w=450&h=800&fit=clip&crop=faces&fm=pjpg&auto=compress
            (domain_nosub === "stackpathdns.com" && domain.indexOf("-grlk5lagedl.stackpathdns.com") >= 0) ||
            // https://www.beautycrew.com.au/media/12866/jessica-alba-portrait.jpg?width=200
            (domain === "www.beautycrew.com.au" && src.indexOf("/media/") >= 0) ||
            // https://www.hola.com/imagenes/moda/tendencias/2016071486971/summer-denim-looks/0-377-84/jessica_alba_1-a.jpg?interpolation=lanczos-normal&downsize=200px:*&output-format=progressive-jpeg
            // https://us.hola.com/en/imagenes/fashion/2017111710813/latin-grammy-awards-2017-red-carpet-fashion/0-16-344/latin-grammys-t.jpg?interpolation=lanczos-normal&downsize=780px:*&output-format=progressive-jpeg
            (domain_nosub === "hola.com" && src.indexOf("/imagenes/") >= 0) ||
            // http://vh1.mtvnimages.com/uri/mgid:file:http:shared:vh1.com/news/uploads/sites/2/2018/03/GettyImages-873076880-1522090083.jpg?quality=0.85&format=jpg&width=480
            domain_nosub === "mtvnimages.com" ||
            // https://dsx.weather.com/util/image/w/greenaldnberg.jpg?v=at&w=320&h=180&api=7db9fe61-7414-47b5-9871-e17d87b8b6a0
            (domain === "dsx.weather.com" && src.indexOf("/util/image/") >= 0) ||
            // https://img.r7.com/images/iceberg-gigante-14072018102456056?dimensions=600x315
            domain === "img.r7.com" ||
            // https://cdn-images.rtp.pt/icm/images/e1/e12cf8ca828c5079d156e5e1f4903c1a?1200&rect=0,17,700,384&q=100&w=620&q=75
            domain === "cdn-images.rtp.pt" ||
            // https://media.ouest-france.fr/v1/pictures/f34478ee116ed1a208792e10a772aa78-banquise-glacier-iceberg-tout-fond-sur-terre.jpg?width=940&height=531&fill=0&focuspoint=49%2C25&cropresize=1
            domain === "media.ouest-france.fr" ||
            // https://www.rbsdirect.com.br/imagesrc/24569629.jpg?w=1024&h=512&a=c
            (domain_nowww === "rbsdirect.com.br" && src.indexOf("/imagesrc/") >= 0) ||
            // https://www.newfoundlandlabrador.com/-/media/marquees/things-to-do/iceberg-viewing/our-icebergs/iceberg-viewing-our-icebergs-marquee.jpg?mh=477&mw=1272&hash=013C8094C8B7F70F880BE7567A37631629C58B07
            (domain_nowww === "newfoundlandlabrador.com" && src.indexOf("/-/media/") >= 0) ||
            // https://images.businessoffashion.com/site/uploads/2016/02/shutterstock_85109977.jpg?auto=format%2Ccompress&crop=top&fit=crop&h=573&w=1024
            domain === "images.businessoffashion.com" ||
            // http://n10.cmsfile.pg0.cn/group2/M00/2C/C8/Cgqg2lh3CNGAK9KoAANuU1gzN84392.jpg?enable=&w=550&h=731&cut=
            (domain_nosub === "pg0.cn" && domain.match(/cmsfile\.pg0\.cn/)) ||
            // http://api.ning.com/files/JtotRF7dxCUb6oEDdSaFzZJXhL0GGMo-wPYbqAOga3rqEmhaecqI*AxzoQNAArT08Pqt4g9PX*0aFA8I2bPe1b8RtTBY8KD8/011212natalieportmanoscars350.jpg?width=30
            domain === "api.ning.com" ||
            // http://storage0.dms.mpinteractiv.ro/media/2/1401/16207/16175015/4/b30cdcf1c208a63611f6d15a9b76276e.jpg?width=400
            (domain_nosub === "mpinteractiv.ro" && domain.match(/^storage[0-9]*\./) && src.indexOf("/media/") >= 0) ||
            // https://a0.muscache.com/im/pictures/14866a48-c889-4cad-91fa-ae3216e2841e.jpg?aki_policy=x_medium
            (domain_nosub === "muscache.com" && src.match(/\/im\/pictures\/[-0-9a-f]+\./)) ||
            // https://wedd.today/wallpaper/99c10ed13a6aa8620bd5955f14c08bdd/tgc-easy-on-the-eye-thread-no-nsfw-image-pics-only-no-chat-no-paige-spiranac-wallpaper-hd?w=116&h=88
            (domain_nowww === "wedd.today" && src.indexOf("/wallpaper/") >= 0) ||
            // https://www.looklive.at/media/72109/riri.jpg?anchor=center&mode=crop&width=1024&rnd=131565967210000000
            (domain_nowww === "looklive.at" && src.match(/\/media\/[0-9]+\//)) ||
            // https://t.tudocdn.net/150447?w=100&h=1080&fit=clip
            domain === "t.tudocdn.net" ||
            // http://me.phununet.com/topic/resources/img/upload/htsmjle/08032016034306749.jpg?w=400&mode=crop&anchor=topcenter&scale=both
            (domain === "me.phununet.com" && src.indexOf("/resources/img/") >= 0) ||
            // http://cdn.diario26.com.ar/media/image/2018/05/25/389592.jpg?s=2
            (domain === "cdn.diario26.com.ar" && src.indexOf("/media/image/") >= 0) ||
            // http://discovermagazine.com/~/media/Images/Promo%20Images/2018/june/CentaurusA.jpg?mw=200
            (domain_nowww === "discovermagazine.com" && src.indexOf("/media/Images/") >= 0) ||
            // https://steamusercontent-a.akamaihd.net/ugc/952958110703301417/7410320729F64979B9BFFED4C742F9BC1535FB64/?interpolation=lanczos-none&output-format=jpeg&output-quality=95&fit=inside%7C506%3A284&composite-to=*,*%7C506%3A284&background-color=black
            domain === "steamusercontent-a.akamaihd.net" ||
            // https://www.qfeast.com/imret/qq/iI4Fe2.jpg?w=300&h=300&sc=1
            (domain_nowww === "qfeast.com" && src.indexOf("/imret/") >= 0) ||
            // http://statis.gamen.vn/images/upload/2016/09/14/57_l5u2MnoUOr_animemomokofanartrinkyajapan6.jpg?w=200
            (domain === "statis.gamen.vn" && src.indexOf("/images/upload/") >= 0) ||
            // https://img.anikore.jp/images/board/4/2/2/55422/55422.jpg?width=560&height=560&type=resize
            domain === "img.anikore.jp" ||
            // https://cdn1.newsplex.pt/media/2018/3/5/628723.jpg?type=xl
            (domain_nosub === "newsplex.pt" && domain.match(/^cdn[0-9]*\./)) ||
            // http://static.origos.hu/s/img/i/1712/2017121499.jpg?w=644&h=866
            (domain === "static.origos.hu" && src.indexOf("/img/") >= 0) ||
            // http://robertocavada.com/Images/6c732c90-1dee-4d93-968f-47c3bd9d8d9d.jpg?width=385&format=png
            (domain_nowww === "robertocavada.com" && src.indexOf("/Images/") >= 0) ||
            // https://images.mncdn.pl/com_calendar/kurt_nilsen.png?resizeimage=w:230,q:97?resizeimage=w:130,q:97
            domain === "images.mncdn.pl" ||
            // https://imgsearches.com/i/arod-meme-jenniferlopez-losangeles-tights-jennifer-lopez-in-tights-los-D3bdaa424e3c7179ddfcdda66a5c38e5e.jpg?w=238
            (domain_nowww === "imgsearches.com" && src.indexOf("/i/") >= 0) ||
            // http://www.thetimesnews.com/storyimage/NC/20180904/NEWS/180909253/AR/AR-180909253.jpg?Q=75&maxH=775&maxW=775
            // http://www.thetimesnews.com/galleryimage/NC/20180905/NEWS/905009997/PH/1/1/PH-905009997.jpg?Q=75&maxH=775&maxW=775
            (domain_nowww === "thetimesnews.com" && (
                src.indexOf("/storyimage/") >= 0 ||
                    src.indexOf("/galleryimage/") >= 0)) ||
            // https://static.fthis.gr/userfiles/articles/legacy/badb6201-6565-4904-bcdd-3494b9ddea15.jpg?h=573&scale=both&bgcolor=151515&mode=pad
            domain === "static.fthis.gr" ||
            // https://img.pixelz.com/blog/how-to-shoot-a-lookbook/photo-bohemian-model-rocks-and-sand.jpg?w=1000
            (domain === "img.pixelz.com" && src.indexOf("/blog/") >= 0) ||
            // https://ca.hellomagazine.com/imagenes/healthandbeauty/201210249802/get-the-bond-girl-body/0-49-79/naomie-harris-1--a.jpg?interpolation=lanczos-normal&downsize=200px:*&output-format=progressive-jpeg
            (domain_nosub === "hellomagazine.com" && src.indexOf("/imagenes/") >= 0) ||
            // https://i0.1616.ro/media/521/2861/35030/17944527/1/jennifer-lawrence.jpg?width=160
            (domain_nosub === "1616.ro" && domain.match(/^i[0-9]*\./)) ||
            // http://images.lifeandstylemag.com/uploads/posts/image/35601/paula-patton-spirit-awards.jpg?crop=top&fit=clip&h=500&w=698
            domain === "images.lifeandstylemag.com" ||
            // https://img.freepik.com/free-vector/wrinkled-paper-texture_1100-12.jpg?size=158c&ext=jpg
            domain === "img.freepik.com" ||
            // https://img1.fonwall.ru/o/zl/redhead-freckles-sensual-gaze.jpg?route=low&h=200
            (domain_nosub === "fonwall.ru" && domain.match(/^img[0-9]*\./)) ||
            // https://www.wonderwall.com/photos/2018/09/14/1036597-copper-fit-and-kate-upton-launch-event-in-nyc.jpg?x=500&y=1025&icq=74&sig=43aca4eba07017dd9e832c2a0b806368
            (domain_nowww === "wonderwall.com" && src.indexOf("/photos/") >= 0) ||
            // https://www.thestar.com.my/~/media/online/2013/08/29/11/46/doc6bgz1axwovp1c21a5duc.ashx/?w=620&h=413&crop=1&hash=F8EDD8B2D1EF3FA235A86220BB7EB24045FE73B5
            (domain_nowww === "thestar.com.my" && src.indexOf("/~/media/online/") >= 0) ||
            // http://www.vancouversun.com/entertainment/movie-guide/cms/binary/8231595.jpg?size=140x95
            (domain_nowww === "vancouversun.com" && src.indexOf("/cms/") >= 0) ||
            // https://imageproxy.viewbook.com/a22ab14f4e2f7c3ddbe8fc6b48cde6d6_hd.jpg?fit=max&dpr=1&w=200
            domain === "imageproxy.viewbook.com" ||
            // https://image.lag.vn/upload/news/17/11/20/13-1511026059714_QVIK.jpg?w=200
            (domain === "image.lag.vn" && src.indexOf("/upload/") >= 0) ||
            // https://www.booktrust.org.uk/globalassets/images/news-and-blogs/blogs-2017/03.-march/dr-seuss/dr-seuss-16x9.jpg?w=200&h=675&quality=70&anchor=middlecenter
            (domain_nowww === "booktrust.org.uk" && src.indexOf("/globalassets/images/") >= 0) ||
            // http://us.jimmychoo.com/dw/image/v2/AAWE_PRD/on/demandware.static/-/Sites-jch-master-product-catalog/default/dw70b1ebd2/images/rollover/LIZ100MPY_120004_MODEL.jpg?sw=245&sh=245&sm=fit
            // https://www.aritzia.com/on/demandware.static/-/Library-Sites-Aritzia_Shared/default/dw3a7fef87/seasonal/ss18/ss18-springsummercampaign/ss18-springsummercampaign-homepage/hptiles/tile-wilfred-lrg.jpg
            src.match(/\/demandware\.static\//) ||
            // https://cdn1.kongcdn.com/assets/avatars/defaults/robotboy.png?i10c=img.resize(width:40)
            src.match(/\?i10c=[^/]*$/) ||
            // http://hypebeast.com/wp-content/blogs.dir/4/files/2018/01/louis-vuitton-2018-fall-winter-50.jpg?q=75&w=400
            // doesn't work:
            // https://d2u7zfhzkfu65k.cloudfront.net/resize/wp-content/uploads/2018/5/8/15/f21a56c81474b277e24bca7575e94dc7.jpg?w=70&q=85
            src.indexOf("/wp-content/blogs.dir/") >= 0 ||
            src.indexOf("/wp-content/uploads/") >= 0 ||
            src.indexOf("/wp/uploads/") >= 0) {
            src = src.replace(/\?[^/]*$/, "");
        }

        // https://c1.hoopchina.com.cn/uploads/star/event/images/180215/bmiddle-5e8c9e13a07a397579c89590685b479db07ff6b8.png?x-oss-process=image/resize,w_800/format,webp
        if ((domain_nosub === "hoopchina.com.cn" && domain.match(/[ci][0-9]*\.hoopchina\.com\.cn/)) ||
            // https://cdn.odigo.net/60168923a5f06af67f74250c44de7861.png?imageView2/2/w/800/interlace/1%7Cimageslim
            domain === "cdn.odigo.net" ||
            // https://i.linkeddb.com/person2/bc2b/4ac6/d18db22f165a63046031cbb9.jpg?x-oss-process=image/resize,m_fill,w_170,h_230
            domain === "i.linkeddb.com" ||
            // http://wangsuimg.fanshuapp.com/14892066562143large17ef000388f3e91c711a?imageView2/2/w/375/q/80
            domain === "wangsuimg.fanshuapp.com" ||
            // https://img.aiji66.com/83/9d/f1/f4/64/afe732c7-9501-11e7-9040-11832666daf4.jpg?ufopmogr3/auto-orient/thumbnail/300x/crop/x792/interlace/1/quality/100/&e=1519833600&token=Uon2lwH6FDLYBhVyGu5jN25PwVCQuNAIf-_PaQ8E:2Du8aIDyVBLvGBAdS0vvI1eX53c=
            domain === "img.aiji66.com" ||
            // http://imgs.aixifan.com/content/2018_05_01/1525165813.jpg?imageView2/1/w/432/h/240
            domain === "imgs.aixifan.com" ||
            // https://img5.ofashion.com.cn/goods_collection/20160512/193454_1114125733f50485293.jpg?x-oss-process=image/resize,w_640
            (domain_nosub === "ofashion.com.cn" && domain.match(/^img[0-9]*\.ofashion.com.cn/)) ||
            // https://kanfaimage.oss-cn-beijing.aliyuncs.com/20180715/focus_153163480295909.jpg?x-oss-process=image/resize,m_fill,w_600,h_300
            domain === "kanfaimage.oss-cn-beijing.aliyuncs.com" ||
            // http://imgcdn.thecover.cn/cf48adfc-f370-4ee9-922e-dd17fe90691e@1532497060708?imageView2/1/w/315/h/157
            domain === "imgcdn.thecover.cn" ||
            // http://img.qdaily.com/article/article_show/201801221803061ecNiBfxSIF2pzrU.jpg?imageMogr2/auto-orient/thumbnail/!245x185r/gravity/Center/crop/245x185/quality/85/format/webp/ignore-error/1
            domain === "img.qdaily.com" ||
            // https://img.ksl.com/slc/2657/265775/26577563.jpg?filter=ksl/img143
            domain === "img.ksl.com" ||
            // http://s1.mioreport.com/file/fushi/xiuchang/2017-06-02/98c2cd2e90cf206b5bcf3490e3a56d0e.jpg?x-oss-process=style/sty1
            (domain_nosub === "mioreport.com" && domain.match(/^s[0-9]*\./)) ||
            // https://img3.tapimg.com/avatars/1e81533319ff240f73fa29a04ae8b769.jpg?imageMogr2/auto-orient/strip/thumbnail/!300x300r/gravity/Center/crop/300x300/format/jpg/interlace/1/quality/80
            (domain_nosub === "tapimg.com" && domain.match(/^img[0-9]*\./)) ||
            // http://7xka0y.com1.z0.glb.clouddn.com/%E3%80%90%E6%8E%A8%E8%8D%90%E3%80%91%E8%80%81%E5%A4%96%E5%B8%B8%E6%8C%82%E5%9C%A8%E5%98%B4%E8%BE%B9%E7%9A%84%E7%9F%AD%E5%8F%A5%E8%A1%A8%E8%BE%BE%EF%BC%882%EF%BC%89.jpg?imageView2/1/w/375/h/250/q/100
            domain === "7xka0y.com1.z0.glb.clouddn.com" ||
            // https://p4-q.mafengwo.net/s10/M00/73/67/wKgBZ1l9RWWAEl9xAAFOhGs4tI892.jpeg?imageMogr2%2Fthumbnail%2F%21440x260r%2Fgravity%2FCenter%2Fcrop%2F%21440x260%2Fquality%2F100
            (domain_nosub === "mafengwo.net" && domain.match(/^p[0-9]*(?:-[a-z]+)\./)) ||
            // http://mplive-1253454074.image.myqcloud.com/mplive_dev/imgZmFkNWY0Y2ItNDFkOS00ZTNlLWE3ZmEtZmE4YTA2MGI1NjM0.jpg?imageView2/1/w/400/h/225
            (domain_nosub === "myqcloud.com" && domain.match(/image\.myqcloud\.com/)) ||
            // https://ci.xiaohongshu.com/751cccf1-a34a-57fd-ac5e-438265582359?imageMogr2/thumbnail/640x640/format/jpg/quality/92/auto-orient/strip
            domain === "ci.xiaohongshu.com" ||
            // http://imgboys1.yohobuy.com/spidercms/2018/01/27/01/0127fc0ca0f50496e5235ebc742ff0e056.jpeg?imageView2/2/w/240/q/75|imageslim
            (domain_nosub === "yohobuy.com" && domain.match(/^img[a-z]*[0-9]*\.yohobuy\.com$/)) ||
            // http://i-4-yxdown.715083.com/2018/3/30/a9be3ebb-50a7-4993-9cfb-c1a3ddc3ff61.png?imageView2/2/q/65/w/600
            (domain_nosub === "715083.com" && domain.match(/^i-[0-9]*-yxdown\./)) ||
            // http://i-4.yxdown.com/2018/3/30/KDYwMHgp/a9be3ebb-50a7-4993-9cfb-c1a3ddc3ff61.png?imageView2/2/q/65/w/600
            (domain_nosub === "yxdown.com" && domain.match(/^i-[0-9]*\./)) ||
            // http://upload-images.jianshu.io/upload_images/1685198-ebfc2a22664f623c?imageMogr2/auto-orient/strip%7CimageView2/2/w/300
            domain === "upload-images.jianshu.io") {
            src = src.replace(/\?.*$/, "");
        }

        if (domain_nosub === "wallpapersok.com" && domain.match(/cdn[0-9]*\.wallpapersok\.com/) ||
            // http://mtv.mtvnimages.com/uri/mgid:file:gsp:scenic:/international/mtvema/2017/images/nominees/Taylor_Swift_1940x720.jpg?quality=0.85&width=1024&height=450&crop=true -- 400
            // https://mtv.mtvnimages.com/uri/mgid:file:http:shared:mtv.com/news/wp-content/uploads/2017/03/GettyImages-661260604-1490974103.jpg?quality=.8&height=1221.3740458015266&width=800 -- 400
            domain === "mtv.mtvnimages.com" ||
            // https://item4.tradesy.com/images/miu-miu-cut-off-cat-eye-marble-havana-retro-funky-sunnies-sunglasses-1063438-5-0.jpg?width=720&height=960 -- stretched, 406 for head
            (domain_nosub === "tradesy.com" && domain.match(/^item[0-9]*\.tradesy/) && src.indexOf("/images/") >= 0)) {
            // http://cdn2.wallpapersok.com/uploads/picture/669/332/332669/picture-332669.jpg?width=160&height=90&crop=true -- 403 for head
            return {
                url: src.replace(/\?.*$/, ""),
                can_head: false
            };
        }

        if (domain === "store-images.microsoft.com") {
            // https://store-images.microsoft.com/image/apps.48655.9007199266600012.ac6a9859-80c3-4fc8-8ac1-45b10b74e7ab.e9bce38b-5ca6-4355-8e25-a2d486d2d568?w=712&h=400&mode=letterbox&background=black
            return {
                url: src.replace(/\?.*$/, ""),
                head_wrong_contenttype: true
            };
        }

        if (domain_nowww === "dailyherald.com") {
            // http://www.dailyherald.com/storyimage/DA/20140418/news/140418160/AR/0/AR-140418160.jpg&updated=201404182313&MaxW=800&maxH=800&noborder
            newsrc = src.replace(/[?&].*$/, "");
            if (newsrc !== src)
                return newsrc;
        }

        // check to make sure this doesn't break anything
        // test: https://s3.amazonaws.com/oscars-img-abc/wp-content/uploads/2017/02/26164054/950c51cde0a1cab411efdbf8f1abc117a6aad749397172c9b95dd3c47bfb6f6f-370x492.jpg
        // http://3.imimg.com/data3/BH/EP/MY-26242/silk-printed-ties-500x500.jpg
        if (domain_nosub === "imimg.com" ||
            //domain.indexOf(".files.wordpress.com") >= 0 || // doesn't work
            // https://blogs-images.forbes.com/jasonevangelho/files/2018/06/playstation-logo-1200x675.jpg
            domain === "blogs-images.forbes.com" ||
            // https://static.gofugyourself.com/uploads/2017/10/shutterstock_9134610ar-1507848416-353x560.jpg
            domain === "static.gofugyourself.com" ||
            // http://static.thesuperficial.com/uploads/2016/07/lindsay-lohan-egor-tarabasov-butterfly-ball-0701-01-420x560.jpg -- dead
            domain === "static.thesuperficial.com" ||
            // doesn't work:
            // http://static.celebuzz.com/uploads/2011/06/10/Emma-Roberts-Outside-Today-Show-in-NYC-e1435832610488-385x560.jpg
            // http://static.celebuzz.com/uploads/2011/06/10/Emma-Roberts-Outside-Today-Show-in-NYC.jpg
            // http://static.celebuzz.com/uploads/2011/06/10/Emma-Roberts-Outside-Today-Show-in-NYC-e1435832660684-310x560.jpg
            // http://static.celebuzz.com/uploads/2011/06/10/Emma-Roberts-Outside-Today-Show-in-NYC.JPG
            // works:
            // http://static.celebuzz.com/uploads/2018/02/kim-kardashian-celeb-snaps-020218-1517608914-414x268.jpg
            domain === "static.celebuzz.com" ||
            // http://img.vogue.co.kr/vogue/2018/07/style_5b43023b0c1b0-783x930.jpg
            domain === "img.vogue.co.kr" ||
            // https://static.spin.com/files/2016/11/needledropjeremy-1480526302-1648x800.png
            domain === "static.spin.com" ||
            // https://zrockr.com/user-files/uploads/2018/04/John5.4.7.2018-3867-1024x683.jpg
            domain_nowww === "zrockr.com" ||
            // http://electricegg.co.uk/media/uploads/2017/08/nick-hewer-by-electric-egg-375x320.jpg
            domain_nowww === "electricegg.co.uk" ||
            // http://www.media2.hw-static.com/media/2018/01/wenn_kerrywashington_012618-442x216.jpg
            (domain_nosub === "hw-static.com" && domain.match(/www\.media[0-9]*\.hw-static\.com/)) ||
            // http://i2.cdn.turner.com/money/dam/assets/160511121527-emma-watson-780x439.jpg
            (domain_nosub === "turner.com" && domain.indexOf(".cdn.turner.com") >= 0) ||
            // http://k99.com/files/2013/01/JohnnyCarson_Facebook-630x477.jpg
            domain_nowww === "k99.com" ||
            // http://97rockonline.com/files/2012/07/Flag-Bikini-Venus-214x300.jpg
            domain_nowww === "97rockonline.com" ||
            // http://wfgr.com/files/2011/03/old-rich-woman-200x300.jpg
            domain_nowww === "wfgr.com" ||
            // http://wblk.com/files/2013/04/sirius-alien-630x355.jpg
            domain_nowww === "wblk.com" ||
            // http://fun107.com/files/2015/01/charlie-hunnam-and-chris-hemsworth-630x346.jpg
            domain_nowww === "fun107.com" ||
            // http://965kvki.com/files/2013/12/christmasgenius-630x472.jpg
            domain_nowww === "965viki.com" ||
            // http://1079ishot.com/files/2013/06/90713084-630x434.jpg
            domain_nowww === "1079ishot.com" ||
            // https://edge.alluremedia.com.au/m/l/2017/05/Surface-Laptop-410x231.png
            domain === "edge.alluremedia.com.au" ||
            // https://s3-us-west-1.amazonaws.com/blogs-prod-media/us/uploads/2016/06/02110848/Coco-Austin-breastfeeding-650x630.jpg
            (amazon_container === "blogs-prod-media" && src.indexOf("/uploads/") >= 0) ||
            // https://d36tnp772eyphs.cloudfront.net/blogs/1/2014/08/8754021448_bf2a5c94a3_k-940x403.jpg
            domain === "d36tnp772eyphs.cloudfront.net" ||
            // http://img.allurekorea.com/allure/2016/10/style_581190dac6d83-835x1024.jpg
            domain === "img.allurekorea.com" ||
            // https://www.psu.com/app/uploads/2017/12/gang_beasts_review_01-1024x576.jpg
            // https://psu.com/app/uploads/2017/12/gang_beasts_review_01-1024x576.jpg
            domain_nowww === "psu.com" ||
            // http://media.popculture.com/2018/01/demi-lovato-fabletics-fitness-leggings-20022601-160x90.jpeg
            domain === "media.popculture.com" ||
            // http://www.rap-up.com/app/uploads/2018/02/rihanna-gpe-340x330.jpg
            // http://rap-up.com/app/uploads/2018/02/rihanna-gpe-340x330.jpg
            domain_nowww === "rap-up.com" ||
            // http://img.snacker.hankyung.com/hk-content/2017/08/terracotta-army-1865006__340-400x300.jpg
            (domain_nosub === "hankyung.com" && domain.match(/img\..*?\.hankyung\.com$/)) ||
            // https://www.traveltipy.com/content/uploads/2015/10/Gorlitz-Germany-1024x692.jpg
            domain_nowww === "traveltipy.com" ||
            // http://coveteur.com/content/uploads/2017/03/Emma-Roberts-Hair-3-940x940.jpg
            domain_nowww === "coveteur.com" ||
            // http://food-ehow-com.blog.ehow.com/files/2014/12/edits-2282-1024x682.jpg
            (domain_nosub === "ehow.com" && domain.indexOf(".blog.ehow.com") >= 0) ||
            // https://cdn2.theheartysoul.com/uploads/2016/06/image1-798x418.jpg
            (domain_nosub === "theheartysoul.com" && domain.match(/cdn[0-9]*\.theheartysoul\.com/)) ||
            // http://www.bandt.com.au/information/uploads/2017/08/Screen-Shot-2017-08-01-at-10.58.17-am-420x280.png
            // http://bandt.com.au/information/uploads/2017/08/Screen-Shot-2017-08-01-at-10.58.17-am-420x280.png
            domain_nowww === "bandt.com.au" ||
            // https://www.theepochtimes.com/assets/uploads/2017/08/28/Agriculture-dependent-to-the-river-5-700x420.jpg
            domain === "www.theepochtimes.com" ||
            // https://images.gamme.com.tw/news2/2018/82/30/pJySpaabj56WsKQ-300x250.jpg
            domain === "images.gamme.com.tw" ||
            // http://images.gamme.com.cn/news2/2017/97/14/pZeao56Yj6aZqA-380x300.jpg
            domain === "images.gamme.com.cn" ||
            // http://cdn.hoahoctro.vn/uploads/2018/02/5a87a07c09b7e-pagehihi-600x450.jpg
            domain === "cdn.hoahoctro.vn" ||
            // https://vnn-imgs-f.vgcloud.vn/2018/02/22/09/fan-xon-xao-mat-son-tung-beo-u-sau-tet-nguyen-dan-140x78.jpg
            domain === "vnn-imgs-f.vgcloud.vn" ||
            // https://static.vibe.com/files/archives/galleries/2005/01/23/ciara2-160x160.jpg
            domain === "static.vibe.com" ||
            // https://rightsinfo.org/app/uploads/2018/02/nathan-dumlao-378988-unsplash-1024x671.jpg
            domain === "rightsinfo.org" ||
            // http://img.marieclairekorea.com/2018/03/mck_5a9de416ee7a4-570x381.jpg
            domain === "img.marieclairekorea.com" ||
            // http://tokyopopline.com/images/2013/01/130106kara6-515x341.jpg
            domain === "tokyopopline.com" ||
            // http://px1img.getnews.jp/img/archives/2017/10/ba35fadf68725a24224b306250f20c2f-1024x761.jpg
            domain === "px1img.getnews.jp" ||
            // https://media.thetab.com/blogs.dir/279/files/2017/03/emma-1177x557.jpg
            domain === "media.thetab.com" ||
            // https://assets.rockpapershotgun.com/images//2018/02/survivingmars2-620x315.jpg
            domain === "assets.rockpapershotgun.com" ||
            // http://spotted.tv/app/uploads/20131210-2339481-750x355.jpg
            domain === "spotted.tv" ||
            // http://f.imgs.vietnamnet.vn/2017/11/05/09/t-ara-roi-nuoc-mat-vi-fan-viet-4-100x30.jpg
            (domain_nosub === "vietnamnet.vn" && domain.indexOf(".imgs.vietnamnet.vn") >= 0) ||
            // https://sloanreview.mit.edu/content/uploads/2018/04/GEN-Ross-Digital-Transformation-Speed-Long-Term-1200-300x300.jpg
            domain === "sloanreview.mit.edu" ||
            // http://business.inquirer.net/files/2017/09/pet6-1024x682.jpg
            domain === "business.inquirer.net" ||
            // http://static.thefrisky.com/uploads/2013/07/10/Victoria-Justice-Lucy-Hale-And-Nina-Dobrev-600x450.jpg
            //   http://static.thefrisky.com/uploads/2013/07/10/Victoria-Justice-Lucy-Hale-And-Nina-Dobrev.jpg
            domain === "static.thefrisky.com" ||
            // http://hobby.dengeki.com/ss/hobby/uploads/2017/12/P1014922-440x586.jpg
            domain === "hobby.dengeki.com" ||
            // https://cdn-blog.adafruit.com/uploads/2017/06/megumin-cosplay-360x480.jpg
            domain === "cdn-blog.adafruit.com" ||
            // http://img.uuhy.com/uploads/2010/10/sexy-cosplay-46-550x825.jpg
            // http://simg.uuhy.com/2017/06/businesscards7-220x150.jpg
            (domain_nosub === "uuhy.com" && domain.match(/s?img\.uuhy\.com/)) ||
            // http://img.butongshe.com/2017/12/DSXVVOWVAAEVjVa-520x245.jpg
            domain === "img.butongshe.com" ||
            // https://myreco.asia/img/uploads/article/SE9OJk4VWYhKq8JN1t7THTyVFzvdbA2qOy3XgEVS-2000x1000.jpeg
            domain === "myreco.asia" ||
            // https://d3p157427w54jq.cloudfront.net/uploads/2018/01/selena-site-637x397.jpg
            domain === "d3p157427w54jq.cloudfront.net" ||
            // http://cdn.harpersbazaar.com.sg/2017/10/DSC_2716-1200x799.jpg
            domain === "cdn.harpersbazaar.com.sg" ||
            // http://nsfw.myconfinedspace.com/files/2017/06/gomez__7__1-1000x1500.jpg
            domain_nosub === "myconfinedspace.com" ||
            // https://s3.amazonaws.com/hiphopdx-production/2017/08/Rihanna-826x620.jpg
            amazon_container === "hiphopdx-production" ||
            // https://assets.wonderlandmagazine.com/uploads/2014/11/Taylor-Swift-Wonderland-1-Crop-345x483.jpg
            domain === "assets.wonderlandmagazine.com" ||
            // https://am24.akamaized.net/tms/cnt/uploads/2017/04/taylor-swift-650x372.jpg
            domain === "am24.akamaized.net" ||
            // http://snappa.static.pressassociation.io/assets/2016/04/08154418/1460126656-210b91ce6f5398e743add7f71b3e9b72-600x986.jpg
            (domain_nosub === "pressassociation.io" && domain.indexOf("static.pressassociation.io") >= 0) ||
            // https://icdn2.digitaltrends.com/image/dragon-age-inquisition-multiplayer-header-720x720.jpg?ver=1.jpg
            (domain_nosub === "digitaltrends.com" && domain.match(/icdn[0-9]*\.digitaltrends\.com/)) ||
            // https://assets.vg247.com/current/2014/09/sep_23_-_keyart_inquisitormf_v3-156x108.jpg
            domain === "assets.vg247.com" ||
            // https://www.theblemish.com/images/2015/02/taylor-swift-stops-by-kelsey-edwards-studio-17-640x881.jpg
            (domain_nowww === "theblemish.com" && src.indexOf("/images/") >= 0) ||
            // https://www.dailyxtra.com/content/uploads/2017/06/billc36-479x270.jpg
            (domain === "www.dailyxtra.com" && src.indexOf("/content/uploads/") >= 0) ||
            // https://media.metrolatam.com/2018/05/12/neymarseponecamistapsg2018-09b3bddb47d54ac1e4d12b24697bc2e8-300x200.jpg
            domain === "media.metrolatam.com" ||
            // http://media.comicbook.com/2018/01/dove-cameron-ruby-agents-of-shield-1079103-1280x0.jpeg
            domain === "media.comicbook.com" ||
            // https://www.grazia.it/content/uploads/2018/01/Dove-Cameron-800x599.jpg
            domain === "www.grazia.it" ||
            // https://img.kpopmap.com/2018/05/loco-445x262.jpg
            domain === "img.kpopmap.com" ||
            // https://s.nbst.gr/files/1/2018/03/AP_18064008875527-353x221.jpg
            domain === "s.nbst.gr" ||
            // https://assets.metrolatam.com/gt/2015/01/14/488408753-200x300.jpg
            domain === "assets.metrolatam.com" ||
            // https://women.mthai.com/app/uploads/2014/01/rihanna2-100x140.jpg
            domain_nosub === "mthai.com" ||
            // https://cdn.webnoviny.sk/sites/13/2013/02/cerveny-koberec-55-hudobnych-cien-grammy1-640x897.jpeg
            domain === "cdn.webnoviny.sk" ||
            // https://bloggar.expressen.se/emmasmode/files/2013/02/2013-GRAMMY-AWARDS-ARRIVALS.JPEG-0AB3E3-835x1022.jpg
            domain === "bloggar.expressen.se" ||
            // http://img2.saostar.vn/2016/02/16/279989/taylor-swift-grammys-red-carpet-2016-646x1024.jpg
            (domain_nosub === "saostar.vn" && domain.match(/img[0-9]*\.saostar\.vn/)) ||
            // https://s3.gossipcop.com/up/2018/06/Selena-Gomez-Jennifer-Aniston-Justin-Theroux-533x395.jpg
            (domain_nosub === "gossipcop.com" && domain.match(/s[0-9]*\.gossipcop\.com/)) ||
            // https://petapixel.com/assets/uploads/2017/01/RT40170-800x534.jpg
            domain === "petapixel.com" ||
            // https://d3i6fh83elv35t.cloudfront.net/newshour/app/uploads/2017/03/cat-tongue_AdobeStock_70141743-1024x719.jpeg
            domain === "d3i6fh83elv35t.cloudfront.net" ||
            // https://d17fnq9dkz9hgj.cloudfront.net/uploads/2018/03/Russian-Blue_01-390x203.jpg
            domain === "d17fnq9dkz9hgj.cloudfront.net" ||
            // https://pinknews.co.uk/images/2018/02/pexels-photo-596590-650x433.jpeg
            domain_nowww === "pinknews.co.uk" ||
            // https://images.everyeye.it/img-notizie/yakuza-6-emergono-40-minuti-gameplay-v6-272793-350x16.jpg
            domain === "images.everyeye.it" ||
            // https://koreaboo-cdn.storage.googleapis.com/2016/12/15123352_1467738783241379_1368418332014232741_o-650x867.jpg
            googlestorage_container === "koreaboo-cdn" ||
            // https://www.behindzscene.net/file/2018/01/%D8%A7%D8%B3%D8%B7%D9%88%D8%B1%D8%A9-440x264.jpg
            (domain_nowww === "behindzscene.net" && src.indexOf("/file/") >= 0) ||
            // https://www.hipertextual.com/files/2014/12/christopher-nolan-670x410.jpg
            (domain_nowww === "hipertextual.com" && src.indexOf("/files/") >= 0) ||
            // https://geeksofdoom.com/GoD/img/2015/11/the-bastard-executioner-110-03-530x353.jpg
            (domain_nowww === "geeksofdoom.com" && src.indexOf("/img/") >= 0) ||
            // http://newsimages.fashionmodeldirectory.com/content/2018/06/july-cover2-392x400.jpg
            domain === "newsimages.fashionmodeldirectory.com" ||
            // https://akm-img-a-in.tosshub.com/indiatoday/images/story/201804/fLIPKART_FB-88x50.jpeg?7aUorT.AyYkITen3_QwmsIcFMHwg032p
            domain === "akm-img-a-in.tosshub.com" ||
            // http://img.blogtamsu.vn/2015/12/tae-yeon-hanh-trinh-vit-hoa-thien-nga-blogtamsu291-600x900.jpg
            domain === "img.blogtamsu.vn" ||
            // https://cdn03.starsdaily.net/starsdaily/uploads/2016/11/%E1%9F%A5%E1%9F%A5-683x1024.jpg
            (domain_nosub === "starsdaily.net" && domain.match(/cdn[0-9]+\.starsdaily\.net/)) ||
            // https://nextnature.net/app/uploads/2017/02/71HTjrSeI5L-1280x450.jpg
            //   https://nextnature.net/app/uploads/2017/02/71HTjrSeI5L.jpg
            (domain_nowww === "nextnature.net" && src.indexOf("/uploads/") >= 0) ||
            // https://www.vooks.net/img/2018/06/mosiac-1000x562.jpg
            (domain_nowww === "vooks.net" && src.indexOf("/img/") >= 0) ||
            // https://i.ido.bi/assets/podcast/2017/12/jenna-ortega-friends-434x650.jpg
            domain === "i.ido.bi" ||
            // https://cdn.techgyd.com/150-best-Anime-Wallpaper-In-HD-For-Your-Device-65-640x1024.jpg
            domain === "cdn.techgyd.com" ||
            // https://4girls.co.il/uploads/mediaBank/2017/02/22-gallery_photos-1f4c8c1e-120x80.jpg
            (domain_nowww === "4girls.co.il" && src.indexOf("/uploads/") >= 0) ||
            // http://gceleb.com/photo/2016/06/Mathematician-Rachel-Riley-768x1152.jpg
            (domain_nowww === "gceleb.com" && src.indexOf("/photo/") >= 0) ||
            // https://www.seriouseats.com/recipes/images/2015/02/20150216-grilled-tofu-banh-mi-recipe-vegan-12-1500x1125.jpg
            (domain === "www.seriouseats.com" && src.indexOf("/images/") >= 0) ||
            // http://i.epochtimes.com/assets/uploads/2016/11/yangmi-600x400.jpg
            domain === "i.epochtimes.com" ||
            // https://cdn.thammysen.vn//2017/04/tam-trang-toan-than-bang-sua-chua-va-mat-ong3-300x200.jpg
            domain === "cdn.thammysen.vn" ||
            // https://www.pedestrian.tv/content/uploads/2017/10/DNTXJ6jVwAAUNtC-e1509358138415-605x397.jpg
            (domain === "www.pedestrian.tv" && src.indexOf("/uploads/") >= 0) ||
            // http://d1lofqbqbj927c.cloudfront.net/xtremaGT/2017/12/06190753/camila-500x263.jpg
            domain === "d1lofqbqbj927c.cloudfront.net" ||
            // http://www.180grados.com.mx/img/2017/05/rs-camila-cabello-ad1dc260-a687-4b5a-8fe3-9fad3800ab7b-560x294.jpg
            (domain_nowww === "180grados.com.mx" && src.indexOf("/img/") >= 0) ||
            // http://photo.tin8.co/upload/2018/07/06/14663363979018311466336543sumarionormal14838670891530849084-308x201.jpg
            domain === "photo.tin8.co" ||
            // https://cdn3.whatculture.com/images/2015/04/avengers-end-scene-600x400.jpg
            (domain_nosub === "whatculture.com" && domain.match(/^cdn[0-9]*\.whatculture\.com/) && src.indexOf("/images/") >= 0) ||
            // http://www.electronicbeats.net/app/uploads/2013/11/baxxter-oehlen-electronic-beats-luci-lux-1240x710.jpg
            (domain === "www.electronicbeats.net" && src.indexOf("/uploads/") >= 0) ||
            // https://media.iconsingapore.com/2018/05/Julianne-Moore-in-Givenchy-750x1125.jpg
            domain === "media.iconsingapore.com" ||
            // http://p.cosmopolitan.bg/g/e/gettyimages-699742676-74636-636x0.jpg?1504777991774
            domain === "p.cosmopolitan.bg" ||
            // https://cache.pakistantoday.com.pk/447464_24204507-230x130.jpg
            domain === "cache.pakistantoday.com.pk" ||
            // https://media.breitbart.com/media/2017/06/EmiliaClarkeSexismGameOfThrones-640x480.jpg
            domain === "media.breitbart.com" ||
            // https://s.rozali.com/p/j/e/jesika-alba-34-320293-500x0.jpg
            domain === "s.rozali.com" ||
            // https://s.sdgcdn.com/7/2018/06/d15ed3e907d41b4e1236d5bd0d14836f768ce800_90f83913e7f20144896634648ea442679d3ed64e_2016_06_29_07_24_12_2412_05e4_optimized-429x600.jpg
            domain === "s.sdgcdn.com" ||
            // http://ticket.heraldtribune.com/files/2013/08/Victoria-Justice-200x300.jpg
            (domain === "ticket.heraldtribune.com" && src.indexOf("/files/") >= 0) ||
            // https://blog.hola.com/estilistademodacristinareyes/files/2014/09/elle-08-birthdays-beyonce-xln-xln-200x300.jpg
            domain === "blog.hola.com" ||
            // http://www.therussiantimes.com/upkeep/uploads/2018/07/00103c8b-800-650x366.jpg
            (domain_nowww === "therussiantimes.com" && src.indexOf("/uploads/") >= 0) ||
            // http://static.idolator.com/uploads/2010/09/selenagomez-vmas1-500x747.jpg
            domain === "static.idolator.com" ||
            // http://images.saloona.co.il/commelle/files/2016/03/i3kxpbzo4wr9enzrr18-199x300.jpg
            domain === "images.saloona.co.il" ||
            // http://bellezaenvena.com/my_uploads/2017/08/miss-dior-eau-de-parfum-450x600.jpg
            (domain_nowww === "bellezaenvena.com" && src.indexOf("/my_uploads/") >= 0) ||
            // http://c1.thejournal.ie/media/2014/06/samantha-mumba-752x501.jpg
            (domain_nosub === "thejournal.ie" && src.indexOf("/media/") >= 0) ||
            // http://tvperson.ru/2016/01/jeanne-tripplehorn-006-682x1024.jpg
            domain_nowww === "tvperson.ru" ||
            // http://iwantpix.com/stuff/female-celebrities/female-celebrities-33-810x1024.jpg
            domain_nowww === "iwantpix.com" ||
            // http://nudemodelpics.com/girls/2016/12/nelly-show-me-yummy/nelly-amour-angels-nudemodel.pics-01-180x240.jpg
            domain_nowww === "nudemodelpics.com" ||
            // https://images.chr.bg/uploads/2017/07/Zendaya-Feet-2287006-1108x831.jpg
            (domain === "images.chr.bg" && src.indexOf("/uploads/") >= 0) ||
            // http://woman.ua/file/images/2014/08/2014081353eb770bdc340-370x515.jpg
            (domain_nowww === "woman.ua" && src.indexOf("/file/images/") >= 0) ||
            // https://gdsit.cdn-immedia.net/2015/11/Rihanna-4-423x505.jpg
            domain === "gdsit.cdn-immedia.net" ||
            // http://cseditors.com/g/pho/photoshoot-for-the-new-york-times-style-magazine-october-2015-615x734.jpg
            domain_nowww === "cseditors.com" ||
            // https://imcdn.org/uploads/2016/02/emma-watson-300x178.gif
            (domain_nowww === "imcdn.org" && src.indexOf("/uploads/") >= 0) ||
            // http://t.a4vn.com/2009/12/emma-127x92.jpg
            domain === "t.a4vn.com" ||
            // http://dodskypict.com/D/Emma-Watson-Wallpaper-On-Wallpaper-Hd-8-480x320.jpg
            domain_nowww === "dodskypict.com" ||
            // https://files.dals.media/mediafiles/wpf/2016/12/15534872_1362015517143304_547806809268682752_n-1024x1024.jpg
            domain === "files.dals.media" ||
            // https://cdn.crhoy.net/imagenes/2018/08/asia-argento%C2%BA-300x169.jpg
            domain === "cdn.crhoy.net" ||
            // http://longwallpapers.com/Desktop-Wallpaper/cute-bunny-images-For-Desktop-Wallpaper-230x140.jpg
            domain_nowww === "longwallpapers.com" ||
            // https://files.greatermedia.com/uploads/sites/53/2018/06/GettyImages-845019148-1-1400x1727.jpg
            domain === "files.greatermedia.com" ||
            // https://tsundora.com/image/2016/05/re_zero_kara_hajimeru_isekai_seikatsu_181-1024x576.jpg
            (domain_nowww === "tsundora.com" && src.indexOf("/image/") >= 0) ||
            // https://clips-media-assets2.twitch.tv/vod-290596181-offset-0-preview-260x147.jpg
            (domain_nosub === "twitch.tv" && domain.match(/^clips-media-assets[0-9]*\./) && src.match(/-preview-[0-9]+x[0-9]+\.[^/.]*$/)) ||
            // https://file.immo.vlan.be/ImageHandler/Image/Wordpress/effeil2-1024x576.jpg
            (domain === "file.immo.vlan.be" && src.indexOf("/Image/Wordpress/") >= 0) ||
            // https://media.trud.bg/2016/10/26-6-360x540.jpg
            domain === "media.trud.bg" ||
            // https://rotativo.com.mx/assets//2018/03/rihanna-se-lanza-contra-a-snapchat-696x573.jpg
            (domain_nowww === "rotativo.com.mx" && src.indexOf("/assets/") >= 0) ||
            // https://www.chfi.com/wp-content/blogs.dir/2/files/Rihanna_Diamonds_World_Tour_2013_Cropped-637x838.png
            (domain_nowww === "chfi.com" && src.indexOf("/wp-content/") >= 0) ||
            // https://storage.googleapis.com/sin-cdn/2017/12/rihanna-367x215.jpg
            // https://sin-cdn.storage.googleapis.com/2017/12/rihanna-367x215.jpg
            googlestorage_container === "sin-cdn" ||
            // https://cdn.appleigeek.com/2018/03/rihanna-644x350.jpg
            domain === "cdn.appleigeek.com" ||
            // https://media.cnnchile.com/sites/2/2018/06/imagen_principal-9349-740x430.jpg
            domain === "media.cnnchile.com" ||
            // http://festivalteen.com.br/qsafrcbfds/uploads/2018/08/WhatsApp-Image-2018-08-06-at-14.40.46-252x300.jpeg
            (domain_nowww === "festivalteen.com.br" && src.indexOf("/uploads/") >= 0) ||
            // https://rhodiesworld.s3.amazonaws.com/uploads/2018/08/bey5-400x483.jpg
            (amazon_container === "rhodiesworld" && src.indexOf("/uploads/") >= 0) ||
            // https://ntdtv.kr/assets/uploads/2017/11/1-1-10-795x436.jpg
            (domain_nowww === "ntdtv.kr" && src.indexOf("/assets/") >= 0) ||
            // http://xdn.tf.rs/2015/05/18/Dzenifer-Lopez-1-670x984.jpg
            domain === "xdn.tf.rs" ||
            // https://static.acg12.com/uploads/2015/07/7cedbaa31f53feaa86fed37fd9fe9da6-320x200.jpg
            domain === "static.acg12.com" ||
            // https://www.delas.pt/files/2016/08/hd-aspect-1459874430-hbz-jennifer-lawrence-may-2016-09-150x84.jpg
            (domain_nowww === "delas.pt" && src.indexOf("/files/") >= 0) ||
            // https://img.zone5.ru/50/1/0/zone5.ru-hermione-corfield-176882-145x200.jpg
            domain === "img.zone5.ru" ||
            // https://i2.bssl.es/lacosarosa/2017/12/emiliaclarke-880x495.jpg
            (domain_nosub === "bssl.es" && domain.match(/^i[0-9]*\./)) ||
            // http://images.virgula.com.br/2017/06/Sofia-Solares-1-387x479.jpg
            domain === "images.virgula.com.br" ||
            // http://rotana.net/assets/uploads/2017/08/2936489101502703278-406x228.jpg
            (domain_nowww === "rotana.net" && src.indexOf("/assets/uploads/") >= 0) ||
            // https://elle.unitedinfluencers.org/content/uploads/sites/19/2013/04/c11-621x1024.jpg
            (domain === "elle.unitedinfluencers.org" && src.indexOf("/content/uploads/") >= 0) ||
            // https://zenska.hudo.com/files/2016/08/c24e131d48b6c478405ad53365ae90fa-409x660.jpg
            (domain === "zenska.hudo.com" && src.indexOf("/files/") >= 0) ||
            // https://s3.ap-south-1.amazonaws.com/seenitblog/uploads/2016/02/Margot-634x1024.jpg
            (amazon_container === "seenitblog" && src.indexOf("/uploads/") >= 0) ||
            // https://marieclaire.hu/uploads/2016/10/A-vilag-legkulonlegesebb-gyemantmarkaja-Magyarorszagon-1-680x1024.jpg
            (domain_nowww === "marieclaire.hu" && src.indexOf("/uploads/") >= 0) ||
            // http://infinitymemories.com/amour/files/2018/05/Margot-Robbie-assiste-%C3%A0-la-90e-Annual-Academy-Awards-au-Hollywood-Highland-Center-683x1024.jpg
            (domain_nowww === "infinitymemories.com" && src.indexOf("/files/") >= 0) ||
            // https://www.tuxboard.com/photos/2013/12/best-photo-nature-2013-14-640x405.jpg
            (domain_nowww === "tuxboard.com" && src.indexOf("/photos/") >= 0) ||
            // http://arcdn02.mundotkm.com/2014/08/S11-286x400.jpg
            (domain_nosub === "mundotkm.com" && domain.match(/^arcdn[0-9]*\./)) ||
            // http://cdn2.game4v.com/2015/09/cosplay-game-322-560x373.jpg
            (domain_nosub === "game4v.com" && domain.match(/^cdn[0-9]*\./)) ||
            // https://cosplaytime.pl/uploads/2018/06/5297219860-400x600.jpg
            (domain_nosub === "cosplaytime.pl" && src.indexOf("/uploads/") >= 0) ||
            // http://img.wkorea.com/w/2018/04/style_5ad5567c70116-924x1200.jpg
            domain === "img.wkorea.com" ||
            // https://static.stereogum.com/uploads/2017/02/CAMILA_MOBLEY-2-1487873904-640x427.jpg
            domain === "static.stereogum.com" ||
            // https://i.mdel.net/newfaces/i/2013/09/dd_ak_25-783x1024.jpg
            (domain === "i.mdel.net" && src.indexOf("/newfaces/i/") >= 0) ||
            // https://media.celebmasta.com/2016/03/real-lindsay-lohan-nude-pics-and-video-scene-41-370x297.jpg
            domain === "media.celebmasta.com" ||
            // https://media.korea25.com/news/2018/10/0003458151_3267522_I-280x280.jpg
            // I and U, can't find any difference
            domain === "media.korea25.com" ||
            // http://sexyfandom.com/images/2018/02/A2-Cosplay-by-Miyuko-1-650x922.jpg
            (domain_nowww === "sexyfandom.com" && src.indexOf("/images/") >= 0) ||
            // https://i.dmarge.com/2016/06/twothousand-610x424.jpg
            domain === "i.dmarge.com" ||
            // http://assets.boundingintocomics.com/content/uploads/2018/05/Korg-Thor-Ragnarok-750x400.jpg
            domain === "assets.boundingintocomics.com" ||
            // https://media.profootballfocus.com/2018/10/DENZEL-1024x581.jpg
            domain === "media.profootballfocus.com" ||
            // http://www.redu.pl/img/2012/08/539863_391053194270196_1915005508_n-600x425.jpg
            (domain_nowww === "redu.pl" && src.indexOf("/img/") >= 0) ||
            // https://multifiles.pressherald.com/uploads/sites/4/2018/10/1590594_931934-20180930_112727-1024-1024x556.jpg
            (domain === "multifiles.pressherald.com" && src.indexOf("/uploads/") >= 0) ||
            // https://24.p3k.hu/app/uploads/2018/08/37917789_245179279451422_1933202043065860096_n-e1534658460612-1024x575.jpg
            (domain === "24.p3k.hu" && src.indexOf("/uploads/") >= 0) ||
            // https://cdn.gamerant.com/wp-content/uploads/resident-evil-2-director-remake-faith-738x410.jpg.webp
            //   https://cdn.gamerant.com/wp-content/uploads/resident-evil-2-director-remake-faith.jpg.webp
            // https://d13ezvd6yrslxm.cloudfront.net/wp/wp-content/images/x-men-apocalypse-700x300.jpg
            src.indexOf("/wp/wp-content/images/") >= 0 ||
            src.indexOf("/wp-content/uploads/") >= 0 ||
            src.indexOf("/wp/uploads/") >= 0) {
            // http://arissa-x.com/miss-x-channel/wp-content/uploads/2017/06/IMG_0005.jpg
            src = src.replace(/-[0-9]*x[0-9]*\.([^/]*)$/, ".$1");
        }

        if ((domain === "store.pinseyun.com" && src.indexOf("/uploads/") >= 0) ||
            // https://media.coindesk.com/uploads/2018/07/shutterstock_703755544-860x430.jpg
            (domain === "media.coindesk.com" && src.indexOf("/uploads/") >= 0)) {
            // http://store.pinseyun.com/uploads/2016/10/20161021222440-150x150.jpg
            // http://store.pinseyun.com/uploads/2016/06/201605work-94-150x150.jpg
            return {
                url: src.replace(/-[0-9]*x[0-9]*\.([^/.]*)$/, ".$1"),
                can_head: false
            };
        }

        // https://cdn.heatworld.com/one/lifestyle-legacy/fc/e7794/f8a77/be88e/964ad/02b2a/6e7bd/claude-littner_940x526.jpg
        //   https://cdn.heatworld.com/one/lifestyle-legacy/fc/e7794/f8a77/be88e/964ad/02b2a/6e7bd/claude-littner.jpg
        if (domain === "cdn.heatworld.com" ||
            // http://www.sohobluesgallery.com/mm5/graphics/00000001/Rolling_Stones_Keith_Richards_Guitar_God_475x705.jpg
            //   http://www.sohobluesgallery.com/mm5/graphics/00000001/Rolling_Stones_Keith_Richards_Guitar_God.jpg
            domain === "www.sohobluesgallery.com" ||
            // https://i.vimeocdn.com/video/530332183_780x439.jpg
            domain === "i.vimeocdn.com" ||
            // https://media.indiatimes.in/media/content/2018/Feb/arun_jaitley_allocates_rs_1200_crore_to_promote_bamboo_cultivation_1517487222_100x150.jpg
            domain === "media.indiatimes.in" ||
            // https://vcdn-ione.vnecdn.net/2018/02/04/topoppp-1681-1517742371_500x300.jpg
            domain === "vcdn-ione.vnecdn.net" ||
            // https://www.bangkokpost.com/media/content/20180126/c1_1401970_180126042828_620x413.jpg
            // https://bangkokpost.com/media/content/20180126/c1_1401970_180126042828_620x413.jpg
            domain_nowww === "bangkokpost.com" ||
            // https://media2.mensxp.com/media/content/2018/Feb/congress-takes-digs-at-bjp-and-pm-modi-with-a-valentines-day-video-1400x653-1518681640_401x187.jpg
            (domain_nosub === "mensxp.com" && domain.match(/media[0-9]*\.mensxp\.com/)) ||
            // http://221.132.38.109/nvdata/uploads/thumbnail/2017/12/01/baogiohetbatlucnhintremamnonbibaohanh_20171201151535_220x124.jpg
            domain === "221.132.38.109" ||
            // https://i-ngoisao.vnecdn.net/2012/11/26/10-585669-1376858787_500x0.jpg
            domain === "i-ngoisao.vnecdn.net" ||
            // http://www.jpcoast.com/img/201403/21_DSC_1247_600x400.jpg
            // http://jpcoast.com/img/201403/21_DSC_1247_600x400.jpg
            (domain_nowww === "jpcoast.com" && src.indexOf("/img/") >= 0) ||
            // https://pics.prcm.jp/908a8687073fe/66459731/jpeg/66459731_220x241.jpeg
            domain === "pics.prcm.jp" ||
            // http://s1.lprs1.fr/images/2017/08/17/7197618_sofia-solares-cover_940x500.PNG
            (domain_nosub === "lprs1.fr" && domain.match(/s[0-9]*\.lprs1\.fr/)) ||
            // http://m.wsj.net/video/20170227/022717oscarsfashion/022717oscarsfashion_1280x720.jpg
            domain === "m.wsj.net" ||
            // http://img.lifestyler.co.kr/uploads/program/1/1728/menu/16/board/0/0/f131717137323426000(0)_226x146.jpg
            domain === "img.lifestyler.co.kr" ||
            // https://static-us-cdn.eporner.com/photos/537995_296x1000.jpg
            (domain_nosub === "eporner.com" && domain.match(/static-(?:[a-z]+-)?cdn\.eporner\.com/)) ||
            // http://fototo.blox.pl/resource/rihanna_and_red_400x400.jpg
            domain === "fototo.blox.pl" ||
            // http://media.nvyouj.com/photos/2017/1007/20/DLiF1LFVoAAdtbR_240x240.jpg
            domain === "media.nvyouj.com" ||
            // http://cl.buscafs.com/www.tomatazos.com/public/uploads/images/184724_600x315.jpg
            (domain === "cl.buscafs.com" && src.indexOf("/www.tomatazos.com/") >= 0) ||
            // http://tomatazos.buscafs.com/uploads/images/199130_600x759.jpg
            (domain === "tomatazos.buscafs.com" && src.indexOf("/uploads/images/") >= 0) ||
            // http://nisfeldunia.ahram.org.eg/Media/NewsMedia/2017/6/4/2017-636321794648424569-842_242x160.jpg
            (domain === "nisfeldunia.ahram.org.eg" && src.indexOf("/Media/") >= 0) ||
            // https://d2t7cq5f1ua57i.cloudfront.net/images/r_images/51261/54063/51261_54063_77_0_8968_20141223201250892_200x200.jpg
            domain === "d2t7cq5f1ua57i.cloudfront.net" ||
            // https://image.ibb.co/fmOKNJ/h_54456811_768x530.jpg
            domain === "image.ibb.co" ||
            // http://socdn.smtown.com/upload/smtownnow/pictures/images/2018/06/15/o_1cg12bap41e5v3vh1iu2mhkjaj9_600x800.jpg
            domain === "socdn.smtown.com" ||
            // http://www.lecturas.com/medio/2018/03/14/andrea-duro-4_6a8880f6_800x1200.jpg
            (domain === "www.lecturas.com" && src.indexOf("/medio/") >= 0) ||
            // https://www.clara.es/medio/2018/02/26/margot-robbie-oscars-2017_f0ed3ed6_600x900.jpg
            (domain_nowww === "clara.es" && src.indexOf("/medio/") >= 0) ||
            // https://images.anandtech.com/doci/12326/2018-01-09_14.26.05_678x452.jpg
            domain === "images.anandtech.com" ||
            // https://cdn.popbela.com/content-images/post/20170217/foto-cover-tweak-10c04c1a30b06c260e3dedd966775b45_750x500.jpg
            domain === "cdn.popbela.com" ||
            // http://cdnimg103.lizhi.fm/audio_cover/2017/06/01/2605105337514729479_320x320.png
            (domain_nosub === "lizhi.fm" && domain.match(/^cdnimg[0-9]*\./)) ||
            // https://img.cf.47news.jp/public/photo/46f4777d8bbca4365d93bdd700e40cb4/photo_120x96.jpg
            domain === "img.cf.47news.jp" ||
            // https://static.filmin.es/images/media/22272/4/still_1_3_790x398.jpg
            domain === "static.filmin.es" ||
            // http://img0.ropose.com/story/9fNu_1496394464744_db0ebcd0_a337_350x525.jpeg
            (domain_nosub === "ropose.com" && domain.match(/^img[0-9]*\./)) ||
            // http://resource.info.mn/infomn/images/2013/5/266c1f4994f07d060888db46a9100581/2013+Billboard+Music+Awards+Arrivals+19GjdCzDuPix_500x500.jpg
            domain === "resource.info.mn" ||
            // http://image1.thegioitre.vn/2018/08/16/neu-khong-muon-vai-u-thit-bap-chi-em-dung-tap-6-bai-the-duc-nay-thumb_160x106.jpg
            (domain_nosub === "thegioitre.vn" && domain.match(/^image[0-9]*\./)) ||
            // https://vcdn-giaitri.vnecdn.net/2018/10/11/tiffany-young-tren-tham-do-american-music-awards-1539224433_1539233031_140x84.jpg
            domain === "vcdn-giaitri.vnecdn.net" ||
            // http://img.uduba.com/uduba/user_data/60/8c/608c39df8cadf0a631422b5000631aba_430x272.jpg?uduba_pid=3164615
            //   http://img.uduba.com/uduba/user_data/60/8c/608c39df8cadf0a631422b5000631aba.jpg?uduba_pid=3164615
            domain === "img.uduba.com" ||
            // http://images.cinefil.com/movies/1053952_1600x450.jpg
            //   http://images.cinefil.com/movies/1053952.jpg
            domain === "images.cinefil.com") {
            newsrc = src.replace(/_[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
            if (newsrc !== src)
                return newsrc;
        }

        // http://www.mediaonlinevn.com/wp-content/uploads/2016/03/160315-pantech-launch-hcm-41_resize-680x365_c.jpg
        // https://mediaonlinevn.com/wp-content/uploads/2016/03/160315-pantech-launch-hcm-41_resize-680x365_c.jpg
        if (domain_nowww === "mediaonlinevn.com") {
            src = src.replace(/-[0-9]*x[0-9]*(?:_[a-z])?\.([^/.]*)$/, ".$1");
        }

        // http://felipepitta.com/blog/wp-content/uploads/2014/08/Harry-Potter-Hogwarts-Express-Jacobite-Fort-William-Scotland-Train(pp_w970_h646).jpg
        // http://www.onelittlepicture.com.au/wp-content/uploads/2012/07/IMG_0077a-copy-682x1024(pp_w599_h900).jpg
        if (src.indexOf("/wp-content/uploads/") >= 0 ||
            //domain.indexOf(".files.wordpress.com") >= 0 || -- no evidence of this actually working, other patterns don't work for it either
            src.indexOf("/wp/uploads/") >= 0) {
            src = src.replace(/\(pp_w[0-9]+_h[0-9]+\)(\.[^/.]*)$/, "$1");
        }


        // doesn't work:
        // https://thechive.files.wordpress.com/2018/06/funny-football-memes-fifa-world-cup-27-5b34f3ecb603a__700.jpg
        if (//domain.indexOf(".files.wordpress.com") >= 0 ||
            // https://static.boredpanda.com/blog/wp-content/uploads/2017/08/GW-130817_DSC1426-copy-599f17eddebf2__880.jpg
            //   https://static.boredpanda.com/blog/wp-content/uploads/2017/08/GW-130817_DSC1426-copy-599f17eddebf2.jpg
            src.indexOf("/wp-content/uploads/") >= 0 ||
            src.indexOf("/wp/uploads/") >= 0) {
            // http://www.randomnude.com/wp-content/uploads/sites/39/2017/06/gomez__7__1.jpg
            src = src.replace(/__[0-9]{2,}(\.[^/.]*)$/, "$1");
        }

        // https://www.thetrace.org/wp-content/uploads/2017/04/Cleveland_Gun_Survivors_065-5394x0-c-default.jpg
        if (src.indexOf("/wp-content/uploads/") >= 0 ||
            src.indexOf("/wp/uploads/") >= 0) {
            src = src.replace(/-[0-9]+x[0-9]+-c-default(\.[^/.]*)$/, "$1");
        }

        // https://storage.journaldemontreal.com/v1/dynamic_resize/sws_path/jdx-prod-images/cc417dc4-919a-4fa9-b7eb-d28f406dc442_JDX-2x1_WEB.jpg?quality=80&size=1200x&version=1
        //   https://storage.journaldemontreal.com/v1/jdx-prod-images/cc417dc4-919a-4fa9-b7eb-d28f406dc442_JDX-2x1_WEB.jpg
        //   https://storage.journaldemontreal.com/v1/jdx-prod-images/cc417dc4-919a-4fa9-b7eb-d28f406dc442_ORIGINAL.jpg
        if (domain === "storage.journaldemontreal.com" ||
            // http://storage.torontosun.com/v1/dynamic_resize/sws_path/suns-prod-images/1297848560868_ORIGINAL.jpg?size=520x
            //   http://storage.torontosun.com/v1/suns-prod-images/1297848560868_ORIGINAL.jpg
            // http://storage.torontosun.com/v1/suns-prod-images/1297953142311_LARGE_BOX.jpg?quality=80&stmp=1494378455559
            //   http://storage.torontosun.com/v1/suns-prod-images/1297953142311_ORIGINAL.jpg
            domain === "storage.torontosun.com" ||
            // http://storage.ottawasun.com/v1/dynamic_resize/sws_path/suns-prod-images/1297804218043_ORIGINAL.jpg?size=520x
            domain === "storage.ottawasun.com" ||
            // http://storage.chathamthisweek.com/v1/dynamic_resize/sws_path/suns-prod-images/-143866_ORIGINAL.jpg?quality=80&size=650x&stmp=1336623589647
            //   http://storage.chathamthisweek.com/v1/suns-prod-images/-143866_ORIGINAL.jpg
            domain === "storage.chathamthisweek.com" ||
            // http://storage.journaldequebec.com/v1/dynamic_resize/sws_path/jdx-prod-images/e3b49bbd-ba13-4f0e-99e4-e0d0ee77bbfe_ORIGINAL.jpg?quality=80&size=700x&version=1
            domain === "storage.journaldequebec.com" ||
            // http://storage.journaldemontreal.com/v1/dynamic_resize/sws_path/jdx-prod-images/b618335b-9523-4599-9f42-e7e394ceee77_ORIGINAL.jpg?quality=80&size=640x&version=7
            domain === "storage.journaldemontreal.com" ||
            // http://storage.canoe.com/v1/dynamic_resize/?size=298&quality=80&src=http%3A%2F%2Fstorage.ottawasun.com%2Fv1%2Fsuns-prod-images%2F1297947551736_ORIGINAL.jpg%3Fquality%3D80
            //   http://storage.ottawasun.com/v1/suns-prod-images/1297947551736_ORIGINAL.jpg
            domain === "storage.canoe.com" ||
            // http://storage-cube.quebecormedia.com/v1/dynamic_resize?quality=75&size=400x400&src=http%3A%2F%2Fstorage-cube.quebecormedia.com%2Fv1%2Fellequebec_prod%2Felle_quebec%2F2849ba1cbafd6e4f65f25dd54ea9466a3a4c95eb%2FCouples-MET-Gala-2017.jpg
            //   http://storage-cube.quebecormedia.com/v1/ellequebec_prod/elle_quebec/2849ba1cbafd6e4f65f25dd54ea9466a3a4c95eb/Couples-MET-Gala-2017.jpg
            domain === "storage-cube.quebecormedia.com" ||
            src.match(/^[a-z]+:\/\/storage\.[^/]*\/v[0-9]*\/dynamic_resize\/sws_path\//)) {
            //return src.replace(/(\/dynamic_resize\/.*)\?[^/]*$/, "$1?size=99999999");
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/v[0-9]*\/dynamic_resize\/*.*?[?&]src=([^&]*).*?$/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);

            newsrc = src
                .replace(/\/dynamic_resize\/sws_path\//, "/")
                .replace(/_(?:JDX-[0-9]+x[0-9]+_[A-Z]+|LARGE_BOX)(\.[^/.]*)$/, "_ORIGINAL$1")
                .replace(/\?[^/]*$/, "");
            if (newsrc !== src)
                return newsrc;

            return {
                url: src,
                head_wrong_contenttype: true
            };
        }

        /*if (domain === "storage.journaldemontreal.com" ||
            domain === "storage.torontosun.com" ||
            domain === "storage.ottawasun.com") {
            return {
                url: src,
                head_wrong_contenttype: true
            };
        }*/

        if (domain === "pictures.ozy.com" ||
            // http://www.retail-jeweller.com/pictures/2000x2000fit/4/2/6/3007426_Pandora-ambassador-Tess-Daly-UK.jpg
            //   http://www.retail-jeweller.com/pictures/99999999x99999999/4/2/6/3007426_Pandora-ambassador-Tess-Daly-UK.jpg
            domain_nowww === "retail-jeweller.com" ||
            // https://d1nslcd7m2225b.cloudfront.net/Pictures/2000x2000fit/1/7/5/1281175_lily_collins_wondercon_2013_555557.jpg
            //   https://d1nslcd7m2225b.cloudfront.net/Pictures/99999999x99999999/1/7/5/1281175_lily_collins_wondercon_2013_555557.jpg
            domain === "d1nslcd7m2225b.cloudfront.net") {
            // https://pictures.ozy.com/pictures/768xany/9/5/0/127950_LESLIE_HILL.jpg
            //   https://pictures.ozy.com/pictures/99999999x99999999/9/5/0/127950_LESLIE_HILL.jpg
            // https://pictures.ozy.com/pictures/600x337fit/9/1/5/127915_sean_ozyfest_00628.jpg
            //   https://pictures.ozy.com/pictures/99999999x99999999/9/1/5/127915_sean_ozyfest_00628.jpg
            // https://pictures.ozy.com/Pictures/385x385/4/3/1/111431_culligan_ozyfest_054.jpg
            //   https://pictures.ozy.com/Pictures/99999999x99999999/4/3/1/111431_culligan_ozyfest_054.jpg
            // https://pictures.ozy.com/pictures/anyx296/2/0/5/70205_OZY_mix_tape_2.jpg
            //   https://pictures.ozy.com/pictures/99999999x99999999/2/0/5/70205_OZY_mix_tape_2.jpg
            return src.replace(/(\/[Pp]ictures\/)[0-9any]+x[0-9any]+(?:[a-z]+)?\//, "$199999999x99999999/");
        }

        if (domain === "hips.hearstapps.com") {
            // https://hips.hearstapps.com/hmg-prod.s3.amazonaws.com/images/bgus-1060427-037-1-1510856807.jpg
            //   http://hmg-prod.s3.amazonaws.com/images/bgus-1060427-037-1-1510856807.jpg
            // https://hips.hearstapps.com/rover/profile_photos/21445446-1bde-4290-a24e-2bdd274be027_1516741729.jpg?fill=1:1&resize=200:*
            //   https://hips.hearstapps.com/rover/profile_photos/21445446-1bde-4290-a24e-2bdd274be027_1516741729.jpg
            newsrc = src.replace(/.*hips\.hearstapps\.com\/([^/]+\.[^/]+)/, "http://$1");
            if (newsrc !== src)
                return newsrc;
            return src.replace(/\?[^/]*$/, "");
        }

        if (domain === "img.wennermedia.com") {
            // http://img.wennermedia.com/social/benson-fe365ae4-d2a2-461d-a6c1-9468b99177a2.jpg
            //   http://img.wennermedia.com/benson-fe365ae4-d2a2-461d-a6c1-9468b99177a2.jpg
            return src.replace(/:\/\/img\.wennermedia\.com\/[^?#]*\/([^/]*)$/, "://img.wennermedia.com/$1");
        }

        // specials-images.forbesimg.com
        if (domain_nosub === "forbesimg.com" && domain.indexOf("images.forbesimg.com") >= 0) {
            // https://specials-images.forbesimg.com/imageserve/8988f42a4522469f9aeded6263f85183/960x0.jpg?fit=scale
            //   https://specials-images.forbesimg.com/imageserve/8988f42a4522469f9aeded6263f85183/0x0.jpg
            return {
                url: src.replace(/\/[0-9]*x[0-9]*\.([^/.?]*)(\?.*)?/, "/0x0.$1"),
                head_wrong_contentlength: true
            };
        }

        // MediaWiki
        // https://upload.wikimedia.org/wikipedia/commons/thumb/8/83/Bundesarchiv_-_Wikimedia_Deutschland_-_Pressekonferenz_%285999%29.jpg/220px-Bundesarchiv_-_Wikimedia_Deutschland_-_Pressekonferenz_%285999%29.jpg
        //   https://upload.wikimedia.org/wikipedia/commons/8/83/Bundesarchiv_-_Wikimedia_Deutschland_-_Pressekonferenz_%285999%29.jpg
        if (domain === "upload.wikimedia.org" ||
            // https://www.generasia.com/w/images/thumb/4/4d/aiko_-_Shimetta_Natsu_no_Hajimari_promo.jpg/500px-aiko_-_Shimetta_Natsu_no_Hajimari_promo.jpg
            //   https://www.generasia.com/w/images/4/4d/aiko_-_Shimetta_Natsu_no_Hajimari_promo.jpg
            domain_nowww === "generasia.com" ||
            // https://cdn.wikimg.net/strategywiki/images/thumb/0/01/PW_JFA_Official_Artwork.jpg/350px-PW_JFA_Official_Artwork.jpg
            domain === "cdn.wikimg.net" ||
            // http://liquipedia.net/commons/images/thumb/d/df/Tossgirl_2008_stx081014.jpg/269px-Tossgirl_2008_stx081014.jpg
            //   http://liquipedia.net/commons/images/d/df/Tossgirl_2008_stx081014.jpg
            domain === "liquipedia.net" ||
            // https://i.know.cf/imgwi/f/f8/Peyton_Roi_List.JPG/240px-Peyton_Roi_List.JPG
            //   https://i.know.cf/imgwi/f/f8/Peyton_Roi_List.JPG
            domain === "i.know.cf" ||
            // http://oyster.ignimgs.com/mediawiki/apis.ign.com/best-of-2017-awards/thumb/8/86/Anime.jpg/610px-Anime.jpg
            //   http://oyster.ignimgs.com/mediawiki/apis.ign.com/best-of-2017-awards/8/86/Anime.jpg
            src.match(/\/thumb\/.\/..\/[^/]*\.[^/]*\/[0-9]*px-/)) {
            return src.replace(/\/(?:thumb\/)?(.)\/(..)\/([^/]*)\/.*/, "/$1/$2/$3");
        }

        if (domain === "pixel.nymag.com") {
            // https://pixel.nymag.com/imgs/thecut/slideshows/2015/02/oscars-red-carpet/batch-7/464162110_10.nocrop.w443.h670.2x.jpg
            //   http://pixel.nymag.com/imgs/thecut/slideshows/2015/02/oscars-red-carpet/batch-7/464162110_10.jpg
            // https://pixel.nymag.com/imgs/thecut/slideshows/2015/05/met-gala/23/472181460.o.jpg/a_4x-vertical.jpg
            //   https://pixel.nymag.com/imgs/thecut/slideshows/2015/05/met-gala/23/472181460.jpg -- 3280x4928
            // https://pixel.nymag.com/imgs/thecut/slideshows/lookbooks/lindsay-lohan/lindsay-lohan-2016-06-22.o.jpg/a_4x-vertical.jpg
            //   https://pixel.nymag.com/imgs/thecut/slideshows/lookbooks/lindsay-lohan/lindsay-lohan-2016-06-22.jpg
            return src
                .replace(/\/([^/.]*)(\.[^/]*)?\.([^/.]*)$/, "/$1.$3")
            //.replace(/\/slideshows\/(?:[0-9]+\/[0-9]+\/[^/]*\/[^/]*\/[0-9]+(?:_[0-9]+)?)(?:\.[^/]*)?(\.[^/.]*)\/[^/]*$/, "$1$2");
                .replace(/(\/slideshows\/.*\/[^/]*)\.[a-z](\.[^/.]*)\/[^/]*(?:[?#].*)?$/, "$1$2");
        }

        if (domain === "assets.nydailynews.com" ||
            // http://assets.nydailynews.com/polopoly_fs/1.1756087.1397507807!/img/httpImage/image.jpg_gen/derivatives/article_750/ccweb15s-2-web.jpg
            //   http://assets.nydailynews.com/polopoly_fs/1.1756087.1397507807!/img/httpImage/ccweb15s-2-web.jpg

            // http://static1.nydailynews.com/polopoly_fs/1.2229393.1432140395!/img/httpImage/image.jpg_gen/derivatives/article_400/lopez21f-2-web.jpg
            //   http://static1.nydailynews.com/polopoly_fs/1.2229393.1432140395!/img/httpImage/lopez21f-2-web.jpg
            (domain_nosub === "nydailynews.com" && domain.match(/^static[0-9]*\./)) ||
            // https://i.cbc.ca/1.4304676.1506225777!/fileImage/httpImage/edmonton-oilers.JPG?imwidth=720
            //   https://i.cbc.ca/1.4304676.1506225777!/fileImage/httpImage/edmonton-oilers.JPG
            domain === "i.cbc.ca" ||
            // http://cdn.newsday.com/polopoly_fs/1.6354403.1383272745!/httpImage/image.JPG_gen/derivatives/landscape_1280/image.JPG
            //   https://cdn.newsday.com/polopoly_fs/1.6354403.1383272745!/httpImage/image.JPG
            domain === "cdn.newsday.com" ||
            // https://www.stripes.com/polopoly_fs/1.545877.1536091200!/image/image.jpg_gen/derivatives/300x200/image.jpg
            //   https://www.stripes.com/polopoly_fs/1.545877.1536091200!/image/image.jpg
            domain_nowww === "stripes.com" ||
            // can't find any test case, disabling for now
            //domain.indexOf("www.thetimesnews.com") >= 0 ||
            // https://www.irishtimes.com/polopoly_fs/1.3616909.1535987603!/image/image.jpg_gen/derivatives/box_300_160/image.jpg
            //   https://www.irishtimes.com/polopoly_fs/1.3616909.1535987603!/image/image.jpg
            domain_nowww === "irishtimes.com" ||
            // https://www.ctvnews.ca/polopoly_fs/1.4071511.1535482319!/httpImage/image.jpg_gen/derivatives/landscape_300/image.jpg
            //   https://www.ctvnews.ca/polopoly_fs/1.4071511.1535482319!/httpImage/image.jpg
            domain_nowww === "ctvnews.ca" ||
            // http://www.lancashirelife.co.uk/polopoly_fs/1.1596808!/image/2417471173.jpg_gen/derivatives/landscape_490/2417471173.jpg
            //   http://www.lancashirelife.co.uk/polopoly_fs/1.1596808!/image/2417471173.jpg
            domain_nowww === "lancashirelife.co.uk" ||
            // http://images.archant.co.uk/polopoly_fs/1.5453783.1522228810!/image/image.jpg_gen/derivatives/landscape_630/image.jpg
            //   http://images.archant.co.uk/polopoly_fs/1.5453783.1522228810!/image/image.jpg
            domain === "images.archant.co.uk" ||
            // https://www.tsn.ca/polopoly_fs/1.432481!/fileimage/httpImage/image.jpg_gen/derivatives/default/connor-mcdavid.jpg -- doesn't work
            //domain === "www.tsn.ca" ||
            // http://images.glaciermedia.ca/polopoly_fs/1.23165389.1517899084!/fileImage/httpImage/image.jpg_gen/derivatives/landscape_804/edm110453004-jpg.jpg
            //   https://images.glaciermedia.ca/polopoly_fs/1.23165389.1517899084!/fileImage/httpImage/edm110453004-jpg.jpg
            domain === "images.glaciermedia.ca" ||
            // https://static.gulfnews.com/polopoly_fs/1.2168576!/image/3397099558.jpg_gen/derivatives/box_460346/3397099558.jpg
            //   https://static.gulfnews.com/polopoly_fs/1.2168576!/image/3397099558.jpg
            domain === "static.gulfnews.com" ||
            // https://www.cp24.com/polopoly_fs/1.3742970.1514935441!/httpImage/image.jpg_gen/derivatives/landscape_150/image.jpg
            //   https://www.cp24.com/polopoly_fs/1.3742970.1514935441!/httpImage/image.jpg
            domain === "www.cp24.com" ||
            // https://images.anandabazar.com/polopoly_fs/1.832890.1531660919!/image/image.jpg_gen/derivatives/box_375_281/image.jpg
            // https://www.anandabazar.com/polopoly_fs/1.832890!/image/image.jpg_gen/derivatives/landscape_390/image.jpg
            domain_nosub === "anandabazar.com" ||
            // http://www.islingtongazette.co.uk/polopoly_fs/1.957786!/image/89195513.jpg_gen/derivatives/landscape_490/89195513.jpg
            domain === "www.islingtongazette.co.uk" ||
            // https://images.haaretz.co.il/polopoly_fs/1.5869852.1521547002!/image/2715066667.jpg_gen/derivatives/size_300xAuto/2715066667.jpg
            //   https://images.haaretz.co.il/polopoly_fs/1.5869852.1521547002!/image/2715066667.jpg
            domain === "images.haaretz.co.il" ||
            // http://p1014p.quotidiano.net/polopoly_fs/1.3245998.1499154460!/httpImage/image.JPG_gen/derivatives/gallery_800/image.JPG -- doesn't work
            //(domain_nosub === "quotidiano.net" && src.indexOf("/polopoly_fs/") >= 0) ||
            // http://www.edp24.co.uk/polopoly_fs/1.5540960!/image/image.jpg_gen/derivatives/landscape_630/image.jpg
            //   http://www.edp24.co.uk/polopoly_fs/1.5540960!/image/image.jpg
            domain_nowww === "edp24.co.uk") {
            newsrc = src
                .replace(/\/image\.[^_/]*_gen\/derivatives\/[^/]*\//, "/")
                .replace(/\/image\/[^_/]*_gen\/derivatives\/[^/]*\//, "/image/");
            if (newsrc !== src) {
                return newsrc.replace(/\?.*/, "");
            }
            // doesn't work for all:
            // https://ludovica.opopular.com.br/polopoly_fs/1.850210.1431538905!/image/image.jpg_gen/derivatives/landscape_800/image.jpg
        }

        if (domain === "static.gulfnews.com") {
            return {
                url: src,
                head_wrong_contenttype: true
            };
        }

        if (domain === "www.tsn.ca") {
            // https://www.tsn.ca/polopoly_fs/1.738832!/fileimage/httpImage/image.jpg_gen/derivatives/landscape_620/kyle-fuller.jpg
            //   https://www.tsn.ca/polopoly_fs/1.738832!/fileimage/httpImage/image.jpg_gen/derivatives/default/kyle-fuller.jpg
            return src.replace(/(\/image\.[^_/]*_gen\/derivatives\/)[^/]*\//, "$1default/");
        }

        if (domain_nosub === "bbci.co.uk" &&
            domain.match(/ichef(?:-[0-9]*)?.bbci.co.uk/)) {
            newsrc = src.replace(/\/[0-9]+_[0-9]+\//, "/original/");
            if (newsrc !== src)
                return newsrc;

            // http://ichef.bbci.co.uk/corporate2/images/width/live/p0/55/fh/p055fhy8.jpg/624
            //   http://ichef.bbci.co.uk/corporate2/images/width/live/p0/55/fh/p055fhy8.jpg/0
            newsrc = src.replace(/(\.[^/.]*)\/[0-9]+$/, "$1/0");
            if (newsrc !== src)
                return newsrc;

            // https://ichef.bbci.co.uk/images/ic/960x540/p03jg3g8.jpg
            //   https://ichef.bbci.co.uk/images/ic/raw/p03jg3g8.jpg
            // https://ichef.bbci.co.uk/images/ic/720x405/p0517py6.jpg
            //   https://ichef.bbci.co.uk/images/ic/raw/p0517py6.jpg
            // https://ichef.bbci.co.uk/images/ic/1920xn/p0698c1x.jpg
            //   https://ichef.bbci.co.uk/images/ic/raw/p0698c1x.jpg
            // http://ichef.bbci.co.uk/images/ic/144x81/p02cbtdd.jpg
            //   http://ichef.bbci.co.uk/images/ic/raw/p02cbtdd.jpg
            newsrc = src.replace(/(:\/\/[^/]*)\/images\/ic\/[0-9n]+x[0-9n]+\//, "$1/images/ic/raw/");
            if (newsrc !== src)
                return newsrc;

            // http://ichef.bbci.co.uk/wwhp/999/cpsprodpb/7432/production/_99764792_8e240163-62f5-4b0f-bf90-6def2cdc883b.jpg
            //   http://ichef.bbci.co.uk/news/999/cpsprodpb/7432/production/_99764792_8e240163-62f5-4b0f-bf90-6def2cdc883b.jpg
            //   https://c.files.bbci.co.uk/7432/production/_99764792_8e240163-62f5-4b0f-bf90-6def2cdc883b.jpg
            // https://ichef.bbci.co.uk/news/999/media/images/79831000/jpg/_79831755_hewer2_bbc.jpg
            //   https://news.bbcimg.co.uk/media/images/79831000/jpg/_79831755_hewer2_bbc.jpg
            // https://ichef-1.bbci.co.uk/news/235/cpsprodpb/A771/production/_99756824_trumpmueller.jpg
            //   https://c.files.bbci.co.uk/A771/production/_99756824_trumpmueller.jpg
            // http://ichef.bbci.co.uk/news/999/mcs/media/images/79839000/jpg/_79839098_bbcnickhewer.jpg
            //   http://news.bbcimg.co.uk/media/images/79839000/jpg/_79839098_bbcnickhewer.jpg
            // http://news.bbcimg.co.uk/news/special/2016/newsspec_15380/img/trump_annotated_976v2.png
            // http://news.bbcimg.co.uk/news/special/2017/newsspec_17595/img/hurricane_globe_v6.gif
            // http://ichef.bbci.co.uk/news/976/cpsprodpb/11B74/production/_88046527_getty_ora.jpg
            //   http://news.bbcimg.co.uk/media/images/88046527/jpg/_88046527_getty_ora.jpg -- not found
            //   http://c.files.bbci.co.uk/11B74/production/_88046527_getty_ora.jpg
            // http://news.bbcimg.co.uk/media/images/74104000/jpg/_74104195_6671990f-809f-432b-8699-7b5b92d053a0.jpg
            // http://news.bbcimg.co.uk/media/images/61015000/jpg/_61015960_3a79d215-7772-4ec1-b157-1655c66793ad.jpg
            // http://news.bbcimg.co.uk/news/special/2016/newsspec_12799/content/full-width/common/img/italy_graves_intro_1400.jpg
            // https://ichef.bbci.co.uk/onesport/cps/800/cpsprodpb/41F9/production/_98998861_ragnbone.jpg
            // http://c.files.bbci.co.uk/28EE/production/_98587401_afoty_624x351_player5.jpg
            // https://ichef.bbci.co.uk/live-experience/cps/800/cpsprodpb/vivo/live/images/2018/5/29/433b3e44-09ac-4366-a535-c1fbd8bc9cde.jpg
            //   https://c.files.bbci.co.uk/vivo/live/images/2018/5/29/433b3e44-09ac-4366-a535-c1fbd8bc9cde.jpg
            // https://ichef.bbci.co.uk/food/ic/food_16x9_832/recipes/irish_fish_chowder_with_08587_16x9.jpg -- 832x468
            //   https://food-images.files.bbci.co.uk/food/recipes/irish_fish_chowder_with_08587_16x9.jpg -- 5341x3004
            //
            //
            // larger images:
            // https://news.files.bbci.co.uk/include/shorthand/40714/media/nk_family_tree_shorthand_la.png -- 2560x1440
            // http://www.bbc.co.uk/staticarchive/3950fd5e40621b9769250aecda90d060da592198.jpg -- 602x357
            //   http://www.bbc.co.uk/sing/hallelujah/images/bbc_sing-hallelujah-london_fullsize.jpg -- 5616x3329
            // http://ichef.bbci.co.uk/images/ic/raw/p05k91nn.png -- 4001x3438
            //
            // subdomains for files.bbci.co.uk:
            //   a
            //   b
            //   c
            //   nav
            //   news
            //   childrens-binary
            //   search
            //   m
            //     https://m.files.bbci.co.uk/modules/bbc-morph-sport-opengraph/1.1.1/images/bbc-sport-logo.png
            //   guides
            //   food
            //   podcasts
            //   mybbc
            //   bbcthree-web-cdn
            //     https://bbcthree-web-cdn.files.bbci.co.uk/bbcthree-web-server/2.9.0-257.x86_64/images/share-best-of.png
            //   bam
            //     https://bam.files.bbci.co.uk/bam/live/content/zm8497h/large
            //     https://bam.files.bbci.co.uk/bam/live/content/zm8497h/small -- different (but related) image
            // subdomains for bbci.co.uk:
            //   static -- used for js etc. sometimes for images
            //   feeds -- used for rss feeds
            //   downloads
            //     http://downloads.bbc.co.uk/commissioning/site/CBBC_New_Logo_RGB.png
            //   android
            //   r
            //   [blank]
            //   www
            //   emp
            //
            // different cropping:
            // https://ichef.bbci.co.uk/news/999/cpsprodpb/01C8/production/_99765400_hi039575218.jpg
            // https://ichef.bbci.co.uk/news/999/cpsprodpb/DB2A/production/_99760165_hi039575218.jpg
            // http://news.bbcimg.co.uk/media/images/99765000/jpg/_99765400_hi039575218.jpg - doesn't work
            newsrc = src.replace(/.*\.bbci\.co\.uk\/news\/[0-9]*\/(?:[^/]*\/)?media\//, "http://news.bbcimg.co.uk/media/");
            if (newsrc !== src)
                return newsrc;

            newsrc = src.replace(/:\/\/[^/]*\/food\/ic\/[^/]*\//, "://food-images.files.bbci.co.uk/food/");
            if (newsrc !== src)
                return newsrc;

            // http://ichef.bbci.co.uk/naturelibrary/images/ic/credit/640x395/h/hu/hummingbird/hummingbird_1.jpg
            //   http://ichef.bbci.co.uk/naturelibrary/images/ic/640x395/h/hu/hummingbird/hummingbird_1.jpg
            newsrc = src.replace(/\/images\/ic\/credit(\/[0-9]+x[0-9]+\/)/, "/images/ic$1");
            if (newsrc !== src)
                return newsrc;

            newsrc = src.replace(/.*\/cpsprodpb\//, "https://c.files.bbci.co.uk/");
            if (newsrc !== src)
                return newsrc;

            // https://ichef.bbci.co.uk/news/1024/branded_portuguese/D518/production/_102525545_mediaitem102524830.jpg
            //   https://c.files.bbci.co.uk/D518/production/_102525545_mediaitem102524830.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/news\/[0-9]+\/[^/]*\//, "https://c.files.bbci.co.uk/");
            if (newsrc !== src)
                return newsrc;

            /*var origsize = src.match(/\.bbci\.co\.uk\/[^/]*\/([0-9]*)\//);
            if (origsize && false) { // scales up
                var size = parseInt(origsize[1], 10);
                if (size < 2048) {
                    return src.replace(/(\.bbci\.co\.uk\/[^/]*)\/[0-9]*\//, "$1/2048/");
                }
            }*/
        }

        if (domain === "amp.thisisinsider.com" ||
            domain === "amp.businessinsider.com") {
            // https://amp.thisisinsider.com/images/58c2c3d580c5ac1f008b47dc-960-1545.jpg
            //   https://static2.thisisinsider.com/image/58c2c3d580c5ac1f008b47dc/
            // https://amp.businessinsider.com/images/56dc9a3052bcd028008b4703-750-887.jpg
            //   https://static2.thisisinsider.com/image/56dc9a3052bcd028008b4703/
            // https://amp.businessinsider.com/images/5a383bcc7101ad309463675a-480-320.jpg
            //   https://static2.thisisinsider.com/image/5a383bcc7101ad309463675a/ -- doesn't work
            //   https://static2.businessinsider.com/image/5a383bcc7101ad309463675a.jpg
            //   https://static2.businessinsider.com/image/5a383bcc7101ad309463675a/
            // https://amp.businessinsider.com/images/59c5495519d2f523008b4c91-750-375.jpg
            //   https://static2.businessinsider.com/image/59c5495519d2f523008b4c91/
            // https://amp.businessinsider.com/images/58b36d34dd0895f4328b4c39-750-1125.jpg
            return urljoin(src, src.replace(/^[a-z]+:\/\/amp\.([^/]*)\/images\/([a-f0-9]+)-[0-9]+(?:-[0-9]+)?(\.[^/.]*)$/, "//static2.$1/image/$2/"));
        }

        if ((domain_nosub === "businessinsider.com" ||
             domain_nosub === "thisisinsider.com") &&
            domain.match(/^static[0-9]*\./)) {
            // http://static2.thisisinsider.com/image/58c2c3d580c5ac1f008b47dc-200/
            //   https://static2.thisisinsider.com/image/58c2c3d580c5ac1f008b47dc/
            // http://static6.uk.businessinsider.com/image/58ae09acdd089506308b4ad1-2377/undefined
            //   http://static6.uk.businessinsider.com/image/58ae09acdd089506308b4ad1/undefined
            //   http://static6.uk.businessinsider.com/image/58ae09acdd089506308b4ad1/
            // http://static.thisisinsider.com/image/59f0985d9091c139008b45da-750.jpg
            //   http://static.thisisinsider.com/image/59f0985d9091c139008b45da.jpg
            //return src.replace(/(\/image\/[^/]*)-[0-9]*(\/[^/]*|\.[^/.]*)$/, "$1$2");
            //return src.replace(/\/image\/([^-/]*)[^/]*\//, "/image/$1/");
            return src.replace(/(\/image\/[0-9a-f]+)(?:-[^/]*|\.[^/]*)?(?:\/.*)?$/, "$1/");
        }

        if (domain === "media.nbcwashington.com" ||
            // https://media.nbcnewyork.com/images/653*367/AP_18012240030020.jpg
            domain === "media.nbcnewyork.com" ||
            // http://media.graytvinc.com/images/810*455/TAYLOR+SWIFT19.jpg
            domain === "media.graytvinc.com" ||
            // https://media.telemundochicago.com/images/600*300/tlmd_leslie_grace_llega_a_radio_disney.jpg
            domain === "media.telemundochicago.com" ||
            // https://media.nbcdfw.com/images/652*367/calboy+picture.JPG
            //   https://media.nbcdfw.com/images/calboy+picture.JPG
            domain === "media.nbcdfw.com" ||
            // https://media.nbcchicago.com/images/652*367/t-swift-cover.jpg
            domain === "media.nbcchicago.com") {
            return src.replace(/\/images\/[0-9]+\*[0-9]+\//, "/images/");
        }

        if (domain_nowww === "bet.com") {
            // https://www.bet.com/style/living/2018/01/29/chrissy-teigen-gender-reveal/_jcr_content/squareImage.featured1x1.dimg/__1517248018208__1517242933377/012918-style-chrissy-teigen-gender-reveal.jpg
            //   https://www.bet.com/style/living/2018/01/29/chrissy-teigen-gender-reveal/_jcr_content/bodycopycontainer/embedded_image_0/image.custom0fx0fx0xcrop.dimg/__1517248018208__1517242933377/012918-style-chrissy-teigen-gender-reveal.jpg
            // https://www.bet.com/style/beauty/2018/01/30/cheap-beauty-products-celebrities-use/_jcr_content/bodycopycontainer/listiclecontainer/listicleitem_3/embedded_image/image.custom1200x1581.dimg/__1516987722286__1516987306610/012618-style-yara-shahidi-cheap-beauty-products.jpg
            // https://www.bet.com/style/fashion/2018/01/28/see-all-the-looks-from-the-grammy-s-2018-red-carpet/_jcr_content/squareImage.featuredlist.dimg/__1517191072539__1517189173163/012818-style-grammy-looks-1.jpg
            // https://www.bet.com/style/fashion/2018/01/28/see-rihanna-slay-a-patent-trench-as-she-accepted-a-grammy-award-/_jcr_content/image.ampheroimage.dimg/__1517189314895__1517188008118/012818-style-see-rihanna-slay-a-patent-trench-as-she-accepted-a-grammy-award.jpg
            // https://www.bet.com/style/living/2018/02/01/leslie-jones-meagan-good-body-positivity-black-girl-magic/_jcr_content/squareImage.relatedinline1x1.dimg/__1517510003204__1517501332582/020118-Celebs-Leslie-Jones-Megan-Good.jpg
            // https://www.bet.com/style/fashion/2018/01/31/jennifer-lopez-shows-off-toned-legs/_jcr_content/image.feedcontainer.dimg/__1517429162639__1517412507314/013118-style-jennifer-lopez-shows-off-toned-legs-3.jpg
            return src
                .replace(/\/(_jcr_content.*?\/[^/]*)\.custom[0-9]+fx[0-9]+fx[0-9]+xcrop\.([^/]*)\//, "/$1.custom0fx0fx0xcrop.$2/")
                .replace(/\/(_jcr_content.*?\/[^/]*)\.custom[0-9]+x[0-9]+\.([^/]*)\//, "/$1.custom0fx0fx0xcrop.$2/")
                .replace(/\/(_jcr_content.*?\/[^/]*)\.featured[0-9]+x[0-9]+\.([^/]*)\//, "/$1.custom0fx0fx0xcrop.$2/")
                .replace(/\/(_jcr_content.*?\/[^/]*)\.featuredlist\.([^/]*)\//, "/$1.custom0fx0fx0xcrop.$2/")
                .replace(/\/(_jcr_content.*?\/[^/]*)\.ampheroimage\.([^/]*)\//, "/$1.custom0fx0fx0xcrop.$2/")
                .replace(/\/(_jcr_content.*?\/[^/]*)\.feedcontainer\.([^/]*)\//, "/$1.custom0fx0fx0xcrop.$2/")
                .replace(/\/(_jcr_content.*?\/[^/]*)\.[^/.]*\.([^/]*)\//, "/$1.custom0fx0fx0xcrop.$2/")
                .replace(/\/(_jcr_content.*?\/[^/]*)\.relatedinline[0-9]+x[0-9]+\.([^/]*)\//, "/$1.custom0fx0fx0xcrop.$2/");
                //.replace(/\/_jcr_content\/.*(\/[^/]*)$/, "/_jcr_content/bodycopycontainer/embedded_image_0/image.custom0fx0fx0xcrop.dimg/$1");
        }

        if ((domain_nosub === "cbsistatic.com" &&
             // http://cbsnews1.cbsistatic.com/hub/i/r/2015/05/21/6836ca67-f2b8-48ae-ac4e-807d36830612/thumbnail/620x350/eca9fadfb6373619ab9174af67663e21/justin-bieber-and-james-cordon.jpg
             //   http://cbsnews1.cbsistatic.com/hub/i/r/2015/05/21/6836ca67-f2b8-48ae-ac4e-807d36830612/eca9fadfb6373619ab9174af67663e21/justin-bieber-and-james-cordon.jpg
             (domain.match(/^cbsnews[0-9]*\./) ||
              // https://zdnet1.cbsistatic.com/hub/i/r/2018/01/12/2dcbd29f-f3fa-4283-b11a-e163c03bbc08/resize/770xauto/99721c4b340e885277343e7f6cb4b6c3/ndcboom1-alt.jpg
              //   https://zdnet1.cbsistatic.com/hub/i/r/2018/01/12/2dcbd29f-f3fa-4283-b11a-e163c03bbc08/99721c4b340e885277343e7f6cb4b6c3/ndcboom1-alt.jpg
              // https://zdnet4.cbsistatic.com/hub/i/r/2018/02/06/1eef8bb5-4034-4e88-b356-ff9b035778d9/thumbnail/170x128/122ea3f0f9d0c3b86c23c3ff362ad252/brooke-cagle-195777.jpg
              //   https://zdnet4.cbsistatic.com/hub/i/r/2018/02/06/1eef8bb5-4034-4e88-b356-ff9b035778d9/122ea3f0f9d0c3b86c23c3ff362ad252/brooke-cagle-195777.jpg
              domain.match(/zdnet[0-9]*\./))) ||
            // https://sportshub.cbsistatic.com/i/r/2017/12/07/49119fbe-9e96-49a6-8c87-503f699477f2/thumbnail/770x433/9994a568cadde287e9e29ef38cf2ef36/demarcus-cousins.jpg
            //   https://sportshub.cbsistatic.com/i/r/2017/12/07/49119fbe-9e96-49a6-8c87-503f699477f2/9994a568cadde287e9e29ef38cf2ef36/demarcus-cousins.jpg
            domain === "sportshub.cbsistatic.com" ||
            // http://cimg.tvgcdn.net/i/r/2016/07/22/56a5114b-3639-4f72-8eac-12f22575c2e2/resize/900x600/2d6504f572963ac75616d4ef74dcc162/160722-news-rorys-boyfriends.jpg
            //   http://cimg.tvgcdn.net/i/r/2016/07/22/56a5114b-3639-4f72-8eac-12f22575c2e2/2d6504f572963ac75616d4ef74dcc162/160722-news-rorys-boyfriends.jpg
            domain === "cimg.tvgcdn.net") {
            newsrc = src
                .replace(/\/resize\/[0-9a-z]*x[0-9a-z]*\//, "/")
                .replace(/\/crop\/[^/]*\//, "/")
                .replace(/\/thumbnail\/[^/]*\//, "/");
            if (newsrc !== src) {
                return {
                    url: newsrc,
                    head_wrong_contentlength: true
                };
            }
        }

        if (domain_nosub === "cbsistatic.com" &&
            domain.match(/cnet[0-9]*\.cbsistatic\.com/)) {
            // https://cnet3.cbsistatic.com/img/FK8CGJDejVV-sEaEJZ2nXW8eM3k=/1600x900/2017/03/15/a2595ca5-43fc-4508-9c36-745b04dd49a1/coco2.jpg
            //   https://cnet3.cbsistatic.com/img/2017/03/15/a2595ca5-43fc-4508-9c36-745b04dd49a1/coco2.jpg
            // https://cnet1.cbsistatic.com/img/nCMng7w4iuS_uxiPM4wghBjtQBg=/81x398:2438x2724/0x527/2017/05/08/9f832785-f506-4ec3-b175-f85723d123dc/ew-opener.jpg
            //   https://cnet1.cbsistatic.com/img/2017/05/08/9f832785-f506-4ec3-b175-f85723d123dc/ew-opener.jpg
            // https://cnet1.cbsistatic.com/img/DIHwjRMV2yd28ex651bXyFnHQmE=/2017/12/27/3397f9e3-e1b9-4630-8e14-451a97546d32/dsc01630.jpg
            //   https://cnet1.cbsistatic.com/img/2017/12/27/3397f9e3-e1b9-4630-8e14-451a97546d32/dsc01630.jpg
            // https://cnet1.cbsistatic.com/img/7WiR6Xi_Xc5FW2s5N7TdDmG6qLM=/fit-in/570x0/2017/12/12/c2363e6d-59e7-4027-9fda-7a5c467122fe/falcon-tie-finn.gif
            //   https://cnet1.cbsistatic.com/img/2017/12/12/c2363e6d-59e7-4027-9fda-7a5c467122fe/falcon-tie-finn.gif
            return src.replace(/\/img\/[^/]*=\/(?:fit-in\/)?(?:[0-9]+x[0-9]+:[0-9]+x[0-9]+\/)?(?:[0-9]+x[0-9]+\/)?(.*)/, "/img/$1");
        }

        if (domain_nosub === "cbsstatic.com" &&
            domain.match(/wwwimage[0-9]*(?:-secure)?\.cbsstatic\.com/)) {
            // http://wwwimage2.cbsstatic.com/thumbnails/photos/w370/blog/abd70cf777ca6a77_marissa_golds_guide_1920.jpg
            //   http://wwwimage2.cbsstatic.com/base/files/blog/abd70cf777ca6a77_marissa_golds_guide_1920.jpg
            // http://wwwimage.cbsstatic.com/thumbnails/photos/files/asset/10/00/56/47/927857742dd31df2_dianes_world.jpg
            //   http://wwwimage.cbsstatic.com/base/files/asset/10/00/56/47/927857742dd31df2_dianes_world.jpg
            // http://wwwimage4.cbsstatic.com/thumbnails/videos/w270/CBS_Production_Entertainment_VMS/761/811/2018/02/06/1145406531709/CBS_SCORPION_416_IMAGE_NO_LOGO_thumb_Master.jpg
            //   http://wwwimage4.cbsstatic.com/thumbnails/videos/files/CBS_Production_Entertainment_VMS/761/811/2018/02/06/1145406531709/CBS_SCORPION_416_IMAGE_NO_LOGO_thumb_Master.jpg
            // http://wwwimage2.cbsstatic.com/thumbnails/photos/770xh/danielle_big_brother_over_the_top.jpg
            // http://wwwimage2.cbsstatic.com/thumbnails/photos/100q/danielle_big_brother_over_the_top.jpg
            // https://wwwimage-secure.cbsstatic.com/thumbnails/photos/770xh/610a45ac16030991_lady-gaga-2-red-carpet-2018-grammy-awards.jpg
            //
            // error:
            //Not enough parameters were given.
            //
            //Available parameters:
            //w = Maximum width
            //h = Maximum height
            //c = Crop ratio (width:height)
            //q = Quality (0-100)
            //b = Background fill color (RRGGBB or RGB)
            //p = Progressive (0 or 1)
            //
            //Example usage:
            // http://wwwimage2.cbsstatic.com/thumbnails/photos/w300-h300-c1:1/path/to/image.jpg
            return src
                //.replace(/\/thumbnails\/([^/]*)\/[wh][0-9]*\//, "/thumbnails/$1/files/")
                .replace(/\/thumbnails\/([^/]*)\/[-a-z0-9:]*\//, "/thumbnails/$1/files/")
                .replace("/thumbnails/photos/files/", "/base/files/");
        }

        if (domain === "api.fidji.lefigaro.fr") {
            // http://api.fidji.lefigaro.fr/media/ext/1900x/madame.lefigaro.fr/sites/default/files/img/2015/01/defile-valentino-automne-hiver-2015-2016-paris-look-46.jpg
            //   http://i.f1g.fr/media/ext/1900x/madame.lefigaro.fr/sites/default/files/img/2015/01/defile-valentino-automne-hiver-2015-2016-paris-look-46.jpg
            // http://api.fidji.lefigaro.fr/media/ext/1900x/img.tvmag.lefigaro.fr/ImCon/Arti/89615/PHO0ce17170-86bd-11e5-81ca-efc6b4cd613e-805x453.jpg
            //   http://i.f1g.fr/media/ext/1900x/img.tvmag.lefigaro.fr/ImCon/Arti/89615/PHO0ce17170-86bd-11e5-81ca-efc6b4cd613e-805x453.jpg
            return src.replace("://api.fidji.lefigaro.fr/", "://i.f1g.fr/");
        }

        if (domain === "i.f1g.fr") {
            newsrc = src.replace(/.*i\.f1g\.fr\/media\/ext\/[^/]*\//, "http://");
            var newdomain = newsrc.replace(/^http:\/\/([^/]*)\/.*/, "$1");
            if (newsrc !== src &&
                newdomain !== "img.tvmag.lefigaro.fr")
                return newsrc;

            // http://svn.pimentech.org/pimentech/libcommonDjango/django_pimentech/pixr/views.py
            // mirror: https://pastebin.com/D7zPvfa1
            //
            // http://i.f1g.fr/media/figaro/493x100_crop/2017/03/28/XVM5540edbe-13a3-11e7-9e28-7b011fa4a165.jpg
            //   http://i.f1g.fr/media/figaro/orig/2017/03/28/XVM5540edbe-13a3-11e7-9e28-7b011fa4a165.jpg
            // http://i.f1g.fr/media/eidos/493x178_crop/2017/11/05/XVM758e1cb8-c212-11e7-b1f9-8e8a8cad8fcc.jpg
            //   http://i.f1g.fr/media/eidos/orig/2017/11/05/XVM758e1cb8-c212-11e7-b1f9-8e8a8cad8fcc.jpg
            return src.replace(/\/media\/([a-z]*)\/[^/]*\//, "/media/$1/orig/");
        }

        if ((domain_nosub === "h-cdn.co" ||
             // http://cnl.h.cdn.cosmopolitan.nl/assets/14/52/480x419/nrm_1419442245-billboard-awards-2013.jpg
             //   http://cnl.h.cdn.cosmopolitan.nl/assets/14/52/nrm_1419442245-billboard-awards-2013.jpg
             (domain_nosub === "cosmopolitan.nl" && domain.match(/h\.cdn\.cosmopolitan\./)))
            && src.indexOf("/assets/") >= 0) {
            // http://cos.h-cdn.co/assets/15/10/980x490/landscape_nrm_1425328178-tiffanypps2.jpg
            //   http://cos.h-cdn.co/assets/15/10/landscape_nrm_1425328178-tiffanypps2.jpg
            // http://ell.h-cdn.co/assets/15/24/980x490/landscape-1433956992-elle-wit.jpg
            //   http://ell.h-cdn.co/assets/15/24/landscape-1433956992-elle-wit.jpg
            return src.replace(/\/[0-9]*x[0-9]*\//, "/");
            // return src.replace(/(\/assets\/[^/]*\/[^/]*\/)[0-9]+x[0-9]+\//, "$1");
        }

        if (domain === "imgix.ranker.com") {
            // https://imgix.ranker.com/user_node_img/50076/1001516851/original/sheldon-and-_39_s-in-an-insane-asylum-and-the-show-only-takes-place-in-his-head-photo-u1?w=600&q=50&fm=jpg
            //   https://imgix.ranker.com/user_node_img/50076/1001516851/original/sheldon-and-_39_s-in-an-insane-asylum-and-the-show-only-takes-place-in-his-head-photo-u1?fm=png
            return src.replace(/\?[^/]*$/, "?fm=png");
        }

        if (domain === "driftt.imgix.net") {
            // https://driftt.imgix.net/https%3A%2F%2Fdriftt.imgix.net%2Fhttps%253A%252F%252Fs3.amazonaws.com%252Fcustomer-api-avatars-prod%252F124400%252Fa382421eaa0c3184c7c1588a54a481014za77e245kzk%3Ffit%3Dmax%26fm%3Dpng%26h%3D200%26w%3D200%26s%3Db662f982cf04f9f733dcb1ce4522ee73?fit=max&fm=png&h=200&w=200&s=cd4c2695da2c9621a41fc14e92516b37
            //  https://driftt.imgix.net/https%3A%2F%2Fs3.amazonaws.com%2Fcustomer-api-avatars-prod%2F124400%2Fa382421eaa0c3184c7c1588a54a481014za77e245kzk?fit=max&fm=png&h=200&w=200&s=b662f982cf04f9f733dcb1ce4522ee73
            //   https://s3.amazonaws.com/customer-api-avatars-prod/124400/a382421eaa0c3184c7c1588a54a481014za77e245kzk
            return decodeURIComponent(src.replace(/.*?driftt\.imgix\.net\//, ""));
        }

        if (domain === "data.whicdn.com") {
            // https://data.whicdn.com/images/284282683/superthumb.jpg
            //   https://data.whicdn.com/images/284282683/original.jpg
            return src.replace(/\/[^/.]*\.([^/.]*)$/, "/original.$1");
        }

        if (domain_nosub === "whicdn.com" && domain.match(/^data[0-9]*\./)) {
            // http://data3.whicdn.com/images/139561907/large.jpg
            //   http://data.whicdn.com/images/139561907/large.jpg
            return src.replace(/:\/\/data[0-9]*\./, "://data.");
        }

        if (domain === "cdn.empireonline.com") {
            // 12
            // https://cdn.empireonline.com/jpg/70/0/0/640/480/aspectfit/0/0/0/0/0/0/c/reviews_films/5a57bf3d652c21bb08ce7fc8/pixar-coco-concept-art.jpg
            //   https://cdn.empireonline.com/c/reviews_films/5a57bf3d652c21bb08ce7fc8/pixar-coco-concept-art.jpg
            // https://cdn.empireonline.com/jpg/80/0/0/300/170/0/north/0/0/0/0/0/c/reviews_films/5a73e5036bb57fce0af3b5ab/den-of-thieves-1.jpg
            //   https://cdn.empireonline.com/c/reviews_films/5a73e5036bb57fce0af3b5ab/den-of-thieves-1.jpg
            //return src.replace(/cdn\.empireonline\.com\/(?:jpg|png|gif)\/(?:[0-9]+\/){5}aspectfit\/(?:[0-9]+\/){6}/, "cdn.empireonline.com/");
            return src.replace(/cdn\.empireonline\.com\/(?:jpg|png|gif)\/(?:[^/.]+\/){12}/, "cdn.empireonline.com/");
            //return urljoin(src, src.replace(/cdn\.empireonline\.com\/(jpg)|(png)|(gif)\/[^/]*\/[^/]*\/[^/]*\/[^/]*\/[^/]*\/[^/]*\/[^/]*\/[^/]*\/[^/]*\/[^/]*\/[^/]*\/[^/]*\//, "/"));
        }

        if (domain_nosub === "celebmafia.com" ||
            domain_nosub === "hawtcelebs.com") {
            return src.replace(/\/([^/]*)_thumbnail\.([^/.]*)$/, "/$1.$2");
        }

        if ((domain_nosub === "pixhost.org" ||
             domain_nosub === "pixhost.to") &&
            domain.match(/[a-z]*[0-9]*\./)) {
            // https://t17.pixhost.to/thumbs/469/66269400_ns4w-org-2.jpg
            //   https://img17.pixhost.to/images/469/66269400_ns4w-org-2.jpg
            return src.replace(/\/t([0-9]*\.pixhost\.[a-z]*)\/thumbs\//, "/img$1/images/");
        }

        /*if (domain.indexOf("ssli.ulximg.com") >= 0) {
            return src.replace(/\/image\/[0-9]+x[0-9]+\//, "/image/full/");
        }*/

        if (domain_nosub === "ulximg.com" ||
            // https://www.hotnewhiphop.com/image/620x412/cover/1524605990_feb5e308477137cbfd1b33ec83a5ba73.jpg/a2190aede262d8430a74acf84c6fc2b3/1524605990_b78abf068561f64fc0d7a44ff44dde65.jpg
            //   https://www.hotnewhiphop.com/image/full/cover/1524605990_feb5e308477137cbfd1b33ec83a5ba73.jpg/a2190aede262d8430a74acf84c6fc2b3/1524605990_b78abf068561f64fc0d7a44ff44dde65.jpg
            //   https://www.hotnewhiphop.com/image/full/cover/1524605990_feb5e308477137cbfd1b33ec83a5ba73.jpg -- also works
            domain_nowww === "hotnewhiphop.com") {
            // https://sslh.ulximg.com/image/740x493/cover/1517447102_98a80a4ead45fe6ea39dba7f13d82d59.jpg/cf804979603806d94cb139fc0676f0ca/1517447102_4694e8c352198b439a03d90f0ea03910.jpg
            //   https://sslh.ulximg.com/image/full/cover/1517447102_98a80a4ead45fe6ea39dba7f13d82d59.jpg/cf804979603806d94cb139fc0676f0ca/1517447102_4694e8c352198b439a03d90f0ea03910.jpg
            // https://sslb.ulximg.com/image/640xfull/gallery/1519079706_9a191bef4598aefcd89fdb14d43dd943.jpg/ab146c791e98eccd4a763e2a31fa10ce/1519079706_65c3b37c6f9215a3c80d86f6172920c2.jpg
            //   https://sslb.ulximg.com/image/full/gallery/1519079706_9a191bef4598aefcd89fdb14d43dd943.jpg/ab146c791e98eccd4a763e2a31fa10ce/1519079706_65c3b37c6f9215a3c80d86f6172920c2.jpg
            // doesn't work for all:
            // https://sslh.ulximg.com/image/740x493/cover/1517954740_3e7856551e64f1217860014d8853d1e1.jpg
            return src
                .replace(/\/image\/[0-9a-z]*x[0-9a-z]*\//, "/image/full/");
                //.replace(/(\/cover\/[^/.]*\.[^/.]*)\/.*/, "$1");
        }

        if (domain === "fm.cnbc.com") {
            // https://fm.cnbc.com/applications/cnbc.com/resources/img/editorial/2018/07/12/105325481-Preview10.600x400.jpeg?v=1531393316
            //   https://fm.cnbc.com/applications/cnbc.com/resources/img/editorial/2018/07/12/105325481-Preview10.jpeg?v=1531393316
            return src.replace(/\.[0-9]+x[0-9]+\.([^/.]*)$/, ".$1");
        }

        if (domain === "images.bwwstatic.com") {
            // https://images.bwwstatic.com/upload/44785/tn-500_(23).jpg
            //   https://images.bwwstatic.com/upload/44785/(23).jpg
            return src.replace(/\/tn-[0-9]+_([^/]*)$/, "/$1");
        }

        if (domain_nosub === "houstonpress.com" && domain.match(/images[0-9]*\.houstonpress\.com/)) {
            // https://images1.houstonpress.com/imager/u/745x420/9795106/10-19_745x420.jpg
            //   https://images1.houstonpress.com/imager/u/original/9795106/10-19_745x420.jpg
            return src.replace(/(\/imager\/[^/]*\/)[^/]*\//, "$1original/");
        }

        if (domain.indexOf("img.rasset.ie") >= 0 && false) {
            // https://img.rasset.ie/000a704c-440.jpg
            //   https://img.rasset.ie/000a704c-9999.jpg -- wildly stretched (4096x6144)
            return src.replace(/(\/[^/]*)-[0-9]*(\.[^/.]*)$/, "$1-9999$2");
        }

        if (domain === "i.pinimg.com" ||
            // http://s3.amazonaws.com/media.pinterest.com/640x/c9/68/4a/c9684afc422e69662bed9f59835d2001.jpg
            //   http://s3.amazonaws.com/media.pinterest.com/originals/c9/68/4a/c9684afc422e69662bed9f59835d2001.jpg
            // http://media.pinterest.com.s3.amazonaws.com/640x/c9/68/4a/c9684afc422e69662bed9f59835d2001.jpg
            //   http://media.pinterest.com.s3.amazonaws.com/originals/c9/68/4a/c9684afc422e69662bed9f59835d2001.jpg
            amazon_container === "media.pinterest.com") {
            // https://i.pinimg.com/640x/1f/3f/ed/1f3fed6c284955934c7d724d2fe13ecb.jpg
            //   https://i.pinimg.com/originals/1f/3f/ed/1f3fed6c284955934c7d724d2fe13ecb.png
            // https://i.pinimg.com/640x/a7/db/c3/a7dbc392372f1ca8f744032ba3c5ade1.jpg
            //   https://i.pinimg.com/originals/a7/db/c3/a7dbc392372f1ca8f744032ba3c5ade1.gif
            if (src.match(/:\/\/[^/]*\/media\.pinterest\.com\//))
                newsrc = src.replace(/(:\/\/[^/]*\/media\.pinterest\.com\/)[^/]*(\/.*\/[^/]*\.[^/.]*)$/, "$1originals$2");
            else
                newsrc = src.replace(/(:\/\/[^/]*\/)[^/]*(\/.*\/[^/]*\.[^/.]*)$/, "$1originals$2");

            if (newsrc !== src) {
                return add_extensions_gif(newsrc);
            }
        }

        // vg-images.condecdn.net
        // gl-images.condecdn.net
        if (domain_nosub === "condecdn.net" && domain.indexOf("images.condecdn.net") >= 0) {
            // http://vg-images.condecdn.net/image/5LQVw4Pp8rR/crop/1020
            //   https://vg-images.condecdn.net/image/5LQVw4Pp8rR/original/
            // https://gl-images.condecdn.net/image/DAwRBl12EGY/crop/810
            //   https://gl-images.condecdn.net/image/DAwRBl12EGY/original/
            return src.replace(/(\/image\/[^/]*\/).*/, "$1original/");
        }

        if (domain === "media.fromthegrapevine.com" ||
            // https://www.mediavillage.com/media/articles/alex-wong-17993-unsplash.jpg.1440x1000_q85_box-19%2C0%2C634%2C427_crop_detail.jpg
            //   https://www.mediavillage.com/media/articles/alex-wong-17993-unsplash.jpg
            domain_nowww === "mediavillage.com") {
            // https://media.fromthegrapevine.com/assets/images/2017/3/waiting-in-long-line.jpg.824x0_q71_crop-scale.jpg
            //   https://media.fromthegrapevine.com/assets/images/2017/3/waiting-in-long-line.jpg
            return src.replace(/\/([^/.]*\.[^/.]*)\.[^/.]*\.[^/.]*$/, "/$1");
        }

        if (domain_nosub === "acsta.net" && domain.search(/img[0-9]*\.acsta\.net/) >= 0) {
            newsrc = src.replace(/acsta\.net\/[^/]*\/pictures\//, "acsta.net/pictures/");
            if (newsrc !== src)
                return newsrc;

            // http://fr.web.img4.acsta.net/r_640_360/videothumbnails/15/06/05/12/59/008779.jpg
            //   http://fr.web.img4.acsta.net/videothumbnails/15/06/05/12/59/008779.jpg
            // http://fr.web.img2.acsta.net/c_208_117/videothumbnails/17/02/08/14/59/169562.jpg
            //   http://fr.web.img2.acsta.net/videothumbnails/17/02/08/14/59/169562.jpg
            return src.replace(/\/[rc]_[0-9]+_[0-9]+\//, "/");
        }

        if (domain === "em.wattpad.com") {
            // https://em.wattpad.com/10c43b485be3ed7d7dd3e7e24ad6cb9d8a11a264/687474703a2f2f6a656e6d6172696577696c64652e636f6d2f77702d636f6e74656e742f75706c6f6164732f323031352f30332f4576614642436f7665722e6a7067?s=fit&h=360&w=360&q=80
            //   http://jenmariewilde.com/wp-content/uploads/2015/03/EvaFBCover.jpg
            // https://em.wattpad.com/08067e2680eba0d36693e085bc95b85c9c0d8f8b/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f776174747061642d6d656469612d736572766963652f53746f7279496d6167652f3062446c6b2d786e5565654d54673d3d2d32303633363333342e313436393133373236306332313733383233313938393638383435332e6a7067?s=fit&w=720&h=720
            //   https://s3.amazonaws.com/wattpad-media-service/StoryImage/0bDlk-xnUeeMTg==-20636334.1469137260c21738231989688453.jpg
            return src.replace(/.*\.wattpad\.com\/[a-f0-9]*\/([a-f0-9]*).*/, "$1").replace(/([0-9A-Fa-f]{2})/g, function() {
                return String.fromCharCode(parseInt(arguments[1], 16));
            });
        }

        if (domain === "vignette.wikia.nocookie.net") {
            // https://vignette.wikia.nocookie.net/arresteddevelopment/images/2/2a/2015_MM_and_A_TGIT_Party_-_Portia_de_Rossi.jpg/revision/latest/top-crop/width/320/height/320?cb=20151215213157
            //   https://vignette.wikia.nocookie.net/arresteddevelopment/images/2/2a/2015_MM_and_A_TGIT_Party_-_Portia_de_Rossi.jpg/revision/latest/?cb=20151215213157
            // https://vignette.wikia.nocookie.net/kpop/images/9/95/Various_Seulki_I_Only_Want_You_photo.png/revision/latest/scale-to-width-down/350
            //   https://vignette.wikia.nocookie.net/kpop/images/9/95/Various_Seulki_I_Only_Want_You_photo.png/revision/latest/
            //return src.replace(/(\/images\/[^/]*\/.*)\/scale-to-width-down\/[0-9]*/, "$1");
            return src.replace(/\/revision\/([^/]*)\/.*?(\?.*)?$/, "/revision/$1/$2");
        }

        if (domain === "static.asiachan.com") {
            // https://static.asiachan.com/600/38/06/50338.jpg
            //   https://static.asiachan.com/full/38/06/50338.jpg
            // https://static.asiachan.com/Seohyun.600.171223.jpg
            //   https://static.asiachan.com/Seohyun.full.171223.jpg
            return src
                .replace(/(\/[^/]*\.)[0-9]*(\.[0-9]*\.[^/.]*$)/, "$1full$2")
                .replace(/(:\/\/[^/]*\/)[0-9]+(\/[0-9]+\/[0-9]+\/[0-9]+\.[^/.]*)$/, "$1full$2");
        }

        if (domain === "pic.xiami.net" ||
            // https://club-img.kdslife.com/attach/1k2/jm/36/p79ee9-1m6r.jpg@1o_1l_600w_90q.jpg
            //   https://club-img.kdslife.com/attach/1k2/jm/36/p79ee9-1m6r.jpg -- stretched?
            domain === "club-img.kdslife.com" ||
            // http://p0.meituan.net/movie/86f093dd1c7dfb6306ab488c958be31d356758.png@200w_1l
            //   http://p0.meituan.net/movie/86f093dd1c7dfb6306ab488c958be31d356758.png
            domain === "p0.meituan.net" ||
            // http://img.sdxapp.com/say/source/12/d2/12d2bb054022c4fc1038f3e4d279353d.jpg@600w_400h
            //   http://img.sdxapp.com/say/source/12/d2/12d2bb054022c4fc1038f3e4d279353d.jpg
            domain === "img.sdxapp.com") {
            // http://pic.xiami.net/images/artistlogo/43/15296162953243.png@!c-330-330
            //   http://pic.xiami.net/images/artistlogo/43/15296162953243.png
            return src.replace(/@[^/]*$/, "");
        }

        // img4.c.yinyuetai.com
        if (domain_nosub === "yinyuetai.com" &&
            domain.match(/^img[0-9]*\.c\.yinyuetai\.com/)) {
            // http://img0.c.yinyuetai.com/video/mv/180802/0/-M-f2e73b6131de7338d8375c82e7e60f70_240x135.jpg
            //   http://img0.c.yinyuetai.com/video/mv/180802/0/-M-f2e73b6131de7338d8375c82e7e60f70_0x0.jpg
            // http://img1.c.yinyuetai.com/user/avatar/170813/4165907-1502610570582/-M-3fe425e60e2fcf46bad875cc638be60f_180x180.jpg
            //   http://img1.c.yinyuetai.com/user/avatar/170813/4165907-1502610570582/-M-3fe425e60e2fcf46bad875cc638be60f_0x0.jpg -- doesn't work
            return src.replace(/[0-9]+x[0-9]+(\.[^/.]*)$/, "0x0$1");
        }

        // it also has img7.qiyipic.com, which hosts /passport/, which doesn't work with this (mp2.qiyipic.com)
        // test cases can be found, but can't find referer headers
        if (domain.search(/mp[0-9]*\.qiyipic\.com/) >= 0 && src.indexOf("/passport/") < 0) {
            return src.replace(/[0-9]*_[0-9]*(\.[^/.]*)$/, "0_0$1");
        }

        if (domain === "b-ssl.duitang.com") {
            // https://b-ssl.duitang.com/uploads/item/201508/01/20150801214854_2Vr53.thumb.700_0.jpeg -- 403
            //   https://b-ssl.duitang.com/uploads/item/201508/01/20150801214854_2Vr53.jpeg -- works
            return src.replace(/\.thumb\.[0-9]+_[0-9]+\./, ".");
        }

        if (domain_nosub === "vcimg.com" &&
            domain.match(/i-[0-9]\.vcimg.com/)) {
            // http://i-7.vcimg.com/trim/8d8fb8b28853070f596166213f455c1c1806479/trim.jpg
            //   http://i-7.vcimg.com/8d8fb8b28853070f596166213f455c1c1806479/trim.jpg
            // http://i-7.vcimg.com/crop/c626725e944a9b4bd836f20be4ebf264254823(600x)/thumb.jpg
            //   http://i-7.vcimg.com/c626725e944a9b4bd836f20be4ebf264254823(600x)/thumb.jpg
            //   http://i-7.vcimg.com/c626725e944a9b4bd836f20be4ebf264254823/thumb.jpg
            // filename can be anything
            return src.replace(/\/(?:crop|trim)\//, "/").replace(/(\/[0-9a-f]+)\([0-9]+x(?:[0-9]+)?\)\//, "$1/");
        }

        if (domain_nosub === "zhimg.com" &&
            domain.match(/pic[0-9]\.zhimg\.com/)) {
            // https://pic1.zhimg.com/74c63994d55e7307d41d39066d53eb72_1200x500.jpg
            //   https://pic1.zhimg.com/74c63994d55e7307d41d39066d53eb72.jpg
            // https://pic1.zhimg.com/80/4ae63ae895f29a18e035d78aad1804d8_hd.png
            //   https://pic1.zhimg.com/80/4ae63ae895f29a18e035d78aad1804d8.png
            return src.replace(/_[^/._]*(\.[^/.]*)$/, "$1");
        }

        // seems to returns 403 if 'referer' header is set:
        //   {"code":"40310014","msg":"invalid Referer header"}
        if (domain === "img.hb.aicdn.com" ||
            domain_nosub === "upaiyun.com") {
            // http://img.hb.aicdn.com/504850944a803cb529c8ea7672c7959aa930b911b37e7-FjZhoC_fw658
            // http://hbimg.b0.upaiyun.com/61a5e5496ff85c52aedb1a0b88cfa6cf2fab85b25baa4-OOfVFz_fw236
            // http://hbimg.b0.upaiyun.com/24c9187996fff6a463a6e0cf33e445a5c106f840110dad-GoXNdV_fw658
            // http://hbimg.b0.upaiyun.com/eb022d252413c843904d7929cd20efad6ce5ad1d1a13b-nuwiDc_fw236
            // http://hbimg.b0.upaiyun.com/2dee7739bd27dac4368381fc5e571fc5efffa0dc1b2530-76nu98
            // http://hbimg.b0.upaiyun.com/26f0536f7035fde61b7332a3bbf1e54bf0255c4d2d07b-gZ7snl_fw658
            return {
                url: src.replace(/_[^/_]*$/, ""),
                headers: {
                    "Referer": ""
                }
            };
            // return src.replace(/_fw[0-9]*$/, "");
        }

        if (domain === "imagev2.xmcdn.com") {
            // http://imagev2.xmcdn.com/group22/M07/3C/67/wKgJM1rvlETB0ToJAAfrPV-PTII537.jpg!op_type=5&upload_type=album&device_type=ios&name=mobile_large&strip=0&quality=7
            //   http://imagev2.xmcdn.com/group22/M07/3C/67/wKgJM1rvlETB0ToJAAfrPV-PTII537.jpg
            // https://i2.wp.com/imagev2.xmcdn.com/group35/M08/4B/55/wKgJnFoJZEeyBE1iAAVLw1BLZEE066_mobile_large.jpg!op_type=5&upload_type=album&device_type=ios&name=mobile_large&magick=jpg&strip=1&quality=6
            //   http://imagev2.xmcdn.com/group35/M08/4B/55/wKgJnFoJZEeyBE1iAAVLw1BLZEE066.jpg
            // http://imagev2.xmcdn.com/group21/M01/EC/AE/wKgJKFiGm4_DV0_TAAJWeaCCpzE969.jpg!op_type=5&upload_type=album&device_type=ios&name=mobile_large&strip=0&quality=7
            //   http://imagev2.xmcdn.com/group21/M01/EC/AE/wKgJKFiGm4_DV0_TAAJWeaCCpzE969.jpg
            return src.replace(/![^/]*$/, "").replace(/(\/[^/]*?)(?:_[a-z_]+)?(\.[^/.]*)$/, "$1$2");
        }

        if ((domain_nosub === "bdimg.com" || domain_nosub === "baidu.com") &&
            // http://c.hiphotos.baidu.com/forum/w%3D272%3Bq%3D80%3Bg%3D0/sign=9a65dccd7f8da9774e2f812c826a8924/bf848226cffc1e175a7793cf4690f603728de936.jpg?&src=http%3A%2F%2Fimgsrc.baidu.com%2Fforum%2Fpic%2Fitem%2Fbf848226cffc1e175a7793cf4690f603728de936.jpg
            //   http://imgsrc.baidu.com/forum/pic/item/bf848226cffc1e175a7793cf4690f603728de936.jpg
            domain.match(/[a-z]\.hiphotos\.baidu\.com/) ||
            // https://timg04.bdimg.com/timg?wapbaike&quality=60&size=b396_593&sec=1349839550&di=55fd97fcbc1e84aca81eda03ac89fa53&src=http://imgsrc.baidu.com/baike/pic/item/a1ec08fa513d2697a2dc0cf653fbb2fb4316d80a.jpg
            //   http://imgsrc.baidu.com/baike/pic/item/a1ec08fa513d2697a2dc0cf653fbb2fb4316d80a.jpg
            (domain.match(/timg.*?\.bdimg\.com/) ||
             domain.match(/timg.*?\.baidu\.com/))) {
            // https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1490961932774&di=65b21e6bef59bf6b1f6e71f18f46008c&imgtype=0&src=http%3A%2F%2Fqcloud.dpfile.com%2Fpc%2FqqYXMqI9j2MqLzJ3hKYFqx6407skBHDx-gKkvyfBaUcZWk8eZQMRW2FeuVD9x_wbTYGVDmosZWTLal1WbWRW3A.jpg
            //   http://qcloud.dpfile.com/pc/qqYXMqI9j2MqLzJ3hKYFqx6407skBHDx-gKkvyfBaUcZWk8eZQMRW2FeuVD9x_wbTYGVDmosZWTLal1WbWRW3A.jpg
            return decodeURIComponent(src.replace(/.*\/[^/]*[?&]src=([^&]*).*/, "$1"));
        }

        // p2.xiaohx.net
        // test urls can be found, but all are 403, even from the website
        // https://www.xiaohx.org/ (new address)
        // https://ftp.vpnx.cn:8080/WNZMFU.jpg
        /*if (domain.search(/p[0-9]*\.xiaohx\.net/) >= 0) {
            // http://p2.xiaohx.net/thumb/VZlQhgoo1.jpg
            //   http://p2.xiaohx.net/VZlQhgoo1.jpg
            return src.replace("/thumb/", "/");
        }*/

        // img1.doubanio.com
        if (domain_nosub === "doubanio.com" &&
            domain.match(/^img[0-9]*\./)) {
            // https://img3.doubanio.com/lpic/s26811681.jpg
            //   https://img3.doubanio.com/opic/s26811681.jpg
            // https://img3.doubanio.com/img/musician/small/24961.jpg
            //   https://img3.doubanio.com/img/musician/large/24961.jpg
            // https://img3.doubanio.com/pview/event_poster/large/public/ac898415e6278f1.jpg
            //   https://img3.doubanio.com/pview/event_poster/raw/public/ac898415e6278f1.jpg
            return src
                .replace(/\/[a-z]+(\/public\/[a-f0-9]+\.[^/.]*)$/, "/raw$1")
                .replace(/\/(?:small|medium)\//, "/large/")
                .replace(/\/[a-z]pic\//, "/opic/");
        }

        if (domain === "img.idol001.com") {
            // https://img.idol001.com/thumbnail/2014/12/14/e7e8a98d3a6553e71c3014549e07c7301418560761.jpg
            //   https://img.idol001.com/origin/2014/12/14/e7e8a98d3a6553e71c3014549e07c7301418560761.jpg
            // http://img.idol001.com/origin/2017/07/12/a4b9f31547c1a41a36606d1f6d94ceff1499865415_watermark.jpg
            //   http://img.idol001.com/origin/2017/07/12/a4b9f31547c1a41a36606d1f6d94ceff1499865415.jpg
            return src
                .replace(/^(.*?idol001\.com\/)[^/]*\//, "$1origin/")
                .replace(/(\/[0-9a-f]+)_watermark(\.[^/.]*)$/, "$1$2");
        }

        // for media.nrj.fr
        // http://media.nrj.fr/1900x1200/2017/11/selena-gomez-et-ariana-grande_7134.jpg
        // http://media.nrj.fr/800x600/2017/12/cover-ariana-grande-jpg5981_1375899.jpg
        // http://media.nrj.fr/436x327/113-jpg_200414.jpg
        // http://media.nrj.fr/1400x1400/2017/09/guillaume-radio-podcasts-_388327.jpg
        // http://media.nrj.fr/360x270/2017/07/julien-dore_5171.jpg
        // http://media.nrj.fr/300x500/2015/08/11907170-1042189502503923-8150073793944711126-n-jpg-9164253.jpg
        // http://media.nrj.fr/160x120/2014/10/logodjbuzz-3159-1111-8790_8361.jpg
        // http://media.nrj.fr/manu69/2017/06/fugitif-paris-2.jpg
        // http://media.nrj.fr/217x326/2013/05/the-big-bang-theory-penny_9252.jpg
        // http://media.nrj.fr/200x150/2017/01/cover-kanye-west-jpg638_1351247.jpg
        // http://image-api.nrj.fr/02_5a02579e3cb49.png?w=730&h=410
        //   http://image-api.nrj.fr/02_5a02579e3cb49.png
        // http://image-api.nrj.fr/une-chance-sur-deux_5a7ad778514a1.jpg
        // http://image-api.nrj.fr/6-jobs-etudiants-qui-recrutent-en-periode-de-fetes-istock-519555835_584fb5cc450ec.jpg
        // http://players.nrjaudio.fm/live-metadata/player/img/600x/196622-202066.JPG
        // http://www.nrj.fr/img/nrjactive/orientation/motivations/relever_des_defis.jpg
        // http://cdn.nrj-platform.fr/uploads/pages/58c59bc78b042_capture-d-cran-2017-03-12--20-03-22.jpg
        // while it can be downscaled, it can't be upscaled, can't find any other pattern
        if (domain === "image-api.nrj.fr" &&
            src.indexOf("/http/") >= 0) {
            // http://image-api.nrj.fr/http/players.nrjaudio.fm%2Flive-metadata%2Fplayer%2Fimg%2Fplayer-files%2Fnrj%2Flogos%2F640x640%2FP_logo_NRJ_wr_La_Playlist_du_jeudi_New.png?w=360&h=360
            //   http://players.nrjaudio.fm/live-metadata/player/img/player-files/nrj/logos/640x640/P_logo_NRJ_wr_La_Playlist_du_jeudi_New.png
            return "http://" + decodeURIComponent(src.replace(/.*\.nrj\.fr\/http\/([^/?&]*).*/, "$1"));
        }

        if (domain_nowww === "norwalkreflector.com" &&
            src.indexOf("/image/") >= 0) {
            // http://www.norwalkreflector.com/image/2018/06/25/x700_q30/Scott-Hamernik-badge.jpg
            //   http://www.norwalkreflector.com/image/2018/06/25/Scott-Hamernik-badge.jpg
            return src.replace(/(\/image\/[0-9]*\/[0-9]*\/[0-9]*\/)[^/]*\/([^/]+)$/, "$1$2");
        }

        if (domain === "assets.bwbx.io") {
            // https://assets.bwbx.io/images/users/iqjWHBFdfxIU/iY0p6s6mL24Q/v3/800x-1.png
            //   https://assets.bwbx.io/images/users/iqjWHBFdfxIU/iY0p6s6mL24Q/v3/-1x-1.png
            return src.replace(/\/[0-9]*x(-[0-9]*\.[^/]*)$/, "/-1x$1");
        }

        if (domain === "file.osen.co.kr") {
            // http://file.osen.co.kr/article_thumb/2018/01/25/201801251451774572_5a6975efc76bc_120x68.jpg
            //   http://file.osen.co.kr/article/2018/01/25/201801251451774572_5a6975efc76bc.jpg
            return src.replace("/article_thumb/", "/article/").replace(/_[0-9]+x(?:[0-9]+)?(\.[^/.]*)$/, "$1");
        }

        if (domain === "thumbnews.nateimg.co.kr") {
            // http://thumbnews.nateimg.co.kr/news130/http://news.nateimg.co.kr/orgImg/nn/2018/03/30/201803302311296710_1.jpg
            //   http://news.nateimg.co.kr/orgImg/nn/2018/03/30/201803302311296710_1.jpg
            // http://thumbnews.nateimg.co.kr/mnews105/http://news.nateimg.co.kr/orgImg/dh/2018/03/30/b38bab99257a78968bceed1266895c20.jpg
            //   http://news.nateimg.co.kr/orgImg/dh/2018/03/30/b38bab99257a78968bceed1266895c20.jpg
            return src.replace(/.*\/(?:view|m?news)[0-9]*\//, "");
        }

        if (domain === "thumb.pann.com") {
            // http://thumb.pann.com/tc_100x75/http://fimg4.pann.com/new/download.jsp?FileID=45339728
            //   http://fimg4.pann.com/new/download.jsp?FileID=45339728
            return src.replace(/^[a-z]+:\/\/[^/]*\/[^/]*\//, "");
        }

        if (domain_nosub === "nate.com" && domain.indexOf(".video.nate.com") >= 0) {
            // http://mpmedia003.video.nate.com/img/thumb/75_57/006/76/00/0F/B_20180413100402594366711006.jpg
            //   http://mpmedia003.video.nate.com/img/006/76/00/0F/B_20180413100402594366711006.jpg
            return src.replace(/\/img\/thumb\/[0-9]+[^/]*\//, "/img/");
        }

        if (false && domain.indexOf("img.sedaily.com") >= 0) {
            // http://www.sedaily.com/Photo/Gallery/Viewer/2154#48592
            //   http://img.sedaily.com/Photo/Gallery/2018/05/2154_b.jpg
            //     http://img.sedaily.com/Photo/Gallery/2018/05/2154.jpg -- completely different picture
            //   http://img.sedaily.com/Photo/Unit/2018/05/48592_s.jpg
            //     http://img.sedaily.com/Photo/Unit/2018/05/48592.jpg -- proper
            // http://img.sedaily.com/Photo/Gallery/2018/05/2149_b.jpg
            //   http://img.sedaily.com/Photo/Gallery/2018/05/2149.jpg -- works
            //   http://img.sedaily.com/Photo/Unit/2018/05/48368.jpg -- same
            // http://newsimg.sedaily.com/2018/05/20/1RZLV7PG9Q_2_m.jpg
            //   http://newsimg.sedaily.com/2018/05/20/1RZLV7PG9Q_2.jpg -- works
            // http://newsimg.sedaily.com/2018/06/15/1S0TG51GGK_1_m.jpg
            //   http://newsimg.sedaily.com/2018/06/15/1S0TG51GGK_1.jpg -- works
            return src.replace(/(\/[0-9]*)_[^/.]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "stat.ameba.jp" ||
            domain === "stat.profile.ameba.jp") {
            return src.replace(/\/t[0-9]*_([^/]*)$/, "/o$1");
        }

        //if (domain === "livedoor.blogimg.jp") {
        if (domain_nosub === "blogimg.jp" ||
            // http://image.news.livedoor.com/newsimage/stf/5/6/5634f_249_20180424039-m.jpg
            //   http://image.news.livedoor.com/newsimage/stf/5/6/5634f_249_20180424039.jpg
            domain === "image.news.livedoor.com") {
            // http://lineofficial.blogimg.jp/en/imgs/c/5/c5832999-s.png
            //   http://lineofficial.blogimg.jp/en/imgs/c/5/c5832999.png
            return src.replace(/(\/[^/.]*)-[^/.]*(\.[^/.]*)/, "$1$2");
        }

        if (domain === "image.cine21.com") {
            // http://image.cine21.com/resize/IMGDB/people/2004/0504/large/105535_spe45[H800-].jpg?H300
            //   http://image.cine21.com/IMGDB/people/2004/0504/large/105535_spe45.jpg
            // http://image.cine21.com/resize/cine21/still/2017/1213/11_39_08__5a3092cc9f638[X50,60].jpg
            //   http://image.cine21.com/cine21/still/2017/1213/11_39_08__5a3092cc9f638.jpg
            // http://image.cine21.com/resize/cine21/poster/2005/0603/M0010044_1[F230,329].jpg
            //   http://image.cine21.com/cine21/poster/2005/0603/M0010044_1.jpg
            return src
                .replace("/resize/", "/")
                .replace(/\/(?:small|medium)(\/[^/]*)$/, "/large$1")
                .replace(/\?.*$/, "")
                .replace(/\[[WH][-0-9]*\](\.[^/.]*)$/, "$1")
                .replace(/\[[XF][0-9]+,[0-9]+\](\.[^/.]*)$/, "$1");
        }

        if (domain === "cdnimg.melon.co.kr" ||
            domain === "cmtimg.melon.co.kr"/* &&
            (src.indexOf("/images/") >= 0 ||
             src.indexOf("/image/") >= 0 ||
             src.indexOf("/user_images/") >= 0)*/) {
            // http://cdnimg.melon.co.kr/svc/user_images/plylst/2016/12/21/56/425022806_org.jpg?tm=20171210105300/melon/resize/x262/quality/100/optimize
            //   http://cdnimg.melon.co.kr/svc/user_images/plylst/2016/12/21/56/425022806_org.jpg
            // http://cdnimg.melon.co.kr/cm/album/images/003/74/978/374978_500.jpg/melon/resize/120/quality/80/optimize
            //   http://cdnimg.melon.co.kr/cm/album/images/003/74/978/374978_org.jpg
            // http://cdnimg.melon.co.kr/cm/artistcrop/images/006/72/337/672337_500.jpg?f88c5a23497a77f68d8ac296e218db02/melon/resize/416/quality/80/optimize
            //   http://cdnimg.melon.co.kr/cm/artistcrop/images/006/72/337/672337_org.jpg
            // http://cdnimg.melon.co.kr/cm/artistcrop/images/010/24/317/1024317_500.jpg

            // http://cdnimg.melon.co.kr/cm/mv/images/43/501/78/990/50178990_1_640.jpg/melon/quality/80/resize/144/optimize
            //   http://cdnimg.melon.co.kr/cm/mv/images/43/501/78/990/50178990_1_org.jpg

            // http://cdnimg.melon.co.kr/svc/images/main/imgUrl20180123110250.jpg/melon/quality/80
            //   http://cdnimg.melon.co.kr/svc/images/main/imgUrl20180123110250.jpg

            // http://cdnimg.melon.co.kr/resource/mobile40/cds/event/image/201711/mixnine/artist/079.jpg/melon/quality/80/resize/134/optimize

            // http://cmtimg.melon.co.kr/20180331/542/52/233808_0483.png/melon/resize/192x192/quality/80/optimize
            newsrc = src.replace(/(\.[a-zA-Z]+)\/melon\/.*/, "$1");
            if (newsrc !== src)
                return newsrc;

            if (src.indexOf("/images/main/") >= 0) {
                return src.replace(/(images\/.*\/[^/_]*)((_[^/.]*)_)?(_?[^/._]*)?(\.[^/.?]*)(?:[?/].*)?$/, "$1$3$5");
            } else {
                return src.replace(/(images\/.*\/[^/_]*)((_[^/.]*)_)?(_?[^/._]*)?(\.[^/.?]*)(?:[?/].*)?$/, "$1$3_org$5");
            }
        }

        // itunes, is4-ssl.mzstatic.com
        if (domain_nosub === "mzstatic.com" && domain.match(/is[0-9](-ssl)?\.mzstatic\.com/) &&
            src.indexOf("/image/thumb/") >= 0) {
            // https://is3-ssl.mzstatic.com/image/thumb/Music111/v4/e1/dc/68/e1dc6808-6d55-1e38-a34d-a3807d488859/191061355977.jpg/1200x630bb.jpg
            //   https://is3-ssl.mzstatic.com/image/thumb/Music111/v4/e1/dc/68/e1dc6808-6d55-1e38-a34d-a3807d488859/191061355977.jpg/999999999x0w.jpg
            // http://is4.mzstatic.com/image/thumb/Music6/v4/4e/92/37/4e923792-948a-ae3a-dc5b-b7416c23807a/source/165x165bb.jpg
            //   http://is4.mzstatic.com/image/thumb/Music6/v4/4e/92/37/4e923792-948a-ae3a-dc5b-b7416c23807a/source/999999999x0w.jpg
            // http://a3.mzstatic.com/us/r30/Video/v4/3e/8a/b0/3e8ab028-45f5-a0dd-6a6f-84daf9f93a11/101_Dalmatians_E-Distribution_Standard_Electronic_Apple_Taiwan.jpg
            // https://s1.mzstatic.com/eu/r30/Purple71/v4/a6/be/93/a6be93ed-e301-5e91-68c2-2c5df31a4b8a/sc2732x2048.jpeg
            // http://is5.mzstatic.com/image/thumb/Music62/v4/0b/1f/36/0b1f364c-cc8f-1c8c-74a4-70cfb01d8ef4/source/100000x100000-999.jpg
            return src.replace(/\/[0-9]*x[0-9]*[a-z]*(?:-[0-9]+)?(\.[^/.]*)$/, "/999999999x0w$1");
        }

        if (domain_nosub === "alicdn.com" &&
            (domain.match(/[0-9]*\.alicdn\.com/) ||
             //domain.match(/sc[0-9]*\.alicdn\.com/) ||
             domain === "img.alicdn.com")) {
            // https://ae01.alicdn.com/kf/HTB1AMo8a4uaVKJjSZFjq6AjmpXai/BINYEAE-new-CD-seal-State-of-Grace-Paul-Schwartz-Lisbeth-Scott-CD-disc-free-shipping.jpg_640x640.jpg
            //   https://ae01.alicdn.com/kf/HTB1AMo8a4uaVKJjSZFjq6AjmpXai/BINYEAE-new-CD-seal-State-of-Grace-Paul-Schwartz-Lisbeth-Scott-CD-disc-free-shipping.jpg
            // https://ae01.alicdn.com/kf/HT1N7knFG0dXXagOFbXQ/220255879/HT1N7knFG0dXXagOFbXQ.jpg?size=209686&height=1472&width=970&hash=b068627a285860c5226596bada694403
            //   https://ae01.alicdn.com/kf/HT1N7knFG0dXXagOFbXQ/220255879/HT1N7knFG0dXXagOFbXQ.jpg
            return src
                .replace(/_[0-9]+x[0-9]+[^/]*?$/, "")
                .replace(/\?.*/, "");
        }

        if (domain_nosub === "1818lao.com" &&
            domain.match(/^i[0-9]*\./)) {
            // http://i0.1818lao.com/aliexpress1/kf/HTB1PMR.QXXXXXaAXVXXq6xXFXXXP/anime-swimsuits-Cosplay-Costume-D-VA-SUKUMIZU-Spandex-Swimsuit-DVA-Costume-anime-cosplay-Su-ku-water.jpg
            //   http://ae01.alicdn.com/kf/HTB1PMR.QXXXXXaAXVXXq6xXFXXXP/anime-swimsuits-Cosplay-Costume-D-VA-SUKUMIZU-Spandex-Swimsuit-DVA-Costume-anime-cosplay-Su-ku-water.jpg -- no watermark
            return src.replace(/:\/\/[^/]*\/aliexpress[0-9]*(\/kf\/)/, "://ae01.alicdn.com$1");
        }

        if (domain === "thumbor.forbes.com") {
            return decodeURIComponent(src.replace(/.*\/([^/]*%3A%2F%2F[^/]*).*/, "$1"));
        }

        if (domain === "lastfm-img2.akamaized.net") {
            return src.replace(/\/i\/u\/[^/]*\//, "/i/u/");
        }

        if (domain_nosub === "myspacecdn.com" &&
            domain.match(/a[0-9](?:\...)?-images\.myspacecdn\.com/)) {
            // http://a2.ec-images.myspacecdn.com/images02/152/52c2d549e3a647199831fab8c34c2b92/l.jpg
            //   http://a2.ec-images.myspacecdn.com/images02/152/52c2d549e3a647199831fab8c34c2b92/full.jpg
            // https://a3-images.myspacecdn.com/images01/3/06c1249fcc1441046241101fa905b56b/300x300.jpg
            //   https://a3-images.myspacecdn.com/images01/3/06c1249fcc1441046241101fa905b56b/full.jpg
            return src.replace(/\/[^/.]*(\.[^/.]*)$/, "/full$1");
        }

        // https://geo-media.beatport.com/image_size/250x250/e6997bab-e115-41b2-acab-3cae7bcf3615.jpg
        if (domain === "geo-media.beatport.com") {
            return src.replace(/\/image_size\/[0-9]*x[0-9]*\//, "/image_size/0x0/");
        }

        if (domain_nosub === "tumblr.com" &&
            domain.indexOf("media.tumblr.com") > 0) {
            // some gifs don't play properly (same case with raw?)
            // handle this?
            // https://78.media.tumblr.com/25e643db76a1e626ff4e79faa2f7bb3d/tumblr_inline_mvspvogcB51sq8rci.jpg
            // https://static.tumblr.com/2074b5c013a08663cbfe4f86f54aad99/b70lpcc/m9Vnkyvyw/tumblr_static_d04dkibmyqokwgwsgcwggkowg.jpg
            // https://static.tumblr.com/978c2da2706d61fcdc5a13083a05c70c/yffueik/n9Znvprsi/tumblr_static_bp7fdwcxpbwc8k440ksocks8c.png
            // https://static.tumblr.com/rpaguup/J6wmdtouh/tumblr_mdipupjoku1r2xx88o1_500.png
            //   http://data.tumblr.com/rpaguup/J6wmdtouh/tumblr_mdipupjoku1r2xx88o1_raw.png -- doesn't work
            // http://media.tumblr.com/tumblr_m94wh56woC1ro0opg.png
            // http://media.tumblr.com/bbeec3764efd6b63c14fe1e56f4f5b22/tumblr_inline_mn9bgayRCZ1qz4rgp.png
            // http://media.tumblr.com/cd90bd6fe3989956567f086153430e4c/tumblr_inline_mimvhtpoYw1qz4rgp.gif
            // https://78.media.tumblr.com/tumblr_m2p6yiRZNR1qha0cy.gif
            // http://media.tumblr.com/tumblr_mah067upzv1rtyo86.gif
            // https://static.tumblr.com/ae53741763a8e9a937e587fd71c24ee5/065fclu/Okon9yxx0/tumblr_static_filename_640_v2.jpg
            // https://static.tumblr.com/9d9cb03d00947212897f5fa390615bb1/szhmsgg/PW8ok7jgi/tumblr_static_tumblr_static__640.jpg
            // https://static.tumblr.com/9873073729f37d9fb36dce1576f1f3ee/gtqzlnb/34Ync89wm/tumblr_static_tumblr_static_79qnyyc3l2os0c84swcswowks_640.gif
            //
            // working gifs:
            // https://78.media.tumblr.com/4b9573a2fdd97a6e6cac771d4a0c0edd/tumblr_ntg9jreu9X1s5q5l6o4_400.gif
            //   http://data.tumblr.com/4b9573a2fdd97a6e6cac771d4a0c0edd/tumblr_ntg9jreu9X1s5q5l6o4_raw.gif
            // https://78.media.tumblr.com/e7976904bb598ed701324ee471056156/tumblr_ntg9jreu9X1s5q5l6o3_400.gif
            //   http://data.tumblr.com/e7976904bb598ed701324ee471056156/tumblr_ntg9jreu9X1s5q5l6o3_raw.gif
            // https://78.media.tumblr.com/2d799573226814e336e0984263269507/tumblr_nwe2hfH0dX1u9vqklo1_250.gif
            //   https://s3.amazonaws.com/data.tumblr.com/2d799573226814e336e0984263269507/tumblr_nwe2hfH0dX1u9vqklo1_raw.gif
            // https://78.media.tumblr.com/tumblr_lyqq4hsfo01qdphnvo1_500.gif
            //   https://78.media.tumblr.com/tumblr_lyqq4hsfo01qdphnvo1_1280.gif
            //
            // semi-working gifs: (thanks to rEnr3n on github)
            // https://78.media.tumblr.com/b6a2ed8abae3e9f0a64ccc5bd14b5bbf/tumblr_n8w8k50vpR1r3kk98o1_250.gif -- works
            //
            // https://78.media.tumblr.com/a1dfad9537af0e38063ec186e2ff392e/tumblr_n87ft44o4Y1r3kk98o1_250.gif -- works
            //   https://78.media.tumblr.com/a1dfad9537af0e38063ec186e2ff392e/tumblr_n87ft44o4Y1r3kk98o1_500.gif -- doesn't work
            //   https://78.media.tumblr.com/a1dfad9537af0e38063ec186e2ff392e/tumblr_n87ft44o4Y1r3kk98o1_1280.gif -- doesn't work
            //   https://s3.amazonaws.com/data.tumblr.com/a1dfad9537af0e38063ec186e2ff392e/tumblr_n87ft44o4Y1r3kk98o1_raw.gif -- works
            // https://78.media.tumblr.com/b6a2ed8abae3e9f0a64ccc5bd14b5bbf/tumblr_n8w8k50vpR1r3kk98o1_250.gif
            //
            // non-working gifs: (all sizes don't work, except for _raw, credit to rEnr3n again for finding these)
            // https://78.media.tumblr.com/102fca5704db6aa1cc5e56ed7d9aa369/tumblr_n5ltfvGJC51r3kk98o1_250.gif
            //   https://s3.amazonaws.com/data.tumblr.com/102fca5704db6aa1cc5e56ed7d9aa369/tumblr_n5ltfvGJC51r3kk98o1_raw.gif -- works
            // https://78.media.tumblr.com/257cce1bd6ec64e56b1c55129ddc547d/tumblr_n5lbkmnp5g1r3kk98o1_250.gif
            //   https://s3.amazonaws.com/data.tumblr.com/257cce1bd6ec64e56b1c55129ddc547d/tumblr_n5lbkmnp5g1r3kk98o1_raw.gif -- works
            //
            // raw doesn't work:
            // https://78.media.tumblr.com/9968a8dffa5ade4eeaf6a77a1f5323e3/tumblr_inline_oca234l0kV1sszmh4_500.gif
            //   https://s3.amazonaws.com/data.tumblr.com/9968a8dffa5ade4eeaf6a77a1f5323e3/tumblr_inline_oca234l0kV1sszmh4_raw.gif

            // https://78.media.tumblr.com/4efd905dfc517da760d1d53f98b5c5d4/tumblr_oy8m3u1aR01tsmy5xo1_1280.pnj
            //   https://78.media.tumblr.com/4efd905dfc517da760d1d53f98b5c5d4/tumblr_oy8m3u1aR01tsmy5xo1_1280.png
            //   https://s3.amazonaws.com/data.tumblr.com/4efd905dfc517da760d1d53f98b5c5d4/tumblr_oy8m3u1aR01tsmy5xo1_raw.png
            // https://78.media.tumblr.com/b05b512a57c51e5ead1be5159d28b428/tumblr_p8665hUaJv1sejmmmo2_540.gifv
            //   https://78.media.tumblr.com/b05b512a57c51e5ead1be5159d28b428/tumblr_p8665hUaJv1sejmmmo2_540.gif
            //   https://s3.amazonaws.com/data.tumblr.com/b05b512a57c51e5ead1be5159d28b428/tumblr_p8665hUaJv1sejmmmo2_raw.gif
            newsrc = src
                .replace(/\.pnj(\?.*)?$/, ".png$1")
                .replace(/\.gifv(\?.*)?$/, ".gif$1");
            if (newsrc !== src)
                return newsrc;

            // due to recent updates disabling _raw, until something is found, _1280 will have to suffice
            if (!src.match(/_[0-9]*\.gif$/))
                return src.replace(/(\/tumblr_[0-9a-zA-Z]+)_[0-9]*(\.[^/.]*)$/, "$1_1280$2");

            // disable _raw for now, unless something is found
            if (src.match(/:\/\/[^/]*\/[0-9a-f]*\/tumblr_[0-9a-zA-Z]+(?:_r[0-9]+)?_[0-9]+\.[^/]*$/) && false) {
                // https://78.media.tumblr.com/3ebf4c3e175553194b3c9a0867a47719/tumblr_nugefiK7yj1u0c780o1_500.jpg
                //   http://data.tumblr.com/3ebf4c3e175553194b3c9a0867a47719/tumblr_nugefiK7yj1u0c780o1_raw.jpg
                // https://78.media.tumblr.com/96a4d0ab5a1e05ecc6f3eb638a5504a5/tumblr_oxin3qLmFS1spqhdqo7_500.jpg
                //   http://data.tumblr.com/96a4d0ab5a1e05ecc6f3eb638a5504a5/tumblr_oxin3qLmFS1spqhdqo7_raw.jpg -- width of 1400 (vs 1280)
                return src
                    .replace(/:\/\/[^/]*\/(.*)_[0-9]*(\.[^/.]*)$/, "://s3.amazonaws.com/data.tumblr.com/$1_raw$2");
            } else if (src.match(/:\/\/[^/]*\/[^/]*$/)) {
                // https://78.media.tumblr.com/tumblr_m4fhyoiFd51rqmd7mo1_500.jpg
                //   https://78.media.tumblr.com/tumblr_m4fhyoiFd51rqmd7mo1_1280.jpg
                if (!src.match(/_[0-9]*\.gif$/)) // disable gif support as it's notoriously problematic
                    return src.replace(/_[0-9]*(\.[^/.]*)$/, "_1280$1");
            }
        }

        // many broken URLs, need to revamp can_head so it doesn't redirect
        if (domain === "wc-ahba9see.c.sakurastorage.jp" && false) {
            if (src.indexOf("/max-1200/") >= 0) {
                // https://wc-ahba9see.c.sakurastorage.jp/max-1200/59530/e929c45f84ace23cf416c2b6fc1c1eacb34f20bf-350x600.jpg
                //   https://wc-ahba9see.c.sakurastorage.jp/max-1200/59530/e929c45f84ace23cf416c2b6fc1c1eacb34f20bf-1200.jpg
                return {
                    url: src.replace(/-[0-9a-z]+(\.[^/.]*)$/, "-1200$1"),
                    can_head: false
                };
            } else {
                // https://wc-ahba9see.c.sakurastorage.jp/533191/ebqzwxdflpsovyghbvfmpvzowripdfdorrlkwogi-350x600.jpg
                //   https://wc-ahba9see.c.sakurastorage.jp/533191/ebqzwxdflpsovyghbvfmpvzowripdfdorrlkwogi-3000.jpg
                // doesn't work:
                // https://wc-ahba9see.c.sakurastorage.jp/40021/5a4bd340b2c95e674a1816f9adece947d06b1df2-100.jpg
                //   https://wc-ahba9see.c.sakurastorage.jp/40021/5a4bd340b2c95e674a1816f9adece947d06b1df2-3000.jpg -- 404
                return {
                    url: src.replace(/-[0-9a-z]+(\.[^/.]*)$/, "-3000$1"),
                    can_head: false,
                    headers: {
                        Referer: ""
                    }
                };
            }
        }

        if (domain === "www.nautiljon.com" &&
            src.match(/\/images[a-z]*\//)) {
            // https://www.nautiljon.com/imagesmin/anime/00/48/kuroko_no_basket_2184.jpg?1517340247
            //   https://www.nautiljon.com/images/anime/00/48/kuroko_no_basket_2184.jpg?1517340247
            // https://www.nautiljon.com/images/86x86/people/00/51/il_hoon_btob_33715.jpg?1520059769
            //   https://www.nautiljon.com/images/people/00/51/il_hoon_btob_33715.jpg?1520059769
            // https://www.nautiljon.com/images/actualite/00/68/medium/1525681783131_image.jpg -- 177x250
            //   https://www.nautiljon.com/images/actualite/00/68/large/1525681783131_image.jpg -- 638x900
            //   https://www.nautiljon.com/images/actualite/00/68/1525681783131_image.jpg -- 680x960
            return src
                .replace(/\/imagesmin\//, "/images/")
                .replace(/\/images\/[0-9]+x[0-9]+\//, "/images/")
                .replace(/\/mini\/([^/]*)$/, "/$1")
                .replace(/(\/[0-9]+\/[0-9]+\/)[a-z]+\/([^/]*)$/, "$1$2");
        }

        // wall street journal:
        // A, C, D, (E,F), G, H, P, J, M
        // https://s.wsj.net/public/resources/images/BN-WV466_rotiss_A_20180103172646.jpg
        // https://s.wsj.net/public/resources/images/BN-WV466_rotiss_C_20180103172646.jpg
        // https://s.wsj.net/public/resources/images/BN-WV466_rotiss_D_20180103172646.jpg
        // https://s.wsj.net/public/resources/images/BN-WV466_rotiss_G_20180103172646.jpg
        // https://s.wsj.net/public/resources/images/BN-WV466_rotiss_M_20180103172646.jpg
        //
        // https://s.wsj.net/public/resources/images/BN-WV815_3m8WN_M_20180104143735.jpg
        // https://si.wsj.net/public/resources/images/BN-WV794_apples_M_20180104140237.jpg (s.wsj.net works too)
        //
        // doesn't support J or M:
        //
        // A, C, D, E, F, G, P
        // https://s.wsj.net/public/resources/images/OB-YL084_KoreaC_G_20130805214258.jpg
        // https://s.wsj.net/public/resources/images/OB-YL082_KoreaC_P_20130805213748.jpg
        //
        // so far it seems that P is the largest common one, but M can be larger. maybe date has something to do with it?
        //
        // other:
        // https://si.wsj.net/public/resources/images/BN-WW013_0105KO_Z120_20180104213322.jpg
        // Z120 works with "newer" urls, but not with older ones (Z0, Z100, etc. don't work)
        //
        // https://art.wsj.net/api/photos/gams-files/BN-WV826_3fHQP_A_20180104144705.jpg?width=110&height=73
        // https://s.wsj.net/public/resources/images/BN-WV826_3fHQP_A_20180104144705.jpg
        // width=0&height=0 returns a 1x1, same for width=-1&height=-1. width=8000&height=8000 results in a zoomed in image (but rather high quality nonetheless)
        // https://art.wsj.net/api/photos/gams-files/BN-WV826_3fHQP_A_20180104144705.jpg (invalid, since it requires parameters) results in:
        // {"message":"No HTTP resource was found that matches the request URI 'http://art.wsj.net/api/photos/gams-id:3fHQP/smartcrop?crophint=A'.","messageDetail":"No action was found on the controller 'PhotoApi' that matches the request."}
        // http://art.wsj.net/api/photos/gams-id:3fHQP/smartcrop
        // {"message":"No HTTP resource was found that matches the request URI 'http://art.wsj.net/api/photos/gams-id:3fHQP/smartcrop'.","messageDetail":"No action was found on the controller 'PhotoApi' that matches the request."}
        // http://art.wsj.net/api/photos/gams-id:3fHQP - works!
        //
        // https://art.wsj.net/api/photos/gams-files/BN-WV815_3m8WN_A_20180104143735.jpg?width=110&height=61
        // https://art.wsj.net/api/photos/gams-id:3m8WN
        //
        // id is base62 using 0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ as the alphabet
        //
        // most don't work with this though
        //
        // https://si.wsj.net/public/resources/images/BN-KS721_GerryB_AM_20151013072049.jpg
        // M doesn't work, but P does (conversely, AM doesn't work with some old images, but seems to work with newer ones)
        // https://si.wsj.net/public/resources/images/BN-WV959_SYRDET_ER_20180104172634.jpg
        // https://s.wsj.net/public/resources/images/BN-WU361_SZA_01_D_20171229145931.jpg

        if (domain === "art.wsj.net") {
            if (src.indexOf("/api/photos/gams-files/") >= 0) {
                return src.replace(/\/gams-files\/[^-_/.]*-[^-_/.]*_([^/_.]*)_.*$/, "/gams-id:$1");
            }

            if (src.indexOf("/api/photos/gams-id:") >= 0) {
                return src.replace(/(\/gams-id:[^/]*)\/.*$/, "$1");
            }
        }

        if (domain_nosub === "fanpop.com" &&
            domain.match(/images[0-9]*\.fanpop\.com/)) {
            // http://images6.fanpop.com/image/photos/33100000/Zetsuen-No-Tempest-zetsuen-no-tempest-33126825-2048-2970.jpg
            //   http://images6.fanpop.com/image/photos/33100000/Zetsuen-No-Tempest-zetsuen-no-tempest-33126825.jpg
            // http://images1.fanpop.com/images/image_uploads/cf-calista-flockhart-912712_525_700.jpg
            //   http://images1.fanpop.com/images/image_uploads/cf-calista-flockhart-912712.jpg
            // http://images.fanpop.com/images/image_uploads/Emma-Watson--emma-watson-95242_500_400.jpg
            //   http://images.fanpop.com/images/image_uploads/Emma-Watson--emma-watson-95242.jpg
            // http://images6.fanpop.com/image/answers/3197000/3197239_1364966408102.53res_426_300.jpg
            //
            // http://images6.fanpop.com/image/photos/38000000/Zayn-Malik-2015-one-direction-38049270-2121-2500.jpg
            //   http://images6.fanpop.com/image/photos/38000000/Zayn-Malik-2015-one-direction-38049270.jpg - doesn't work
            return src
                .replace(/([0-9]+)-[0-9]+-[0-9]+(\.[^/.]*)$/, "$1$2")
                .replace(/([0-9]+)_[0-9]+_[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "image.jimcdn.com") {
            // https://image.jimcdn.com/app/cms/image/transf/dimension=299x10000:format=png/path/s07f3459425dd27f2/image/i23aaf7ddb2a0e16d/version/1471508912/image.png
            //   https://image.jimcdn.com/app/cms/image/transf/none/path/s07f3459425dd27f2/image/i23aaf7ddb2a0e16d/version/1471508912/image.png
            // https://github.com/thumbor/thumbor/issues/564
            return src.replace(/(\/app\/cms\/image\/transf\/)[^/]*\//, "$1none/");
        }

        // useless, nearly impossible to test due to redirects
        if (false && domain === "u.jimdo.com") {
            // http://u.jimdo.com/www54/o/sef0c3710159530fc/img/i314f3a735d2ffdcc/1406803251/std/image.jpg
            //   https://image.jimcdn.com/app/cms/image/transf/none/path/sef0c3710159530fc/image/i314f3a735d2ffdcc/version/1440585179/cara-delevingne-wird-neues-kampagnengesicht-des-brit-labels-topshop.jpg
            return src.replace(/:\/\/[^/]*\/www[0-9]*\/[a-z]\/([0-9a-z]+)\/img\/(i[0-9a-f]+)\/([0-9]+)\/[^/]*\/([^/]\.[^/.]*)$/,
                               "://image.jimcdn.com/app/cms/image/transf/none/path/$1/image/$2/version/$3/$4");
        }

        if (domain_nosub === "ladmedia.fr" &&
            (domain.match(/resize[0-9]*-[a-z]*\.ladmedia\.fr/) ||
             domain.match(/cdn[0-9]*-[a-z]*\.ladmedia\.fr/))) {
            // http://resize-parismatch.ladmedia.fr/r/625,417,center-middle,ffffff/img/var/news/storage/images/paris-match/people/meurtre-du-cousin-de-rihanna-un-suspect-en-detention-provisoire-1432127/23594795-1-fre-FR/Meurtre-du-cousin-de-Rihanna-un-suspect-en-detention-provisoire.jpg
            //   http://cdn-parismatch.ladmedia.fr/var/news/storage/images/paris-match/people/meurtre-du-cousin-de-rihanna-un-suspect-en-detention-provisoire-1432127/23594795-1-fre-FR/Meurtre-du-cousin-de-Rihanna-un-suspect-en-detention-provisoire.jpg
            // http://resize1-parismatch.ladmedia.fr/r/300,300,center-middle,ffffff/img/var/news/storage/images/paris-match/people-a-z/rihanna/5971706-8-fre-FR/Rihanna.jpg
            //   http://cdn-parismatch.ladmedia.fr/var/news/storage/images/paris-match/people-a-z/rihanna/5971706-8-fre-FR/Rihanna.jpg
            // http://resize1-doctissimo.ladmedia.fr/r/1010,,forcex/img/var/doctissimo/storage/images/fr/www/beaute/diaporamas/coiffure-de-star-coiffures-de-stars/coiffure-ciara/2440196-1-fre-FR/Le-Tie-Dye-rate-de-Ciara.jpg
            //   http://cdn-doctissimo.ladmedia.fr/var/doctissimo/storage/images/fr/www/beaute/diaporamas/coiffure-de-star-coiffures-de-stars/coiffure-ciara/2440196-1-fre-FR/Le-Tie-Dye-rate-de-Ciara.jpg
            // https://resize-public.ladmedia.fr/rcrop/140,104/img/var/public/storage/images/toutes-les-photos/photos-emilie-nef-naf-torride-en-tout-petit-bikini-wahiba-ribery-sous-le-choc-1469251/38549175-1-fre-FR/Photos-Emilie-Nef-Naf-torride-en-tout-petit-bikini-Wahiba-Ribery-sous-le-choc-!.jpg
            //   https://resize-public.ladmedia.fr/img/var/public/storage/images/toutes-les-photos/photos-emilie-nef-naf-torride-en-tout-petit-bikini-wahiba-ribery-sous-le-choc-1469251/38549175-1-fre-FR/Photos-Emilie-Nef-Naf-torride-en-tout-petit-bikini-Wahiba-Ribery-sous-le-choc-!.jpg
            //   https://cdn-public.ladmedia.fr/var/public/storage/images/toutes-les-photos/photos-emilie-nef-naf-torride-en-tout-petit-bikini-wahiba-ribery-sous-le-choc-1469251/38549175-1-fre-FR/Photos-Emilie-Nef-Naf-torride-en-tout-petit-bikini-Wahiba-Ribery-sous-le-choc-!.jpg
            // https://resize-elle.ladmedia.fr/r/625,,forcex/crop/625,625,center-middle,forcex,ffffff/img/var/plain_site/storage/images/loisirs/musique/news/selena-gomez-pourquoi-pose-t-elle-presque-nue-2982877/56148853-1-fre-FR/Selena-Gomez-pourquoi-pose-t-elle-presque-nue.png
            //   https://resize-elle.ladmedia.fr/crop/625,625,center-middle,forcex,ffffff/img/var/plain_site/storage/images/loisirs/musique/news/selena-gomez-pourquoi-pose-t-elle-presque-nue-2982877/56148853-1-fre-FR/Selena-Gomez-pourquoi-pose-t-elle-presque-nue.png
            //   https://resize-elle.ladmedia.fr/img/var/plain_site/storage/images/loisirs/musique/news/selena-gomez-pourquoi-pose-t-elle-presque-nue-2982877/56148853-1-fre-FR/Selena-Gomez-pourquoi-pose-t-elle-presque-nue.png
            //   https://cdn-elle.ladmedia.fr/var/plain_site/storage/images/loisirs/musique/news/selena-gomez-pourquoi-pose-t-elle-presque-nue-2982877/56148853-1-fre-FR/Selena-Gomez-pourquoi-pose-t-elle-presque-nue.png
            //
            // https://cdn2-public.ladmedia.fr/var/public/storage/images/news/photos/photos-rihanna-elle-nous-refait-le-coup-de-la-robe-fendue-et-ultra-decolletee-197341/rihanna-a-la-soiree-stella-mccartney-hier-soir-a-londres-197343/1701021-1-fre-FR/Rihanna-a-la-soiree-Stella-McCartney-hier-soir-a-Londres_portrait_w674.jpg
            //   https://cdn2-public.ladmedia.fr/var/public/storage/images/news/photos/photos-rihanna-elle-nous-refait-le-coup-de-la-robe-fendue-et-ultra-decolletee-197341/rihanna-a-la-soiree-stella-mccartney-hier-soir-a-londres-197343/1701021-1-fre-FR/Rihanna-a-la-soiree-Stella-McCartney-hier-soir-a-Londres.jpg
            return {
                url: src
                    .replace(/\/(?:r|crop|rcrop)\/[^/]*\//, "/")
                    .replace(/:\/\/resize[0-9]*-([a-z]+)[^/]*?\/img\/var\//, "://cdn-$1.ladmedia.fr/var/")
                    .replace(/_[a-z0-9_]+(\.[^/.]*)$/, "$1"),
                can_head: true
            };
        }

        if (domain_nosub === "imgbox.com" &&
            (domain.match(/^thumbs[0-9]*\./) ||
             domain.match(/images[0-9]*\./))) {
            // https://thumbs2.imgbox.com/6b/e7/rklghXlY_t.jpg
            //   https://images2.imgbox.com/6b/e7/rklghXlY_o.jpg
            // https://thumbs3.imgbox.com/63/1b/bUg59AO0_b.jpg
            //   https://images3.imgbox.com/63/1b/bUg59AO0_o.jpg
            // https://5-t.imgbox.com/H8mh6PYR.jpg
            //   https://thumbs3.imgbox.com/a5/e8/H8mh6PYR_t.jpg
            //   https://images3.imgbox.com/a5/e8/H8mh6PYR_o.jpg
            // https://1-t.imgbox.com/Q3x3sr3Z.jpg
            //   https://thumbs3.imgbox.com/9d/37/Q3x3sr3Z_t.jpg
            //   https://images3.imgbox.com/9d/37/Q3x3sr3Z_o.jpg
            // http://0.t.imgbox.com/eLFM9k0c.jpg
            //   https://thumbs3.imgbox.com/e4/3f/eLFM9k0c_t.jpg
            //   https://images3.imgbox.com/e4/3f/eLFM9k0c_o.jpg
            return src
                .replace(/\/thumbs([0-9]*)\.imgbox\.com\//, "/images$1.imgbox.com/")
                .replace(/_[a-z]*(\.[^/.]*)/, "_o$1");
        }

        if ((domain_nosub === "steamstatic.com" && domain.match(/cdn\.[^.]*\.steamstatic\.com/)) ||
            // https://steamcdn-a.akamaihd.net/steamcommunity/public/images/avatars/2c/2c43030ea4900ebfcd3c42a4e665e9d926b488ef_medium.jpg
            //   https://steamcdn-a.akamaihd.net/steamcommunity/public/images/avatars/2c/2c43030ea4900ebfcd3c42a4e665e9d926b488ef_full.jpg
            (domain_nosub === "akamaihd.net" && domain.match(/steamcdn(?:-[a-z]*)?\.akamaihd\.net/))) {
            // http://cdn.edgecast.steamstatic.com/steam/apps/405710/ss_8555059322d118b6665f1ddde6eaa987c54b2f31.600x338.jpg?t=1516755673
            //   http://cdn.edgecast.steamstatic.com/steam/apps/405710/ss_8555059322d118b6665f1ddde6eaa987c54b2f31.jpg?t=1516755673
            // http://cdn.akamai.steamstatic.com/steam/apps/678950/ss_cd54f0430e919020ce554f6cfa8d2f3b0d062716.600x338.jpg
            //   http://cdn.akamai.steamstatic.com/steam/apps/678950/ss_cd54f0430e919020ce554f6cfa8d2f3b0d062716.jpg
            // http://cdn.akamai.steamstatic.com/steamcommunity/public/images/avatars/c4/c44ec2d22a0c379d697c66b05e5ca8204827ce75.jpg
            //   http://cdn.akamai.steamstatic.com/steamcommunity/public/images/avatars/c4/c44ec2d22a0c379d697c66b05e5ca8204827ce75_full.jpg
            if (src.indexOf("/public/images/avatars/") >= 0) {
                src = src.replace(/(?:_[^/.]*)?(\.[^/.]*)$/, "_full$1");
            }
            return src.replace(/\.[0-9]+x[0-9]+(\.[^/]*)$/, "$1");
        }

        if (domain_nosub === "medium.com" &&
            (domain.match(/cdn-images-[0-9]*\.medium\.com/) ||
             domain === "miro.medium.com")) {
            // https://cdn-images-1.medium.com/fit/c/120/120/1*EBmQkTlD1aZEsZOHFiBcdg.png
            //   https://cdn-images-1.medium.com/1*EBmQkTlD1aZEsZOHFiBcdg.png
            // https://cdn-images-1.medium.com/max/800/1*BvC8Rvz4L-CLuK5Ou37qoA.png
            //   https://cdn-images-1.medium.com/1*BvC8Rvz4L-CLuK5Ou37qoA.png
            // https://miro.medium.com/fit/c/240/240/1*Znlrcvh2KRPP4xG_s9Bp7A@2x.jpeg
            //   https://miro.medium.com/1*Znlrcvh2KRPP4xG_s9Bp7A@2x.jpeg
            //return src.replace(/\/max\/[^/]*\//, "/");
            return src.replace(/(:\/\/[^/]*\/).*?\/([^/]*)$/, "$1$2");
        }

        if ((domain_nosub === "zimbio.com" ||
             domain_nosub === "stylebistro.com" ||
             domain_nosub === "livingly.com") &&
            domain.match(/www[0-9]*\.pictures\.(.*\.)?[a-z]+\.com/)) {
            // http://www4.pictures.zimbio.com/bg/Calista+Flockhart+2001+SAG+Awards+FuUveoCUR9_l.jpg
            //   http://www4.pictures.zimbio.com/bg/Calista+Flockhart+2001+SAG+Awards+FuUveoCUR9_x.jpg
            // http://www4.pictures.stylebistro.com/gi/HeEXH_STdIGx.jpg
            // http://www1.pictures.gi.zimbio.com/Katy+Perry+NRJ+Music+Awards+2009+uA-QnAhT6Wul.jpg
            //   http://www1.pictures.gi.zimbio.com/Katy+Perry+NRJ+Music+Awards+2009+uA-QnAhT6Wux.jpg
            // http://www3.pictures.fp.zimbio.com/Emma+Watson+Celebs+Set+Harry+Potter+Deathly+T2P80JadJBDl.jpg
            //   http://www3.pictures.fp.zimbio.com/Emma+Watson+Celebs+Set+Harry+Potter+Deathly+T2P80JadJBDx.jpg -- doesn't work?
            // x, l, m, p, s, c, t
            return src.replace(/[a-z](\.[^/.]*)$/, "x$1");
        }

        if (domain_nowww === "theplace2.ru" ||
            // https://www.theplace.ru/archive/jordyn_jones/img/jordyn_jones_social_media_03_26_2018_1_s.jpg
            //   https://theplace.ru/archive/jordyn_jones/img/jordyn_jones_social_media_03_26_2018_1.jpg
            domain_nowww === "theplace.ru" ||
            // http://image.chaojimote.com/FashionCorrelation/%E7%BB%B4%E5%A4%9A%E5%88%A9%E4%BA%9A%C2%B7%E5%98%89%E4%B8%9D%E8%92%82_VictoriaJustice(13)_s.jpg -- 220x330
            //   http://image.chaojimote.com/FashionCorrelation/%E7%BB%B4%E5%A4%9A%E5%88%A9%E4%BA%9A%C2%B7%E5%98%89%E4%B8%9D%E8%92%82_VictoriaJustice(13).jpg -- 1500x2250
            domain === "image.chaojimote.com" ||
            // http://moviepic.manmankan.com/yybpic/yanyuan/pic/12960/319665_s.jpg
            //   http://moviepic.manmankan.com/yybpic/yanyuan/pic/12960/319665.jpg
            domain === "moviepic.manmankan.com" ||
            domain === "img.star.iecity.com") {
            // https://www.theplace2.ru/archive/calista_flockhart/img/calista611924_s.jpg
            //   https://www.theplace2.ru/archive/calista_flockhart/img/calista611924.jpg
            // http://img.star.iecity.com/Upload/File/201707/29/20170729202504241_s.jpg
            newsrc = src.replace(/_[a-z](\.[^/.]*)$/, "$1");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nowww === "theplace2.ru" ||
            // https://www.theplace.ru/cache/forum/pics/rachelle_lefevre_at_fox_la_screenings_gala_in_los_angeles_0-gthumb-gwdata1200-ghdata1800-gfitdatamax.jpg
            //   https://www.theplace.ru/forum/pics/rachelle_lefevre_at_fox_la_screenings_gala_in_los_angeles_0.jpg
            domain_nowww === "theplace.ru") {
            // https://www.theplace2.ru/cache/archive/rihanna/img/488408753_10-gthumb-gwdata1200-ghdata1200-gfitdatamax.jpg
            //   https://www.theplace2.ru/archive/rihanna/img/488408753_10.jpg
            // https://www.theplace2.ru/cache/archive/jessica_stroup/img/Jessica_Stroup_dress-1-gthumb-gwdata1200-ghdata1200-gfitdatamax.jpg
            //   https://www.theplace2.ru/archive/jessica_stroup/img/Jessica_Stroup_dress.jpg -- different image
            //   https://www.theplace2.ru/archive/jessica_stroup/img/Jessica_Stroup_dress-1.jpg -- correct image
            return src.replace(/(:\/\/[^/]*\/)cache\/(.*?)-g[^/.]*(\.[^/.]*)/, "$1$2$3");
        }

        if ((domain_nosub === "craveonline.com" && domain.match(/cdn[0-9]*-www\.craveonline\.com/)) ||
            // http://www.legswiki.com/pics/rachel-riley/thumbs/thumbs_Rachel-Riley-Legs-Feet1.jpg
            //   http://www.legswiki.com/pics/rachel-riley/Rachel-Riley-Legs-Feet1.jpg
            domain_nowww === "legswiki.com" ||
            // http://cdn1-www.mandatory.com/assets/uploads/gallery/milla-jovovich-of-resident-evil-at-her-hottest-mandatory/thumbs/thumbs_milla-jovovich-2.jpg
            //   http://cdn1-www.mandatory.com/assets/uploads/gallery/milla-jovovich-of-resident-evil-at-her-hottest-mandatory/milla-jovovich-2.jpg
            (domain_nosub === "mandatory.com" && domain.match(/^cdn[0-9]*-www\./)) ||
            // http://cdn2-www.dogtime.com/assets/uploads/gallery/shih-tzu-dog-breed-pictures/thumbs/thumbs_shih-tzu-breed-picture-6.jpg
            //   http://cdn2-www.dogtime.com/assets/uploads/gallery/shih-tzu-dog-breed-pictures/shih-tzu-breed-picture-6.jpg
            (domain_nosub === "dogtime.com" && domain.match(/cdn[0-9]*-www\.dogtime\.com/))) {
            // http://cdn2-www.craveonline.com/assets/uploads/gallery/portia-de-rossi-has-arrested-development-mandatory/thumbs/thumbs_portiaderossihotpictures13.jpg
            //   http://cdn2-www.craveonline.com/assets/uploads/gallery/portia-de-rossi-has-arrested-development-mandatory/portiaderossihotpictures13.jpg
            return src.replace("/thumbs/thumbs_", "/");
        }

        if (domain === "static.tvgcdn.net") {
            // http://static.tvgcdn.net/mediabin/galleries/shows/a_f/bq_bz/brothersandsisters/season3/smallcrops/brothers-sisters282sm.jpg
            //   http://static.tvgcdn.net/mediabin/galleries/shows/a_f/bq_bz/brothersandsisters/season3/brothers-sisters282.jpg
            // http://static.tvgcdn.net/mediabin/showcards/celebs/d-f/thumbs/felicity-jones_768x1024.png
            //   http://static.tvgcdn.net/mediabin/showcards/celebs/d-f/felicity-jones.png
            // return src.replace(/\/thumbs\/([^/.]*)_[0-9]+x[0-9]+(\.[^/.]*)$/, "/$1$2");
            return src
                .replace("/smallcrops/", "/")
                .replace("/thumbs/", "/")
                .replace(/sm(\.[^/.]*)$/, "$1")
                .replace(/_[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "blogcdn.com") {
            // https://s.blogcdn.com/slideshows/images/slides/506/163/7/S5061637/slug/l/selena-gomez-visits-the-elvis-duran-z100-morning-show-1.jpg
            // http://www.blogcdn.com/slideshows/images/slides/289/321/4/S2893214/slug/l/2013-american-music-awards-arrivals-1.jpg
            // http://www.blogcdn.com/slideshows/images/slides/289/305/8/S2893058/slug/l/2014-mtv-video-music-awards-arrivals-1.jpg
            // https://www.blogcdn.com/slideshows/images/slides/851/019/S851019/s.jpg?1
            //   https://www.blogcdn.com/slideshows/images/slides/851/019/S851019/l.jpg?1
            // only found /slug/s and /slug/l so far, tried a-z
            return src
                .replace(/(\/S[0-9]+\/)[a-z](\.[^/.]*)$/, "$1l$2")
                .replace(/\/slug\/[a-z]\//, "/slug/l/");
        }

        if (domain === "photos.imageevent.com") {
            // https://photos.imageevent.com/afap/wallpapers/movies/soulsurfer/small/AnnaSophia%20Robb%20-%20Soul%20Surfer%20-9.jpg
            //   https://photos.imageevent.com/afap/wallpapers/movies/soulsurfer/large/AnnaSophia%20Robb%20-%20Soul%20Surfer%20-9.jpg
            // http://photos.imageevent.com/afap/wallpapers/stars/bellathorne/icons/Bella%20Thorne%20and%20Zendaya%20Coleman.jpg
            //   http://photos.imageevent.com/afap/wallpapers/stars/bellathorne/Bella%20Thorne%20and%20Zendaya%20Coleman.jpg
            return src.replace(/\/(?:small|large|huge|giant|icons)\/([^/]*)$/, "/$1");
        }

        if (domain === "image.ajunews.com") {
            // http://image.ajunews.com//content/image/2015/10/10/20151010181219457255_258_161.jpg
            //   http://image.ajunews.com//content/image/2015/10/10/20151010181219457255.jpg
            return src.replace(/_[0-9]*_[0-9]*(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "telegraph.co.uk" &&
            (domain === "www.telegraph.co.uk" ||
             // https://secure.aws.telegraph.co.uk/content/dam/wellbeing/2016/12/28/graham5_trans_NvBQzQNjv4BqNyaloxhBNUSEitvcqmzeaNrVK9LoR4c_wZH1EhIay9c.jpg?imwidth=480
             //   https://secure.aws.telegraph.co.uk/content/dam/wellbeing/2016/12/28/graham5_trans_NvBQzQNjv4BqNyaloxhBNUSEitvcqmzeaNrVK9LoR4c_wZH1EhIay9c.jpg
             domain.indexOf("aws.telegraph.co.uk") >= 0 ||
             domain === "subscriber.telegraph.co.uk")) {
            // http://www.telegraph.co.uk/content/dam/men/2016/02/26/Headerraz-small_trans_NvBQzQNjv4BqqVzuuqpFlyLIwiB6NTmJwfSVWeZ_vEN7c6bHu2jJnT8.jpg
            //       http://www.telegraph.co.uk/content/dam/men/2016/02/26/Headerraz_trans_NvBQzQNjv4BqqVzuuqpFlyLIwiB6NTmJwfSVWeZ_vEN7c6bHu2jJnT8.jpg
            // http://www.telegraph.co.uk/content/dam/luxury/2018/01/17/018_MM4_9844-large_trans_NvBQzQNjv4BqeqwG1mMdY8c_ukC_8VAhqgb1Y9UHRh9-1rvsHveO7k8.JPG
            //       http://www.telegraph.co.uk/content/dam/luxury/2018/01/17/018_MM4_9844_trans_NvBQzQNjv4BqeqwG1mMdY8c_ukC_8VAhqgb1Y9UHRh9-1rvsHveO7k8.JPG
            // http://www.telegraph.co.uk/content/dam/Author%20photos/Martin%20byline-small.png
            //       http://www.telegraph.co.uk/content/dam/Author%20photos/Martin%20byline.png
            // http://www.telegraph.co.uk/content/dam/fashion/2016/10/11/110910109_ONLINE_USE_ONLY_ONE_USE_ONLY_MUST_CREDIT_Alexi_Lubomirski_-_Harpers__Bazaar_US__MUST_HOTLI_trans_NvBQzQNjv4BqqVzuuqpFlyLIwiB6NTmJwfSVWeZ_vEN7c6bHu2jJnT8.jpg
            // http://www.telegraph.co.uk/content/dam/Travel/Cruise/titanic-1997-film-still-ship-xlarge.jpg
            //        http://www.telegraph.co.uk/content/dam/Travel/Cruise/titanic-1997-film-still-ship.jpg
            //return src.replace(/(\/[^/-]*[^-_])-(?:x*(?:large|medium|small))(_[^/]*)?(\.[^/.]*$)$/, "$1$2$3");
            return src.replace(/-(?:x*(?:large|medium|small))(_[^/]*)?(\.[^/.]*$)$/, "$1$2");
        }

        if (false && (domain === "i.telegraph.co.uk" ||
                      domain === "secure.i.telegraph.co.uk")) {
            // works:
            // http://i.telegraph.co.uk/multimedia/archive/03218/Hogwarts_3218917c.jpg
            // k, a, m, i, b, n, l, c, d, e, f, g, o, p, j, h
            // doesn't work:
            // http://i.telegraph.co.uk/multimedia/archive/02804/Felicity-Jones_2804773c.jpg
            // n, b, i, l, d, c, a, f, g, o, p, j, h
            // doesn't work:
            // https://secure.i.telegraph.co.uk/multimedia/archive/03443/London-Connections_3443046a.jpg
            //
            // https://i.telegraph.co.uk/multimedia/archive/03049/night-tube-full_3049237a.jpg
            //   https://i.telegraph.co.uk/multimedia/archive/03049/night-tube-full_3049237a.jpg - smaller
            //return src.replace(/[a-z](\.[^/.]*)$/, "k$1");
        }

        if (domain === "image.munhwa.com") {
            // http://image.munhwa.com/gen_thumb/201605/20160510MW162123225413_120.jpg
            //    http://image.munhwa.com/gen_news/201605/20160510MW162123225413_b.jpg
            // http://image.munhwa.com/gen_news/201708/2017081701032603000001_b.jpg
            // http://marathon.munhwa.com/munhwa_anyadmin/amboard/imgview.php?no=785&fno=23996&group=basic&code=gallery - very large
            //   http://marathon.munhwa.com/netizen/index02.php?sno=60&group=basic&code=gallery&category=&&abmode=view&no=23996&bsort=&bfsort=&PHPSESSID=91245c6b3debc2a851d802574460ea78 - article
            return src.replace("/gen_thumb/", "/gen_news/").replace(/_[^/._]*(\.[^/.]*$)/, "_b$1");
        }

        if (domain_nosub === "dspmedia.co.kr") {
            // http://kara.dspmedia.co.kr/data/file/karam41/thumb_125x215_100/1935537395_3AVlZGS5__YS_1284.jpg
            //   http://kara.dspmedia.co.kr/data/file/karam41/1935537395_3AVlZGS5__YS_1284.jpg
            return src.replace(/(\/file\/[^/]*\/)thumb_[0-9]*x[0-9]*[^/]*\//, "$1");
        }

        if (domain === "static.wixstatic.com" ||
            // https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/intermediary/f/bc11a5bd-c85a-4e07-a890-a83ce286cfee/dcqjbom-5b42308b-181c-4bb6-9108-5ce3508986e4.jpg/v1/fill/w_730,h_1095,q_70,strp/mileena_by_motesoegyi_dcqjbom-pre.jpg
            //   https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/intermediary/f/bc11a5bd-c85a-4e07-a890-a83ce286cfee/dcqjbom-5b42308b-181c-4bb6-9108-5ce3508986e4.jpg
            domain_nosub === "wixmp.com") {
            // https://static.wixstatic.com/media/c30de2_5bb577f8c9f949178994f77b47f5eb27~mv2_d_1500_2250_s_2.jpg/v1/fill/w_241,h_378,al_c,q_80,usm_0.66_1.00_0.01/c30de2_5bb577f8c9f949178994f77b47f5eb27~mv2_d_1500_2250_s_2.webp
            //   https://static.wixstatic.com/media/c30de2_5bb577f8c9f949178994f77b47f5eb27~mv2_d_1500_2250_s_2.jpg
            // http://static.wixstatic.com/media/140a90_5b3fa9eb4568eac9b3d5e79cf37525d0.jpg_512
            //   http://static.wixstatic.com/media/140a90_5b3fa9eb4568eac9b3d5e79cf37525d0.jpg
            // http://static.wixstatic.com/media/4bd5ee_8328e23583d647c8bbc36a50b9bdaa77.jpg_srz_162_288_85_22_0.50_1.20_0.00_jpg_srz -- forces download?
            //   http://static.wixstatic.com/media/4bd5ee_8328e23583d647c8bbc36a50b9bdaa77.jpg
            // https://static.wixstatic.com/media/964c6e_5f9921a4f67248ba807c0a69416a7ec4~mv2_d_3550_5325_s_4_2.jpg/v1/fill/w_183,h_274,al_c,q_80,usm_0.66_1.00_0.01/964c6e_5f9921a4f67248ba807c0a69416a7ec4~mv2_d_3550_5325_s_4_2.jpg
            //   https://static.wixstatic.com/media/964c6e_5f9921a4f67248ba807c0a69416a7ec4~mv2_d_3550_5325_s_4_2.jpg
            return src
                .replace(/(\.[^/.]*)\/v1\/.*/, "$1")
                .replace(/(\/[^/.]*\.[^/.]*?)_[_0-9.a-z]*$/, "$1");
        }

        if (domain_nosub === "kukinews.com" ||
            // http://www.inews365.com/data/cache/public/photos/20180205/art_15174759398393_648x365.jpg
            //   http://www.inews365.com/data/photos/20180205/art_15174723165416.jpg
            domain === "www.inews365.com" ||
            // http://www.newsinstar.com/data/cache/public/photos/20180309/art_15200463472991_6c6a6f_90x60_c0.jpg
            //   http://www.newsinstar.com/data/photos/20180309/art_15200463472991_6c6a6f.jpg
            domain_nowww === "newsinstar.com" ||
            // http://www.artkoreatv.com/data/cache/public/photos/20180311/art_15209739753682_ce7de1_260x364_c0.jpg
            //   http://www.artkoreatv.com/data/photos/20180311/art_15209739753682_ce7de1.jpg
            domain === "www.artkoreatv.com" ||
            // http://www.ddaily.co.kr/data/cache/public/photos/cdn/20180205/art_1517533165_58x58.jpg
            domain === "www.ddaily.co.kr") {
            // http://cdn.kukinews.com/data/cache/public/photos/cdn/20180104/art_1516601165_300x190.jpg
            //   http://cdn.kukinews.com/data/photos/cdn/20180104/art_1516601165.jpg
            // http://news.kukinews.com/data/cache/public/photos/20180119/art_1516353322_300x190.jpg
            //   http://news.kukinews.com/data/photos/20180119/art_1516353322.jpg
            // http://cdn.kukinews.com/data/photos/kukiArticle/2011/0719/2011071901.jpg - 3594x2202
            // http://m.kukinews.com/data/photos/kukiArticle/2013/0527/09251832521234.jpg - 4636x2891
            // http://cdn.kukinews.com/data/photos/kukiArticle/2013/1208/contax_34.jpg
            // http://kukinews.com/data/cache/public/photos/20180510/art_1525933651_125x105.jpg
            //   http://kukinews.com/data/photos/20180510/art_1525933651.jpg
            return src
                .replace(/\/data\/cache\/public\//, "/data/")
                .replace(/_[0-9]+x[0-9]+(?:_c[0-9]*)?\.([^/.]*)/, ".$1");
        }

        // wip
        // http://cdn.emetro.co.kr/html/image_view.php?f=20180116000114.jpg&x=175&y=120&b=0&p=tl&ds=320
        //   http://cdn.emetro.co.kr/imagebank/2018/01/16/0480/20180116000114.jpg - 480 pixels (/0480/), removing doesn't work, but replacing with 0320, 0640, 1024 works (image is 568x329)
        // http://cdn.emetro.co.kr/html/image_view.php?f=20180123000084.jpg&x=263&y=230&b=20&p=tc&ds=100000
        //   http://cdn.emetro.co.kr/imagebank/2018/01/23/0320/20180123000047.jpg - 320 pixels
        // http://cdn.emetro.co.kr/html/image_view.php?f=20180123000037.jpg&x=122&y=105&b=0&p=tc&ds=1024
        //   http://cdn.emetro.co.kr/imagebank/2018/01/23/0640/20180123000037.jpg
        // http://cdn.emetro.co.kr/html/image_view_maxw.php?f=20180207000150.jpg&x=640&ds=640
        //   http://cdn.emetro.co.kr/html/image_view_maxw.php?f=20180207000150.jpg&x=9999&ds=9999
        //   http://cdn.emetro.co.kr/html/image_view_maxw.php?f=20180207000150.jpg&x=9999999999&ds=9999999999
        //
        // p: position (tl = top left, tc = top center?, etc.), optional
        // d: quality? the higher it is, the less blurry it is, optional
        // b: no idea, optional
        // x, y: required, 0 doesn't work (blank page), -1 returns a 10x10? image, 1 returns 1px, larger stretches it
        if (domain === "cdn.emetro.co.kr") {
            return src
                .replace(/\/image_view\.php.*?[?&]f=([^&]*).*/, "/image_view_maxw.php?f=$1&x=9999999999&ds=9999999999")
                .replace(/\/imagebank\/[0-9]*\/[0-9]*\/[0-9]*\/[0-9]*\/([^/]*)$/, "/html/image_view_maxw.php?f=$1&x=9999999999&ds=9999999999")
                .replace(/\/image_view_maxw.php.*?[?&]f=([^&]*).*/, "/image_view_maxw.php?f=$1&x=9999999999&ds=9999999999");
            /*origsize = src.match(/\/([0-9]*)\/[^/]*$/);
            if (origsize) {
                size = parseInt(origsize[1], 10);
                if (size < 1024) {
                    return src.replace(/\/[0-9]*(\/[^/]*)$/, "/1024$1");
                }
            }*/
        }

        if (domain === "50.7.164.242:8182" ||
            // http://img80.imgspice.com/i/04137/o4sy99ejf4p1_t.jpg
            (domain_nosub === "imgspice.com" && domain.match(/^img[0-9]*\./)) ||
            // http://img150.pixroute.com/i/01807/71x1h0plzn0d_t.jpg
            //   http://img150.pixroute.com/i/01807/71x1h0plzn0d.jpg
            (domain_nosub === "pixroute.com" && domain.match(/img[0-9]*\./))) {
            // http://50.7.164.242:8182/i/05/00355/qpjey5skv52d_t.jpg
            //   http://50.7.164.242:8182/i/05/00355/qpjey5skv52d.jpg
            return src.replace(/(\/i\/.*\/[^/.]*)_t(\.[^/.]*)$/, "$1$2");
        }

        if ((domain_nosub === "imagetwist.com" ||
             // http://img26.picshick.com/th/13110/2ab7lhypu3l2.jpg
             //   http://img26.picshick.com/i/13110/2ab7lhypu3l2.jpg -- forces download
             // some images return an error image with 200
             // there are many headers that could help identify (last-modified, content-length)
             domain_nosub === "picshick.com") &&
            domain.match(/i(?:mg)?[0-9]*\./)) {
            // https://i2.imagetwist.com/th/23629/qxpfyyv61890.jpg
            //   https://i2.imagetwist.com/i/23629/qxpfyyv61890.jpg
            // http://img64.imagetwist.com/th/20956/qfucojvzag41.jpg
            //   http://img64.imagetwist.com/i/20956/qfucojvzag41.jpg
            return src.replace(/\/th\//, "/i/");
        }

        if (domain === "www.theactuary.com") {
            // http://www.theactuary.com/EasysiteWeb/getresource.axd?AssetID=552225&type=custom&servicetype=Inline&customSizeId=104
            //   http://www.theactuary.com/EasysiteWeb/getresource.axd?AssetID=552225
            return src.replace(/getresource\.axd\?.*(AssetID=[0-9]*).*/, "getresource.axd?$1");
        }

        if (domain === "static.new-magazine.co.uk" ||
            // http://star-magazine.co.uk.s3.amazonaws.com/prod/media/images/600x400_ct/834228_56665_1_85643f98ed384ea3c2910d34044488d9.jpg
            //   http://star-magazine.co.uk.s3.amazonaws.com/prod/media/images/original/834228_56665_1_85643f98ed384ea3c2910d34044488d9.jpg
            amazon_container === "star-magazine.co.uk") {
            // https://static.new-magazine.co.uk/prod/media/images/300x200_ct/1105261_334919_157_106_2_b4536ad77d2a7ac6c5c342d5ba94c83a.jpg
            //   https://static.new-magazine.co.uk/prod/media/images/625x833_ct/1105261_334919_157_106_2_b4536ad77d2a7ac6c5c342d5ba94c83a.jpg
            //   https://static.new-magazine.co.uk/prod/media/images/original/1105261_334919_157_106_2_b4536ad77d2a7ac6c5c342d5ba94c83a.jpg
            return src.replace(/(\/prod\/media\/images\/)[^/]*\//, "$1original/");
        }

        if (domain === "www.irishexaminer.com" ||
            // https://www.breakingnews.ie/remote/media.central.ie/media/images/r/roryBestShaneRoss6NationsTrophy_large.jpg?width=600&s=bn-833165
            //   http://media.central.ie/media/images/r/roryBestShaneRoss6NationsTrophy_large.jpg
            domain === "www.breakingnews.ie" ||
            // https://ip.index.hr/remote/indexnew.s3.index.hr/rethatrhtsrhgertr.jpg?width=765&height=440
            //   http://indexnew.s3.index.hr/rethatrhtsrhgertr.jpg
            domain === "ip.index.hr" ||
            domain === "ip.trueachievements.com") {
            // removing ?.* entirely returns 500
            // https://www.irishexaminer.com/remote/image.assets.pressassociation.io/v2/image/production/144492a205ad478ef0233c59e6617054Y29udGVudHNlYXJjaCwxNTEzMDczMTc2/2.30748323.jpg?crop=0,102,3712,2190&ext=.jpg&width=600
            //   https://www.irishexaminer.com/remote/image.assets.pressassociation.io/v2/image/production/144492a205ad478ef0233c59e6617054Y29udGVudHNlYXJjaCwxNTEzMDczMTc2/2.30748323.jpg?ext=.jpg&width=600
            // however, /remote/ is a remote address
            //   http://image.assets.pressassociation.io/v2/image/production/144492a205ad478ef0233c59e6617054Y29udGVudHNlYXJjaCwxNTEzMDczMTc2/2.30748323.jpg
            // https://ip.trueachievements.com/remote/images-eds-ssl.xboxlive.com%2Fimage%3Furl%3D8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcSEliFeYEcpYdMffymmILaXcS00LePBQajKrVx_Va4DQAxgf7VKT9o10FP5RijVvisttt9.R8el9KW5aWefdGAyAK7PHk.TSf1spbv8.x6hWsZrJa2pOp_PXzU7fSK76BcdJyPe_XVC7ZQNPT1kWf.D_KXVQtjCDHj7_wiu8ekYM-?width=1200&height=675
            //   http://images-eds-ssl.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTcSEliFeYEcpYdMffymmILaXcS00LePBQajKrVx_Va4DQAxgf7VKT9o10FP5RijVvisttt9.R8el9KW5aWefdGAyAK7PHk.TSf1spbv8.x6hWsZrJa2pOp_PXzU7fSK76BcdJyPe_XVC7ZQNPT1kWf.D_KXVQtjCDHj7_wiu8ekYM-
            newsrc = src.replace(/.*:\/\/[^/]*\/remote\/([^?]*).*/, "$1");
            if (newsrc !== src)
                return "http://" + decodeURIComponent(newsrc);
        }

        if ((domain === "tellymix-spykawebgroup.netdna-ssl.com" ||
             // http://static6.tellymixcdn.com/ts/800/450/www.tellymix.co.uk/files/2013/06/Tess-Daly.jpg
             //   https://tellymix.co.uk/wp-content/uploads/2013/06/Tess-Daly.jpg
             domain_nosub === "tellymixcdn.com") &&
            src.match(/:\/\/[^/]*\/+ts\//)) {
            // https://tellymix-spykawebgroup.netdna-ssl.com/ts/800/450/tellymix-spykawebgroup.netdna-ssl.com/wp-content/uploads/2016/10/the-apprentice-2016-sugar.jpg
            //   http://tellymix-spykawebgroup.netdna-ssl.com/wp-content/uploads/2016/10/the-apprentice-2016-sugar.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/+ts\/+[0-9]*\/+[0-9]*\/+/, "http://");
        }

        if (domain === "assets.goodhousekeeping.co.uk") {
            // http://assets.goodhousekeeping.co.uk/main/embedded/37045/nick_hewer__large.jpg?20170224112427
            //   http://assets.goodhousekeeping.co.uk/main/embedded/37045/nick_hewer.jpg?20170224112427
            // http://assets.goodhousekeeping.co.uk/main/embedded/37045/scams_2__medium.jpg
            //   http://assets.goodhousekeeping.co.uk/main/embedded/37045/scams_2.jpg
            // http://assets.goodhousekeeping.co.uk/main/embedded/961/DH-esther-rantzen-170913-de__medium.jpg
            //   // http://assets.goodhousekeeping.co.uk/main/embedded/961/DH-esther-rantzen-170913-de.jpg
            //
            // doesn't work:
            // http://assets.goodhousekeeping.co.uk/main/options/sized-good-housekeeping-institute-cookery-school-outside-institute__medium.jpg
            return src.replace(/(\/embedded\/(?:[0-9]*\/)[^/]*)__[^/.]*(\.[^/]*)$/, "$1$2");
        }

        if ((domain === "www.femalefirst.co.uk" ||
             domain === "www.malextra.com") &&
            src.indexOf("/image-library/") >= 0 && false) {
            // wip, need a better way to find numbers ... seems to stretch the image
            // http://www.femalefirst.co.uk/image-library/square/1000/n/nick-hewer.jpg.pagespeed.ce.hpbDLhN-Bn.jpg
            //   http://www.femalefirst.co.uk/image-library/square/1000/n/nick-hewer.jpg
            // http://www.femalefirst.co.uk/image-library/square/250/i/125x125xi-am-health-ledger.jpg.pagespeed.ic.FlFI8UcEzf.webp
            //   http://www.femalefirst.co.uk/image-library/square/250/i/i-am-health-ledger.jpg
            // http://www.femalefirst.co.uk/image-library/partners/bang/land/1000/b/xbruno-mars-bdb9ea9c22850bc313ff7ac8e630fb1d828ffc4f.jpg.pagespeed.ic.rBtqQphklp.jpg
            //   http://www.femalefirst.co.uk/image-library/partners/bang/land/1000/b/bruno-mars-bdb9ea9c22850bc313ff7ac8e630fb1d828ffc4f.jpg
            // https://www.femalefirst.co.uk/image-library/partners/bang/port/1000/c/camila-cabello-03bdc9bf2a1513d9a06c55f25c33f87ea098a0e3.jpg
            // http://www.femalefirst.co.uk/image-library/partners/bang/square/250/l/lord-alan-sugar-d9c582eb51a37f070569b849b1ec3916e0bb28e0.jpg
            //   http://www.femalefirst.co.uk/image-library/partners/bang/square/1000/l/lord-alan-sugar-d9c582eb51a37f070569b849b1ec3916e0bb28e0.jpg -- stretched
            // http://www.femalefirst.co.uk/image-library/deluxe/d/despicable-me-3-character-poster-5.jpg (4050x6000)
            // http://www.femalefirst.co.uk/image-library/deluxe/r/real-housewives-of-beverly-hills-season-8-camille-grammer-deluxe-image.jpg (2249x3000)
            // http://www.femalefirst.co.uk/image-library/deluxe/w/world-of-warcraft-battle-for-azeroth-logo-deluxe.jpg (4500x2400)
            //return src.replace(/\/(?:[0-9]+x[0-9]+x)?x*([^/.]*\.[^/.]*)[^/]*$/, "/$1");
            src = src.replace(/\/[0-9x]*([^/.]*\.[^/.]*)[^/]*$/, "/$1");
            origsize = src.match(/\/([0-9]*)\/.\/[^/]*$/);
            if (origsize) {
                size = origsize[1];
                if (parseInt(size, 10) < 1000) {
                    src = src.replace(/\/[0-9]*(\/.\/[^/]*)$/, "/1000$1");
                }
            }
            return src;
        }

        if (domain === "img.buzzfeed.com") {
            // wip
            // https://img.buzzfeed.com/buzzfeed-static/static/2014-11/19/17/enhanced/webdr10/longform-original-17700-1416435430-4.png
            // https://img.buzzfeed.com/buzzfeed-static/static/2014-11/19/17/campaign_images/webdr03/nick-hewer-has-just-done-his-best-ever-facial-exp-2-32167-1416437197-0_dblbig.jpg
            // https://img.buzzfeed.com/buzzfeed-static/static/2018-01/26/9/campaign_images/buzzfeed-prod-fastlane-03/the-us-olympic-committee-demands-all-usa-gymnasti-2-2591-1516975268-0_dblwide.jpg
            // https://img.buzzfeed.com/buzzfeed-static/static/2018-01/26/8/campaign_images/buzzfeed-prod-fastlane-01/the-supreme-court-stopped-alabama-from-executing--2-14117-1516973637-0_dblwide.jpg
            //   https://img.buzzfeed.com/buzzfeed-static/static/2018-01/25/22/asset/buzzfeed-prod-fastlane-02/sub-buzz-5552-1516935824-2.jpg -- unrelated?
            // https://img.buzzfeed.com/buzzfeed-static/static/2016-05/12/16/enhanced/webdr08/original-6479-1463084088-1.jpg
            // https://img.buzzfeed.com/buzzfeed-static/static/2017-08/22/15/enhanced/buzzfeed-prod-fastlane-01/original-18338-1503431220-9.png
            // https://img.buzzfeed.com/buzzfeed-static/static/2018-04/11/8/enhanced/buzzfeed-prod-web-03/original-16715-1523449517-2.jpg
            return src
                .replace(/_big(\.[^/.]*)$/, "_dblbig$1")
                .replace(/_wide(\.[^/.]*)$/, "_dblbig$1")
                .replace(/_dblwide(\.[^/.]*)$/, "_dblbig$1");
        }

        if (domain === "www.thegenealogist.co.uk") {
            // https://www.thegenealogist.co.uk/images/featuredarticles/header_sm/wdytya2016_dyer.jpg
            //   https://www.thegenealogist.co.uk/images/featuredarticles/header_lg/wdytya2016_dyer.jpg
            return src.replace("/images/featuredarticles/header_sm/", "/images/featuredarticles/header_lg/");
        }

        if (domain === "251d2191a60056d6ba74-1671eccf3a0275494885881efb0852a4.ssl.cf1.rackcdn.com" ||
            // https://8583b52b4a309671f69d-b436b898353c7dc300b5887446a26466.ssl.cf1.rackcdn.com/20971239_donatella-arpaia-announces-shes_9eb94af2_m.jpg?bg=C6BDA4
            //   https://8583b52b4a309671f69d-b436b898353c7dc300b5887446a26466.ssl.cf1.rackcdn.com/20971239_donatella-arpaia-announces-shes_9eb94af2.jpg
            domain === "8583b52b4a309671f69d-b436b898353c7dc300b5887446a26466.ssl.cf1.rackcdn.com" ||
            // https://2e0a24317f4a9294563f-26c3b154822345d9dde0204930c49e9c.ssl.cf1.rackcdn.com/10033326_legends-of-tomorrow-casts-maisie-richardson-_35dcb2d4_m.jpg?bg=686658
            //   https://2e0a24317f4a9294563f-26c3b154822345d9dde0204930c49e9c.ssl.cf1.rackcdn.com/10033326_legends-of-tomorrow-casts-maisie-richardson-_35dcb2d4.jpg
            domain === "2e0a24317f4a9294563f-26c3b154822345d9dde0204930c49e9c.ssl.cf1.rackcdn.com" ||
            // https://7f9c61237bd6e732e57e-5fa18836a2ae6b5e7c49abcc89b20237.ssl.cf1.rackcdn.com/21774981_asia-argento-allegedly-admitted-to-sex_c58de1d1_m.jpg?bg=5E5E5E
            //   https://7f9c61237bd6e732e57e-5fa18836a2ae6b5e7c49abcc89b20237.ssl.cf1.rackcdn.com/21774981_asia-argento-allegedly-admitted-to-sex_c58de1d1.jpg
            domain === "7f9c61237bd6e732e57e-5fa18836a2ae6b5e7c49abcc89b20237.ssl.cf1.rackcdn.com" ||
            // http://homerumah.info/biggest-single-pon-de-replay
            // https://b6c18f286245704fe3e9-05e2055f4cd9122af02914269431c9f6.ssl.cf1.rackcdn.com/20635950_rihanna-is-still-jamming-out-to-pon_c63473e4_m.jpg?bg=554F57
            //   https://b6c18f286245704fe3e9-05e2055f4cd9122af02914269431c9f6.ssl.cf1.rackcdn.com/20635950_rihanna-is-still-jamming-out-to-pon_c63473e4.jpg
            domain === "b6c18f286245704fe3e9-05e2055f4cd9122af02914269431c9f6.ssl.cf1.rackcdn.com" ||
            // https://www.notey.com/blogs/her-source-%7C-hip-hop-beauty-trends
            // https://41dcdfcd4dea0e5aba20-931851ca4d0d7cdafe33022cf8264a37.ssl.cf1.rackcdn.com/18305364_some-fans-are-now-realizing-rihanna_97a66a0b_m.jpg?bg=503D37
            //   https://41dcdfcd4dea0e5aba20-931851ca4d0d7cdafe33022cf8264a37.ssl.cf1.rackcdn.com/18305364_some-fans-are-now-realizing-rihanna_97a66a0b.jpg
            domain === "41dcdfcd4dea0e5aba20-931851ca4d0d7cdafe33022cf8264a37.ssl.cf1.rackcdn.com" ||
            // https://www.notey.com/blogs/taryn-manning?page=2
            // https://575717b777ff8d928c6b-704c46a8034042e4fc898baf7b3e75d9.ssl.cf1.rackcdn.com/11492238_taryn-manning-flaunts-a-colorful-80s-inspired_f0ada11c_m.jpg?bg=A08D87
            //   https://575717b777ff8d928c6b-704c46a8034042e4fc898baf7b3e75d9.ssl.cf1.rackcdn.com/11492238_taryn-manning-flaunts-a-colorful-80s-inspired_f0ada11c.jpg
            domain === "575717b777ff8d928c6b-704c46a8034042e4fc898baf7b3e75d9.ssl.cf1.rackcdn.com" ||
            // https://598d5fcf392acad97538-395e64798090ee0a3a571e8c148d44f2.ssl.cf1.rackcdn.com/19551117_israeli-vr-tech-takes-fashiontv_2f7b85b8_m.jpg?bg=2A323B
            //   https://598d5fcf392acad97538-395e64798090ee0a3a571e8c148d44f2.ssl.cf1.rackcdn.com/19551117_israeli-vr-tech-takes-fashiontv_2f7b85b8.jpg
            domain === "598d5fcf392acad97538-395e64798090ee0a3a571e8c148d44f2.ssl.cf1.rackcdn.com") {
            // https://251d2191a60056d6ba74-1671eccf3a0275494885881efb0852a4.ssl.cf1.rackcdn.com/11860912_countdowns-nick-hewer-amstrad-should_6d456945_m.jpg?bg=7C7374
            //   https://251d2191a60056d6ba74-1671eccf3a0275494885881efb0852a4.ssl.cf1.rackcdn.com/11860912_countdowns-nick-hewer-amstrad-should_6d456945.jpg
            return src.replace(/(\/[^/.]*)_[a-z](\.[^/.?]*)(?:\?[^/]*)?$/, "$1$2");
        }

        if (domain === "cdn.shopify.com") {
            // https://cdn.shopify.com/s/files/1/0947/6410/products/a2178934757_10_1024x1024.jpeg?v=1458824230
            //   https://cdn.shopify.com/s/files/1/0947/6410/products/a2178934757_10.jpeg?v=1458824230
            // https://cdn.shopify.com/s/files/1/0947/6410/products/Om-Sweet-Om_1024x1024.png?v=1450196316
            //   https://cdn.shopify.com/s/files/1/0947/6410/products/Om-Sweet-Om.png?v=1450196316
            // https://cdn.shopify.com/s/files/1/2220/9229/products/Siticker_laptop_image_2048x.jpg
            //   https://cdn.shopify.com/s/files/1/2220/9229/products/Siticker_laptop_image.jpg
            // https://cdn.shopify.com/s/files/1/0846/3086/products/DM21_copy2_large.jpg?v=1464040850
            //   https://cdn.shopify.com/s/files/1/0846/3086/products/DM21_copy2.jpg?v=1464040850
            // http://cdn.shopify.com/s/files/1/0683/4117/products/IMG_6727_grande.jpg?v=1514569448
            //   https://cdn.shopify.com/s/files/1/0683/4117/products/IMG_6727.jpg?v=1514569448
            // https://cdn.shopify.com/s/files/1/1581/4309/articles/stealherstyle-emmawatsonmetgala-tutorial02_1400x.progressive.jpg?v=1490365007
            //   https://cdn.shopify.com/s/files/1/1581/4309/articles/stealherstyle-emmawatsonmetgala-tutorial02.jpg?v=1490365007
            // https://cdn.shopify.com/s/files/1/2684/7106/products/LKE600_720x@2x.jpg?v=1514632635
            //   https://cdn.shopify.com/s/files/1/2684/7106/products/LKE600.jpg?v=1514632635
            // https://cdn.shopify.com/s/files/1/1066/4366/products/MG_84122_compact.jpg?v=1527671088
            //   https://cdn.shopify.com/s/files/1/1066/4366/products/MG_84122.jpg?v=1527671088
            // https://cdn.shopify.com/s/files/1/1878/3879/products/N0690_400x_crop_center.jpg?v=1510258264
            //   https://cdn.shopify.com/s/files/1/1878/3879/products/N0690.jpg?v=1510258264
            return src.replace(/_(?:large|medium|small|grande|compact|[0-9]+x(?:[0-9]+)?)(?:@[0-9]+x)?(?:_crop_[a-z]+)?(?:\.progressive)?(\.[^/.]*)$/, "$1");
        }

        if (domain === "cdn.itv.com") {
            // https://cdn.itv.com/uploads/editor/medium_DyTW1moFnODLSb6a6IiBigbhufrsOXe2y3XWw1ekUN8.jpg
            //   https://cdn.itv.com/uploads/editor/DyTW1moFnODLSb6a6IiBigbhufrsOXe2y3XWw1ekUN8.jpg
            return src.replace(/\/[a-z]*_([^/_]*)$/, "/$1");
        }

        if (domain === "d3mkh5naggjddw.cloudfront.net" ||
            // https://img.blvds.com/unsafe/fit-in/smart/https://res.cloudinary.com/hynomj8e0/image/upload/v1487089435/ajb3zxdwskxppk9ih7fi.jpg
            //   https://res.cloudinary.com/hynomj8e0/image/upload/ajb3zxdwskxppk9ih7fi.jpg
            domain === "img.blvds.com" ||
            // https://resizer.mundotkm.com/unsafe/700x1050/http://cfglobal01.mundotkm.com/2017/07/147114_MP1_1318-e1500065093615.jpg
            //   http://cfglobal01.mundotkm.com/2017/07/147114_MP1_1318-e1500065093615.jpg
            // https://resizer.mundotkm.com/unsafe/http://cfglobal01.mundotkm.com/2017/07/147114_MP1_1037-e1500064972548.jpg
            // https://resizer.mundotkm.com/unsafe/smart/http://cfglobal01.mundotkm.com/2016/12/leslie.jpg
            //   http://cfglobal01.mundotkm.com/2016/12/leslie.jpg
            domain === "resizer.mundotkm.com" ||
            // https://d2isyty7gbnm74.cloudfront.net/unsafe/646x646/https://square-production.s3.amazonaws.com/files/6b56d9597b7a852f61ae767adb0bbe68f722cc80/original.jpeg
            //   https://square-production.s3.amazonaws.com/files/6b56d9597b7a852f61ae767adb0bbe68f722cc80/original.jpeg
            domain === "d2isyty7gbnm74.cloudfront.net" ||
            // http://thumb.connect360.vn/unsafe/0x0/imgs.emdep.vn/Share/Image/2015/05/14/1-100345208.jpg
            //   http://imgs.emdep.vn/Share/Image/2015/05/14/1-100345208.jpg
            domain === "thumb.connect360.vn" ||
            // https://img.movietimes.com/unsafe/fit-in/300x500/smart/https://assets.movietimes.com/v1/celebrity_images/6589/2DN3Hi8AxyiUClzCun7ANG3YBhS.jpg
            //   https://assets.movietimes.com/v1/celebrity_images/6589/2DN3Hi8AxyiUClzCun7ANG3YBhS.jpg
            domain === "img.movietimes.com" ||
            // https://t.t2online.co.in/unsafe/smart/filters:format(webp)/images.anandabazar.com/polopoly_fs/1.855966.1535611606!/image/image.jpg_gen/derivatives/landscape_390/image.jpg
            //   http://images.anandabazar.com/polopoly_fs/1.855966.1535611606!/image/image.jpg_gen/derivatives/landscape_390/image.jpg
            domain === "t.t2online.co.in" ||
            // https://t2.genius.com/unsafe/220x0/https%3A%2F%2Fimages.genius.com%2F4e99624bb74700cf1a5ac40f142cb7cf.1000x1000x1.jpg
            //   https://images.genius.com/4e99624bb74700cf1a5ac40f142cb7cf.1000x1000x1.jpg
            (domain_nosub === "genius.com" && domain.match(/t[0-9]*\.genius\.com/))) {
            // https://d3mkh5naggjddw.cloudfront.net/unsafe/smart/filters:format(jpeg)/http%3A%2F%2Fi.dailymail.co.uk%2Fi%2Fpix%2F2017%2F08%2F10%2F19%2F43248C1D00000578-0-image-a-10_1502389640540.jpg
            //   http://i.dailymail.co.uk/i/pix/2017/08/10/19/43248C1D00000578-0-image-a-10_1502389640540.jpg
            return add_http(decodeURIComponent(src
                                               .replace(/.*\/unsafe\/smart\/(?:filters:[^/]*\/)?/, "")
                                               .replace(/.*\/unsafe\/fit-in\/smart\//, "")
                                               .replace(/.*\/unsafe\/(?:fit-in\/)?(?:[0-9]*x[0-9]*\/)?(?:smart\/)?/, "")));
        }

        if (domain === "elsewhere.scdn3.secure.raxcdn.com") {
            // seems to be the number of pixels??
            // https://elsewhere.scdn3.secure.raxcdn.com/images/v95000/articles/the-rolling-stones-2013-glastonbury-festival-35.jpg -- 267x354
            //   https://elsewhere.scdn3.secure.raxcdn.com/images/v9999999999999/articles/the-rolling-stones-2013-glastonbury-festival-35.jpg -- 754x1000
            //   https://elsewhere.scdn3.secure.raxcdn.com/images/downloads/articles/the-rolling-stones-2013-glastonbury-festival-35.jpg -- 754x1000
            // https://elsewhere.scdn3.secure.raxcdn.com/images/s290/articles/Bj%C3%B6rk-Debut-1993.png -- 290x290
            //   https://elsewhere.scdn3.secure.raxcdn.com/images/downloads/articles/Bj%C3%B6rk-Debut-1993.png
            // https://elsewhere.scdn3.secure.raxcdn.com/images/v9500/articles/Bj%C3%B6rk-Debut-1993.png -- 97x97
            //   https://elsewhere.scdn3.secure.raxcdn.com/images/downloads/articles/Bj%C3%B6rk-Debut-1993.png -- 316x316
            //return src.replace(/\/images\/v[0-9]*\//, "/images/v999999999999999999/");
            return src.replace(/\/images\/[sv][0-9]+\/articles\//, "/images/downloads/articles/");
        }

        if (domain === "static01.nyt.com") {
            // https://static01.nyt.com/images/2015/08/30/arts/30RICHARDSJP5/30RICHARSJP5-superJumbo.jpg
            // https://static01.nyt.com/images/2015/09/17/arts/17KEITH/17KEITH-jumbo.jpg
            // https://static01.nyt.com/images/2015/09/17/arts/17KEITH/17KEITH-thumbStandard.jpg
            // https://static01.nyt.com/images/2015/08/30/arts/30RICHARDS1/30RICHARDS1-master1050.jpg
            // https://static01.nyt.com/images/2015/08/30/arts/30RICHARDSSUB4/30RICHARDSSUB4-master675.jpg
            // https://static01.nyt.com/images/2018/02/03/arts/03playlist/merlin_123145877_5ed2acde-72d5-4afb-a19a-93dbc29b5d2f-superJumbo.jpg?quality=100&auto=webp
            // https://static01.nyt.com/newsgraphics/2018/02/11/mens-slopestyle/assets/images/composite-2-2000_x2.jpg (4000x2058)
            // https://static01.nyt.com/images/2018/02/23/nyregion/23WOMEN01/merlin_134412716_f1cbfeaa-8204-41b1-9576-8cc8c5063348-threeByTwoLargeAt2X.jpg (3600x2400)
            // https://static01.nyt.com/newsgraphics/2014/09/24/private-lives/assets/private_lives_nilsen_1400_v1.png
            // https://static01.nyt.com/packages/flash/Lens/2011/06/20110629-KM-Weiwei/012-20110629-KM-Weiwei.JPG (4193x3307)
            // https://static01.nyt.com/images/2018/02/23/us/politics/23dc-note/merlin_134350481_6712d7ba-b262-4d9e-97f3-8094cc9de088-threeByTwoLargeAt2X.jpg
            // https://static01.nyt.com/newsgraphics/2017/10/31/yellen-legacy/50c5752d6294e63077f7e841ccf62b880fd1599e/yellen-office-alt-1.jpg (5472x3648)
            // https://static01.nyt.com/packages/flash/Lens/2010/10/20101025-NK-Joao/20101025-Joao-extra4.jpg (3200x2108)
            // https://static01.nyt.com/images/2010/10/06/nyregion/20101006Nocturnalist/20101006Nocturnalist-custom1.jpg (5120x3413)
            // https://static01.nyt.com/images/2010/10/06/nyregion/20101006Nocturnalist/20101006Nocturnalist-custom2.jpg ^
            // https://static01.nyt.com/images/2009/02/08/sports/20090209-SIOUX-S.JPG
            // https://static01.nyt.com/images/2010/01/05/arts/supperbig2.jpg (3000x2000)
            // https://static01.nyt.com/images/2015/10/25/t-magazine/25tmag-11well_rihanna-t_CA0/25tmag-11well_rihanna-t_CA0-facebookJumbo.jpg (1050x550)
            //   https://static01.nyt.com/images/2015/10/25/t-magazine/25tmag-11well_rihanna-t_CA0/25tmag-11well_rihanna-t_CA0-superJumbo.jpg (1639x2048)
            // https://static01.nyt.com/images/2015/10/12/t-magazine/12tmag-rihanna-toc-t/12tmag-rihanna-toc-t-blog427.jpg
            //   https://static01.nyt.com/images/2015/10/12/t-magazine/12tmag-rihanna-toc-t/12tmag-rihanna-toc-t-superJumbo.jpg
            // https://static01.nyt.com/images/2016/11/03/fashion/03SKIN1/03SKIN1-master1050-v2.jpg
            //   https://static01.nyt.com/images/2016/11/03/fashion/03SKIN1/03SKIN1-superJumbo-v2.jpg
            //
            // doesn't work:
            // https://static01.nyt.com/images/2010/10/24/arts/RICHARDS-Jp-1/RICHARDS-Jp-1-popup.jpg
            // https://static01.nyt.com/images/2011/11/17/fashion/17felicityspan/17felicityspan-jumbo.jpg
            var matched = src.match(/-([^-_/.]*?)(?:-v[0-9]*)?\.[^/.]*$/);
            if (matched) {
                if (matched[1] === "jumbo" ||
                    matched[1] === "thumbStandard" ||
                    matched[1] === "facebookJumbo" ||
                    matched[1].slice(0, 6) === "master" ||
                    matched[1].slice(0, 4) === "blog") {
                    return src.replace(/-[^-_/.]*(-v[0-9]*)?(\.[^/.]*)$/, "-superJumbo$1$2");
                }
            }
        }

        if (domain === "render.fineartamerica.com") {
            // https://render.fineartamerica.com/images/rendered/search/print/images-medium-5/keith-richards-andre-koekemoer.jpg
            //   https://images.fineartamerica.com/images-medium-large-5/keith-richards-andre-koekemoer.jpg
            return src.replace(/render\.fineartamerica\.com\/images\/rendered\/search\/print\/[^/]*(-[0-9]*)\/([^/]*)$/, "images.fineartamerica.com/images-medium-large$1/$2");
        }

        if (domain === "media.npr.org") {
            // https://media.npr.org/assets/artslife/arts/2010/10/keith-richards/keith-richards-730d749c083f177cc443b4114ee1b19b1e257988-s400-c85.jpg
            //   https://media.npr.org/assets/artslife/arts/2010/10/keith-richards/keith-richards-730d749c083f177cc443b4114ee1b19b1e257988.jpg
            // https://media.npr.org/assets/img/2018/04/13/ap_17339773700572_wide-5b2806a60758e44c259842da1f23f45ac58b1c47.jpg
            //   https://media.npr.org/assets/img/2018/04/13/ap_17339773700572-5b2806a60758e44c259842da1f23f45ac58b1c47.jpg
            // https://media.npr.org/assets/img/2018/02/27/ap_17299821347425-0a0868f089eae2f95d1e5a4aaa0252c2176f1334-s800-c85.jpg
            //   https://media.npr.org/assets/img/2018/02/27/ap_17299821347425-0a0868f089eae2f95d1e5a4aaa0252c2176f1334.jpg
            // https://media.npr.org/assets/img/2018/04/13/gettyimages-111077711_wide-7cec6f88bb5f86c005767e5866a00404396e869e.jpg?s=400
            //   https://media.npr.org/assets/img/2018/04/13/gettyimages-111077711-7cec6f88bb5f86c005767e5866a00404396e869e.jpg
            // https://media.npr.org/assets/img/2018/01/27/rtx4ixrd_sq-744e57fe23b306ed1ccb050b38967d41b5a9c8bd-s400-c85.jpg
            //   https://media.npr.org/assets/img/2018/01/27/rtx4ixrd-744e57fe23b306ed1ccb050b38967d41b5a9c8bd.jpg
            return src
                .replace(/(\/[^/]*)-[sc][0-9]*(?:-[sc][0-9]*)?(\.[^/.]*)/, "$1$2")
                .replace(/_[a-z]+-([a-f0-9]{30,})(\.[^/.]*)$/, "-$1$2");
        }

        if (domain_nosub === "pbsrc.com" && domain.match(/rs[0-9]*\.pbsrc\.com/)) {
            // http://rs375.pbsrc.com/albums/oo198/ZaraTTucker/Get%20Italian%20Translation%20Services%20to%20Boost_zpsms99llho.jpg~c400
            //   http://i375.photobucket.com/albums/oo198/ZaraTTucker/Get%20Italian%20Translation%20Services%20to%20Boost_zpsms99llho.jpg
            // http://i843.photobucket.com/albums/zz352/loaloauk/dlp%20encounter/New%20Album%2042/4640363830_9e9c2ae51b_z.jpg~original
            // http://rs414.pbsrc.com/albums/pp228/sweetblonda/NATURA.jpg?w=280&h=210&fit=crop
            //   http://i414.photobucket.com/albums/pp228/sweetblonda/NATURA.jpg
            return src
                .replace(/rs([0-9]*)\.pbsrc\.com/, "i$1.photobucket.com")
                .replace(/\?.*/, "")
                .replace(/(?:~[^/.]*)?$/, "~original");
        }

        if (domain === "www.welt.de") {
            // https://www.welt.de/img/kultur/pop/mobile132505066/0972501497-ci102l-w1024/Keith-Richards-mit-Enkel-Otto.jpg
            //   https://www.welt.de/img/kultur/pop/mobile132505066/0972501497-ci102l-w0/Keith-Richards-mit-Enkel-Otto.jpg
            return src.replace(/-w[0-9]*(\/[^/]*)$/, "-w0$1");
        }

        if (domain === "cdn.baeblemusic.com") {
            // https://cdn.baeblemusic.com/images/bblog/5-8-2017/keith-richards-almost-died-580.jpg
            return src.replace(/-[0-9]*(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "deviantart.net" &&
            domain.match(/t[0-9]*\.deviantart\.net/)) {
            // https://t00.deviantart.net/7PiX79OLWVS6WAzA0thSVYzWarQ=/300x200/filters:fixed_height(100,100):origin()/pre00/f044/th/pre/i/2004/235/7/b/megaman.jpg
            //   https://pre00.deviantart.net/f044/th/pre/i/2004/235/7/b/megaman.jpg
            // https://t00.deviantart.net/lNDj1np7JyLzN7U1MHhJlzp38Vs=/300x200/filters:fixed_height(100,100):origin()/pre00/4328/th/pre/f/2011/194/b/6/megaman_tribute_by_saiyagina-d3odj4t.jpg
            //   https://pre00.deviantart.net/4328/th/pre/f/2011/194/b/6/megaman_tribute_by_saiyagina-d3odj4t.jpg
            // https://t00.deviantart.net/hbXtsO07Julo2fHWk6VyTkPgU5Y=/fit-in/700x350/filters:fixed_height(100,100):origin()/pre00/034f/th/pre/i/2017/346/6/5/abyss___chibi_by_nightstar234-dbwhn28.png
            //   https://pre00.deviantart.net/034f/th/pre/i/2017/346/6/5/abyss___chibi_by_nightstar234-dbwhn28.png
            return src.replace(/:\/\/.*?\.deviantart\.net\/.*?\/[0-9]*x[0-9]*\/[^/]*\/([^/]*)\/(.*)/, "://$1\.deviantart\.net/$2");
        }

        if (domain_nosub === "grazia.fr" && domain.match(/img[0-9]*\.grazia\.fr/) ||
            // https://www.glamour.de/var/condenast/storage/images/mode/mode-news/galerien/kleider-die-wir-nicht-vergessen/margot-robbie-oscar-2016-gettyimages-512917014/13287889-1-ger-DE/margot-robbie-oscar-2016-gettyimages-512917014_gallery_large_portrait.jpg
            //   https://www.glamour.de/var/condenast/storage/images/mode/mode-news/galerien/kleider-die-wir-nicht-vergessen/margot-robbie-oscar-2016-gettyimages-512917014/13287889-1-ger-DE/margot-robbie-oscar-2016-gettyimages-512917014.jpg
            // https://www.glamour.de/var/condenast/storage/images/media/images/artikelbilder/mode-bilder/margot-robbie-oscar-2016-gettyimages-512917014/13287964-1-ger-DE/margot-robbie-oscar-2016-gettyimages-512917014_g1500xx.jpg
            //   https://www.glamour.de/var/condenast/storage/images/media/images/artikelbilder/mode-bilder/margot-robbie-oscar-2016-gettyimages-512917014/13287964-1-ger-DE/margot-robbie-oscar-2016-gettyimages-512917014.jpg
            domain_nowww === "glamour.de" ||
            // https://asia.nikkei.com/var/site_cache/storage/images/node_43/node_51/2018/201802/20180208t/20180208_malaysia-worker/8879284-1-eng-GB/20180208_Malaysia-worker_article_thumbnail.jpg
            // https://asia.nikkei.com/var/site_cache/storage/images/node_43/node_51/2018/201802/20180208t/20180208_malaysia-worker/8879284-1-eng-GB/20180208_Malaysia-worker_article_main_image.jpg
            // https://asia.nikkei.com/var/site_cache/storage/images/node_43/node_51/2018/201802/0217n/0217n-audi/8939471-1-eng-GB/0217N-Audi_large_image.jpg
            // https://asia.nikkei.com/var/site_cache/storage/images/node_43/node_51/2018/201802/20180213t/20180213_rocket/8908091-1-eng-GB/20180213_rocket_photo_galleries_thumbnail.jpg
            // https://asia.nikkei.com/var/site_cache/storage/images/node_43/node_51/2018/201802/20180213t/20180213_rocket/8908091-1-eng-GB/20180213_rocket_article_main_image.jpg
            // https://asia.nikkei.com/var/site_cache/storage/images/node_43/node_51/2018/201802/20180205t/20180130citiesocial-founder-eric-wang/8846170-2-eng-GB/20180130Citiesocial-Founder-Eric-Wang_more_in_thumbnail.jpg
            //   https://asia.nikkei.com/var/site_cache/storage/images/node_43/node_51/2018/201802/20180205t/20180130citiesocial-founder-eric-wang/8846170-2-eng-GB/20180130Citiesocial-Founder-Eric-Wang.jpg
            // https://asia.nikkei.com/var/site_cache/storage/images/top/viewpoints/humphrey-hawksley/5784021-2-app-WF/Humphrey-Hawksley_square80_thumbnail.png
            // https://asia.nikkei.com/var/site_cache/storage/images/top/magazine/20180215/8920429-1-app-WF/FREEDOM-OF-THE-OPPRESSION_cover_image.jpg
            // https://asia.nikkei.com/var/site_cache/storage/images/node_43/node_51/2018/201802/20180217t/20180217_panda/8940872-1-eng-GB/20180217_Panda_medium_thumbnail.jpg
            domain === "asia.nikkei.com" ||
            // http://www.elle.co.jp/var/ellejp/storage/images/fashion/celeb/selenagomez-bestsnap-2016_17_02/node_1087470/19466418-1-jpn-JP/2017-6-7-NY_image_size_900_x.jpg
            //   http://elle.co.jp/var/ellejp/storage/images/fashion/celeb/selenagomez-bestsnap-2016_17_02/node_1087470/19466418-1-jpn-JP/2017-6-7-NY.jpg
            // http://img.elle.co.jp/var/ellejp/storage/images/fashion/celeb/selenagomez-bestsnap-2016_17_02/node_1087470/19466418-1-jpn-JP/2017-6-7-NY_image_size_192_x.jpg
            //   http://img.elle.co.jp/var/ellejp/storage/images/fashion/celeb/selenagomez-bestsnap-2016_17_02/node_1087470/19466418-1-jpn-JP/2017-6-7-NY.jpg
            domain_nosub === "elle.co.jp" ||
            // http://harpersbazaar.jp/var/hb/storage/images/news/rihanna-30th-birhtday-bad-girl-style-180220-hns/node_54568/658313-1-jpn-JP/2017-9-7_image_size_150_x.jpg
            //   http://harpersbazaar.jp/var/hb/storage/images/news/rihanna-30th-birhtday-bad-girl-style-180220-hns/node_54568/658313-1-jpn-JP/2017-9-7.jpg
            domain_nowww === "harpersbazaar.jp" ||
            // http://www.fotogramas.es/var/ezflow_site/storage/images/media/imagenes/recursos/irnidos/137969938-1-esl-ES/irnidos_reference.jpg
            //   http://www.fotogramas.es/var/ezflow_site/storage/images/media/imagenes/recursos/irnidos/137969938-1-esl-ES/irnidos.jpg
            // http://www.fotogramas.es/var/ezflow_site/storage/images/cinefilia/vicky-luengo-fotomaton/138002962-1-esl-ES/Fotomaton-a-Vicky-Luengo_line.jpg
            //   http://www.fotogramas.es/var/ezflow_site/storage/images/cinefilia/vicky-luengo-fotomaton/138002962-1-esl-ES/Fotomaton-a-Vicky-Luengo.jpg
            // http://www.fotogramas.es/var/ezflow_site/storage/images/noticias-cine/bryan-singer-resuelve-agujero-guion-franquicia-x-men/138127548-1-esl-ES/Bryan-Singer-resuelve-uno-de-los-mayores-agujeros-de-guion-de-la-franquicia-X-Men_columna.jpg
            //   http://www.fotogramas.es/var/ezflow_site/storage/images/noticias-cine/bryan-singer-resuelve-agujero-guion-franquicia-x-men/138127548-1-esl-ES/Bryan-Singer-resuelve-uno-de-los-mayores-agujeros-de-guion-de-la-franquicia-X-Men.jpg
            // http://www.fotogramas.es/var/ezflow_site/storage/images/media/imagenes/recursos/david/138049887-1-esl-ES/david_reference.jpg
            //   http://www.fotogramas.es/var/ezflow_site/storage/images/media/imagenes/recursos/david/138049887-1-esl-ES/david.jpg -- 4283x2855
            // http://www.fotogramas.es/var/ezflow_site/storage/images/cinefilia/fotomaton-a-andrea-duro/77425064-1-esl-ES/Fotomaton-a-Andrea-Duro_dos_elementos.jpg
            //   http://www.fotogramas.es/var/ezflow_site/storage/images/cinefilia/fotomaton-a-andrea-duro/77425064-1-esl-ES/Fotomaton-a-Andrea-Duro.jpg
            // http://www.fotogramas.es/var/ezflow_site/storage/images/cinefilia/documentales-musicales-que-tienes-que-ver/85507133-3-esl-ES/Documentales-musicales-que-tienes-que-ver_inferior-seccion-mos.jpg
            //   http://www.fotogramas.es/var/ezflow_site/storage/images/cinefilia/documentales-musicales-que-tienes-que-ver/85507133-3-esl-ES/Documentales-musicales-que-tienes-que-ver.jpg
            // http://www.fotogramas.es/var/ezflow_site/storage/images/cinefilia/ant-man-avispa-peliculas-personajes-reducidos-diminutos/138126801-1-esl-ES/Ant-Man-y-la-Avispa-y-otras-10-peliculas-con-protagonistas-reducidos_inferior-seccion-mos_portrait.jpg
            //   http://www.fotogramas.es/var/ezflow_site/storage/images/cinefilia/ant-man-avispa-peliculas-personajes-reducidos-diminutos/138126801-1-esl-ES/Ant-Man-y-la-Avispa-y-otras-10-peliculas-con-protagonistas-reducidos.jpg
            // http://www.fotogramas.es/var/ezflow_site/storage/images/noticias-cine/michelle-pfeiffer-entrevista-ant-man-y-la-avispa/138123067-1-esl-ES/El-heroico-retorno-de-Michelle-Pfeiffer-Nunca-pense-a-mi-edad-volver-al-universo-de-los-superheroes_slideshow_principal.jpg
            //   http://www.fotogramas.es/var/ezflow_site/storage/images/noticias-cine/michelle-pfeiffer-entrevista-ant-man-y-la-avispa/138123067-1-esl-ES/El-heroico-retorno-de-Michelle-Pfeiffer-Nunca-pense-a-mi-edad-volver-al-universo-de-los-superheroes.jpg
            domain_nowww === "fotogramas.es" ||
            // http://ellegirl.jp/var/assets/storage/images/article/f_c_daisy_ridley_17_1214/20160410/2386181-1-jpn-JP/MTV-2016_rect600_315.jpg
            //   http://img.ellegirl.jp/var/assets/storage/images/article/f_c_daisy_ridley_17_1214/20160410/2386181-1-jpn-JP/MTV-2016.jpg
            // http://img.ellegirl.jp/var/assets/storage/images/article/f_c_daisy_ridley_17_1214/20160410/2386181-1-jpn-JP/MTV-2016_rect490.jpg
            //   http://img.ellegirl.jp/var/assets/storage/images/article/f_c_daisy_ridley_17_1214/20160410/2386181-1-jpn-JP/MTV-2016.jpg
            // http://img.ellegirl.jp/var/assets/storage/images/article/c_jennifer_aniston_been_treated_worse_by_women_18_0803/2717464-1-jpn-JP/_1_square64.jpg
            //   http://img.ellegirl.jp/var/assets/storage/images/article/c_jennifer_aniston_been_treated_worse_by_women_18_0803/2717464-1-jpn-JP/_1.jpg
            domain_nosub === "ellegirl.jp" ||
            // https://esquire.jp/var/mensclubjp/storage/images/fashion/news/jimmy-choo-dakota-fanning-170313-hns/03/910674-3-jpn-JP/03_rect480.jpg
            //   https://esquire.jp/var/mensclubjp/storage/images/fashion/news/jimmy-choo-dakota-fanning-170313-hns/03/910674-3-jpn-JP/03.jpg
            domain_nosub === "esquire.jp" ||
            // http://img.25ans.jp/var/25ansjp/storage/images/news/fashion/2018-oscar-after-party-by-vanityfair-180306-hns/xcx/1397821-1-jpn-JP/XCX_image_630_x.jpg
            //   http://img.25ans.jp/var/25ansjp/storage/images/news/fashion/2018-oscar-after-party-by-vanityfair-180306-hns/xcx/1397821-1-jpn-JP/XCX.jpg
            domain === "img.25ans.jp" ||
            // https://www.cosmopolitan.com.hk/var/cosmopolitanhk/storage/images/love/1547654e3981d65/154765314ff54c10933edc096fec3b76154765314fff4e8c9f9d0bdc6dc79fd6/1644822-1-chi-HK/154765314ff54c10933edc096fec3b76154765314fff4e8c9f9d0bdc6dc79fd6_img_750_h.png
            //   https://www.cosmopolitan.com.hk/var/cosmopolitanhk/storage/images/love/1547654e3981d65/154765314ff54c10933edc096fec3b76154765314fff4e8c9f9d0bdc6dc79fd6/1644822-1-chi-HK/154765314ff54c10933edc096fec3b76154765314fff4e8c9f9d0bdc6dc79fd6.png
            domain_nowww === "cosmopolitan.com.hk" ||
            // https://www.elle.com.hk/var/ellehk/storage/images/fashion/style_insight/the-most-memorable-oscar-dresses-of-all-time/margot-robbie-2016/22000015-1-chi-HK/MARGOT-ROBBIE-2016_img_885_590.jpg
            //   https://www.elle.com.hk/var/ellehk/storage/images/fashion/style_insight/the-most-memorable-oscar-dresses-of-all-time/margot-robbie-2016/22000015-1-chi-HK/MARGOT-ROBBIE-2016.jpg
            domain_nowww === "elle.com.hk" ||
            // http://m.vogue.de/var/vogue/storage/images/home/vogue/fashion-shows/kollektionen/fruehjahr-2017-hc/paris/alexandre-vauthier/runway/_arc0726/23291608-1-ger-DE/_arc0726_v540x910.jpg
            //   https://m.vogue.de/var/vogue/storage/images/home/vogue/fashion-shows/kollektionen/fruehjahr-2017-hc/paris/alexandre-vauthier/runway/_arc0726/23291608-1-ger-DE/_arc0726.jpg
            domain_nosub === "vogue.de" ||
            // https://img1.telestar.fr/var/telestar/storage/images/2/9/0/290401/1732584-1/Calista-Flockhart-dans-la-serie-Ally-McBeal-en-1997_width1024.jpg
            //   https://img1.telestar.fr/var/telestar/storage/images/2/9/0/290401/1732584-1/Calista-Flockhart-dans-la-serie-Ally-McBeal-en-1997.jpg
            (domain_nosub === "telestar.fr" && domain.match(/img[0-9]*\.telestar\.fr/)) ||
            // https://img3.closermag.fr/var/closermag/storage/images/bio-people/biographie-jose-garcia-112817/827937-1-fre-FR/Jose-Garcia_square500x500.jpg
            //   https://img3.closermag.fr/var/closermag/storage/images/bio-people/biographie-jose-garcia-112817/827937-1-fre-FR/Jose-Garcia.jpg
            (domain_nosub === "closermag.fr" && domain.match(/img[0-9]*\.closermag\.fr/))) {
            // https://img3.grazia.fr/var/grazia/storage/images/article/cinema-solene-rigot-grande-petite-849768/13583494-1-fre-FR/Cinema-Solene-Rigot-grande-petite_exact1900x908_l.jpg
            //   https://img3.grazia.fr/var/grazia/storage/images/article/cinema-solene-rigot-grande-petite-849768/13583494-1-fre-FR/Cinema-Solene-Rigot-grande-petite.jpg
            return src.replace(/(:\/\/[^/]*\/var\/[^/]*\/storage\/images\/.*\/[^/]+)_[a-z][^-/.]*(\.[^/.]*)$/, "$1$2");
            //return src.replace(/_(?:article|large|medium|photo_galleries|more_in_thumbnail|square[0-9]*|cover_image)(?:_[a-z_]*)?(\.[^/.]*)$/, "$1");
            //return src.replace(/_image_size_[0-9]+_x(?:_[0-9]+)?(\.[^/.]*)$/, "$1");
            //return src.replace(/_image_[0-9]+_x(\.[^/.]*)$/, "$1");
            //return src.replace(/_(?:columna|line|reference|dos_elementos|inferior-seccion-mos|portrait|slideshow|principal)(\.[^/.]*)$/, "$1");
            //return src.replace(/_(?:rect|square)[0-9]+(?:_[0-9]+)?(\.[^/.]*)$/, "$1");
            //return src.replace(/_img_[0-9]+_[a-z](\.[^/.]*)$/, "$1");
            //return src.replace(/_img_[0-9]+_[0-9]+(\.[^/.]*)$/, "$1");
            //return src.replace(/_v[0-9]*x[0-9]*\.([^/]*)$/, ".$1");
            //return src.replace(/_width[0-9]*(\.[^/.]*)$/, "$1");
        }

        if ((domain_nosub === "purepeople.com" ||
             // http://static1.purepeople.com.br/articles/2/21/41/22/@/2458737-camila-queiroz-admitiu-que-nunca-consegu-950x0-3.jpg
             //   http://static1.purepeople.com.br/articles/2/21/41/22/@/2458737-camila-queiroz-admitiu-que-nunca-consegu-999999999x0-3.jpg
             domain_nosub === "purepeople.com.br" ||
             // http://static1.purebreak.com/articles/8/59/23/8/@/208690-ciara-800x0-2.jpg
             //   http://static1.purebreak.com/articles/8/59/23/8/@/208690-ciara-0x0-2.jpg -- white padding?
             domain_nosub === "purebreak.com" ||
             // http://static1.purebreak.com.br/articles/5/63/38/5/@/250333-fifth-harmony-releva-desejo-de-fazer-par-696x0-2.jpg
             //   http://static1.purebreak.com.br/articles/5/63/38/5/@/250333-fifth-harmony-releva-desejo-de-fazer-par-999999999x0-2.jpg
             domain_nosub === "purebreak.com.br" ||
             // http://static1.get-the-look.ca/articles/7/11/03/7/@/35882-for-a-perfect-matte-complexion-like-barb-1000x0-2.jpg
             //   http://static1.get-the-look.ca/articles/7/11/03/7/@/35882-for-a-perfect-matte-complexion-like-barb-999999999x0-2.jpg
             domain_nosub === "get-the-look.ca" ||
             // http://static1.hairstyle.com/articles/2/29/32/@/9632-barbara-palvin-s-slicked-back-updo-if-905x0-2.jpg
             //   http://static1.hairstyle.com/articles/2/29/32/@/9632-barbara-palvin-s-slicked-back-updo-if-999999999x0-2.jpg
             domain_nosub === "hairstyle.com" ||
             // http://static1.puretrend.com/articles/5/13/91/15/@/1572135-ciara-joue-un-jeu-dangeureux-en-robe-950x0-2.jpg
             //   http://static1.puretrend.com/articles/5/13/91/15/@/1572135-ciara-joue-un-jeu-dangeureux-en-robe-999999999x0-2.jpg
             domain_nosub === "puretrend.com") &&
            domain.match(/^static[0-9]*\./)) {
            // http://static1.purepeople.com/articles/8/21/01/98/@/2822958-l-actrice-solene-rigot-pour-le-film-en-950x0-1.jpg
            //   http://static1.purepeople.com/articles/8/21/01/98/@/2822958-l-actrice-solene-rigot-pour-le-film-en-0x0-1.jpg
            // http://static1.purepeople.com/articles/8/21/01/98/@/2822931-l-acteur-jose-garcia-pour-le-film-a-fon-114x114-1.jpg
            //   http://static1.purepeople.com/articles/8/21/01/98/@/2822931-l-acteur-jose-garcia-pour-le-film-a-fon-0x0-1.jpg
            // http://static1.purepeople.com/articles/4/20/07/24/@/2631120-solene-rigot-photocall-de-la-soiree-de-opengraph_1200-1.jpg
            //   http://static1.purepeople.com/articles/4/20/07/24/@/2631120-solene-rigot-photocall-de-la-soiree-de-opengraph_99999999x0-1.jpg
            // http://static1.purepeople.com/articles/4/20/07/24/@/2631120-solene-rigot-photocall-de-la-soiree-de-950x0-1.jpg
            //   http://static1.purepeople.com/articles/4/20/07/24/@/2631120-solene-rigot-photocall-de-la-soiree-de-999999999x0-1.jpg
            //return src.replace(/-[0-9]+x[0-9]+(-[0-9]*)?(\.[^/.]*)$/, "-0x0$1$2");
            return src.replace(/([-_])[0-9]+(?:x[0-9]+)?(-[0-9]\.[^/.]*)/, "$1999999999x0$2");
        }

        if (domain_nosub === "belezaextraordinaria.com.br" && domain.match(/^static[0-9]*\./)) {
            // http://static1.belezaextraordinaria.com.br/articles/3/52/3/@/3604--article_versus-4.jpg
            //   http://static1.belezaextraordinaria.com.br/articles/3/52/3/@/3604--article_news-4.jpg
            // http://static1.belezaextraordinaria.com.br/articles/2/23/29/2/@/237944-para-comecar-o-penteado-separe-uma-mech-article_thumb_medium-2.jpg
            //   http://static1.belezaextraordinaria.com.br/articles/2/23/29/2/@/237944-para-comecar-o-penteado-separe-uma-mech-article_news-2.jpg
            // http://static1.belezaextraordinaria.com.br/articles/4/13/38/4/@/161764-o-efeito-ondulado-valoriza-o-corte-e-as-opengraph_1200-3.jpg
            //   http://static1.belezaextraordinaria.com.br/articles/4/13/38/4/@/161764-o-efeito-ondulado-valoriza-o-corte-e-as-article_news-3.jpg
            // using 999999999x0 does work, but it adds black borders around the image
            return src.replace(/([-_])(?:[0-9]+(?:x[0-9]+)?|(?:article|opengraph)_[^-/.]+)(-[0-9]\.[^/.]*)/, "$1article_news$2");
        }

        if (domain === "medias.unifrance.org") {
            // https://medias.unifrance.org/medias/143/107/27535/format_web/media.jpg
            //   https://medias.unifrance.org/medias/143/107/27535/format_page/jose-garcia.jpg
            return src.replace("/format_web/", "/format_page/");
        }

        if (domain_nosub === "lisimg.com" ||
            domain_nosub === "listal.com") {
            // http://iv1.lisimg.com/image/10752485/628full-sol%C3%A8ne-rigot.jpg
            //   http://iv1.lisimg.com/image/10752485/0full-sol%C3%A8ne-rigot.jpg
            // http://i5.lisimg.com/10752485/70.jpg
            //   http://i5.lisimg.com/10752485/0full.jpg
            // http://lb1.lisimg.com/10752485/70.jpg
            //   http://lb1.lisimg.com/10752485/0full.jpg
            // http://ilarge.lisimg.com/image/6915143/780full-sol%C3%A8ne-rigot.jpg
            //   http://ilarge.lisimg.com/image/6915143/0full.jpg
            // http://iv1.lisimg.com/image/2916057/516full-rachel-riley.jpg
            //   http://ilarge.lisimg.com/image/2916057/0full.jpg
            return src
                .replace(/:\/\/[^\./]*\.lisimg\.com\//, "://ilarge.lisimg.com/")
                .replace(/\/([^/]*)\.jpg$/, "/99999999999full.jpg");
                //.replace(/\/([^/]*)\.jpg$/, "/0full.jpg");
        }

        if (domain_nosub === "lesinrocks.com") {
            // https://www.lesinrocks.com/content/thumbs/uploads/2017/03/width-1120-height-612-srcset-1/solene-rigot-1.jpg - stretched
            //   https://www.lesinrocks.com/content/thumbs/uploads/2017/03/width-0-height-0-srcset-1/solene-rigot-1.jpg
            // https://statics.lesinrocks.com/content/thumbs/uploads/2017/12/width-100-height-100/nerd-no-one-ever-really-dies-album-cover-release-date-1.jpg
            //   https://www.lesinrocks.com/content/thumbs/uploads/2017/12/width-0-height-0/nerd-no-one-ever-really-dies-album-cover-release-date-1.jpg
            return src.replace(/\/width-[0-9]*-height-[0-9]*/, "/width-0-height-0");
        }

        if (domain === "media.senscritique.com") {
            // https://media.senscritique.com/media/000006647807/150_200/Solene_Rigot.png
            //   https://media.senscritique.com/media/000006647807/0_0/Solene_Rigot.png
            return src.replace(/\/[0-9]*_[0-9]*\/([^/]*)$/, "/0_0/$1");
        }

        if (domain === "www.franceinter.fr" ||
            // https://cdn.radiofrance.fr/s3/cruiser-production/2017/01/10918994-f2f3-453e-952c-37dc27f8db33/maxnewsfrthree604614.jpg
            //   https://cdn.radiofrance.fr/s3/cruiser-production/2017/01/10918994-f2f3-453e-952c-37dc27f8db33/maxnewsfrthree604614.jpg
            domain === "cdn.radiofrance.fr") {
            // https://www.franceinter.fr/s3/cruiser-production/2017/03/e97f73a2-2cba-4d48-bdc4-e50392aad75a/640_orpheline.jpg
            //   https://www.franceinter.fr/s3/cruiser-production/2017/03/e97f73a2-2cba-4d48-bdc4-e50392aad75a/orpheline.jpg
            return src.replace(/\/[0-9]+(?:x[0-9]+)?_([^/]*\.jpg)$/, "/$1");
        }

        if (domain === "www.vod.lu" &&
            src.indexOf("/media/cache/") >= 0) {
            // https://github.com/liip/LiipImagineBundle/issues/912 related?

            // http://www.vod.lu/media/cache/resolve/400x225/97/0c/970c16f8-fd8f-11e6-823c-d10fb8a0c611.jpg
            //   http://www.vod.lu/media/cache/resolve/9999999x9999999/97/0c/970c16f8-fd8f-11e6-823c-d10fb8a0c611.jpg
            // http://www.vod.lu/media/cache/190x253/92/7d/927da5b5-fd8f-11e6-9eab-ed7742afa678.jpg
            //   http://www.vod.lu/media/cache/9999999x9999999/92/7d/927da5b5-fd8f-11e6-9eab-ed7742afa678.jpg
            return src.replace(/\/media\/cache\/(resolve\/)?[0-9]+x[0-9]+\//, "/media/cache/$19999999x9999999/");
        }

        if (domain === "1645110239.rsc.cdn77.org") {
            // https://1645110239.rsc.cdn77.org/image/s300/q50/mm/befr/movies14119/posters/puppylove.0.jpg
            //   https://1645110239.rsc.cdn77.org/image/mm/befr/movies14119/posters/puppylove.jpg
            // https://1645110239.rsc.cdn77.org/image/x1200x800/q80/mm/been/movies17158/posters/orpheline-1.jpg
            //   https://1645110239.rsc.cdn77.org/image/mm/been/movies17158/posters/orpheline-1.jpg
            return src
                .replace(/\/image\/[a-z][0-9]+\//, "/image/") // to be repeated
                .replace(/\/image\/x[0-9]+x[0-9]+\//, "/image/")
                .replace(/\/([^/.]*)\.[0-9]+(\.[^/.]*)$/, "/$1$2");
        }

        if (domain === "diymag.com" &&
            src.indexOf("/media/img") >= 0) {
            // http://diymag.com/media/img/Artists/B/Beck/_1500x1000_crop_center-center_75/Beck-UpAllNightVideo.jpg
            //   http://diymag.com/media/img/Artists/B/Beck/Beck-UpAllNightVideo.jpg
            return src.replace(/(\/media\/img\/.*\/)_[^/]*\/([^/]*)$/, "$1$2");
        }

        if (domain === "1.fwcdn.pl" && false) {
            // http://1.fwcdn.pl/ph/73/52/737352/569269_1.2.jpg
            // http://1.fwcdn.pl/ph/73/52/737352/569269_1.jpg
            //   http://1.fwcdn.pl/ph/73/52/737352/569269_1.1.jpg
            // doesn't work for all:
            // http://1.fwcdn.pl/an/np/875720/2018/15046_1.9.jpg -- 320x180
            //   http://1.fwcdn.pl/an/np/875720/2018/15046_1.1.jpg -- 90x90
            return src.replace(/(\/[^/.]*)(?:\.[0-9]*)?(\.[^/.]*)$/, "$1.1$2");
        }

        if (domain === "www.semainedelacritique.com" &&
            src.indexOf("/ttimg-rsz") >= 0) {
            // http://www.semainedelacritique.com/ttimg-rsz?src=/uploads/galleriemedia/ed9cf1c0cd7756b1e7e782f8bc2bc3d2.jpg&w=1200&h=800&q=100&zc=2&a=c
            //   http://www.semainedelacritique.com/uploads/galleriemedia/ed9cf1c0cd7756b1e7e782f8bc2bc3d2.jpg
            return urljoin(src, src.replace(/.*\/ttimg-rsz\?.*?src=([^&]*).*/, "$1"));
        }

        if (domain_nosub === "pmdstatic.net" && domain.match(/img\..*?pmdstatic\.net$/)) {
            // https://gal.img.pmdstatic.net/fit/https.3A.2F.2Fphoto.2Egala.2Efr.2Fupload.2Fslideshow.2Fquels-parrains-pour-les-revelations-cesar-les-photos-de-la-soiree-chanel-au-petit-palais-27606.2Fsolene-rigot-chien-et-son-parrain-samuel-benchetrit-475504.2Ejpg/400x600/quality/65/solene-rigot-chien-et-son-parrain-samuel-benchetrit.jpg
            //   https://photo.gala.fr/upload/slideshow/quels-parrains-pour-les-revelations-cesar-les-photos-de-la-soiree-chanel-au-petit-palais-27606/solene-rigot-chien-et-son-parrain-samuel-benchetrit-475504.jpg
            // http://gal.img.pmdstatic.net/fit/https.3A.2F.2Fi.2Eimgur.2Ecom.2FQK42KsW.2Ejpg/400x600/quality/65/test.jpg
            //   https://i.imgur.com/QK42KsW.jpg
            // http://img.tra.pmdstatic.net/fit/http.3A.2F.2Fwww.2Efoodreporter.2Efr.2Fupload.2Foriginal.2F5.2Fc.2Fz.2F8.2Fu.2F1258707.2Ejpg/312x240/quality/100/picture.jpg
            return decodeURIComponent(src.replace(/.*?\.pmdstatic\.net\/fit\/([^/]*).*/, "$1").replace(/\./g, "%"));
        }

        if (domain === "photo.gala.fr") {
            // gives content-length of 0
            // https://photo.gala.fr/upload/slideshow/quels-parrains-pour-les-revelations-cesar-les-photos-de-la-soiree-chanel-au-petit-palais-27606/solene-rigot-chien-et-son-parrain-samuel-benchetrit-475504.jpg
            return {
                url: src,
                head_wrong_contentlength: true
            };
        }

        if (domain === "cdn.cnn.com" ||
            (domain_nosub === "turner.com" && domain.match(/(?:i[0-9]*\.)?cdn\.turner\.com/))) {
            // https://cdn.cnn.com/cnnnext/dam/assets/170301101237-emma-watson-selfies-exlarge-169.jpg
            //   https://cdn.cnn.com/cnnnext/dam/assets/170301101237-emma-watson-selfies.jpg
            // https://cdn.cnn.com/cnnnext/dam/assets/171226214729-carl-bernstein-12-26-super-169.jpg
            //   https://cdn.cnn.com/cnnnext/dam/assets/171226214729-carl-bernstein-12-26.jpg
            // https://cdn.cnn.com/cnnnext/dam/assets/170220104445-mark-turner-volvo-ocean-race-super-169.jpg
            //   https://cdn.cnn.com/cnnnext/dam/assets/170220104445-mark-turner-volvo-ocean-race.jpg
            // https://cdn.cnn.com/cnnnext/dam/assets/170303101934-emma-watson---premiere-full-169.jpg (definitely not full)
            //   https://cdn.cnn.com/cnnnext/dam/assets/170303101934-emma-watson---premiere.jpg
            // https://cdn.cnn.com/cnnnext/dam/assets/170307035422-emma-watson-on-kimmel-02-large-169.jpg
            //   https://cdn.cnn.com/cnnnext/dam/assets/170307035422-emma-watson-on-kimmel-02.jpg
            // https://cdn.cnn.com/cnnnext/dam/assets/180209072938-33-winter-olympics-opening-ceremony-0209-overlay-tease.jpg
            //   https://cdn.cnn.com/cnnnext/dam/assets/180209072938-33-winter-olympics-opening-ceremony-0209.jpg
            // https://cdn.cnn.com/cnnnext/dam/assets/180209112927-10-winter-olympics-opening-ceremony-0209-large-tease.jpg
            //   https://cdn.cnn.com/cnnnext/dam/assets/180209112927-10-winter-olympics-opening-ceremony-0209.jpg
            // https://cdn.cnn.com/cnnnext/dam/assets/180208122950-palestinian-deportee-6-large-alt-11.jpg
            //   https://cdn.cnn.com/cnnnext/dam/assets/180208122950-palestinian-deportee-6.jpg
            // http://i2.cdn.turner.com/cnn/dam/assets/130318122753-emma-watson-january-2013-story-top.jpg
            //   http://i2.cdn.turner.com/cnn/dam/assets/130318122753-emma-watson-january-2013.jpg
            // http://cdn.cnn.com/cnnnext/dam/assets/170428012205-28-met-gala-kurkova.jpg
            // https://cdn.cnn.com/cnnnext/dam/assets/180405060923-plastic-bags-edinburgh-beach-file-restricted-exlarge-169.jpg
            //   https://cdn.cnn.com/cnnnext/dam/assets/180405060923-plastic-bags-edinburgh-beach-file-restricted.jpg
            // doesn't work:
            // http://cdn.cnn.com/cnnnext/dam/assets/140630134917-12-canada-most-beautiful-places-super-169.jpg
            // http://cdn.cnn.com/cnnnext/dam/assets/140630134917-12-canada-most-beautiful-places-large-169.jpg
            // http://cdn.cnn.com/cnnnext/dam/assets/140630134917-12-canada-most-beautiful-places-exlarge-169.jpg
            // http://cdn.cnn.com/cnnnext/dam/assets/140630134917-12-canada-most-beautiful-places-full-169.jpg
            //return src.replace(/-(?:small|medium|large|exlarge|super|full|overlay)-[0-9]*(\.[^/.]*)$/, "$1");
            return {
                url: src.replace(/-(?:small|medium|large|exlarge|super|full|overlay|alt|tease|story-top)(?:-(?:small|medium|large|exlarge|super|full|overlay|alt|tease))?(?:-[0-9]*)?(\.[^/.]*)$/, "$1"),
                can_head: false
            };
            //return src.replace(/-[a-z]*-(?:169|tease)(\.[^/.]*)$/, "$1");
        }

        if (domain === "ugc.kn3.net"/* &&
            src.indexOf("/i/origin/") >= 0*/) {
            // https://ugc.kn3.net/i/origin/http://media3.popsugar-assets.com/files/2013/09/16/795/n/1922564/b962955383f6b80f_1592163256t6a65.xxxlarge_2x/i/Emma-Watson-all-legs-sexy-Peter-Pilotto-cutout-minidress.jpg
            // https://ugc.kn3.net/i/760x/https://butacadavidciana.files.wordpress.com/2015/01/hatefuleightposter.jpg
            //return src.replace(/.*?\/i\/origin\//, "");
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/i\/[0-9a-z]+\//, "");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain === "media.shoko.fr" ||
            // https://media.fan2.fr/article-2548712-ajust_1020-f205148/dove-cameron-devoile-un-trailer-du-nouveau.jpg
            //   https://media.fan2.fr/article-2548712-redim-f205148/dove-cameron-devoile-un-trailer-du-nouveau.jpg
            domain === "media.fan2.fr" ||
            // https://media.melty.it/article-2883254-so-f1/media.jpg
            //   https://media.melty.it/article-2883254-redim-f1/media.jpg
            domain === "media.melty.it" ||
            // https://media.melty.fr/article-3657708-thumb-f8/quantico-saison-3-priyanka-chopra-alex-tease.jpg
            // https://media.melty.fr/article-3658090-head-f4/rihanna-anniversaire-pornhub-film-porno-pornographie.jpg
            // https://media.melty.fr/article-3658090-full/booba-veut-arreter-sa-carriere-fergie-en.jpg
            // https://media.melty.fr/article-923024-head/meltylife-meryl-melty-fr-redactrice-travaille.jpg
            domain === "media.melty.fr") {
            // https://media.shoko.fr/article-3410081-ajust_1000-f1483450645/emma-watson-en-2013-a-l-avant-premiere-de.jpg
            // https://media.shoko.fr/article-3410093-ratio_100-f1483451011/emma-watson-en-1998-une-star-est-nee.jpg
            // https://media.shoko.fr/media_aggregate-3410071-ajust_700-f1483450315/emma-watson-2014-look-red-carpet-harry-potter.jpg
            // https://media.shoko.fr/article-3410071-redim-f1483450315/emma-watson-en-2014-aux-brit-fashion-awards.jpg
            // https://media.shoko.fr/article-1234470-head/emma-watson-peoples-choice-awards-2013.jpg
            // https://media.shoko.fr/emma-watson-harry-potter-et-les-reliques-image-393422-article-head.jpg
            // different:
            // https://media.melty.fr/article-3657733-thumb-f8/julia-les-marseillais-australia-celibataire.jpg
            //   https://media.melty.fr/article-3657733-redim-f8/julia-les-marseillais-australia-celibataire.jpg
            return src
                .replace(/(:\/\/[^/]*)\/([^/]*?)-[^/-]*((?:-f[^/]*)?\.[^/.]*)$/, "$1/$2-redim$3")
                .replace(/(:\/\/[^/]*)\/([^/-]*?-[0-9]*-)[^/-]*(-f[^/]*)?\//, "$1/$2redim$3/");
        }

        if (domain_nosub === "vogue.fr" ||
            // http://www.glamourparis.com/uploads/images/thumbs/201637/48/rodarte_jpg_8718_north_458x687_white.jpg
            domain === "www.glamourparis.com" ||
            // http://www.gqmagazine.fr/uploads/images/thumbs/201803/b7/_vui0653_jpg_9983_north_640x960_transparent.jpg
            //   http://www.gqmagazine.fr/uploads/images/201803/b7/_vui0653_jpg_9983.jpg
            domain === "www.gqmagazine.fr") {
            // https://en.vogue.fr/uploads/images/thumbs/201804/a0/tee_1841.jpeg_north_499x_white.jpg
            //   https://en.vogue.fr/uploads/images/201804/a0/tee_1841.jpeg
            // https://en.vogue.fr/uploads/images/thumbs/201725/26/emma_watson__jpg_3972_jpeg_2620.jpeg_north_499x_white.jpg
            //   https://en.vogue.fr/uploads/images/201725/26/emma_watson__jpg_3972_jpeg_2620.jpeg
            // https://en.vogue.fr/uploads/images/thumbs/201725/55/emma_watson_miu_miu_the_circle_premiere_21_06_2017_paris_jpg_8082_jpeg_7667.jpeg_north_499x_white.jpg
            //   https://en.vogue.fr/uploads/images/201725/55/emma_watson_miu_miu_the_circle_premiere_21_06_2017_paris_jpg_8082_jpeg_7667.jpeg
            //
            // https://en.vogue.fr/uploads/images/thumbs/201712/d2/gettyimages_647393804_jpg_9242_north_499x_white.jpg
            //   https://en.vogue.fr/uploads/images/201712/d2/gettyimages_647393804_jpg_9242.jpg
            // https://en.vogue.fr/uploads/images/thumbs/201712/a4/emma_watson_in_givenchy_hc_par_rt_jpg_340_north_499x_white.jpg
            //   https://en.vogue.fr/uploads/images/201712/a4/emma_watson_in_givenchy_hc_par_rt_jpg_340.jpg
            src = src
                .replace("/images/thumbs/", "/images/");
            newsrc = src.replace(/(\.[^/._]*)_[^/]*$/, "$1");
            if (newsrc !== src)
                return newsrc;
            return src.replace(/_north_[0-9]*x(?:[0-9]+)?_(?:white|transparent)(\.[^/.]*)$/, "$1");
        }

        if (domain === "img.culturacolectiva.com") {
            // https://img.culturacolectiva.com/featured/2017/10/bdfd42e4-138b-4037-8b56-8c309a3dc385-high.jpg
            // https://img.culturacolectiva.com/featured/2018/01/24/1516840709928/le-moine-le-moine-the-monk-13-07-2011-1-g_a_l-medium.jpg
            return src.replace(/-(?:high|medium|low)(\.[^/.]*)$/, "$1");
        }

        if ((domain_nosub === "reveliststatic.com" ||
             // https://ugc-01.cafemomstatic.com/gen/resize/256/386/80/2012/02/16/10/ci/6g/pofsu3tdkw.jpg
             //   https://ugc-01.cafemomstatic.com/gen/full/2012/02/16/10/ci/6g/pofsu3tdkw.jpg
             // https://ugc-01.cafemomstatic.com/gen/crop/9999/9999/0/2018/02/01/11/4g/tr/po8puaj0cg72.png
             //   https://ugc-01.cafemomstatic.com/gen/full/2018/02/01/11/4g/tr/po8puaj0cg72.png
             // http://ugc-01.cafemomstatic.com/gen/crop/9999/9999/0/2018/01/25/11/44/8r/ph1gxpvbeo2qbwe.jpg -- stretched
             //   http://ugc-01.cafemomstatic.com/gen/full/2018/01/25/11/44/8r/ph1gxpvbeo2qbwe.jpg
             // https://static-01.cafemomstatic.com/images/stir_2014/special/celebrate-dad/celebrate_dad_activities_header.jpg
             domain_nosub === "cafemomstatic.com") &&
            domain.match(/^ugc(?:-[0-9]*)?\./)) {
            // http://ugc.reveliststatic.com/gen/constrain/800/800/80/2017/05/09/10/6x/ix/phdkya0kkk2qbwe.jpg
            //   http://ugc.reveliststatic.com/gen/full/2017/05/09/10/6x/ix/phdkya0kkk2qbwe.jpg

            //return src.replace(/\/gen\/crop\/[0-9]*\/[0-9]*\/[0-9]*\//, "/gen/crop/9999/9999/0/");
            //return src.replace(/\/gen\/crop\/[0-9]+\/[0-9]+\/[0-9]+\//, "/gen/full/");
            return src.replace(/\/gen\/(?:constrain|crop|resize)\/[0-9]*\/[0-9]*\/[0-9]*\//, "/gen/full/");
        }

        if (domain === "static.giantbomb.com") {
            // https://static.giantbomb.com/uploads/square_medium/0/329/2767259-journey_20150721143742.jpg
            //   https://static.giantbomb.com/uploads/original/0/329/2767259-journey_20150721143742.jpg
            return src.replace(/\/uploads\/[^/]*\//, "/uploads/original/");
        }

        if (domain === "images.shazam.com") {
            // https://images.shazam.com/coverart/t113448093-b320004845_s400.jpg
            //   https://images.shazam.com/coverart/t113448093-b320004845_s0.jpg
            return src.replace(/_s[0-9]+(\.[^/.]*)$/, "_s0$1");
        }

        if (domain_nosub === "ebayimg.com") {
            // https://i.ebayimg.com/images/g/2lIAAOSwsS1Zkh1k/s-l300.jpg
            //   https://i.ebayimg.com/images/g/2lIAAOSwsS1Zkh1k/s-l9999.jpg
            // https://ssli.ebayimg.com/images/g/nqQAAOSwh2RZ6b1q/s-l500.jpg
            //   https://ssli.ebayimg.com/images/g/nqQAAOSwh2RZ6b1q/s-l9999.jpg
            // http://i.ebayimg.com/images/i/121630247122-0-1/s-l1000.jpg -- 9999 doesn't work
            // http://i.ebayimg.com/images/i/262923537353-0-1/s-l1000.jpg -- 9999
            //   https://i.ebayimg.com/images/g/6OoAAOSw3gJZHI1d/s-l1000.jpg
            // https://i.ebayimg.com/thumbs/images/g/2FMAAOSw4A5Y0l-Z/s-l200.jpg
            //   https://i.ebayimg.com/images/g/2FMAAOSw4A5Y0l-Z/s-l9999.jpg

            // http://i.ebayimg.com/t/Trashy-Red-Riding-Hood-Gingham-Cute-Dress-Up-Halloween-Sexy-Teen-Adult-Costume-/00/s/MzUwWDM1MA==/z/be8AAMXQxVZRCdlO/$T2eC16VHJHgE9n0yFji(BRCdlO!Zpg~~60_35.JPG
            //   http://i.ebayimg.com/00/s/MzUwWDM1MA==/z/be8AAMXQxVZRCdlO/$T2eC16VHJHgE9n0yFji(BRCdlO!Zpg~~60_35.JPG
            //   http://i.ebayimg.com/images/g/be8AAMXQxVZRCdlO/s-l9999.jpg
            newsrc = src.replace(/\/t\/.*?(\/[0-9]+\/s\/)/, "$1");
            if (newsrc !== src) {
                return newsrc;
            }

            // http://i.ebayimg.com/00/s/NjAwWDQ1MA==/z/mEAAAOSwKIpWBa25/$_23.JPG
            //   http://i.ebayimg.com/images/g/mEAAAOSwKIpWBa25/s-l9999.jpg
            newsrc = src.replace(/\/[0-9]+\/[a-z]+\/[^/]*\/[a-z]+\/([^/]+)\/[^/.]*(\.[^/.]*)$/, "/images/g/$1/s-l9999$2");
            if (newsrc !== src) {
                newsrc = newsrc.replace(/(.*\.)[^/.]*$/, "$1") + newsrc.replace(/.*\.([^/.]*)$/, "$1").toLowerCase();
                return newsrc;
            }

            return src
                .replace(/\/thumbs\/images\//, "/images/")
                .replace(/-l[0-9]+(\.[^/.]*)$/, "-l9999$1");
        }

        if ((domain_nosub === "ebaystatic.com" && domain.match(/thumbs[0-9]*\.ebaystatic\.com/)) ||
            // https://securethumbs.ebay.com/d/l140/m/mk1ADy4oa1rnraV-rOti0YQ.jpg
            //   https://ssli.ebayimg.com/images/m/mk1ADy4oa1rnraV-rOti0YQ/s-l9999.jpg
            domain === "securethumbs.ebay.com") {
            // https://thumbs2.ebaystatic.com/m/mKuDpR7Z1yrk82zzlihfOCw/140.jpg
            //   https://ssli.ebayimg.com/images/m/mKuDpR7Z1yrk82zzlihfOCw/s-l9999.jpg
            // https://thumbs2.ebaystatic.com/d/l225/m/mjVOwmkHHi8X0sPdlQhUV7Q.jpg
            //   https://ssli.ebayimg.com/images/m/mjVOwmkHHi8X0sPdlQhUV7Q/s-l9999.jpg
            // https://thumbs.ebaystatic.com/d/l225/pict/400793189705_4.jpg
            //   https://i.ebayimg.com/images/g/X20AAOSwgN9bTFxs/s-l9999.jpg
            //   https://thumbs.ebaystatic.com/d/l9999/pict/400793189705_4.jpg
            // http://thumbs4.ebaystatic.com/pict/1723764064234040_2.jpg
            newsrc = src
                .replace(/^[a-z]*:\/\/[^/]*\/(.*?)\/[0-9]+(\.[^/.]*)$/, "https://ssli.ebayimg.com/images/$1/s-l9999$2")
                .replace(/^[a-z]*:\/\/[^/]*\/d\/l[0-9]+\/([a-z]\/[^/]*)(\.[^/.]*)$/, "https://ssli.ebayimg.com/images/$1/s-l9999$2");
            if (newsrc !== src) {
                return newsrc;
            }

            newsrc = src.replace(/\/d\/[a-z][0-9]+\/pict\//, "/d/l9999/pict/");
            if (newsrc !== src) {
                return {
                    url: src.replace(/\/d\/[a-z][0-9]+\/pict\//, "/d/l9999/pict/"),
                    can_head: false // it just hangs
                }
            }
        }

        if (domain === "www.picclickimg.com") {
            // https://www.picclickimg.com/d/l400/pict/232427221641_/Dove-Cameron-Delicate-8x10-Photo-Picture-Celebrity-Print.jpg
            //   https://thumbs.ebaystatic.com/d/l400/pict/232427221641_/Dove-Cameron-Delicate-8x10-Photo-Picture-Celebrity-Print.jpg
            //   https://www.picclickimg.com/d/l9999/pict/232427221641_/Dove-Cameron-Delicate-8x10-Photo-Picture-Celebrity-Print.jpg
            //   https://thumbs.ebaystatic.com/d/l9999/pict/232427221641_/Dove-Cameron-Delicate-8x10-Photo-Picture-Celebrity-Print.jpg
            // https://www.picclickimg.com/00/s/ODAwWDgwMA==/z/qYUAAOSwzqFY-smJ/$/Overwatch-Swimsuit-OW-Game-D-Va-Swimwear-Cosplay-_1.jpg
            //   https://i.ebayimg.com/00/s/ODAwWDgwMA==/z/qYUAAOSwzqFY-smJ/$/Overwatch-Swimsuit-OW-Game-D-Va-Swimwear-Cosplay-_1.jpg
            return src
                .replace(/:\/\/www.picclickimg.com\/d\//, "://thumbs.ebaystatic.com/d/")
                .replace(/:\/\/www.picclickimg.com(\/[0-9]+\/s\/)/, "://i.ebayimg.com$1");
        }

        if (domain_nowww === "ezcorporateembroidery.com") {
            // http://www.ezcorporateembroidery.com/images/scale/l200/pict/323407082997_1.jpg
            //   http://thumbs4.ebaystatic.com/d/l200/pict/323407082997_1.jpg
            //   https://securethumbs.ebay.com/d/l200/pict/323407082997_1.jpg
            //   https://securethumbs.ebay.com/d/l9999/pict/323407082997_1.jpg
            // http://www.ezcorporateembroidery.com/packs/imageslarge/http://www.ezcorporateembroidery.com/images/scale/l400/pict/323407082997_1.jpg
            //   http://www.ezcorporateembroidery.com/images/scale/l400/pict/323407082997_1.jpg
            //   https://securethumbs.ebay.com/d/l9999/pict/323407082997_1.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/packs\/images[a-z]+\/(https?:\/\/)/, "$1");
            if (newsrc !== src)
                return newsrc;
            return src.replace(/^[a-z]+:\/\/[^/]*\/images\/scale\/([a-z][0-9]+\/)/, "https://securethumbs.ebay.com/d/$1");
        }

        if (domain === "i.slkimg.com") {
            // https://i.slkimg.com/isv1/album/v5d0aa81654166d6a/3248641/web/3/fill/5,0/600.jpg
            //    https://i.slkimg.com/isv1/album/v5d0aa81654166d6a/3248641/web/3/999999999.jpg
            return src
                .replace(/\/fill\/[0-9]+,[0-9]+\//, "/")
                .replace(/[0-9]+(\.[^/.]*)$/, "999999999$1");
        }

        if (domain === "i.vimeocdn.com" &&
            src.indexOf("/filter/overlay") >= 0) {
            // https://i.vimeocdn.com/filter/overlay?src0=https%3A%2F%2Fi.vimeocdn.com%2Fvideo%2F504371620_1280x720.jpg&src1=https%3A%2F%2Ff.vimeocdn.com%2Fimages_v6%2Fshare%2Fplay_icon_overlay.png
            //   https://i.vimeocdn.com/video/504371620_1280x720.jpg
            return decodeURIComponent(src.replace(/.*\/overlay\?.*?src0=([^&]*).*/, "$1"));
        }

        if (domain === "imagelab.nownews.com") {
            // https://imagelab.nownews.com/?w=300&q=70&src=https://rssimg.nownews.com/images/5a6f132bda68fc5330825347_201801292027.jpg
            //   https://rssimg.nownews.com/images/5a6f132bda68fc5330825347_201801292027.jpg
            // https://imagelab.nownews.com/?w=300&q=70&src=https%3A%2F%2Fimg.nownews.com%2Fnownews_production%2Fimages%2F5a6f3bb53d666a52fa4894d8_201801292320.png
            //   https://img.nownews.com/nownews_production/images/5a6f3bb53d666a52fa4894d8_201801292320.png
            return decodeURIComponent(src.replace(/.*[/?&]src=(.*)$/, "$1"));
        }

        if (domain === "cdn.discordapp.com") {
            // https://cdn.discordapp.com/avatars/191394916771823617/a_0cc6551148c73504703e5c4dba44bc0a.png?size=128
            //   https://cdn.discordapp.com/avatars/191394916771823617/a_0cc6551148c73504703e5c4dba44bc0a.png?size=2048
            return src.replace(/\?size=[0-9]*$/, "?size=2048");
        }

        if (domain_nosub === "discordapp.net" && domain.match(/images-ext-[0-9]*\.discordapp\.net/)) {
            // https://images-ext-1.discordapp.net/external/2rLDB8F8wm8zJBuYqxmLrM31K-VuJavo6cBLu62McoY/%3Fsize%3D1024/https/cdn.discordapp.com/avatars/378382650597179392/10a9986e76557e24e53f8da2a573e6d1.webp?width=80&height=80
            //   https://cdn.discordapp.com/avatars/378382650597179392/10a9986e76557e24e53f8da2a573e6d1.webp?size=1024
            // https://images-ext-1.discordapp.net/external/Yu5JBnNXOrtdA4di9Pom8R5u-FXQVuHwUQVNA5VE6TQ/https/instagram.ftxl1-1.fna.fbcdn.net/vp/43a40cdb127e4b2731e0d73056813310/5B049080/t51.2885-15/e35/26293979_199841880752391_9218323895503814656_n.jpg?width=240&height=300
            //   https://instagram.ftxl1-1.fna.fbcdn.net/vp/43a40cdb127e4b2731e0d73056813310/5B049080/t51.2885-15/e35/26293979_199841880752391_9218323895503814656_n.jpg
            return decodeURIComponent(src.replace(/.*\/external\/[^/]*\/(?:([^/]*)\/)?(https?)\/(.*?)(?:\?[^/]*)?$/, "$2://$3$1"));
        }

        if (domain === "hot-korea.net") {
            // https://hot-korea.net/uploads/gallery/thumbs/1238.jpg
            //   https://hot-korea.net/uploads/gallery/1238.jpg
            return src.replace(/\/uploads\/([^/]*\/)thumbs\//, "/uploads/$1");
        }

        if (domain_nosub === "sndcdn.com" && domain.match(/i[0-9]*\.sndcdn\.com/)) {
            // https://i1.sndcdn.com/avatars-000300362115-78ogrs-t500x500.jpg
            //   https://i1.sndcdn.com/avatars-000300362115-78ogrs-original.jpg
            return src.replace(/-[^-/.]*(\.[^/.]*)$/, "-original$1");
        }

        if (domain === "media.licdn.com") {
            // https://media.licdn.com/mpr/mpr/shrinknp_200_200/AAEAAQAAAAAAAAIsAAAAJDI3NTdjMDNhLWM3ZWMtNGQzZS04MGE1LWJjMzlkNWIzNDlhNw.jpg
            //   https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAIsAAAAJDI3NTdjMDNhLWM3ZWMtNGQzZS04MGE1LWJjMzlkNWIzNDlhNw.jpg
            return src.replace(/\/shrinknp_[0-9]+_[0-9]+\//, "/");
        }

        if ((domain_nosub === "townnews.com" && domain.match(/bloximages\..*vip\.townnews\.com/)) ||
            // https://s3-ap-southeast-2.amazonaws.com/syd.cdn.coreweb.com.au/136/1734561-our-neighbourhood-650x360.jpg
            //   http://syd.cdn.coreweb.com.au/136/1734561-our-neighbourhood-650x360.jpg
            amazon_container === "syd.cdn.coreweb.com.au") {
            // https://bloximages.chicago2.vip.townnews.com/tucson.com/content/tncms/assets/v3/editorial/9/e1/9e16bd10-2343-5819-a7c7-89a7d520c38e/5a653cb109be0.image.jpg?resize=750%2C1067
            // https://bloximages.newyork1.vip.townnews.com/roanoke.com/content/tncms/assets/v3/editorial/5/fd/5fd9841d-3b33-5f9a-b8e7-efb5a1730a65/5408aee812bf4.image.jpg
            // https://bloximages.newyork1.vip.townnews.com/heraldmailmedia.com/content/tncms/assets/v3/editorial/1/9a/19a45cfe-354a-11e3-939d-001a4bcf6878/5800f2836b369.image.jpg?resize=1200%2C675
            return src.replace(/^(.*?:\/\/)[^/]*\//, "http://");
        }

        if (domain_nosub === "psbin.com" && domain.match(/cdn[^.]*\.psbin\.com/)) {
            // http://cdnak1.psbin.com/img/mw=160/mh=210/cr=n/d=choz0/0gdge8mcb86p3dfk.jpg
            //   http://cdnak1.psbin.com/img/0gdge8mcb86p3dfk.jpg
            return {
                url: src.replace(/\/img\/[^/]*=[^/]*\//, "/img/"), // repeated
                head_wrong_contentlength: true
            };
        }

        if (domain === "wac.450f.edgecastcdn.net") {
            // http://wac.450f.edgecastcdn.net/80450F/k99.com/files/2013/01/JohnnyCarson_Facebook-630x477.jpg
            // http://wac.450f.edgecastcdn.net/80450F/banana1015.com/files/2013/04/Daryl-Salad-ft.jpg?w=600&h=0&zc=1&s=0&a=t&q=89
            // http://wac.450f.edgecastcdn.net/80450F/thefw.com/files/2012/06/Jimmy-Kimmel-Hooks-Kids-Up-to-Fake-Lie-Detector1.jpg
            // http://wac.450f.edgecastcdn.net/80450F/wokq.com/files/2015/11/12011246_10153099160181766_6355448705489009380_n.jpg
            // http://wac.450f.edgecastcdn.net/80450F/mix106radio.com/files/2017/05/RS8710_177369626.jpg?w=630&h=420&zc=1&s=0&a=t&q=89
            return src.replace(/^(.*?:\/\/)[^/]*\/80450F\//, "http://");
        }

        if (domain === "gp1.wac.edgecastcdn.net") {
            // https://gp1.wac.edgecastcdn.net/802892/http_public_production/musicians/images/458607/original/resize:248x186/crop:x0y8w740h554/hash:1467386813/1425323540_10201484920743713_511360204_n.jpg?1467386813
            //   https://gp1.wac.edgecastcdn.net/802892/http_public_production/musicians/images/458607/original/1425323540_10201484920743713_511360204_n.jpg?1467386813
            return src.replace(/(\/images\/[0-9]*\/[^/]*\/)[^/]*:[^/]*\//, "$1"); // repeated
        }

        if (domain === "www.century21.com") {
            // https://www.century21.com/c21/photo/320x240/c21.azureedge.net/1103i96/6m7cc0c7t2ke40abf3a2tgy386i96
            //   http://c21.azureedge.net/1103i96/6m7cc0c7t2ke40abf3a2tgy386i96
            // https://www.century21.com/c21/photo/maxxmax/c21.azureedge.net/1i103/rk8yf7dx6g8z4na3er4jc4m9b1i103
            //   http://c21.azureedge.net/1i103/rk8yf7dx6g8z4na3er4jc4m9b1i103
            return src.replace(/.*?\/photo\/[0-9a-z]*x[0-9a-z]*\//, "http://");
        }

        if (domain === "cdn.instructables.com") {
            // https://cdn.instructables.com/FK3/KJ6O/J1WW1VNZ/FK3KJ6OJ1WW1VNZ.RECTANGLE1.jpg
            //   https://cdn.instructables.com/ORIG/FK3/KJ6O/J1WW1VNZ/FK3KJ6OJ1WW1VNZ.jpg
            return src.replace(/(:\/\/[^/]*\/)(.*)\.[^/.]*(\.[^/.]*)$/, "$1ORIG/$2$3");
        }

        if (domain_nosub === "pressreader.com" && domain.match(/cdn[0-9]*-img\.pressreader\.com/)) {
            // https://cdn2-img.pressreader.com/pressdisplay/docserver/getimage.aspx?regionKey=nsDHuRjfHcgbdqHuZt9cKQ%3D%3D&scale=100
            //   https://cdn2-img.pressreader.com/pressdisplay/docserver/getimage.aspx?regionKey=nsDHuRjfHcgbdqHuZt9cKQ%3D%3D
            return src.replace(/getimage\.aspx[^/]*[?&](regionKey=[^&]*).*$/, "getimage.aspx?$1");
        }

        if (domain === "layfielddesign.com") {
            // http://layfielddesign.com/assets/uploads/project_images/_fullSize/harpers-bazaar-statistics.jpg
            //   http://layfielddesign.com/assets/uploads/project_images/harpers-bazaar-statistics.jpg
            return src.replace(/\/uploads\/([^/]*)\/_[^/]*\//, "/uploads/$1/");
        }

        if (googlestorage_container === "mediaslide-europe") {
            // https://mediaslide-europe.storage.googleapis.com/uno/pictures/423/24823/large-1489494252-0801f3a26891df01462bae3da66cf8e7.jpg
            //   https://mediaslide-europe.storage.googleapis.com/uno/pictures/423/24823/1489494252-0801f3a26891df01462bae3da66cf8e7.jpg
            return src.replace(/\/[a-z]*-([^/]*)$/, "/$1");
        }

        if (domain_nosub === "netinfo.bg" && domain.match(/m[^.]*\.netinfo\.bg/)) {
            // https://www.vesti.bg/galerii/foto/zvezdite-s-dve-razlichni-obuvki-na-cherveniia-kilim-4877/32735277
            //
            // https://mm.netinfo.bg/resize/resize_on_the_fly.php?address=media/images/32735/32735277/r-1024-768-obuvki-cherven-kilim-znamenitosti.jpg
            //   https://mm.netinfo.bg/resize/resize_on_the_fly.php?address=media/images/32735/32735277/orig-orig-obuvki-cherven-kilim-znamenitosti.jpg
            // https://m5.netinfo.bg/media/images/32735/32735277/r-1024-768-obuvki-cherven-kilim-znamenitosti.jpg
            // https://m5.netinfo.bg/media/images/32735/32735277/r-976-734-obuvki-cherven-kilim-znamenitosti.jpg
            // https://m5.netinfo.bg/media/images/32735/32735277/80-49-obuvki-cherven-kilim-znamenitosti.jpg
            // https://mm.netinfo.bg/resize/resize_on_the_fly.php?address=media/images/32713/32713259/orig-orig-emili-ratajkovski.jpg
            // https://mm.netinfo.bg/resize/resize_on_the_fly.php?address=media/images/32735/32735277/orig-orig-obuvki-cherven-kilim-znamenitosti.jpg
            //
            // https://m.netinfo.bg/media/images/32735/32735274/80-49-obuvki-cherven-kilim-znamenitosti.jpg
            return src.replace(/([/=]media\/images\/[0-9]*\/[0-9]*\/)(?:r-)?[^-/.]*-[^-/.]*/, "$1orig-orig");
        }

        if (domain === "i.imgur.com" &&
            !src.match(/\.gifv(?:\?.*)?$/)) {
            // https://i.imgur.com/ajsLfCab.jpg
            // https://i.imgur.com/ajsLfCam.jpg
            // https://i.imgur.com/ajsLfCal.jpg
            // https://i.imgur.com/ajsLfCa_d.jpg?maxwidth=520&shape=thumb&fidelity=high
            //   https://i.imgur.com/ajsLfCa.jpg
            // h, r, l, g, m, t, b, s

            // fix images, obj before doing this
            if (src.match(/\/removed\.[a-zA-Z]+(?:[?#].*)?$/))
                return {
                    url: src,
                    bad: true
                };

            return src.replace(/\/([a-zA-Z0-9]{7})(?:[hrlgmtbs]|_d)(\.[^/.?]*)$/, "/$1$2");
        }

        if (domain_nowww === "vidble.com") {
            // https://www.vidble.com/ZNOTKNmw6y_sqr.jpg
            //   https://www.vidble.com/ZNOTKNmw6y.jpg
            return src.replace(/_[^/._]*(\.[^/.]*)$/, "$1");
        }

        if (domain === "itpro.nikkeibp.co.jp") {
            // http://itpro.nikkeibp.co.jp/pc/article/interview/20130319/1083744/thumb_420_ph2_px420.jpg
            //   http://itpro.nikkeibp.co.jp/pc/article/interview/20130319/1083744/ph2_px420.jpg
            return src.replace(/\/thumb_[0-9]+_([^/]*)$/, "/$1");
        }

        if (domain === "media-cdn.tripadvisor.com") {
            // https://media-cdn.tripadvisor.com/media/photo-s/0e/8d/a4/5e/hogwarts-express.jpg
            //   https://media-cdn.tripadvisor.com/media/photo-s/0e/8d/a4/5e/hogwarts-express.jpg
            // o, s, f, i, l, t
            return src.replace(/\/media\/photo-[a-z]\//, "/media/photo-o/");
        }

        if (domain === "www.traveller.com.au" ||
            // https://resources.stuff.co.nz/content/dam/images/1/3/q/g/e/a/image.related.StuffLandscapeSixteenByNine.620x349.1inizt.png/1492742323724.jpg
            //   https://resources.stuff.co.nz/content/dam/images/1/3/q/g/e/a/image.
            domain === "resources.stuff.co.nz" ||
            // http://www.essentialbaby.com.au/content/dam/images/4/6/9/8/d/image.gallery.articleLeadwide.620x349.23z5t.png
            //   http://www.essentialbaby.com.au/content/dam/images/4/6/9/8/d/image.
            domain === "www.essentialbaby.com.au") {
            // http://www.traveller.com.au/content/dam/images/3/5/o/g/5/image.related.articleLeadwide.620x349.gz1l7v.png/1508294036655.jpg
            //   http://www.traveller.com.au/content/dam/images/3/5/o/g/5/image.related.articleLeadwide.620x349.gz1l7v.png
            //   http://www.traveller.com.au/content/dam/images/3/5/o/g/5/image.
            // http://www.traveller.com.au/content/dam/images/1/0/f/c/k/q/image.
            //return src.replace(/(\/images\/[0-9a-z]\/[0-9a-z]\/[0-9a-z]\/[0-9a-z]\/[0-9a-z]\/image\.).*$/, "$1");
            return src.replace(/(\/images\/(?:[0-9a-z]\/){4,}image\.).*$/, "$1");
        }

        if (domain === "getwallpapers.com" ||
            // http://hintergrundbild.org/wallpaper/small/f/5/3/71029-full-size-freundschaft-hintergrundbilder-1920x1080.jpg
            //   http://hintergrundbild.org/wallpaper/full/f/5/3/71029-full-size-freundschaft-hintergrundbilder-1920x1080.jpg
            domain_nowww == "hintergrundbild.org" ||
            // https://wallpapertag.com/wallpaper/small/3/3/8/7792-anime-backgrounds-1920x1200-smartphone.jpg
            domain === "wallpapertag.com") {
            // http://getwallpapers.com/wallpaper/small/4/b/a/573224.jpg
            //   http://getwallpapers.com/wallpaper/full/4/b/a/573224.jpg
            return src.replace(/\/wallpaper\/[^/]*\//, "/wallpaper/full/");
        }

        if (domain === "ideascdn.lego.com") {
            // https://ideascdn.lego.com/community/projects/be9/7b9/163334/2794778-o_1b5ccku8lf9a1sep1r8of4to8j7-thumbnail-b5Us8BCO1UerJg.png
            //   https://ideascdn.lego.com/community/projects/be9/7b9/163334/2794778-o_1b5ccku8lf9a1sep1r8of4to8j7.png
            // https://ideascdn.lego.com/community/projects/be9/7b9/163334/2794790-o_1b5ccmo8e53mofh1gnao2ag8ef-square-100.png
            return src
                .replace(/-thumbnail[^/.]*(\.[^/.]*)$/, "$1")
                .replace(/-square[^/.]*(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "legocdn.com" &&
            src.indexOf("/is/image/") >= 0) {
            // https://sh-s7-live-s.legocdn.com/is/image/LEGO/75192_alt4?fit=constrain,1&wid=46&hei=37&fmt=jpg
            //   https://sh-s7-live-s.legocdn.com/is/image/LEGO/75192_alt4?scl=1 -- 2400x1800
            // https://sh-s7-live-s.legocdn.com/is/image/LEGOMKTG/71043-family--2018--gl--mainstage-background--large?$MainStageBackgroundLarge$ -- 1280x500
            //   https://sh-s7-live-s.legocdn.com/is/image/LEGOMKTG/71043-family--2018--gl--mainstage-background--large?scl=1 -- 2560x1000
            return src.replace(/(?:\?.*)?$/, "?scl=1");
        }

        if (domain === "images.newindianexpress.com") {
            // http://images.newindianexpress.com/uploads/user/imagelibrary/2018/2/2/w100X65/d5cd2a22045a49e1a1bfef3810b0144f.jpg
            //   http://images.newindianexpress.com/uploads/user/imagelibrary/2018/2/2/original/d5cd2a22045a49e1a1bfef3810b0144f.jpg
            return src.replace(/\/[wh][0-9]+X[0-9]*\//, "/original/");
        }

        if (domain === "image.spreadshirtmedia.com" && false) {
            // https://image.spreadshirtmedia.com/image-server/v1/designs/1001957174,width=178,height=178/harry-potter-hogwarts-express-coffee-mug.png
            //   https://image.spreadshirtmedia.com/image-server/v1/designs/1001957174/harry-potter-hogwarts-express-coffee-mug.png
            // doesn't work:
            //  https://image.spreadshirtmedia.com/image-server/v1/mp/products/T812A2MPA1663PT17X49Y58D1014395106S29/views/1,width=1200,height=1200,appearanceId=2,backgroundColor=E8E8E8,modelId=115,crop=detail,version=1515071979/deathgrips-men-s-premium-t-shirt.webp - 1200x1200
            //    https://image.spreadshirtmedia.com/image-server/v1/mp/products/T812A2MPA1663PT17X49Y58D1014395106S29/views/1/deathgrips-men-s-premium-t-shirt.webp -- 190x190, different image
            return src.replace(/(\/[0-9]*),(?:[^=/,]*=[^=/,]*,?){1,}(\/[^/]*$)/, "$1$2");
        }

        if (domain_nosub === "blastingcdn.com" && domain.match(/staticr[0-9]*\.blastingcdn\.com/)) {
            // http://staticr1.blastingcdn.com/media/photogallery/2017/10/14/660x290/b_586x276/a-family-was-rescued-by-the-harry-potter-hogwarts-express-in-the-scottish-highlands-image-credit-pixabaycc0_1631843.jpg
            //   http://static.blastingnews.com/media/photogallery/2017/10/14/main/a-family-was-rescued-by-the-harry-potter-hogwarts-express-in-the-scottish-highlands-image-credit-pixabaycc0_1631843.jpg
            return src
                .replace(/\/b_[0-9]+x[0-9]+\/([^/]*)$/, "/$1")
                .replace(/\/[0-9]+x[0-9]+\/([^/]*)$/, "/main/$1");
        }

        if (domain_nowww === "gjdream.com") {
            // http://www.gjdream.com/news/contents/UPFILE/2018/20180201485362_tmb.jpg
            //   http://www.gjdream.com/news/contents/UPFILE/2018/20180201485362.jpg
            return src.replace(/_tmb(\.[^/.]*)$/, "$1");
        }

        if (domain === "www.imaeil.com") {
            // http://www.imaeil.com/m_wiz/imgsrc3.php?w=261&h=142&t=&rate=100&src=/news_img/event_plus/2018.02.02.14.04.38_mainphoto01_1.jpg
            //   http://www.imaeil.com//news_img/event_plus/2018.02.02.14.04.38_mainphoto01_1.jpg
            return src.replace(/\/m_wiz\/imgsrc[0-9]\.php.*?[?&]src=([^&]*).*/, "/$1");
        }

        if (domain === "www.kwnews.co.kr") {
            // untested due to it requiring download
            // http://www.kwnews.co.kr/kwnews_view.asp?kwurl=20180202-218020100137-3001.jpg
            //   http://www.kwnews.co.kr/newsphoto/2018/02/218020100137.jpg
            return src.replace(/\/kwnews_view\.asp?.*?kwurl=([0-9]{4})([0-9]{2})[0-9]*-([0-9]*)-[0-9]*(\.[^/.]*)$/, "/newsphoto/$1/$2/$3$4");
        }

        if (domain_nowww === "yeongnam.com" &&
            src.indexOf("/Photo/") >= 0) {
            // http://www.yeongnam.com/Photo/2018/01/26/S20180126.99001151846332501.jpg
            //   http://www.yeongnam.com/Photo/2018/01/26/R20180126.99001151846332501.jpg
            // R, L, M, S
            return src.replace(/\/[A-Z]([^/]*)$/, "/R$1");
        }

        // doesn't always work, due to .jpg/.jpeg
        if (domain_nowww === "yeongnam.com" &&
            src.indexOf("/news/screennews/") >= 0) {
            // http://www.yeongnam.com/news/screennews/159_20180329_L20180327_99001152405345001.jpg
            //   http://www.yeongnam.com/Photo/2018/03/27/R20180327.99001152405345001.jpeg
            return src
                .replace(/\/news\/screennews\/[0-9]+_[0-9]+_[A-Z]([0-9]{4})([0-9]{2})([0-9]{2})_([0-9]+)(\.[^/.]*)/,
                         "/Photo/$1/$2/$3/R$1$2$3.$4.jpeg");
        }

        if (domain === "db.kookje.co.kr") {
            // http://db.kookje.co.kr/news2000/photo/2018/0202/L20180202.22001000306i1.jpg
            // http://db.kookje.co.kr/news2000/photo/2012/0414/20120414.99002182507i1.jpg - 2568x1640
            //   http://db.kookje.co.kr/news2000/photo/2012/0414/L20120414.99002182507i1.jpg ??? (website overloaded, try again later, also generic 404 page)
            // L, S
            return src.replace(/\/[A-Z]([^/]*)$/, "/L$1");
        }

        if (domain_nowww === "kookje.co.kr") {
            // http://www.kookje.co.kr/news2011/screennews/thumb/466_20180305_20180305.99099001307i1.jpg
            //   http://www.kookje.co.kr/news2011/screennews/466_20180305_20180305.99099001307i1.jpg
            //   http://db.kookje.co.kr/news2000/photo/2018/0305/20180305.99099001307i1.jpg
            //   http://db.kookje.co.kr/news2000/photo/2018/0305/L20180305.99099001307i1.jpg
            // http://www.kookje.co.kr/news2011/screennews/466_20180305_20180305.99099001300i1.jpg
            //   http://db.kookje.co.kr/news2000/photo/2018/0305/20180305.99099001300i1.jpg
            //   http://db.kookje.co.kr/news2000/photo/2018/0305/L20180305.99099001300i1.jpg
            // http://www.kookje.co.kr/news2011/screennews/thumb/466_20180305_20180211.99099004174i1.jpg
            //   http://db.kookje.co.kr/news2000/photo/2018/0211/20180211.99099004174i1.jpg
            //   http://db.kookje.co.kr/news2000/photo/2018/0211/L20180211.99099004174i1.jpg
            return src
                .replace("/thumb/", "/")
                .replace(/.*\/[0-9]+_[0-9]+_([0-9]{4})([0-9]{4})([^/]*)$/, "http://db.kookje.co.kr/news2000/photo/$1/$2/L$1$2$3");
        }

        if (domain_nowww === "joongdo.co.kr") {
            // http://www.joongdo.co.kr/mnt/images/webdata/content/2018y/02m/01d/crop2018020101000198000004991.jpg
            //   http://www.joongdo.co.kr/mnt/images/file/2018y/02m/01d/2018020101000198000004991.jpg
            return src.replace(/\/webdata\/content\//, "/file/").replace(/\/[^0-9]*([0-9]*\.[^/.]*)$/, "/$1");
        }

        if (domain === "img.asiatoday.co.kr" && false) {
            // http://img.asiatoday.co.kr/webdata/content/2018y/02m/28d/20180228002024152_77_58.jpg
            //   http://img.asiatoday.co.kr/file/2018y/02m/28d/20180228002024152_1.jpg
            // http://img.asiatoday.co.kr/webdata/content/2018y/03m/09d/20180309010004779_77_58.jpg
            //   http://img.asiatoday.co.kr/file/2018y/03m/09d/20180309010004779_1.jpg - doesn't work
            //   http://img.asiatoday.co.kr/file/2018y/03m/09d/2018030901000828800047791.jpg - works
            // http://img.asiatoday.co.kr/webdata/content/2017y/03m/31d/20170331010021088_300_300.jpg
            //   http://img.asiatoday.co.kr/file/2017y/03m/31d/2017033101002937000210881.jpg
            // http://img.asiatoday.co.kr/webdata/content/2018y/09m/12d/20180912010007252_300_300.jpg
            //   http://img.asiatoday.co.kr/file/2018y/09m/12d/201809120100072521.jpg -- doesn't work
            //   http://img.asiatoday.co.kr/file/2018y/09m/12d/2018091201000933500072521.jpg
            var regex = /\/webdata\/content\/(.*)_[0-9]+_[0-9]+(\.[^/.]*)$/;
            return [
                src.replace(regex, "/file/$1_1$2"),
                src.replace(regex, "/file/$11$2")
            ];
        }

        if (domain === "jmagazine.joins.com" ||
            // http://www.urbanbug.net/uploads/gallery/photos/2083/thumb_31888-170-05-005.jpg
            //   http://www.urbanbug.net/uploads/gallery/photos/2083/31888-170-05-005.jpg
            (domain === "www.urbanbug.net" && src.indexOf("/uploads/") >= 0) ||
            // http://celebs-news.ru/images/persons/natalie-portman/1611/thumb_natalie_portman_32.jpg
            //   http://celebs-news.ru/images/persons/natalie-portman/1611/natalie_portman_32.jpg
            (domain_nowww === "celebs-news.ru" && src.indexOf("/images/") >= 0) ||
            // https://www.popco.net/zboard/data/sigma_forum/2018/04/25/thumb_53666d20e05f8691128b91b8456961a7.jpeg
            //   https://popco.net/zboard/data/sigma_forum/2018/04/25/53666d20e05f8691128b91b8456961a7.jpeg
            domain_nowww === "popco.net") {
            // https://jmagazine.joins.com/_data/photo/2018/01/thumb_237268740_ZeJ4MpkI_1.jpg
            return src.replace(/\/thumb_([^/]*)$/, "/$1");
        }

        if (domain === "img.tvreport.co.kr") {
            // http://img.tvreport.co.kr/images/20171017/20171017_1508207555_22483100_4.jpg?1512513157
            //   http://img.tvreport.co.kr/images/20171017/20171017_1508207555_22483100_0.jpg?1512513157
            // http://img.tvreport.co.kr/images/20171211/20171211_1512955026_44177100_1.jpg (stretched)
            //   http://img.tvreport.co.kr/images/20171211/20171211_1512955026_44177100_0.jpg (smaller, but not stretched)
            // http://img.tvreport.co.kr/images/20171203/20171203_1512266720_61938500_1.jpg
            //   http://img.tvreport.co.kr/images/20171203/20171203_1512266720_61938500_0.jpg (larger)
            // 0 = original
            // 1 = large
            return src.replace(/_[0-9]*(\.[^/.]*)$/, "_0$1");
        }

        if (domain === "ojsfile.ohmynews.com") {
            // http://ojsfile.ohmynews.com/CT_T_IMG/2018/0131/IE002278988_APP.jpg?4957
            //   http://ojsfile.ohmynews.com/PHT_IMG_FILE/2018/0131/IE002278988_PHT.jpg
            //   http://ojsfile.ohmynews.com/BIG_IMG_FILE/2018/0131/IE002278988_BIG.jpg
            //   http://ojsfile.ohmynews.com/ORG_IMG_FILE/2018/0131/IE002278988_ORG.jpg
            // http://ojsfile.ohmynews.com/CT_T_IMG/2018/0201/IE002279450_APP.jpg?2034
            //   http://ojsfile.ohmynews.com/PHT_IMG_FILE/2018/0201/IE002279450_PHT.jpg
            //   http://ojsfile.ohmynews.com/BIG_IMG_FILE/2018/0201/IE002279450_BIG.jpg
            //   http://ojsfile.ohmynews.com/ORG_IMG_FILE/2018/0201/IE002279450_ORG.jpg
            // http://ojsfile.ohmynews.com/STD_IMG_FILE/2013/0705/IE001596678_STD.jpg
            //   http://ojsfile.ohmynews.com/ORG_IMG_FILE/2013/0705/IE001596678_ORG.jpg
            return src
                .replace(/\/CT_T_IMG\/(.*?)\/([^/]*)_APP(\.[^/.]*?)(?:\?.*)?$/, "/ORG_IMG_FILE/$1/$2_ORG$3")
                .replace(/\/[A-Z]*_IMG_FILE\/(.*?)\/([^/]*)_[A-Z]*(\.[^/.]*)(?:\?.*)?$/, "/ORG_IMG_FILE/$1/$2_ORG$3");
        }

        if (domain === "cmsimg.mnet.com") {
            // wip
            // http://cmsimg.mnet.com/clipimage/artist/240/000/428/428228.jpg
            // http://cmsimg.mnet.com/clipimage/artist/Other/610/000/167/167134.jpg
            //   http://cmsimg.mnet.com/clipimage/artist/Other/1024/000/167/167134.jpg
            //   http://cmsimg.mnet.com/clipimage/artist/Other/000/167/167134.jpg -- 404
            // http://cmsimg.mnet.com/clipimage/vod/Other/000/058/58694.jpg
            //   http://cmsimg.mnet.com/clipimage/vod/Other/610/000/058/58694.jpg -- scaled down to 400x600
            // http://static.global.mnet.com/data/ucc/000/162/359
            // http://static.global.mnet.com/data/ucc/000/162/442
            // http://mnetimg.mnet.com/tvmnetimg/admin/poll/2014/10/1_1413538495789.jpg
            // http://cmsimg.mwave.me/pgmVideo/contentImgUrl/201711/10/0b694d59-29d6-4d36-8470-0e2db3a32e8f.jpg
            // https://cjmwave-prd.s3.ap-northeast-2.amazonaws.com/ion/front/editor/201801/10/e6d980fe-53c3-4604-bce7-08d98c7f2d99.jpg
            // http://mnetimg.mnet.com/L_uimg/adupload/special/2017/08/22/1401090000.jpg
            //return src.replace(/(\/clipimage\/[^/]*)\/[0-9]*\//, "$1/1024/");
            var regex = /(\/clipimage\/.*?[^0-9]\/)[0-9]+\/([0-9]+\/[0-9]+\/[0-9]+\.[^/.]*)$/;
            return [
                src.replace(regex, "$1$2"),
                src.replace(regex, "$11024/$2")
            ];
        }

        if (domain === "image.cloud.sbs.co.kr") {
            // http://image.cloud.sbs.co.kr/smr/clip/201605/20/ihv2JuZcKz8ChXAsxFPPpC_320.jpg
            //   http://image.cloud.sbs.co.kr/smr/clip/201605/20/ihv2JuZcKz8ChXAsxFPPpC.jpg
            return src.replace(/_[0-9]*(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "st-hatena.com" &&
            (domain.match(/cdn-ak-scissors\.[a-z]\.st-hatena\.com/) ||
             domain === "cdn.image.st-hatena.com")) {
            // https://cdn-ak-scissors.b.st-hatena.com/image/scale/6b49da1455b11be153a6a5c060fbb6a65ada1cde/enlarge=0;height=480;type=max;version=1;width=480/https%3A%2F%2Fcdn.image.st-hatena.com%2Fimage%2Fscale%2F4220af82af99afcb2b70c52a3d4ee7a5cea0ba38%2Fbackend%3Dimager%3Benlarge%3D0%3Bheight%3D1000%3Bversion%3D1%3Bwidth%3D1200%2Fhttps%253A%252F%252Fcdn.user.blog.st-hatena.com%252Fdefault_entry_og_image%252F672828%252F1514219817468589
            //   https://cdn.image.st-hatena.com/image/scale/4220af82af99afcb2b70c52a3d4ee7a5cea0ba38/backend=imager;enlarge=0;height=1000;version=1;width=1200/https%3A%2F%2Fcdn.user.blog.st-hatena.com%2Fdefault_entry_og_image%2F672828%2F1514219817468589
            //   https://cdn.user.blog.st-hatena.com/default_entry_og_image/672828/1514219817468589
            // https://cdn-ak-scissors.b.st-hatena.com/image/square/2fc5e622ac7d1dc703f1059dcacff46f0afbb002/height=90;version=1;width=120/http://livedoor.blogimg.jp/milano/imgs/1/b/1b341774.jpg
            newsrc = src.replace(/.*?\/image\/(?:scale|square)\/[^/]*\/[^/]*\/(.*)$/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);
        }

        if (domain === "pimg.togetter.com") {
            // https://pimg.togetter.com/1ac25d603c8ca6f205c7fbfb13f0413ed09017dc/68747470733a2f2f7062732e7477696d672e636f6d2f6d656469612f445536524d442d567741457a3969552e6a70673a6c61726765?w=1200&h=630&t=c
            //   https://pimg.togetter.com/1ac25d603c8ca6f205c7fbfb13f0413ed09017dc/68747470733a2f2f7062732e7477696d672e636f6d2f6d656469612f445536524d442d567741457a3969552e6a70673a6c61726765?w=o&h=o
            return src.replace(/\?[^/]*$/, "?w=o&h=o");
        }

        if (domain === "nimage.newsway.kr") {
            // http://nimage.newsway.kr/phpwas/restmb_idxmake.php?idx=6&simg=20180116000099_0640.jpg
            // http://nimage.newsway.kr/phpwas/restmb_idxmake.php?idx=200&simg=20180202000058_1024.jpg
            // http://nimage.newsway.kr/phpwas/restmb_idxmake.php?idx=138&simg=%2Fphoto%2F2016%2F06%2F02%2F20160602000250_0640.jpg
            //   http://nimage.newsway.kr/photo/2016/06/02/20160602000250_0640.jpg
            if (src.match(/[?&]simg=[%/]/)) {
                return decodeURIComponent(src.replace(/\/phpwas\/restmb_idxmake\.php.*?simg=([^&]*).*?$/, "$1"));
            }
            //return src.replace(/\/phpwas\/restmb_idxmake\.php.*?simg=([0-9]{4})([0-9]{2})([0-9]{2})([^&]*).*?$/, "/photo/$1/$2/$3/$1$2$3$4");

            // http://nimage.newsway.kr/photo/2018/02/01/20180201000273_0480.jpg
            // doesn't work for all:
            // http://nimage.newsway.kr/photo/2016/08/26/20160826000014_0640.png
            //return src.replace(/_[0-9]+(\.[^/.]*)$/, "_1024$1");
        }

        if (domain === "imgsrv.piclick.me") {
            // http://imgsrv.piclick.me/cimg/163x220xN_477539.jpg
            return src.replace(/\/cimg\/[0-9]+x[0-9]+x/, "/cimg/");
        }

        if (domain_nowww === "slate.com") {
            // http://www.slate.com/content/dam/slate/blogs/browbeat/2017/12/01/how_pixar_made_coco_the_biggest_box_office_hit_in_mexico_s_history/cocorgb_c041_41a_pubpub16565.jpg.CROP.promo-xlarge2.jpg
            //   http://www.slate.com/content/dam/slate/blogs/browbeat/2017/12/01/how_pixar_made_coco_the_biggest_box_office_hit_in_mexico_s_history/cocorgb_c041_41a_pubpub16565.jpg
            return src.replace(/(\/[^/.]*\.[^/.]*)\.[^/]*$/, "$1");
        }

        if (domain === "img.cinemablend.com" ||
            // https://img.minq.com/filter:scale/slides/3/6/0/0/9/0/3600901349/29fc1d2cc8d2499990adfafcce8f922ac2e6df13.jpeg?mw=615
            //   https://img.minq.com/slides/3/6/0/0/9/0/3600901349/29fc1d2cc8d2499990adfafcce8f922ac2e6df13.jpeg
            domain === "img.minq.com") {
            // https://img.cinemablend.com/filter:scale/quill/3/d/0/6/a/d/3d06addd736f79f9449400bed217e59f98ff86af.jpg?mw=600
            //   https://img.cinemablend.com/quill/3/d/0/6/a/d/3d06addd736f79f9449400bed217e59f98ff86af.jpg
            return src.replace(/(:\/\/[^/]*\/)filter:[^/]*\/(.*?)(?:\?[^/]*)?$/, "$1$2");
        }

        if (((domain_nosub === "abcimg.es" && domain.match(/r[0-9]*\.abcimg\.es/)) ||
             // https://resizer.elcorreo.com/resizer/resizer.php?imagen=http://www.elcorreo.com/multimedia/201408/30/media/06-modelos-halle-berry.jpg&nuevoalto=480
             //   https://www.elcorreo.com/multimedia/201408/30/media/06-modelos-halle-berry.jpg
             domain === "resizer.elcorreo.com") &&
            src.indexOf("/resizer.php") >= 0) {
            // http://r1.abcimg.es/resizer/resizer.php?imagen=http%3A%2F%2Fwww.abc.es%2Fmedia%2Fsociedad%2F2018%2F02%2F01%2Freina-letizia-kYuH--420x236%40abc.jpg&nuevoancho=128&nuevoalto=73&crop=1&medio=abc
            //   http://www.abc.es/media/sociedad/2018/02/01/reina-letizia-kYuH--420x236@abc.jpg
            //   http://www.abc.es/media/sociedad/2018/02/01/reina-letizia-kgrH-U213052464546JvF-620x370@abc.jpg
            return decodeURIComponent(src.replace(/.*\/resizer\.php.*?[?&]imagen=([^&]*).*$/, "$1"));
        }

        if (domain === "vz.cnwimg.com") {
            // https://vz.cnwimg.com/thumbc-300x300/wp-content/uploads/2012/03/coco.jpg
            // https://vz.cnwimg.com/thumb-300x170/wp-content/uploads/2018/01/GettyImages-127497645.jpg
            return src.replace(/\/thumb[a-z]*-[0-9]+x[0-9]+\//, "/");
        }

        if (domain_nowww === "coleman-rayner.com" &&
            src.indexOf("/watermark/insertwm.php?") >= 0) {
            // http://www.coleman-rayner.com/watermark/insertwm.php?src=http%3A%2F%2Fwww.coleman-rayner.com%2Fwp-content%2Fuploads%2F2014%2F09%2F05.-INSIDE-COCO%E2%80%99S-LAS-VEGAS-WARDROBE-1000.jpg
            return {
                can_head: false,
                url: decodeURIComponent(src.replace(/.*\/watermark\/insertwm\.php.*?[?&]src=([^&]*).*$/, "$1"))
            };
        }

        if (domain === "media.guestofaguest.com") {
            // http://media.guestofaguest.com/t_card_medium/wp-content/uploads/wppa/Coco_Austin6.jpg
            //   http://media.guestofaguest.com/wp-content/uploads/wppa/Coco_Austin6.jpg
            // http://media.guestofaguest.com/t_card_medium/gofg-media/2016/05/1/46413/533596622.jpg
            //   http://media.guestofaguest.com/gofg-media/2016/05/1/46413/533596622.jpg
            return src.replace(/(:\/\/[^/]*\/)[^/]*\/(wp-content|gofg-media)\//, "$1$2/");
        }

        if (domain_nosub === "heartyhosting.com" &&
            domain.match(/i[0-9]*\.heartyhosting\.com/)) {
            // https://i0.heartyhosting.com/starmagazine.com/wp-content/uploads/2016/01/ice-t-coco-austin-baby-chanel-body-anniversary-dress-05.jpg
            return src.replace(/.*?:\/\/[^/]*\//, "http://");
        }

        if (domain === "images.contactmusic.com") {
            // http://images.contactmusic.com/newsimages/wenn2949343_1_14734_24-cm.jpg
            //   http://images.contactmusic.com/newsimages/wenn2949343_1_14734_24.jpg
            // http://images.contactmusic.com/newsimages/wenn90807_1_16815_34-cm.jpg
            //   http://images.contactmusic.com/newsimages/wenn90807_1_16815_34.jpg -- 403
            newsrc = src.replace(/-cm(\.[^/.]*)$/, "$1");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nowww === "contactmusic.com") {
            // http://www.contactmusic.com/pics/mn/20180304/040318_oscarawards2018arrivals/oscar-awards-2018-arrivals_6016429.jpg -- watermark
            //   http://www.contactmusic.com/pics/sn/20180304/040318_oscarawards2018arrivals/oscar-awards-2018-arrivals_6016429.jpg -- no watermark
            //   http://www.contactmusic.com/pics/ln/20180304/040318_oscarawards2018arrivals/oscar-awards-2018-arrivals_6016429.jpg -- larger, watermark
            // http://www.contactmusic.com/pics/sn/20130516/160513_cw_upfront_2/kristin-kreuk-2013-cw-upfront-presentation-_3667039.jpg -- no watermark
            // http://www.contactmusic.com/pics/sa/kerrang_arrivals_210808/thirty_seconds_to_mars_with_jared_leto_5177350.jpg -- 110x139, no watermark
            //   http://www.contactmusic.com/pics/la/kerrang_arrivals_210808/thirty_seconds_to_mars_with_jared_leto_5177350.jpg -- 1747x2200, watermark
            // http://www.contactmusic.com/images/feature-images/the-leftovers-s1-justin-theroux-636-380.jpg -- 3888x2592, no watermark
            // http://www.contactmusic.com/pics/s/dwp_pizza_sculptures_071107/a_sculpture_of_pope_benedict_xvi_1652401.jpg -- 110x160, no watermark
            //   http://www.contactmusic.com/pics/l/dwp_pizza_sculptures_071107/a_sculpture_of_pope_benedict_xvi_1652401.jpg -- 2058x3000, watermark
            var retarray = [];

            newsrc = src.replace(/\/pics\/[a-z]([a-z]?\/)/,"/pics/s$1");
            if (newsrc !== src)
                retarray.push({
                    url: newsrc,
                    problems: {
                        smaller: true
                    }
                });

            newsrc = src.replace(/\/pics\/[a-z]([a-z]?\/)/,"/pics/l$1");
            if (newsrc !== src)
                retarray.push({
                    url: newsrc,
                    problems: {
                        watermark: true
                    }
                });

            if (retarray.length > 0)
                return retarray;
        }

        if (domain === "d15mj6e6qmt1na.cloudfront.net") {
            // https://d15mj6e6qmt1na.cloudfront.net/i/19186419/600/c
            //   https://d15mj6e6qmt1na.cloudfront.net/i/19186419
            return src.replace(/(\/i\/[0-9]*)\/.*/, "$1");
        }

        if ((domain_nosub === "bing.net" && domain.match(/tse[0-9]*\.(?:mm|explicit)\.bing\.net/)) ||
            domain_nosub === "bing.com") {
            // http://tse4.mm.bing.net/th?id=OGC.aea12e4c5efc00f2b1e95e6cf2a165e1&pid=1.7&rurl=https%3A%2F%2Fthumbs.gfycat.com%2FYellowTornCockatiel-size_restricted.gif&ehk=YrV%2F46NR4yeQKcnktlbKNA
            //   https://thumbs.gfycat.com/YellowTornCockatiel-size_restricted.gif
            newsrc = decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/th[^/]*[?&]rurl=([^&]*)&[^/]*$/, "$1"));
            if (newsrc !== src)
                return newsrc;

            // https://tse1.mm.bing.net/th?id=Ad9e81485410912702a018d5f48ec0f5c&w=136&h=183&c=8&rs=1&qlt=90&pid=3.1&rm=2
            // https://www.bing.com/th?id=OPN.RTNews_jJZmvGD6PzvUt22LbHHUUg&w=186&h=88&c=7&rs=2&qlt=80&cdv=1&pid=News
            newsrc = src.replace(/(:\/\/[^/]*)\/th[^/]*[?&]id=([^&]*)&[^/]*$/, "$1/th?id=$2");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain === "cdn.4archive.org") {
            // https://cdn.4archive.org/img/t4Drepmm.jpg
            //   https://cdn.4archive.org/img/t4Drepm.jpg
            return src.replace(/(\/img\/[^/.]{7})m(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "i.4cdn.org" ||
            // https://i.4pcdn.org/pol/1495294640794s.jpg
            //   https://i.4pcdn.org/pol/1495294640794.jpg
            domain === "i.4pcdn.org") {
            // http://i.4cdn.org/hr/1517608108705s.jpg
            //   http://i.4cdn.org/hr/1517608108705.jpg
            return src.replace(/(\/[0-9]*)s(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "thebarchive.com" ||
            // https://desu-usergeneratedcontent.xyz/int/thumb/1512/86/1512866510412s.jpg
            //   https://desu-usergeneratedcontent.xyz/int/image/1512/86/1512866510412.png
            // https://cdn2.desu-usergeneratedcontent.xyz/int/thumb/1506/02/1506029481182s.jpg
            //   https://cdn2.desu-usergeneratedcontent.xyz/int/image/1506/02/1506029481182.jpg
            domain_nosub === "desu-usergeneratedcontent.xyz" ||
            // https://archiveofsins.com/data/s/thumb/1477/81/1477816195263s.jpg
            //   https://archiveofsins.com/data/s/image/1477/81/1477816195263.jpg
            domain_nowww === "archiveofsins.com") {
            // https://www.thebarchive.com/data/b/thumb/1473/37/1473370176558s.jpg
            //   https://www.thebarchive.com/data/b/image/1473/37/1473370176558.jpg
            return add_extensions(src.replace(/(\/)thumb(\/.*\/[0-9]+)s(\.[^/.]*)$/, "$1image$2$3"));
        }

        if (domain === "ii.yakuji.moe" ||
            // http://aqua.komica.org/60/thumb/1509040275477s.jpg
            //   http://aqua.komica.org/60/src/1509040275477.jpg
            domain === "aqua.komica.org") {
            // http://ii.yakuji.moe/b/thumb/1534110350035s.jpg
            //   http://ii.yakuji.moe/b/src/1534110350035.jpg
            return src.replace(/\/thumb\/([0-9]+)s(\.[^/.]*)$/, "/src/$1$2");
        }

        if (domain === "file.tinnhac.com" ||
            domain === "file.tintuckpop.net" ||
            // http://media.bongda.com.vn/resize/455x300/files/hai.phan/2017/03/08/er10-1546.jpg
            domain === "media.bongda.com.vn" ||
            // https://3.404content.com/resize/730x-/1/8C/F7/1206431106501707365/fullsize.jpg
            //   https://3.404content.com/1/8C/F7/1206431106501707365/fullsize.jpg
            domain_nosub === "404content.com" ||
            // different though? - and crop doesn't work
            // https://image.vtc.vn/resize/80x60/files/news/2018/02/21/-210540.jpg
            domain === "image.vtc.vn") {
            // https://file.tinnhac.com/crop/97x74/music/2018/02/03/3-e875.jpg
            //   https://file.tinnhac.com/music/2018/02/03/3-e875.jpg
            // https://file.tinnhac.com/resize/600x-/2016/05/25/1eca49c4b-0953.jpg
            //   https://file.tinnhac.com/2016/05/25/1eca49c4b-0953.jpg
            // http://file.tintuckpop.net/resize/640x-/2016/05/16/1a922-1670.jpg
            // http://file.tintuckpop.net/crop/210x158/tintuckpop/2018/02/22/shinminah-1519107250-d126.jpg
            return src
                .replace(/\/crop\/[-0-9]+x[-0-9]+\//, "/")
                .replace(/\/resize\/[-0-9]+x[-0-9]+\//, "/");
        }

        if (domain_nosub === "zadn.vn" ||
            // https://images.vov.vn/h500/uploaded/wgyyweux2icrb7fgmumzw/2017_05_21/6_LLVB.jpg
            //   https://images.vov.vn/uploaded/wgyyweux2icrb7fgmumzw/2017_05_21/6_LLVB.jpg
            (domain_nosub === "vov.vn" && domain.match(/images?\.(?:[^/.]*\.)?vov\.vn/)) ||
            // https://ss-images.catscdn.vn/w620/2018/06/15/3005641/35380238_1893554624043549_7227395902841815040_n.jpg
            //   https://ss-images.catscdn.vn/2018/06/15/3005641/35380238_1893554624043549_7227395902841815040_n.jpg
            domain === "ss-images.catscdn.vn" ||
            // http://img.v3.news.zdn.vn/w660/Uploaded/cqxrcajwp/2014_12_14/t13.jpg
            //   http://img.v3.news.zdn.vn/Uploaded/cqxrcajwp/2014_12_14/t13.jpg
            domain === "img.v3.news.zdn.vn" ||
            // https://img.vietnamplus.vn/t660/Uploaded/ifysy/2015_02_10/grammy_10.jpg
            //   https://img.vietnamplus.vn/Uploaded/ifysy/2015_02_10/grammy_10.jpg
            domain === "img.vietnamplus.vn" ||
            // https://cdnimg.vietnamplus.vn/t660/Uploaded/ifysv/2014_12_12/x39.jpg
            //   https://cdnimg.vietnamplus.vn/Uploaded/ifysv/2014_12_12/x39.jpg
            domain === "cdnimg.vietnamplus.vn" ||
            // https://image.baonghean.vn/w607/Uploaded/2018/nkdkswkqoc/201602/original/image_7593475.jpg
            //   https://image.baonghean.vn/Uploaded/2018/nkdkswkqoc/201602/original/image_7593475.jpg
            // https://image.baonghean.vn/80x60/Uploaded/2018/ftgbtgazsnzm/2018_09_19/trantieuvy1381crop15372615750611556122614_jlls.jpg
            //   https://image.baonghean.vn/Uploaded/2018/ftgbtgazsnzm/2018_09_19/trantieuvy1381crop15372615750611556122614_jlls.jpg
            domain === "image.baonghean.vn" ||
            // https://image.tienphong.vn/w665/Uploaded/2018/pcgycivo/2016_08_25/5_pyxg.jpg -- stretched
            //   https://image.tienphong.vn/Uploaded/2018/pcgycivo/2016_08_25/5_pyxg.jpg
            // https://image3.tienphong.vn/w665/Uploaded/2018/khunflu/2016_07_03/jessica_alba_braun_beauty_campaign_2016_adds_04_redb.jpg
            //   https://image3.tienphong.vn/Uploaded/2018/khunflu/2016_07_03/jessica_alba_braun_beauty_campaign_2016_adds_04_redb.jpg
            (domain_nosub === "tienphong.vn" && domain.match(/image[0-9]*\.tienphong\.vn/)) ||
            domain === "media.laodong.vn") {
            // https://znews-photo-td.zadn.vn/w960/Uploaded/qfssu/2017_11_05/NGT.jpg
            //   https://znews-photo-td.zadn.vn/Uploaded/qfssu/2017_11_05/NGT.jpg
            // http://image.english.vov.vn/w490/uploaded/wzzqbijjvws/2016_02_25/tara_GCLM.jpg
            //   http://image.english.vov.vn/uploaded/wzzqbijjvws/2016_02_25/tara_GCLM.jpg
            // http://image.english.vov.vn/130x82/Uploaded/TmT2B47lHgLy8UZVeuKg/2018_02_04/Xoang_singing_DPVE.jpg
            //   http://image.english.vov.vn/Uploaded/TmT2B47lHgLy8UZVeuKg/2018_02_04/Xoang_singing_DPVE.jpg
            // http://image.english.vov.vn/h500/uploaded/wzzqbijjvws/2016_03_14/tara_2_KUJE.jpg
            //   http://image.english.vov.vn/uploaded/wzzqbijjvws/2016_03_14/tara_2_KUJE.jpg
            // https://baomoi-photo-2-td.zadn.vn/w700_r1m/16/03/13/105/18868393/9_65381.jpg
            //   https://baomoi-photo-2-td.zadn.vn/16/03/13/105/18868393/9_65381.jpg
            // https://baomoi-photo-3.zadn.vn/w460x/17/10/23/94/23663774/11_117795.jpg
            //   https://baomoi-photo-3.zadn.vn/17/10/23/94/23663774/11_117795.jpg
            // https://baomoi-photo-3-td.zadn.vn/w720x480/18/07/13/100/26873675/2_45090.jpeg
            //   https://baomoi-photo-3-td.zadn.vn/18/07/13/100/26873675/2_45090.jpeg
            // https://media.laodong.vn/Uploaded/thuctapsinh/2016_03_13/6_QVZZ.jpg?w=629&h=419&crop=auto&scale=both
            return src
                .replace(/(:\/\/[^/]*)\/[wht][0-9]+x?(?:_[^/]*)?(?:[0-9]+)?\//, "$1/")
                .replace(/(:\/\/[^/]*)\/[0-9]+x[0-9]+\//, "$1/")
                .replace(/\?.*$/, "");
        }

        if (domain === "cdn.tuoitre.vn" ||
            // https://dantricdn.com/thumb_w/640/487bd2df65/2016/09/24/chipi-1474675645816.jpg
            //   https://dantricdn.com/487bd2df65/2016/09/24/chipi-1474675645816.jpg
            domain === "dantricdn.com" ||
            // http://afamilycdn.com/thumb_w/660/2017/taf-0942-1509860607829.jpg
            domain === "afamilycdn.com" ||
            // https://cafebiz.cafebizcdn.vn/thumb_w/600/2016/14593683-10210661710609628-1503569961-n-1475666918244-crop-1475673547715.jpg
            //   https://cafebiz.cafebizcdn.vn/2016/14593683-10210661710609628-1503569961-n-1475666918244-crop-1475673547715.jpg
            //   http://cafebiz.cafebizcdn.vn/2016/14593683-10210661710609628-1503569961-n-1475666918244.jpg
            domain_nosub === "cafebizcdn.vn" ||
            // http://sohanews.sohacdn.com/thumb_w/1000/2017/photo-1-1510035508692-0-57-337-600-crop-1510035607740.jpg
            //   http://sohanews.sohacdn.com/2017/photo-1-1510035508692.jpg
            domain_nosub === "sohacdn.com" ||
            // http://kenh14cdn.com/thumb_w/300/2016/img-6763-1458013125674-25-0-650-1000-crop-1458013471506.jpg
            //   http://kenh14cdn.com/2016/img-6763-1458013125674.jpg
            domain_nosub === "kenh14cdn.com" ||
            // https://dantricdn.com/zoom/327_245/2018/2/22/img4232-15192810897621333688893.jpg
            //   https://dantricdn.com/thumb_w/600/2018/2/22/img4232-15192810897621333688893.jpg
            //   https://dantricdn.com/2018/2/22/img4232-15192810897621333688893.jpg
            domain === "dantricdn.com" ||
            // https://cafebiz.cafebizcdn.vn/zoom/420_264/2018/2/22/photo1519268407880-15192684078814005972.jpg
            domain === "cafebiz.cafebizcdn.vn" ||
            // http://afamily1.vcmedia.vn/thumb_w/600/dnPHhBsGbzUbzOL6NIfgilSBRC2AR0/Image/2014/10/Jiyeon-20f88.jpg
            //   http://afamily1.vcmedia.vn/dnPHhBsGbzUbzOL6NIfgilSBRC2AR0/Image/2014/10/Jiyeon-20f88.jpg
            domain_nosub === "vcmedia.vn" ||
            // https://genknews.genkcdn.vn/thumb_w/600/2016/photo-1-1471225578014.jpg
            //   https://genknews.genkcdn.vn/2016/photo-1-1471225578014.jpg
            domain_nosub === "genkcdn.vn" ||
            // https://vtv1.mediacdn.vn/zoom/93_93/2018/2/22/nauy-crop-1519281533709468961755.jpg
            //   https://vtv1.mediacdn.vn/2018/2/22/nauy.jpg -- doesn't work
            //   https://vtv1.mediacdn.vn/2018/2/22/nauy-crop-1519281533709468961755.jpg
            domain_nosub === "mediacdn.vn") {
            // https://cdn.tuoitre.vn/thumb_w/640/2017/5-nguoi-ham-mo-1509855071319.jpg
            //   https://cdn.tuoitre.vn/2017/5-nguoi-ham-mo-1509855071319.jpg
            return src
                .replace(/\/zoom\/[^/]*\//, "/")
                .replace(/-[0-9]+-[0-9]+-[0-9]+-[0-9]+-crop-[0-9]+(\.[^/.]*)$/, "$1")
                .replace(/-crop-[0-9]{13,}(\.[^/.]*)$/, "$1")
                .replace(/(:\/\/[^/]*)\/thumb_[a-z]\/[0-9]+\//, "$1/");
        }

        if (domain_nosub === "24hstatic.com" ||
            // https://image-us.24h.com.vn/upload/2-2018/images/2018-06-07/medium/nguoi-gay-an-gi-av-1528357320-626-width640height480.jpg
            //   https://image-us.24h.com.vn/upload/2-2018/images/2018-06-07/nguoi-gay-an-gi-av-1528357320-626-width640height480.jpg
            // https://image-us.24h.com.vn/upload/1-2018/images/2018-02-09/1518170617-487-sao--8--1518169128-width650height482_97_125.jpg
            //   https://image-us.24h.com.vn/upload/1-2018/images/2018-02-09/1518170617-487-sao--8--1518169128-width650height482.jpg
            domain_nosub === "24h.com.vn" ||
            // http://streaming1.danviet.vn/upload/1-2018/images/2018-03-12/miko-matsuda-01-1520847171-width650height650-1520848378-width650height650.jpg
            (domain_nosub === "danviet.vn" && domain.match(/^streaming[0-9]*\./)) ||
            // http://anh.24h.com.vn//upload/4-2017/images/2017-11-08/medium/1510125598-629-151011694144796-chi-pu-5.jpg
            domain === "anh.eva.vn") {
            // https://eva-img.24hstatic.com/upload/1-2017/images/2017-01-18/large/1484712995-1ava.jpg
            //   https://eva-img.24hstatic.com/upload/1-2017/images/2017-01-18/large/1484712995-1ava.jpg
            // https://eva-img.24hstatic.com/upload/1-2017/images/2017-01-18/san-khau-dem-nhac-bi-chay-t-ara-van-nhiet-tinh-het-minh-vi-khan-gia-1-1484711458-width500height334.jpg
            // https://eva-img.24hstatic.com/upload/4-2017/images/2017-10-15/extra_large/1508037671-thumbnail.jpg
            //   https://eva-img.24hstatic.com/upload/4-2017/images/2017-10-15/1508037671-thumbnail.jpg
            // https://eva-img.24hstatic.com/upload/1-2018/images/2018-02-01/thumbnail/cover1-1517500750-188-width640height480.jpg
            //   https://eva-img.24hstatic.com/upload/1-2018/images/2018-02-01/cover1-1517500750-188-width640height480.jpg
            // https://anh.eva.vn///upload/1-2016/images/2016-03-13/medium/1457807610-ava1.jpg
            return src
                .replace(/(\/images\/.*)_[0-9]+_[0-9]+(\.[^/.]*)$/, "$1$2")
                .replace(/(\/images\/[0-9]*-[0-9]*-[0-9]*\/)[^/]*\/([^/]*)$/, "$1$2");
        }

        if ((domain_nosub === "yan.vn" && domain.match(/static[0-9]*\.yan\.vn/)) ||
            // https://car2.autoimg.cn/cardfs/product/g30/M01/A3/D2/640x480_autohomecar__wKgHHFs7NY6AUXLiAAj8ddqKSUg436.jpg
            //   https://car2.autoimg.cn/cardfs/product/g30/M01/A3/D2/autohomecar__wKgHHFs7NY6AUXLiAAj8ddqKSUg436.jpg
            (domain_nosub === "autoimg.cn" && domain.match(/^car[0-9]*\.autoimg\.cn/)) ||
            // https://myzutv.ro/uploads/modules/news/0/2018/3/9/37130/560x400_15205880152019549a.jpg
            //   https://myzutv.ro/uploads/modules/news/0/2018/3/9/37130/15205880152019549a.jpg
            (domain === "myzutv.ro" && src.indexOf("/uploads/") >= 0) ||
            // http://www.rainews.it/dl/img/2018/07/640x360_1531473973863.rainews_20180713112334780.jpg
            //   http://www.rainews.it/dl/img/2018/07/1531473973863.rainews_20180713112334780.jpg
            (domain_nowww === "rainews.it" && src.indexOf("/img/") >= 0) ||
            // https://www.mjuznews.com/public/photos/1000/236/604x320_236-Wikluh_Sky.jpg
            //   https://www.mjuznews.com/public/photos/1000/236/236-Wikluh_Sky.jpg
            (domain === "www.mjuznews.com" && src.indexOf("/photos/") >= 0)) {
            // http://static2.yan.vn/YanThumbNews/2167221/201711/260x130_414f9ea4-e35b-4b11-aed5-883b288ea050.jpg
            //   http://static2.yan.vn/YanThumbNews/2167221/201711/414f9ea4-e35b-4b11-aed5-883b288ea050.jpg
            return src.replace(/\/[0-9]+x[0-9]+_([^/]*)$/, "/$1");
        }

        if (domain === "image.thanhnien.vn") {
            // https://image.thanhnien.vn/1600/uploaded/phangiang/2016_03_12/anh_lfyk.jpg
            return src.replace(/(:\/\/[^/]*)\/[0-9]*\//, "$1/");
        }

        if (domain === "media-local.phunu365.net") {
            // http://media-local.phunu365.net/api1x1/res/ext/0x0/r/image.24h.com.vn/upload/1-2017/images/2017-01-16/1484562734-148456151330358-dia-1.jpg
            return src.replace(/.*?\/api[0-9]+x[0-9]+\/res\/ext\/[0-9]+x[0-9]+\/[^/]*\//, "http://");
        }

        if ((domain_nosub === "nguoiduatin.vn" && domain.match(/.*media[0-9]*\.nguoiduatin\.vn/)) ||
            // http://media.doisongphapluat.com/thumb_x200x/352/2015/2/9/lady-gaga-grammy-doisongphapluat.jpg
            //   http://media.doisongphapluat.com/352/2015/2/9/lady-gaga-grammy-doisongphapluat.jpg
            domain === "media.doisongphapluat.com" ||
            // http://media.hotbirthdays.com/thumb_x200x204/upload/2015/10/27/emilia-clarke.jpg
            //   http://media.hotbirthdays.com/upload/2015/10/27/emilia-clarke.jpg
            domain === "media.hotbirthdays.com") {
            // http://xmedia.nguoiduatin.vn/amp_thumb_x1120x832/ndt/16/03/12/202/18865226/8_288040.jpg
            //   http://xmedia.nguoiduatin.vn/ndt/16/03/12/202/18865226/8_288040.jpg
            // http://media1.nguoiduatin.vn/thumb_x680x354/media/le-nham-than/2018/02/04/hoa.png
            //   http://media1.nguoiduatin.vn/media/le-nham-than/2018/02/04/hoa.png
            return src.replace(/(:\/\/[^/]*)\/[^/]*x[0-9]+x(?:[0-9]+)?\//, "$1/");
        }

        if (domain === "www.wowkorea.live" ||
            // http://images.vfl.ru/ii/1517170346/e739011e/20348673_s.jpg
            //   http://images.vfl.ru/ii/1517170346/e739011e/20348673.jpg
            domain === "images.vfl.ru") {
            // http://www.wowkorea.live/img/album/8/42081/76033_m.jpg
            return src.replace(/(\/[0-9]*)_[a-z](\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "seoul.co.kr" && domain.match(/img[^.]*\.seoul\.co\.kr/)) {
            // http://img.seoul.co.kr/img/upload/2018/02/04/SSI_20180204221012_V.jpg
            //   http://img.seoul.co.kr/img/upload/2018/02/04/SSI_20180204221012.jpg
            // none, O, V, L, S, N, N2, N3, N4, N5
            // http://img.seoul.co.kr//img/upload/2017/02/20/SSI_20170220101030_V.jpg
            //   http://img.seoul.co.kr//img/upload/2017/02/20/SSI_20170220101030.jpg
            // (V, none), O, L, S, N,...
            // http://imgnn.seoul.co.kr/img//upload/2009/01/20/SSI_20090120114407_V.jpg
            //
            // http://img.seoul.co.kr/img/upload/2015/12/29/SSI_20151229090141_V.jpg
            //   http://img.seoul.co.kr/img/upload/2015/12/29/SSI_20151229090141.jpg - 2500x3235
            return src.replace(/_[A-Z](?:[0-9]){0,2}(\.[^/.]*)$/, "$1");
        }

        if (domain === "img.yonhapnews.co.kr") {
            // http://img.yonhapnews.co.kr/photo/yna/YH/2017/12/30/PYH2017123017200001300_P1.jpg
            //   http://img.yonhapnews.co.kr/photo/yna/YH/2017/12/30/PYH2017123017200001300_P4.jpg
            // http://img.yonhapnews.co.kr/etc/graphic/YH/2017/10/25/GYH2017102500160004400.jpg
            // http://img.yonhapnews.co.kr/etc/inner/EN/2018/02/19/AEN20180219010000315_02_i.jpg
            // http://img.yonhapnews.co.kr/etc/graphic/YH/2013/11/28/GYH2013112800040003900_P2.jpg
            // http://img.yonhapnews.co.kr/etc/inner/KR/2017/04/28/AKR20170428061900017_01_i.jpg
            // http://img.yonhapnews.co.kr/mpic/YH/2018/02/23/MYH20180223017200038.jpg (1920x1080)
            // http://img.yonhapnews.co.kr/etc/inner/KR/2016/11/03/AKR20161103119100061_01_i.jpg (3810x2704)
            return src.replace(/(\/PYH[^/_.]*)_[^/.]*(\.[^/.]*)$/, "$1_P4$2");
        }

        if (domain_nosub === "yonhapnews.co.kr" && domain.match(/big[0-9]*\.yonhapnews\.co\.kr/)) {
            // http://big5.yonhapnews.co.kr:83/gate/big5/img.yonhapnews.co.kr/basic/template/ck/2018/02/09/tmp_4504_20180209103744.jpg
            //   http://img.yonhapnews.co.kr/basic/template/ck/2018/02/09/tmp_4504_20180209103744.jpg
            return src.replace(/.*:\/\/[^/]*\/gate\/[^/]*\//, "http://");
        }

        if (domain_nosub === "bunjang.net") {
            // http://seoul-p-studio.bunjang.net/product/64557873_1_1514396938_w320.jpg
            //   http://seoul-p-studio.bunjang.net/product/64557873_1_1514396938.jpg
            return {
                url: src.replace(/_[wh][0-9]*(\.[^/.]*)$/, "$1"),
                can_head: false // 404
            };
        }

        if (domain === "betanews.heraldcorp.com" ||
            domain_nowww === "betanews.net") {
            // http://betanews.heraldcorp.com:8080/imagedb/thumb/2017/0821/acc59960.jpg
            //   http://betanews.heraldcorp.com:8080/imagedb/orig/2017/0821/acc59960.jpg
            // http://www.betanews.net/imagedb/first/2018/0204/d37686d0.jpg
            //   http://betanews.net/imagedb/orig/2018/0204/d37686d0.jpg
            // http://www.betanews.net/imagedb/main/thumb/805/805660.jpg
            //   http://www.betanews.net/imagedb/main/orig/805/805660.jpg
            return src
                .replace(/(\/imagedb\/(:?[^/]*\/)?)(?:first|thumb)\//, "$1orig/");
        }

        if (domain === "img.smlounge.co.kr") {
            // http://img.smlounge.co.kr/upload/grazia/article/201611/thumb/32609-190630-sampleM.jpg
            //   http://img.smlounge.co.kr/upload/grazia/article/201611/32609-190630.jpg
            // http://www.smlounge.co.kr/upload/grazia/article/201801/thumb/37419-279467-sample.jpg
            //   http://img.smlounge.co.kr/upload/grazia/article/201801/37419-279467.jpg
            return src.replace(/\/thumb\/([^/.]*)-sample[^/.-]*(\.[^/.]*)$/, "/$1$2");
        }

        if (false && domain === "img.etoday.co.kr") {
            // wip
            // http://www.etoday.co.kr/news/section/newsview_photo.php?idxno=1315836&seq=1
            // http://img.etoday.co.kr/pto_db/2016/04/20160412091428_851269_450_691.jpg (450x691)
            // http://img.etoday.co.kr/html/lib_img_crop.php?id=851269&mw=300&mh=225 (doesn't go up to 691, stretches)
            // http://img.etoday.co.kr/html/lib_img_mxwidth.php?idxno=1220670&maxw=530
        }

        if (domain === "image.tving.com" &&
            src.indexOf("tving.com/resize.php") >= 0) {
            // http://image.tving.com/resize.php?u=http://image.tving.com/upload/smr/clip/2018/02/04/C01_150548_0405.jpg&w=228
            return src.replace(/.*:\/\/[^/]*\/resize\.php.*?[?&]u=([^&]*).*/, "$1");
        }

        if (domain === "cdn.pastemagazine.com") {
            // https://cdn.pastemagazine.com/www/articles/assets_c/2015/02/skyrim%20mod%206-thumb-500x281-138387.jpg
            //   https://cdn.pastemagazine.com/www/articles/skyrim%20mod%206.jpg
            return src.replace(/(\/[^/]*\/)assets_[^/]*\/[0-9]*\/[0-9]*\/([^-]*)-.*(\.[^/.]*)$/, "$1$2$3");
        }

        if (domain === "www.beauty-co.jp") {
            // https://www.beauty-co.jp/news/assets_c/2018/02/180228_lucy_01-thumb-142xauto-21539.jpg
            //   https://www.beauty-co.jp/news/img/180228_lucy_01.jpg
            return src.replace(/\/news\/assets_[^/]*\/[0-9]*\/[0-9]*\/([^-]*)-.*(\.[^/.]*)$/, "/news/img/$1$2");
        }

        if (domain === "seichimap.jp") {
            // https://seichimap.jp/contents/assets_c/2015/08/P8150066-thumb-400xauto-539.jpg
            //   https://seichimap.jp/contents/pht/P8150066.JPG
            newsrc = src.replace(/(\/[^/]*\/)assets_[^/]*\/[0-9]*\/[0-9]*\/([^-]*)-.*(\.[^/.]*)$/, "$1pht/$2$3");
            if (newsrc !== src) {
                return [
                    newsrc,
                    newsrc.replace(".jpg", ".JPG")
                ];
            }
        }

        if (domain === "www.agencyteo.com") {
            // http://www.agencyteo.com/news/download/28302/w/600/KakaoTalk_20161121_144905918.jpg
            //   http://www.agencyteo.com/news/download/28302/KakaoTalk_20161121_144905918.jpg
            // http://www.agencyteo.com/news/download/48614/w/600/735318-800w.jpg
            //   // http://www.agencyteo.com/news/download/48614/735318.jpg
            return src
                .replace(/-[0-9]*[wh]*(\.[^/.]*)$/, "$1")
                .replace(/(\/download\/[0-9]*\/)[wh]\/[0-9]*\//, "$1");
        }

        if (domain_nosub === "riotpixels.net" && domain.match(/s[0-9]*\.riotpixels\.net/)) {
            // http://s01.riotpixels.net/data/37/29/3729e0a0-9e4c-4efa-9eb2-f89f17dde8fa.jpg.240p.jpg
            // http://s01.riotpixels.net/data/37/29/3729e0a0-9e4c-4efa-9eb2-f89f17dde8fa.jpg/screenshot.assassins-creed-origins.1920x1080.2017-11-25.87.jpg
            //   http://s01.riotpixels.net/data/37/29/3729e0a0-9e4c-4efa-9eb2-f89f17dde8fa.jpg
            // http://s01.riotpixels.net/data/b5/d0/b5d0cf29-9c4e-44f1-a2f4-1a5613453006.jpg.240p.jpg
            return src.replace(/(\/data\/[a-f0-9]*\/[a-f0-9]*\/[^./]*\.[^/.]*)[./].*$/, "$1");
        }

        if ((domain_nosub === "ignimgs.com" ||
             domain_nosub === "ign.com") &&
            domain.match(/^assets[0-9]*\./)) {
            // http://assets1.ignimgs.com/2018/02/02/ac-origins-the-hidden-ones---button-1517533272073_180h.jpg
            // http://assets1.ignimgs.com/2018/02/06/nightinthewoods-deck-ff6c25-1517944777381_358w.jpg
            // http://assets1.ignimgs.com/2017/05/09/1-1-1494366320371_grande.jpg
            //   http://assets1.ignimgs.com/2017/05/09/1-1-1494366320371.jpg
            // https://assets.ign.com/thumbs/userUploaded/2014/9/19/20823568_fatalframewiiu_tgs2014trailer_ign-1411150047803_medium.jpg
            //return src.replace(/_[0-9]*[wh](\.[^/.]*)$/, "$1");
            return src.replace(/_[^-_/.]*(\.[^/.]*)$/, "$1");
        }

        if (domain === "static.gamespot.com") {
            // https://static.gamespot.com/uploads/square_tiny/1578/15789737/3348796-alteredcarbon.jpg
            //   https://static.gamespot.com/uploads/original/1578/15789737/3348796-alteredcarbon.jpg
            // https://static.gamespot.com/uploads/scale_small/1365/13658182/2673733-geralt_yennefer-size_1920x1200.jpg
            //   https://static.gamespot.com/uploads/original/1365/13658182/2673733-geralt_yennefer-size_1920x1200.png
            return add_extensions(src.replace(/\/uploads\/[^/]*\//, "/uploads/original/"));
        }

        if (domain === "i.neoseeker.com" &&
            src.match(/\/size\/[0-9]+x[0-9]+\//)) {
            // https://i.neoseeker.com/size/166x85/1/n/1/1500662379_dbz_disc_display.jpg
            //   https://i.neoseeker.com/size/0x0/1/n/1/1500662379_dbz_disc_display.jpg
            return src.replace(/\/size\/[0-9]+x[0-9]+\//, "/size/0x0/");
        }

        if (domain === "i.neoseeker.com" &&
            src.match(/\/p\/[0-9]*\/[0-9]*\//)) {
            // https://i.neoseeker.com/p/206/46/dragon-ball-fighterz_thumb_pOUTR.jpg
            //   https://i.neoseeker.com/screenshots/MjA2LzQ2Lw==/dragon-ball-fighterz_image_pOUTR.jpg
            //   https://i.neoseeker.com/p/206/46/dragon-ball-fighterz_image_pOUTR.jpg
            return src.replace(/_thumb_([^/]*$)/, "_image_$1");
        }

        if (domain === "resource.supercheats.com") {
            // https://resource.supercheats.com/library/640w/ember/emb_intro.jpg
            //   https://resource.supercheats.com/library/ember/emb_intro.jpg
            // https://resource.supercheats.com/library/thumbs/2018/1515877801dlc.png
            //   https://resource.supercheats.com/library/2018/1515877801dlc.png
            return src.replace(/\/library\/(?:(?:[0-9]*[wh])|thumbs)\//, "/library/");
        }

        if (amazon_container === "intergi-phoenix") {
            // https://intergi-phoenix.s3.amazonaws.com/1021319/videos/5450791/images/thumb_large_Cod-WWII-dlc.jpg
            //   https://intergi-phoenix.s3.amazonaws.com/1021319/videos/5450791/images/Cod-WWII-dlc.jpg
            return src.replace(/\/images\/thumb_large_([^/]*)$/, "/images/$1");
        }

        if (domain === "www.primagames.com" ||
            // https://assets.rockpapershotgun.com/images/2018/09/acship.jpg/RPSS/resize/760x-1/format/jpg/quality/70
            //   https://assets.rockpapershotgun.com/images/2018/09/acship.jpg
            domain === "assets.rockpapershotgun.com") {
            // https://www.primagames.com/media/images/news/Playdead-Inside-ResearchFacility-40.jpg/PRIMA/resize/100x/format/jpg
            // https://www.primagames.com/media/files/news/dragon-age-inquisition-landing-page/dragon-age-inquisition-cover-ce.png/PRIMAP/resize/618x/format/jpg/quality/80 -- scaled up
            //   https://www.primagames.com/media/files/news/dragon-age-inquisition-landing-page/dragon-age-inquisition-cover-ce.png
            //return src.replace(/\/PRIMAP?\/.*/, "");
            return src.replace(/(\/[^/]*\.[^/.]*)\/[A-Z]+\/(?:resize|format|crop|quality)?\/.*$/, "$1");
        }

        if (domain_nosub === "ixquick.com" && domain.match(/s[0-9]*-[^.]*\.ixquick\.com/)) {
            // https://s15-us2.ixquick.com/cgi-bin/serveimage?url=http%3A%2F%2Ft0.gstatic.com%2Fimages%3Fq%3Dtbn%3AANd9GcQybc24UPrYyg-TnWPRUYH7zgzbQXgL4P86ngojIWv8J-Fzom7dAA&sp=ea6bc994daf22079cacb1e62879fa8d4&anticache=581224
            //   http://t0.gstatic.com/images?q=tbn:ANd9GcQybc24UPrYyg-TnWPRUYH7zgzbQXgL4P86ngojIWv8J-Fzom7dAA
            return decodeURIComponent(src.replace(/.*\/serveimage.*?[?&]url=([^&]*).*/, "$1"));
        }

        if (domain === "beta.ems.ladbiblegroup.com") {
            // http://beta.ems.ladbiblegroup.com/s3/content/353x199/0b7434735a7a95090e0210baf66f63ed.png
            //   http://beta.ems.ladbiblegroup.com/s3/content/0b7434735a7a95090e0210baf66f63ed.png
            return src.replace(/\/s3\/content\/[0-9]+x[0-9]+\//, "/s3/content/");
        }

        if (domain === "mtv-intl.mtvnimages.com") {
            // http://mtv-intl.mtvnimages.com/uri/mgid:arc:content:mtvasia.com:cdeab016-8964-423d-96ae-8ec187190fef?ep=mtvasia.com&stage=live&format=jpg&quality=0.8&quality=0.85&width=656&height=369&crop=true
            //   http://mtv-intl.mtvnimages.com/uri/mgid:arc:content:mtvasia.com:cdeab016-8964-423d-96ae-8ec187190fef
            return src.replace(/(\?ep=[^&]*).*/, "$1");
        }

        if (domain === "gaia.adage.com") {
            // http://gaia.adage.com/images/bin/image/x-large/GettyImages90319988832.jpg?1515686676
            //   http://gaia.adage.com/images/bin/image/GettyImages90319988832.jpg?1515686676
            // http://gaia.adage.com/images/bin/image/medium/Bud-Light-Super-Bowl-2018---Bud-Knight.jpg?1517433099
            //   http://gaia.adage.com/images/bin/image/Bud-Light-Super-Bowl-2018---Bud-Knight.jpg?1517433099
            return src.replace(/\/images\/bin\/image\/[^/]*\//, "/images/bin/image/");
        }

        if (domain === "t-eska.cdn.smcloud.net") {
            // http://t-eska.cdn.smcloud.net/hotplota/t/2/t/image/98343cf69b8e6bfcd82fd21c1573c5b4IMU2KOV8-en-0.jpg/ru-0-r-600,600-n-98343cf69b8e6bfcd82fd21c1573c5b4IMU2KOV8en0.jpg
            //   http://t-eska.cdn.smcloud.net/hotplota/t/2/t/image/98343cf69b8e6bfcd82fd21c1573c5b4IMU2KOV8-en-0.jpg/n-98343cf69b8e6bfcd82fd21c1573c5b4IMU2KOV8en0.jpg
            // http://t-eska.cdn.smcloud.net/hotplota/t/2/t/image/adc18921067ea9ca27d451b35ac4b964a2tUvABZ-prze.PNG/ru-0-ra-280,255-n-adc18921067ea9ca27d451b35ac4b964a2tUvABZprze.PNG
            //   http://t-eska.cdn.smcloud.net/hotplota/t/2/t/image/adc18921067ea9ca27d451b35ac4b964a2tUvABZ-prze.PNG/n-adc18921067ea9ca27d451b35ac4b964a2tUvABZprze.PNG
            return src.replace(/\/[^/]*?n-([^/]*)$/, "/n-$1");
        }

        if (domain === "cdn.wegow.com") {
            // https://cdn.wegow.com/media/artist-media/bad-gyal/bad-gyal-4132.-1x2560.jpg - stretched
            //   https://cdn.wegow.com/media/artist-media/bad-gyal/bad-gyal-4132.jpg
            return src.replace(/\.[-0-9]*x[-0-9]*(\.[^/.]*)$/, "$1");
        }

        if (domain === "www.ecestaticos.com") {
            // https://www.ecestaticos.com/image/clipping/330/74d2adf4c3ccfa3144086c71e16eabf3/alba-farelo-es-bad-gyal-una-de-las-mujeres-que-lidera-el-dancehall-espanol-gerard-lopez.jpg
            //   https://www.ecestaticos.com/image/clipping/0/74d2adf4c3ccfa3144086c71e16eabf3/alba-farelo-es-bad-gyal-una-de-las-mujeres-que-lidera-el-dancehall-espanol-gerard-lopez.jpg
            return src.replace(/\/clipping\/[0-9]*\//, "/clipping/0/");
        }

        if (domain === "sonarreykjavik.com" ||
            domain === "sonar.es") {
            // https://sonarreykjavik.com/system/attached_images/19379/medium/BadGyal_AlexisG%C3%B3mez.jpg?1513685256
            //   https://sonarreykjavik.com/system/attached_images/19379/large/BadGyal_AlexisG%C3%B3mez.jpg?1513685256
            //   https://sonarreykjavik.com/system/attached_images/19379/original/BadGyal_AlexisG%C3%B3mez.jpg?1513685256
            // https://sonar.es/system/attached_images/18702/medium/badgyal_xs_sonar2017_fernandoschlaepfer_004.jpg?1497713257 -- stretched?
            //   https://sonar.es/system/attached_images/18702/original/badgyal_xs_sonar2017_fernandoschlaepfer_004.jpg?1497713257
            return src.replace(/(\/attached_images\/[0-9]*\/)[^/]*\//, "$1original/");
        }

        if (domain === "pgw.udn.com.tw") {
            // https://pgw.udn.com.tw/gw/photo.php?u=https://uc.udn.com.tw/photo/2016/08/03/99/2447700.jpg&x=0&y=0&sw=0&sh=0&sl=W&fw=750
            // https://pgw.udn.com.tw/gw/photo.php?u=https://uc.udn.com.tw/photo/2018/05/16/realtime/4742890.jpg&x=0&y=0&sw=0&sh=0&sl=W&fw=1050&exp=3600
            //   https://uc.udn.com.tw/photo/2018/05/16/realtime/4742890.jpg
            return src.replace(/.*\/photo\.php.*?[?&]u=([^&]*).*/, "$1");
        }

        if (domain === "uc.udn.com.tw") {
            // https://uc.udn.com.tw/photo/2018/05/16/realtime/4742890.jpg -- HEAD returns 404
            return {
                url: src,
                can_head: false
            };
        }

        if ((domain_nosub === "hdslb.com" && domain.match(/i[0-9]*\.hdslb\.com/)) ||
            // https://img.xiaohongshu.com/avatar/5b56be0014de415b2db830a6.jpg@160w_160h_92q_1e_1c_1x.jpg
            //   https://img.xiaohongshu.com/avatar/5b56be0014de415b2db830a6.jpg
            domain === "img.xiaohongshu.com" ||
            // http://alcdn.img.xiaoka.tv/20160708/899/367/44745628/899367337e05da1af210de07ff2740e6.jpg@1e_1c_0o_0l_640h_640w_100q_1pr.jpg
            //   http://alcdn.img.xiaoka.tv/20160708/899/367/44745628/899367337e05da1af210de07ff2740e6.jpg
            // https://alcdn.img.xiaoka.tv/20161017/a33/379/27774175/a333797899a6aa5d2766de56d58dc7a3.jpg@1e_1c_0o_0l_330h_330w
            //   https://alcdn.img.xiaoka.tv/20161017/a33/379/27774175/a333797899a6aa5d2766de56d58dc7a3.jpg
            (domain_nosub === "xiaoka.tv" && domain.match(/alcdn\.img\.xiaoka\.tv/))) {
            // https://i0.hdslb.com/bfs/bangumi/546991a5d3add9b550925b1168abf0a460e5f552.jpg@240w_320h.jpg
            // https://i2.hdslb.com/bfs/archive/6b1d06f79ec31b6e23e4ecb7eb87c53ccd86f965.jpg@.webp
            //   https://i2.hdslb.com/bfs/archive/6b1d06f79ec31b6e23e4ecb7eb87c53ccd86f965.jpg
            // http://i0.hdslb.com/320_180/u_user/a5ab2c18e8e4a62240fad3f0b040ba00.jpg
            //   http://i0.hdslb.com/u_user/a5ab2c18e8e4a62240fad3f0b040ba00.jpg
            return src
                .replace(/(:\/\/[^/]*\/)[0-9]+_[0-9]+\//, "$1")
            //.replace(/(\.[^/.]*)@(?:[0-9]*[a-z](?:_[0-9]*[wh])?)?(\.[^/.]*)$/, "$1");
                .replace(/(\.[^/.]*)@[_0-9a-z]*(?:\.[^/.]*)?$/, "$1");
        }

        if (domain === "d.ifengimg.com") {
            // http://d.ifengimg.com/w204_h115/p0.ifengimg.com/pmop/2017/1230/E538B9A1631291D8B1578F161157F26647C97944_size296_w448_h252.png
            // http://d.ifengimg.com/w600/p0.ifengimg.com/pmop/2017/0726/F4057A55111AE62724AF9C914EFEE425FEBD79C7_size41_w750_h422.jpeg
            // http://d.ifengimg.com/q100/p0.ifengimg.com/pmop/2017/0726/F4057A55111AE62724AF9C914EFEE425FEBD79C7_size41_w750_h422.jpeg
            // https://d.ifengimg.com/mw640_q100/y3.ifengimg.com/yidian/2015_46/4321111b2929329_w366_h550.jpg
            //   http://y3.ifengimg.com/yidian/2015_46/4321111b2929329_w366_h550.jpg

            return src.replace(/.*?\/[a-z]+[0-9]*(?:_[whq][0-9]*)?\//, "http://");
            //return src.replace(/(:\/\/[^/]*\/)[wh][0-9]+(?:_[wh][0-9]*)?\//, "$1w0/");
        }

        if (domain === "www.nationalgeographic.com") {
            // https://www.nationalgeographic.com/content/dam/magazine/rights-exempt/2012/04/unseen-titanic/01-port-bow-titanic-3x2.ngsversion.1492030266842.adapt.1900.1.jpg
            //   https://www.nationalgeographic.com/content/dam/magazine/rights-exempt/2012/04/unseen-titanic/01-port-bow-titanic-3x2.jpg
            return src.replace(/\.[^/]*(\.[^/.]*)$/, "$1");
        }

        // fixme: find other and merge with it
        if (domain === "media.mnn.com" ||
            // https://alljapantours.com/places-to-visit-in-japan/most-beautiful-places-in-japan/img/issue_04most_photo01.jpg.pagespeed.ce.woxsyqYnu2.jpg
            domain === "alljapantours.com" ||
            // http://shows.gqimg.com.cn/showspic/FashionImages/F2018MEN/paris/louis-vuitton/collection/_VUI0653h.jpg.100X150.jpg
            domain === "shows.gqimg.com.cn" ||
            // http://shows.vogueimg.com.cn/showspic/FashionImages/S2017CTR/paris/alexandre-vauthier/collection/_ARC0726h.jpg.100X150.jpg
            domain === "shows.vogueimg.com.cn" ||
            // https://smedia.webcollage.net/rwvfp/wc/cp/22757735/module/cpwalmart/_cp/products/1472244742078/tab-0e3f8313-5e4d-4103-9de5-caca68cf8437/eaddf5d5-afe7-4086-9bc7-149b6b486cdd.jpg.w480.jpg
            //    https://media3.webcollage.net/a8d14734c22ff05fcb5aa464bcde656048f8ec9b?response-content-type=image%2Fjpeg&AWSAccessKeyId=AKIAIIE5CHZ4PRWSLYKQ&Expires=1893510561&Signature=eqN507piWJYrWEhhc72wNlKeaao%3D
            // https://smedia.webcollage.net/rwvfp/wc/cp/22757735/module/cpwalmart/_cp/products/1472244742078/tab-0e3f8313-5e4d-4103-9de5-caca68cf8437/eaddf5d5-afe7-4086-9bc7-149b6b486cdd.jpg
            //    https://media3.webcollage.net/0ddf5fd70a8e0511dcd624ae9620bae32ae1ca4b?response-content-type=image%2Fjpeg&AWSAccessKeyId=AKIAIIE5CHZ4PRWSLYKQ&Expires=1893509612&Signature=cb7UbzZXRXb4S%2BLblX1crSDyOB0%3D
            (domain_nosub === "webcollage.net" && domain.indexOf("media.webcollage.net") >= 0) ||
            // http://www.metronews.ca/content/dam/thestar/uploads/2017/3/29/oilers.jpg.size.xxlarge.promo.jpg
            domain === "www.metronews.ca" ||
            // https://images.meredith.com/content/dam/bhg/Images/life-in-color/arnold%20gian.jpg.rendition.largest.jpg
            domain === "images.meredith.com" ||
            // http://img-cdn.jg.jugem.jp/584/719314/20131206_802590.jpg.thumb.jpg
            domain === "img-cdn.jg.jugem.jp" ||
            // http://anime-thai.net/bbs/data/attachment/album/201405/22/171403xnhmbbh70bx5kp47.jpg.thumb.jpg
            domain_nowww === "anime-thai.net" ||
            // http://styleyen.com/galleries/6/image_slide/2/taylor-swift-bangs.jpg.thumb_200_width.jpg
            domain_nowww === "styleyen.com" ||
            // http://www.nbstr.org/sitebuildercontent/sitebuilderpictures/webassets/hercules.jpg.w300h300.jpg
            domain === "www.nbstr.org" ||
            // https://dyn0.media.forbiddenplanet.com/products/201226.jpg.maxheight-285_square-true_size-285.jpg
            (domain_nosub === "forbiddenplanet.com" && domain.match(/^dyn[0-9]*\.media\.forbiddenplanet\.com/)) ||
            // https://media.treehugger.com/assets/images/2018/02/16300451622_c972b01dae_b_1.jpg.860x0_q70_crop-smart.jpg
            domain === "media.treehugger.com" ||
            // http://media.allyou.net/2/28690/images/7918324/MarieClaire-72.jpg.5000x640_q90.jpg
            domain === "media.allyou.net" ||
            // https://image.pbs.org/poster_images/assets/IcebergCultureBlank_JPEG1.jpg.resize.710x399.jpg
            domain === "image.pbs.org" ||
            // http://plasticsurgerystar.com/images/measurements2/jennifer-lawrence-body-height-weight-bra-size/jennifer-lawrence-weight.jpg.thumb_100_width.jpg
            (domain_nowww === "plasticsurgerystar.com" && src.indexOf("/images/") >= 0) ||
            domain === "d26oc3sg82pgk3.cloudfront.net" ||
            domain === "d53l9d6fqlxs2.cloudfront.net") {
            // https://media.mnn.com/assets/images/2017/03/cyclops-2-titanic-wreck.jpg.653x0_q80_crop-smart.jpg
            //   https://media.mnn.com/assets/images/2017/03/cyclops-2-titanic-wreck.jpg
            // https://d26oc3sg82pgk3.cloudfront.net/files/media/uploads/zinnia/2017/08/22/0824-felicity-jones_cred_shutterstock-featureflash-photo-agency.jpg.644x420_q100.jpg
            //   https://d26oc3sg82pgk3.cloudfront.net/files/media/uploads/zinnia/2017/08/22/0824-felicity-jones_cred_shutterstock-featureflash-photo-agency.jpg
            // https://d53l9d6fqlxs2.cloudfront.net/photos/41/41127-tokyos-tak.jpg.660x0_q80_crop-scale_upscale.jpg
            //   https://d53l9d6fqlxs2.cloudfront.net/photos/41/41127-tokyos-tak.jpg
            newsrc = src.replace(/(\/[^/.]*\.[^/.]*)\.[^/]*$/, "$1");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain === "media.contentapi.ea.com") {
            // https://media.contentapi.ea.com/content/dam/ea/dragonage/inquisition-refresh/videos/2018/01/90614bfc-1566-7230-3359-3ea9a1f39577.youtube/subassets/poster.jpg.adapt.crop16x9.1920w.jpg
            //   https://media.contentapi.ea.com/content/dam/ea/dragonage/inquisition-refresh/videos/2018/01/90614bfc-1566-7230-3359-3ea9a1f39577.youtube/subassets/poster.jpg
            // https://media.contentapi.ea.com/content/dam/ea/dragonage/inquisition-refresh/images/2018/01/ea-hero-medium-dai-homepage-7x2-xl.jpg.adapt.crop3x5.320w.jpg
            //   https://media.contentapi.ea.com/content/dam/ea/dragonage/inquisition-refresh/images/2018/01/ea-hero-medium-dai-homepage-7x2-xl.jpg
            newsrc = src.replace(/(\/[^/.]*\.[^/.]*)\.[^/]*$/, "$1");
            if (newsrc !== src)
                return {
                    url: newsrc,
                    can_head: false
                };
        }


        if (domain === "img.bleacherreport.net") {
            // https://img.bleacherreport.net/cms/media/image/fa/2f/08/6e/dfb9/4c1f/b030/48ba951160bd/crop_exact_USATSI_10579599.jpg?w=460&h=259&q=75
            //   https://img.bleacherreport.net/cms/media/image/fa/2f/08/6e/dfb9/4c1f/b030/48ba951160bd/USATSI_10579599.jpg?w=999999999999&h=999999999999
            return src
                .replace(/\/crop_exact_([^/]*)$/, "/$1")
                .replace(/\?.*$/, "?w=999999999999&h=999999999999");
        }

        if (domain === "images.gr-assets.com") {
            // https://images.gr-assets.com/books/1403200898m/7923163.jpg
            // https://images.gr-assets.com/authors/1281489919p2/3443203.jpg
            // https://images.gr-assets.com/users/1268072620p2/1668975.jpg
            return src
                .replace(/(\/(?:authors|users)\/[0-9]*p)[0-9]\//, "$18/")
                .replace(/(\/books\/[0-9]*)[a-z]\//, "$1l/");
        }

        if (domain === "dynamic.indigoimages.ca") {
            // https://dynamic.indigoimages.ca/books/1506701655.jpg?altimages=false&scaleup=true&maxheight=515&width=380&quality=85&sale=0&lang=en
            // https://dynamic.indigoimages.ca/books/1506701655.jpg?width=999999999
            return src.replace(/(\?.*)?$/, "?width=999999999");
        }

        if (domain === "cdn.mos.cms.futurecdn.net") {
            // https://cdn.mos.cms.futurecdn.net/wtXpUq7DAuPqftGRshxtzD-650-80.jpg
            //   https://cdn.mos.cms.futurecdn.net/wtXpUq7DAuPqftGRshxtzD.jpg
            return src.replace(/-[0-9]+-[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "www.allkpop.com") {
            // https://www.allkpop.com/upload/2018/02/af/12101614/clc.jpg
            //   https://www.allkpop.com/upload/2018/02/af_org/12101614/clc.jpg
            return src.replace(/\/af\/([0-9]*\/[^/]*)$/, "/af_org/$1");
        }

        if (domain === "cwcontent.asiae.co.kr") {
            return src
                //.replace(/\/amgimagelink\/[0-9]*\//, "/amgimagelink/0/")
                .replace(/^(.*?:\/\/).*\/[^/]*resize\/[0-9]*\/([^/]*)$/, "$1cphoto.asiae.co.kr/listimglink/4/$2");
            // http://cwcontent.asiae.co.kr/stooresize/32/2018020812382111881_1518061101.jpg
            //   http://cwcontent.asiae.co.kr/stooresize/28/2018020812382111881_1518061101.jpg
            //   http://cphoto.asiae.co.kr/listimglink/7/2018020812382111881_1518061101.jpg
            //   http://cphoto.asiae.co.kr/listimglink/4/2018020812382111881_1518061101.jpg - max
            // http://cwcontent.asiae.co.kr/amgimagelink/98/2018020408443101207A_1.jpg
            //   http://cphoto.asiae.co.kr/listimglink/4/201110161718307486692A_1.jpg - different
            // http://cwcontent.asiae.co.kr/asiaresize/80/2018021210005919425_1518397258.jpg
            //   http://cwcontent.asiae.co.kr/asiaresize/113/2018021210005919425_1518397258.jpg
            //   http://cwcontent.asiae.co.kr/asiaresize/132/2018021210005919425_1518397258.jpg
            //   http://cphoto.asiae.co.kr/listimglink/4/2018021210005919425_1518397258.jpg - max, same as above
            // http://cwcontent.asiae.co.kr/asiaresize/103/2018021210300316119_2.jpg
            //   http://cphoto.asiae.co.kr/listimglink/4/2018021210300316119_2.jpg - doesn't work
            //   http://cphoto.asiae.co.kr/listimglink/4/2018021210291519546_1518398953.jpg - proper
            // http://cwcontent.asiae.co.kr/amgimagelink/98/2018031311511632721A_1.jpg -- not
            //   http://cwcontent.asiae.co.kr/amgimagelink/0/2018031311511632721A_1.jpg -- gif
            //   http://cwcontent.asiae.co.kr/listimglink/4/2018031311511632721A_1.jpg -- doesn't work
            // http://cwcontent.asiae.co.kr/amgimagelink/98/2017092915472067985A_1.jpg -- not
            //   http://cwcontent.asiae.co.kr/amgimagelink/0/2017092915472067985A_1.jpg -- gif??
            //   http://cwcontent.asiae.co.kr/listimglink/4/2017092915472067985A_1.jpg -- doesn't work
            // http://cwcontent.asiae.co.kr/amgimagelink/0/201411151911520388001A_1.jpg -- watermark
            //   http://cwcontent.asiae.co.kr/listimglink/4/201411151911520388001A_1.jpg -- without
            // http://cphoto.asiae.co.kr/listimglink/4/2016051308263757999_1.jpg
            //   http://cwcontent.asiae.co.kr/amgimagelink/0/2016051308263757999_1.jpg -- smaller
            //   http://cwcontent.asiae.co.kr/amgimagelink/0/2016051308263757999_1.jpg -- slightly larger
            // http://cwcontent.asiae.co.kr/stooresize/33/2018031311332188690A_1.jpg
            //   http://cphoto.asiae.co.kr/listimglink/4/2018031311332188690A_1.jpg -- content length: 0
            //   http://cwcontent.asiae.co.kr/amgimagelink/0/2018031311332188690A_1.jpg -- proper
            // http://cwcontent.asiae.co.kr/amgimagelink/0/2018030609164136390A_1.jpg -- 540x607
            //   http://cwcontent.asiae.co.kr/amgimagelink/98/2018030609164136390A_1.jpg -- 1080x1215
            // http://cwcontent.asiae.co.kr/amgimagelink/0/2014091709013891379_1.jpg -- 540x379
            //   http://cwcontent.asiae.co.kr/listimglink/4/2014091709013891379_1.jpg -- larger (885x623)
            // http://cwcontent.asiae.co.kr/amgimagelink/98/201410202126598761515A_1.jpg
            //   http://cphoto.asiae.co.kr/listimglink/4/201410202126598761515A_1.jpg -- same size, without watermark
            // http://wcontent.asiaeconomy.co.kr/amgimage_link.htm?idx=0&no=2008090309143458665_1.jpg
            // http://photo.asiae.co.kr/listimg_link.php?idx=2&no=2018031212153472858_1520824535.jpg
            // http://cwstoo.asiae.co.kr/freeimg_get.htm?img=1371 -- download
            // resize:
            // 28, 1, 20, 16, 3, 34, 18, 9, 35, 13, 21, 24, 39, 7, 15, 2, 23, 44, 11, 5, 22, 30, 4, 6, 25, 40, 8, 36, 47, 27, 48, 43, 46, 33, 17, 38, 41, 37, 14, 32, 45, 42, 31, 26, 12, 29, 10, 19
            // listimglink:
            // (4, 5 [=download]), 7, 6, 2, 3
            // amgimagelink:
            // (98, 12, 0), 11, 3, 14, 10, 4
        }

        if (domain === "cphoto.asiae.co.kr") {
            // http://cphoto.asiae.co.kr/listimglink/4/2015101609215433891_1.jpg - 2598x3354
            // http://cphoto.asiae.co.kr/listimg_link.php?idx=3&no=2010070915075405717_2.jpg
            //   http://cphoto.asiae.co.kr/listimg_link.php?idx=4&no=2010070915075405717_2.jpg
            // http://cphoto.asiae.co.kr/resizeimglink/2/201012011609040182464A_1.jpg
            //   http://cphoto.asiae.co.kr/listimglink/4/201012011609040182464A_1.jpg
            return src
                .replace(/\/listimglink\/[0-9]*\//, "/listimglink/4/")
                .replace(/\/resizeimglink\/[0-9]*\//, "/listimglink/4/")
                .replace(/\/listimg_link\.php.*?[?&]no=([^&]*).*?$/, "/listimg_link.php?idx=4&no=$1");
        }

        if (domain === "thumbs-prod.si-cdn.com") {
            // https://thumbs-prod.si-cdn.com/eoEYA_2Hau4795uKoecUZZgz-3w=/800x600/filters:no_upscale()/https://public-media.smithsonianmag.com/filer/52/f9/52f93262-c29b-4a4f-b031-0c7ad145ed5f/42-33051942.jpg
            //   https://public-media.smithsonianmag.com/filer/52/f9/52f93262-c29b-4a4f-b031-0c7ad145ed5f/42-33051942.jpg
            return src.replace(/.*\/(https?:\/\/)/, "$1");
        }

        if (domain === "assets.atlasobscura.com") {
            // https://assets.atlasobscura.com/article_images/800x/17628/image.jpg
            //   https://assets.atlasobscura.com/article_images/17628/image.jpg
            return src.replace(/\/article_images\/[0-9]*x\//, "/article_images/");
        }

        if (domain === "wonderopolis.org" &&
            src.indexOf("/_img") >= 0) {
            // https://wonderopolis.org/_img?img=/wp-content/uploads/2012/01/squirell_shutterstock_6383917.jpg&transform=resizeCrop,720,450
            //   https://wonderopolis.org/_img?img=/wp-content/uploads/2012/01/squirell_shutterstock_6383917.jpg
            return src.replace(/\/_img.*?[?&](img=[^&]*).*/, "/_img?$1");
        }

        if (domain === "www.thehindu.com" ||
            domain === "www.gloria.hr" ||
            // http://i4.mirror.co.uk/incoming/article1323853.ece/ALTERNATES/s1227b/Sky%20Sports%20news%20female%20presenters
            //   http://i4.mirror.co.uk/incoming/article1323853.ece/BINARY/Sky%20Sports%20news%20female%20presenters
            ((domain_nosub === "mirror.co.uk" ||
              // https://i2-prod.birminghammail.co.uk/incoming/article15152252.ece/ALTERNATES/s615/2_NWP_BEM_130918Bailey01JPG.jpg
              //   https://i2-prod.birminghammail.co.uk/incoming/article15152252.ece/BINARY/2_NWP_BEM_130918Bailey01JPG.jpg
              domain_nosub === "birminghammail.co.uk" ||
              // https://i2-prod.dailypost.co.uk/incoming/article15148144.ece/BINARY/2_Joint-owner-Jules-Peters-has-opened-a-new-coffee-shop-called-Haus-on-Penrhyn-Road-Colwyn-Bay-Image.jpg
              //   https://i2-prod.dailypost.co.uk/incoming/article15148144.ece/BINARY/2_Joint-owner-Jules-Peters-has-opened-a-new-coffee-shop-called-Haus-on-Penrhyn-Road-Colwyn-Bay-Image.jpg
              domain_nosub === "dailypost.co.uk" ||
              // https://i2-prod.bristolpost.co.uk/incoming/article1628442.ece/ALTERNATES/s615/BristolMagsCourtPNG.png
              //   https://i2-prod.bristolpost.co.uk/incoming/article1628442.ece/BINARY/BristolMagsCourtPNG.png
              domain_nosub === "bristolpost.co.uk" ||
              // https://i2-prod.irishmirror.ie/incoming/article8862957.ece/ALTERNATES/s615b/abb08375.jpg
              //   https://i2-prod.irishmirror.ie/incoming/article8862957.ece/BINARY/abb08375.jpg
              domain_nosub === "irishmirror.ie" ||
              // https://i2-prod.coventrytelegraph.net/incoming/article14083906.ece/ALTERNATES/s1200/Davina-McCall-1.jpg
              //   https://i2-prod.coventrytelegraph.net/incoming/article14083906.ece/BINARY/Davina-McCall-1.jpg
              domain_nosub === "coventrytelegraph.net" ||
              // https://i2-prod.dublinlive.ie/incoming/article14444188.ece/ALTERNATES/s458/CC-METRO-FIRE190393751.jpg
              //   https://i2-prod.dublinlive.ie/incoming/article14444188.ece/BINARY/CC-METRO-FIRE190393751.jpg
              domain_nosub === "dublinlive.ie") &&
             domain.match(/i[0-9]*(?:-prod)?\./)) ||
            // https://www.mirror.co.uk/incoming/article1323853.ece/ALTERNATES/s1227b/Sky%20Sports%20news%20female%20presenters
            domain === "www.mirror.co.uk" ||
            // https://beta.images.theglobeandmail.com/76a/sports/hockey/article38351471.ece/ALTERNATES/w620/web-sp-hk-senators-0326.JPG
            // https://beta.images.theglobeandmail.com/339/sports/article34852751.ece/BINARY/w620/hk-moss28sp3.JPG
            domain === "beta.images.theglobeandmail.com" ||
            // http://www.globalblue.com/destinations/uk/london/article288436.ece/alternates/LANDSCAPE2_970/cara_delevingne_rochas.jpg
            domain === "www.globalblue.com" ||
            // https://cdn-04.belfasttelegraph.co.uk/entertainment/film-tv/news/article36669885.ece/ALTERNATES/w620/bpanews_d1dbd5df-f462-4575-86fd-ef234930e632_embedded235347559
            //   https://cdn-04.belfasttelegraph.co.uk/entertainment/film-tv/news/article36669885.ece/BINARY/bpanews_d1dbd5df-f462-4575-86fd-ef234930e632_embedded235347559
            (domain_nosub === "belfasttelegraph.co.uk" && domain.match(/cdn(-[0-9]+)?\.belfasttelegraph\.co\.uk/)) ||
            // http://www.ladylike.gr/articles/galleries/photostories/article2773870.ece/ALTERNATES/w60/olsen.jpg
            // http://www.ladylike.gr/articles/galleries/photostories/article2773872.ece/BINARY/original/Rihanna.jpg
            //   http://www.ladylike.gr/articles/galleries/photostories/article2773872.ece/BINARY/Rihanna.jpg -- same
            domain === "www.ladylike.gr" ||
            // http://www.24horas.cl/incoming/iceberg-en-groenlandia-2764254/ALTERNATES/w620h350/iceberg%20en%20Groenlandia
            //   http://www.24horas.cl/incoming/iceberg-en-groenlandia-2764254/BINARY/iceberg%20en%20Groenlandia
            domain_nowww === "24horas.cl" ||
            // https://www.jyllands-posten.dk/pictures/image/10752571/qz36h4/ALTERNATES/g-5_3/innarsuit
            domain_nowww === "jyllands-posten.dk" ||
            // https://www.svtstatic.se/image-cms/svtse/1531589739/nyheter/article18662486.svt/alternates/large/180714-gronlandisberg-715344-a001nh-jpg
            //   https://www.svtstatic.se/image-cms/svtse/1531589739/nyheter/article18662486.svt/BINARY/180714-gronlandisberg-715344-a001nh-jpg
            domain_nowww === "svtstatic.se" ||
            // https://www.adressa.no/incoming/article17124160.ece/9r0lq0/ALTERNATES/w980-default/td0459ed.jpg
            domain_nowww === "adressa.no" ||
            // https://www.belfasttelegraph.co.uk/migration_catalog/article25788206.ece/ALTERNATES/h342/SamanthaMumba
            domain_nowww === "belfasttelegraph.co.uk" ||
            // https://www.miamiherald.com/entertainment/celebrities/b166pq/picture149952302/alternates/FREE_1140/cabello
            //   https://www.miamiherald.com/entertainment/celebrities/b166pq/picture149952302/BINARY/cabello -- 403 HEAD, but fine with GET
            domain_nowww === "miamiherald.com" ||
            src.match(/\/incoming\/article[^/]*\.(?:ece|svt)\/(?:[^/]*\/)?(?:alternates|ALTERNATES)\//) ||
            src.match(/:\/\/i[0-9]*(?:-prod)?\..*\/article[^/]*\.(?:ece|svt)\//) ||
            // https://www.independent.ie/world-news/article37114917.ece/ALTERNATES/h342/ipanews_2350b658-06c1-4a29-b747-cbfdcd1b624c_1
            //   https://www.independent.ie/world-news/article37114917.ece/BINARY/ipanews_2350b658-06c1-4a29-b747-cbfdcd1b624c_1
            // https://cdn-01.independent.ie/incoming/article35675982.ece/70a4f/AUTOCROP/w940/675787992.jpg
            //   https://cdn-01.independent.ie/incoming/article35675982.ece/70a4f/BINARY/675787992.jpg
            domain_nosub === "independent.ie") {
            // wip
            // http://www.thehindu.com/migration_catalog/article14926809.ece/alternates/FREE_660/30MPSQUIRREL
            // http://www.thehindu.com/migration_catalog/article14926809.ece/alternates/FREE_960/30MPSQUIRREL
            // http://www.thehindu.com/migration_catalog/article14926809.ece
            // http://www.thehindu.com/news/national/kerala/article22745555.ece/alternates/LANDSCAPE_100/Priya
            // http://www.thehindu.com/news/national/kerala/article22745555.ece/alternates/FREE_460/Priya
            // https://i2-prod.mirror.co.uk/incoming/article7024597.ece/ALTERNATES/s615/PAY-Three-cute-squirrels-CUDDLING.jpg
            // https://i2-prod.mirror.co.uk/incoming/article236507.ece/ALTERNATES/s615/FA8A36EC-B0C4-D13B-383835E6F08D4428.jpg
            // https://i2-prod.mirror.co.uk/incoming/article11181827.ece/ALTERNATES/s615b/PROD-JRP_LEC_140117lsquirral_002JPG.jpg
            // https://i2-prod.mirror.co.uk/incoming/article11691534.ece/ALTERNATES/s1227b/PAY-SQUIRREL-AND-BIRD.jpg
            // https://i2-prod.mirror.co.uk/incoming/article11691532.ece/ALTERNATES/s1227b/PAY-SQUIRREL-AND-BIRD.jpg
            // https://i2-prod.mirror.co.uk/incoming/article5603898.ece/ALTERNATES/s1200/PAY-Squirrels.jpg
            // https://i2-prod.mirror.co.uk/incoming/article11263183.ece/ALTERNATES/s1168v/VIDEO-SQUIRREL.jpg
            // https://i2-prod.mirror.co.uk/incoming/article12021721.ece/ALTERNATES/s1176b/MGP_MDG_1302182281JPG.jpg
            // https://i2-prod.mirror.co.uk/incoming/article12021243.ece/ALTERNATES/s270b/MAIN-paddy.jpg
            // https://i2-prod.mirror.co.uk/incoming/article8949472.ece/ALTERNATES/s270b/National-Lottery-Euromillions-ticket.jpg
            //   https://i2-prod.mirror.co.uk/incoming/article8949472.ece/ALTERNATES/s810/National-Lottery-Euromillions-ticket.jpg
            // https://i2-prod.mirror.co.uk/incoming/article12021158.ece/ALTERNATES/s508/RIP-Pizza-Express-give-away-free-meals-to-certain-customers-who-do-this-one-thing.jpg
            //   https://i2-prod.mirror.co.uk/incoming/article12021158.ece/ALTERNATES/s615/RIP-Pizza-Express-give-away-free-meals-to-certain-customers-who-do-this-one-thing.jpg
            //   https://i2-prod.mirror.co.uk/incoming/article12021158.ece/ALTERNATES/s810/RIP-Pizza-Express-give-away-free-meals-to-certain-customers-who-do-this-one-thing.jpg
            //   https://i2-prod.mirror.co.uk/incoming/article12021158.ece/ALTERNATES/s1200/RIP-Pizza-Express-give-away-free-meals-to-certain-customers-who-do-this-one-thing.jpg
            // https://i2-prod.mirror.co.uk/incoming/article4997473.ece/ALTERNATES/s298/Actress-Felicity-Jones.jpg
            // http://www.dailymirror.lk/article/Rare-albino-squirrel-posing-in-his-white-suit--126748.html
            //   http://static.dailymirror.lk/media/images/image_1491276569-ba3932b3dc.jpg
            //   http://static.dailymirror.lk/media/images/image_1491276584-77a6a42e37.jpg
            //   http://static.dailymirror.lk/media/images/image_1491276594-bc6ed40255.jpg
            // https://i2-prod.birminghammail.co.uk/news/midlands-news/article8438687.ece/ALTERNATES/s615b/Felicity-Jones-The-Worst-Witch.jpg
            //   https://i2-prod.birminghammail.co.uk/news/midlands-news/article8438687.ece/BINARY/Felicity-Jones-The-Worst-Witch.jpg
            // https://i2-prod.mirror.co.uk/incoming/article9801836.ece/ALTERNATES/s810/SUNDAYPEOPLE-PROD-Tara-Palmer-Tomkinson.jpg
            // https://i2-prod.mirror.co.uk/incoming/article7009917.ece/BINARY/CS85701845-1.png
            // https://i2-prod.dailypost.co.uk/incoming/article12849370.ece/binary/BigBubble.jpg
            // https://i2-prod.bristolpost.co.uk/incoming/article1143957.ece/BINARY/Elise-Britten-profile-pic-square.jpg
            // https://www.gloria.hr/moda/novosti/naomicampbell01jpg/6949668/alternates/FREE_580/NaomiCampbell01.jpg
            //return src.replace(/(\/article[0-9]*\.ece\/.*?)(?:alternates|ALTERNATES|AUTOCROP|autocrop)\/[^/]*\//, "$1BINARY/");
            newsrc = src.replace(/(?:alternates|ALTERNATES|AUTOCROP|autocrop|binary|BINARY)\/[^/]*\/([^/]*)$/, "BINARY/$1");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain === "images.fandango.com" ||
            // http://www.statf.com/ImageRenderer/0/0/redesign/static/img/default_poster.png/0/images/masterrepository/other/INTRO-1_Getty_139033234.jpg
            //   http://www.statf.com/images/masterrepository/other/INTRO-1_Getty_139033234.jpg
            domain === "www.statf.com") {
            // no noticeable change though
            // https://images.fandango.com/ImageRenderer/0/0/redesign/static/img/default_poster.png/0/images/masterrepository/performer%20images/p237485/thetempest2010-mv-19.jpg
            //   https://images.fandango.com/images/masterrepository/performer%20images/p237485/thetempest2010-mv-19.jpg
            // http://images.fandango.com/ImageRenderer/0/0/redesign/static/img/default_poster.png/0/images/masterrepository/performer%20images/p237485/felicityjones-cheri-7.jpg
            //   http://images.fandango.com/images/masterrepository/performer%20images/p237485/felicityjones-cheri-7.jpg
            return src.replace(/\/ImageRenderer\/.*?\/images\//, "/images/");
        }

        if (domain === "s3.amazonaws.com" &&
            src.match(/\/s3\.amazonaws\.com\/assets\.forward\.com\//)) {
            // https://s3.amazonaws.com/assets.forward.com/images/cropped/gettyimages-655344102-1500478034.jpg
            return src.replace(/.*:\/\/[^/]*\//, "http://");
        }

        if (domain === "assets.forward.com" ||
            // https://assets.forwardcdn.com/images/cropped/1020-5-1524514529.jpeg
            //   https://assets.forwardcdn.com/images/1020-5-1524514529.jpeg
            domain === "assets.forwardcdn.com") {
            // http://assets.forward.com/images/cropped/gettyimages-655344102-1500478034.jpg
            //   http://assets.forward.com/images/gettyimages-655344102-1500478034.jpg
            return src.replace(/\/images\/cropped\//, "/images/");
        }

        if (domain === "www.thejewelleryeditor.com") {
            // http://www.thejewelleryeditor.com/media/images_thumbnails/filer_public_thumbnails/old/21228/Felicity-Jones-Finch-Oscars-2013.jpg__1536x0_q75_crop-scale_subsampling-2_upscale-false.jpg - stretched
            //   http://www.thejewelleryeditor.com/media/images/old/21228/Felicity-Jones-Finch-Oscars-2013.jpg
            return src.replace(/\/images_thumbnails\/[^/]*_thumbnails\/([^/]*\/[0-9]*\/[^/.]*\.[^_/.]*)__[^/]*$/, "/images/$1");
        }

        if (domain_nowww === "sass.com.ua") {
            // https://sass.com.ua/static/media/public_thumbnails/public/2017/11/11/03.jpg__1024x1024_q85_subsampling-2.jpg
            //   https://sass.com.ua/static/media/public/2017/11/11/03.jpg
            return src.replace(/\/static\/media\/[^/]*(\/public\/.*\/[^/]*?\.[a-z]+)__[^/]*$/, "/static/media$1");
        }

        if (domain === "files.sharenator.com") {
            // https://files.sharenator.com/felicity-jones-s3504x4800-453760-1020.jpg
            //   https://files.sharenator.com/felicity-jones-s3504x4800-453760.jpg
            //   https://files.sharenator.com/453760.jpg -- 3504x4800
            // https://files.sharenator.com/jessica-alba-s700x1001-432323.jpg
            //   https://files.sharenator.com/432323.jpg -- 700x1001
            return src.replace(/(:\/\/[^/]*\/)[^/.]+-s[0-9]+x[0-9]+-([0-9]{4,})(?:-[0-9]*)?(\.[^/.]*)$/, "$1$2$3");
        }

        if (domain === "cdn.jolie.de") {
            // http://cdn.jolie.de/297989-4137908-2/image160w/felicity-jones-oscars-2017.jpg
            //   http://cdn.jolie.de/297989-4137908-2/original/felicity-jones-oscars-2017.jpg
            return src.replace(/\/image[0-9]*[wh]\//, "/original/");
        }

        if (domain === "img.mp.itc.cn" ||
            // http://wallpapercraze.com/images/wallpapers/02_CGI_Robert_Downey_Jr_th.png
            //   http://wallpapercraze.com/images/wallpapers/02_CGI_Robert_Downey_Jr.png
            (domain_nowww === "wallpapercraze.com" && src.indexOf("/images/wallpapers/") >= 0) ||
            // http://img.mp.sohu.com/upload/20170512/af6d692d7b6b493b9c3e002db2feebd1_th.png
            //   http://img.mp.sohu.com/upload/20170512/af6d692d7b6b493b9c3e002db2feebd1.png
            domain === "img.mp.sohu.com") {
            // http://img.mp.itc.cn/upload/20170227/aa7bad178ad94c1e94428c87b6227fc7_th.jpeg
            //   http://img.mp.itc.cn/upload/20170227/aa7bad178ad94c1e94428c87b6227fc7.jpeg
            return src.replace(/_th(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "qpic.cn") {
            // http://mmbiz.qpic.cn/mmbiz_jpg/HiaNy8LPboMwzXqYuvrlHAicCbwUffgUbjY2EgQa81icMQxeKHeG5dTmhupXk7MKHibwKQAtNxEbeceH7elpaTT2fw/640?wx_fmt=jpeg&_ot=1514246400129
            // https://puui.qpic.cn/vcover_vt_pic/0/7m7cvdfbslfme4u1478827029/260
            // http://t3.qpic.cn/mblogpic/afb2a8f5fc3b14b0015e/2000
            //   http://t3.qpic.cn/mblogpic/afb2a8f5fc3b14b0015e/0 -- smaller
            // http://mmbiz.qpic.cn/mmbiz_jpg/BKb3XsZIgQaRTBiaocsuNJlzpfAqVOx8kzJRt8icY75kPjiaD42TE7F75Vf5xicn0L8YKQ2FYpFK2znwMfBSKWCAsg/640.jpeg
            //   http://mmbiz.qpic.cn/mmbiz_jpg/BKb3XsZIgQaRTBiaocsuNJlzpfAqVOx8kzJRt8icY75kPjiaD42TE7F75Vf5xicn0L8YKQ2FYpFK2znwMfBSKWCAsg/0
            if (!domain.match(/^t[0-9]*\.qpic\.cn$/))
                return src.replace(/\/[0-9]*(?:\.[^/.]*)?(?:\?.*)?$/, "/0");
        }

        if (domain === "vogue.ua") {
            // https://vogue.ua/cache/gallery_x1160_watermark/uploads/image/dc0/ab2/a48/58b3a48ab2dc0.jpeg
            //   https://vogue.ua/uploads/image/dc0/ab2/a48/58b3a48ab2dc0.jpeg
            return src.replace(/\/cache\/[^/]*\/uploads\//, "/uploads/");
        }

        if (domain === "imagesvc.timeincuk.net") {
            // https://imagesvc.timeincuk.net/v3/keystone/image?w=441&url=http://ksassets.timeincuk.net/wp/uploads/sites/46/2016/12/Felicity-Jonesw-style-file-december-2016.jpg&q=82
            return src.replace(/.*?\/keystone\/image.*?[?&]url=([^&]*).*/, "$1");
        }

        if (domain === "img.timeinc.net") {
            // http://img.timeinc.net/time/daily/2010/1003/360_afestival_0315.jpg
            //   http://img.timeinc.net/time/daily/2010/1003/afestival_0315.jpg
            // http://img.timeinc.net/time/daily/2010/1011/360_br10q_1129.jpg -- upscaled?
            //   http://img.timeinc.net/time/daily/2010/1011/br10q_1129.jpg
            return src.replace(/\/[0-9]+_([^/_]+_[0-9]+(?:_[^/]*)?\.[^/.]*)$/, "/$1");
        }

        if ((domain_nosub === "bdstatic.com" ||
             domain_nosub === "baidu.com") &&
            domain.match(/gss[0-9]*\./)) {
            if (src.indexOf("/timg?") >= 0) {
                // https://gss3.bdstatic.com/84oSdTum2Q5BphGlnYG/timg?wapp&quality=80&size=b150_150&subsize=20480&cut_x=0&cut_w=0&cut_y=0&cut_h=0&sec=1369815402&srctrace&di=c10cad3328e6895cc32131aa4cfa7d32&wh_rate=null&src=http%3A%2F%2Fimgsrc.baidu.com%2Fforum%2Fpic%2Fitem%2F90529822720e0cf3c1045a710046f21fbf09aa4c.jpg
                //   http://imgsrc.baidu.com/forum/pic/item/90529822720e0cf3c1045a710046f21fbf09aa4c.jpg
                return {
                    url: decodeURIComponent(src.replace(/.*?\/timg.*?[?&]src=([^&]*).*/, "$1")),
                    head_wrong_contenttype: true
                };
            }

            if (src.indexOf("/sign=") >= 0 ||
                src.indexOf("/pic/item/") >= 0) {
                // HEAD request gives text/html
                // https://gss1.bdstatic.com/9vo3dSag_xI4khGkpoWK1HF6hhy/baike/w%3D268%3Bg%3D0/sign=3cca8ea804087bf47dec50efcae83011/d058ccbf6c81800a388738edb73533fa838b47f6.jpg
                //   https://imgsrc.baidu.com/baike/pic/item/d058ccbf6c81800a388738edb73533fa838b47f6.jpg
                return {
                    url: src.replace(/:\/\/[^/]*\/[^/]*\//, "://imgsrc.baidu.com/"),
                    head_wrong_contenttype: true
                };
            }
        }

        if (domain === "imgsrc.baidu.com") {
            // http://imgsrc.baidu.com/forum/wh%3D200%2C90%3B/sign=a5aa97f7bb7eca80125031e5a113bbe4/f7582e381f30e924af22ade547086e061c95f734.jpg
            // http://imgsrc.baidu.com/forum/wh=200,90;/sign=a5aa97f7bb7eca80125031e5a113bbe4/f7582e381f30e924af22ade547086e061c95f734.jpg
            //   http://imgsrc.baidu.com/forum/w%3D580%3B/sign=fc7fb3a148a98226b8c12b2fbab9bb01/7af40ad162d9f2d34097153ba2ec8a136227cc5b.jpg - slightly larger
            //   http://imgsrc.baidu.com/forum/pic/item/f7582e381f30e924af22ade547086e061c95f734.jpg - orig?
            // http://imgsrc.baidu.com/forum/abpic/item/dda5e6fe9925bc31b6fe8f4b5edf8db1ca137017.jpg
            //   http://imgsrc.baidu.com/forum/pic/item/dda5e6fe9925bc31b6fe8f4b5edf8db1ca137017.jpg
            // http://imgsrc.baidu.com/forum/w%3D415/sign=e28730d85edf8db1bc2e7d653c22dddb/b164910a304e251f2b2dd5b8a786c9177e3e536c.jpg
            //   http://imgsrc.baidu.com/forum/pic/item/b164910a304e251f2b2dd5b8a786c9177e3e536c.jpg
            // https://gss1.bdstatic.com/9vo3dSag_xI4khGkpoWK1HF6hhy/baike/h%3D160/sign=750b8bdd9ceef01f52141cc3d0ff99e0/9345d688d43f879465467a97da1b0ef41ad53ac9.jpg
            //   https://gss1.bdstatic.com/9vo3dSag_xI4khGkpoWK1HF6hhy/baike/w%3D268%3Bg%3D0/sign=7f8d6ceafe246b607b0eb572d3c37d71/9345d688d43f879465467a97da1b0ef41ad53ac9.jpg
            //   https://gss1.bdstatic.com/9vo3dSag_xI4khGkpoWK1HF6hhy/baike/c0=baike933,5,5,933,330/sign=6ccfd69a7bf08202399f996d2a929088/9345d688d43f879465467a97da1b0ef41ad53ac9.jpg
            //   https://imgsrc.baidu.com/baike/c0=baike933,5,5,933,330/sign=6ccfd69a7bf08202399f996d2a929088/9345d688d43f879465467a97da1b0ef41ad53ac9.jpg
            //   http://imgsrc.baidu.com/baike/pic/item/9345d688d43f879465467a97da1b0ef41ad53ac9.jpg
            newsrc = src
                .replace("/abpic/item/", "/pic/item/")
                .replace(/\/[^/]*(?:=|%3D)[^/]*\/sign=[^/]*\//, "/pic/item/");
            return {
                url: newsrc,
                head_wrong_contenttype: true
            };
        }

        if (domain_nosub === "baidu.com" && domain.indexOf("himg.baidu.com") >= 0) {
            // http://tb.himg.baidu.com/sys/portrait/item/57cf0859
            //    http://tb.himg.baidu.com/sys/portraitn/item/57cf0859
            //    http://tb.himg.baidu.com/sys/portraitm/item/57cf0859
            //    http://tb.himg.baidu.com/sys/portraitl/item/57cf0859
            //    http://tb.himg.baidu.com/sys/original/item/57cf0859 (doesn't matter the text, can be anything other than the ones above)
            //    http://himg.baidu.com/sys/original/item/57cf4b616e6748796559656f6e0859
            return src.replace(/\/sys\/[^/]*\/item\//, "/sys/original/item/");
        }

        if (domain === "a.ksd-i.com") {
            // https://a.ksd-i.com/s/160l_86400_82d10665e8e8ca12632547568577442d/static.koreastardaily.com/2017-10-24/99264-550368.jpg
            // https://a.ksd-i.com/s/480x_86400_53c96fbf9a6baa55c9b527dcbeb4928e/static.koreastardaily.com/2017-10-24/99264-550368.jpg
            //   http://static.koreastardaily.com/2017-10-24/99264-550368.jpg
            // https://a.ksd-i.com/s/160l_86400_aaf286b862dc657320f390e272bd7cb8/static.koreastardaily.com/2017-06-26/95799-521086.jpg
            // https://a.ksd-i.com/s/480x_86400_63072b0849030d169deca9872c37d761/static.koreastardaily.com/2017-10-24/99264-550364.jpg
            return src.replace(/.*:\/\/[^/]*\/s\/[^/]*\//, "http://");
        }

        if (domain === "static.koreastardaily.com") {
            // http://static.koreastardaily.com/2017-04-13/93388-506687.jpg
            //   https://a.ksd-i.com/a/2017-04-13/93388-506687.jpg -- same (but HTTPS)
            return src.replace(/.*:\/\/[^/]*\/([0-9]+-[0-9]+-[0-9]+\/[0-9]+-[0-9]+\.[^/.]*)$/, "https://a.ksd-i.com/a/$1");
        }

        if (domain === "pic.pimg.tw") {
            // https://pic.pimg.tw/silvia17895/1518597084-877783212_n.jpg
            //   https://pic.pimg.tw/silvia17895/1518597084-877783212.jpg
            // (none, l), b, m, n, q, s, t
            return src.replace(/_[a-z](\.[^/]*)$/, "$1");
        }

        if (domain_nowww === "helloidol.com" &&
            src.indexOf("/script/get_pic.php") >= 0) {
            // http://www.helloidol.com/script/get_pic.php?src=https://1.bp.blogspot.com/-iblNAdULcFY/WnkEGyGjySI/AAAAAAAADHQ/pgVIIcLeHOo6IngbASGuakOIpxBwHr8dACLcBGAs/s1600/Eulachacha-Waikiki.jpg&h=256&w=400&zc=1
            return src.replace(/.*\/script\/get_pic\.php.*?[?&]src=([^&]*).*?$/, "$1");
        }

        if (domain === "yams.akamaized.net" &&
            src.indexOf("/Assets/") >= 0) {
            // https://yams.akamaized.net/Assets/56/610/p0082761056.jpg
            return src.replace(/\/(?:[^/._]*_)?([^/_]*)$/, "/l_$1");
        }

        if (domain_nosub === "pixpo.net" && domain.match(/img[0-9]\.pixpo\.net/)) {
            // https://img1.pixpo.net/img/da/4/0dwxci32wc/sg_0DwXCi32Wc_t324x216.jpg
            //   https://img1.pixpo.net/img/da/4/0dwxci32wc/sg_0DwXCi32Wc.jpg
            return src.replace(/_t[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "www.mirrormedia.mg" &&
            src.indexOf("/assets/images/") >= 0) {
            // https://www.mirrormedia.mg/assets/images/20170626110017-7cd692da02e985b28918adaf10d858ad-desktop.jpg
            return src.replace(/-desktop(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "kknews.cc" && domain.match(/i[0-9]*\.kknews\.cc/)) {
            // https://i1.kknews.cc/SIG=32hj89t/p6700021qr20759nn46_s.jpg
            //   https://i1.kknews.cc/SIG=32hj89t/p6700021qr20759nn46.jpg
            return src.replace(/_[a-z]*(\.[^/.]*)$/, "$1");
        }

        if (domain === "resource.holyshare.com.tw") {
            // http://resource.holyshare.com.tw/uploads/article/85x65/1443691071QSo_1.png
            // http://resource.holyshare.com.tw/uploads/article/600x0/1413181844EmZ_1.jpg
            return src.replace(/\/article\/[0-9]*x[0-9]*\//, "/article/");
        }

        if (domain_nowww === "kyeongin.com") {
            // http://www.kyeongin.com/mnt/file_m/201802/2018021501001103400052931.jpg
            return src.replace("/file_m/", "/file/");
        }

        if (domain === "www.wallpaperup.com") {
            // https://www.wallpaperup.com/uploads/wallpapers/2013/04/05/70727/793b48d70207428a317f912ac9f1342e-250.jpg
            return src.replace(/-[0-9]+(\.[^/.]*)$/, "$1");
        }

        if ((domain_nosub === "wallhere.com" ||
             domain_nosub === "pxhere.com") &&
            domain.match(/^[a-z]*\./)) {
            // https://c.wallhere.com/photos/e2/9a/women_brunette_model_Marina_Shimkovich_window_sill_jean_shorts_legs_barefoot-285016.jpg!d
            //   https://get.wallhere.com/photo/women_brunette_model_Marina_Shimkovich_window_sill_jean_shorts_legs_barefoot-285016.jpg
            // https://get.wallhere.com/photo/Asian-Sunny-Girls-Generation-SNSD-Person-Kwon-Yuri-Jessica-Jung-Im-Yoona-Choi-Sooyoung-Kim-Taeyeon-Kim-Hyoyeon-Seohyun-Tiffany-Hwang-finger-2560x1600-px-523643.jpg
            //   https://get.wallhere.com/photo/Asian-Sunny-Girls-Generation-SNSD-Person-Kwon-Yuri-Jessica-Jung-Im-Yoona-Choi-Sooyoung-Kim-Taeyeon-Kim-Hyoyeon-Seohyun-Tiffany-Hwang-finger-523643.jpg
            // https://get.wallhere.com/photo/5333x3000-px-Girls-Generation-K-pop-Korean-Lee-Soonkyu-Sunny-989174.jpg
            //   https://get.wallhere.com/photo/Girls-Generation-K-pop-Korean-Lee-Soonkyu-Sunny-989174.jpg
            // https://c.pxhere.com/photos/73/fc/women_model_sauna_beauty_girl_pretty_sexy_woman_photography-696156.jpg!s
            //   https://get.pxhere.com/photo/women_model_sauna_beauty_girl_pretty_sexy_woman_photography-696156.jpg
            // https://c.pxhere.com/images/38/fe/762e69512e53d94f4b4711f60d0e-1419055.png!s
            //   https://get.pxhere.com/photo/762e69512e53d94f4b4711f60d0e-1419055.png
            return src
                .replace(/[a-z]*\.wallhere\.com/, "get.wallhere.com")
                .replace(/[a-z]*\.pxhere\.com/, "get.pxhere.com")
                .replace(/\/(?:photos|images)\/[0-9a-f]*\/[0-9a-f]*\/([^/.]*\.[^/.!]*).*?$/, "/photo/$1")
                .replace(/\/[0-9]+x[0-9]+-px-([^/]*)$/, "/$1")
                .replace(/-[0-9]+x[0-9]+-px-([0-9]+\.[^/.]*)$/, "-$1");
        }

        if (domain === "img.grouponcdn.com") {
            // https://img.grouponcdn.com/deal/nx2giiTu5SBQbemLQteLqW/shutterstock_140728459-2-1500x900/v1/c300x182.jpg
            return src.replace(/\/v[0-9]+\/[^/]*$/, "");
        }

        if ((domain_nosub === "goodfon.com" ||
             // https://img1.goodfon.ru/original/2560x1440/8/18/devochka-povyazka-kniga-bluzka.jpg
             //   https://img1.goodfon.ru/wallpaper/original/8/18/devochka-povyazka-kniga-bluzka.jpg
             domain_nosub === "goodfon.ru" ||
             // https://img3.badfon.ru/wallpaper/big/c/b0/devushka-nagota-dlinnye-volosy.jpg
             //   https://img3.badfon.ru/wallpaper/original/c/b0/devushka-nagota-dlinnye-volosy.jpg
            domain_nosub === "badfon.ru") &&
            domain.match(/^img[0-9]*\./)) {
            // https://img4.goodfon.com/wallpaper/middle/2/86/brevno-sova-ptitsa.jpg
            //   https://img4.goodfon.com/wallpaper/original/2/86/brevno-sova-ptitsa.jpg
            // https://img2.goodfon.com/original/1280x720/0/e6/venera-ray-devushka-krasivaya.jpg
            //   https://img2.goodfon.com/wallpaper/original/0/e6/venera-ray-devushka-krasivaya.jpg
            return src.replace(/(:\/\/[^/]*\/)[^/]*\/[^/]*\//, "$1wallpaper/original/");
            //return src.replace(/\/wallpaper\/[^/]*\//, "/wallpaper/original/");
        }

        if ((domain_nosub === "yimg.jp" && domain.indexOf(".c.yimg.jp") >= 0) &&
            src.match(/:\/\/[^/]*\/im_/)) {
            // https://lpt.c.yimg.jp/im_siggiQbAsU9YOpUOxobTU3EtUg---x200-y200/amd/20180215-00205238-okinawat-000-view.jpg
            //   https://lpt.c.yimg.jp/amd/20180215-00205238-okinawat-000-view.jpg
            // https://amd.c.yimg.jp/im_siggfkAIHQmt2wB5qZ4fql1LCw---x900-y506-q90-exp3h-pril/amd/20180216-00010002-ksbv-000-1-view.jpg
            //   https://amd.c.yimg.jp/amd/20180216-00010002-ksbv-000-1-view.jpg
            // https://iwiz-news-profile.c.yimg.jp/im_sigg6aeoTpWVSD8ZSZj4Bo7mBA---x64-y64-pril-n1-exp30d/d/iwiz-news-profile/img/nb34khhuyczsy7o6f4dsott4zq.png?1477551484
            //   https://iwiz-news-profile.c.yimg.jp/d/iwiz-news-profile/img/nb34khhuyczsy7o6f4dsott4zq.png?1477551484
            //return src.replace(/(:\/\/[^/]*)\/[^/]*(\/amd\/[^/]*)$/, "$1$2");
            return src.replace(/(:\/\/[^/]*\/)im_[^/]*\//, "$1");
        }

        if ((domain_nosub === "yimg.jp" && domain.indexOf(".c.yimg.jp") >= 0) &&
            src.match(/:\/\/[^/]*\/sim\?/)) {
            // https://wing-auctions.c.yimg.jp/sim?furl=auctions.c.yimg.jp/images.auctions.yahoo.co.jp/image/dr000/auc0402/users/0/4/9/4/ane6371969-img600x425-1518659462gyve6525845.jpg&dc=1&sr.fs=20000
            //   http://auctions.c.yimg.jp/images.auctions.yahoo.co.jp/image/dr000/auc0402/users/0/4/9/4/ane6371969-img600x425-1518659462gyve6525845.jpg
            return src.replace(/.*:\/\/[^/]*\/sim.*?[?&]furl=([^&]*).*/, "http://$1");
        }

        if ((domain_nosub === "yimg.jp" && domain.indexOf(".c.yimg.jp") >= 0) &&
            src.match(/\/Images\/(?:[a-z]_)?[0-9]+(\.[^/]*)$/)) {
            // https://daily.c.yimg.jp/gossip/2015/06/16/Images/08127258.jpg
            //   https://daily.c.yimg.jp/gossip/2015/06/16/Images/f_08127258.jpg
            // f, d, g, e, b, a
            return src.replace(/\/Images\/(?:[a-z]_)?([0-9]+\.[^/.]*)$/, "/Images/f_$1");
        }

        if (domain_nosub === "yimg.jp" && domain.indexOf(".c.yimg.jp") >= 0 &&
            src.match(/:\/\/[^/]*\/yjimage\?/)) {
            // https://msp.c.yimg.jp/yjimage?q=SXErbsYXyLGSwqjcra07dAdtU7oG4sOUUXYButchAcGfrPPO0AFW2QnVBOjrLkIHN.SUOzCFDQcmuyDlnejSiBuj0wolEJkWkN379HL35K5_JOwQpplbsz0KNgGrbHRtY.dBoqXpBFPiZFOcSQ--&sig=138glqrj7&x=30&y=16
            //   https://msp.c.yimg.jp/yjimage?q=SXErbsYXyLGSwqjcra07dAdtU7oG4sOUUXYButchAcGfrPPO0AFW2QnVBOjrLkIHN.SUOzCFDQcmuyDlnejSiBuj0wolEJkWkN379HL35K5_JOwQpplbsz0KNgGrbHRtY.dBoqXpBFPiZFOcSQ--&sig=138glqrj7
            return src.replace(/^([a-z]+:\/\/[^/]*\/yjimage).*$/, "$1") + "?q=" + url.searchParams.get("q") + "&sig=" + url.searchParams.get("sig");
        }

        if (domain === "av.watch.impress.co.jp") {
            // https://av.watch.impress.co.jp/img/avw/docs/1106/827/01_s.jpg
            //   https://av.watch.impress.co.jp/img/avw/docs/1106/827/01_o.jpg
            return src.replace(/(\/[0-9]+)_s(\.[^/.]*)$/, "$1_o$2");
        }

        if (domain === "internet.watch.impress.co.jp") {
            // https://internet.watch.impress.co.jp/img/iw/docs/1106/860/01_s.jpg
            //   https://internet.watch.impress.co.jp/img/iw/docs/1106/860/01.jpg
            return src.replace(/(\/[0-9]+)_s(\.[^/.]*)$/, "$1$2");
            //return src.replace(/_s(\.[^/.]*)$/, "$1");
        }

        if (domain === "media.image.infoseek.co.jp") {
            // https://media.image.infoseek.co.jp/isnews/photos/mag2news/mag2news_350262_0-small.jpg
            // https://media.image.infoseek.co.jp/isnews/photos/gree/gree_164114_0-small.jpg
            //   https://media.image.infoseek.co.jp/isnews/photos/gree/gree_164114_0.jpg
            // https://media.image.infoseek.co.jp/isnews/photos/sirabee/sirabee_20161410960_0-small.jpg
            //   https://media.image.infoseek.co.jp/isnews/photos/sirabee/sirabee_20161410960_0.jpg
            return src.replace(/-[a-z]*(\.[^/.]*)$/, "$1");
        }

        if (domain === "s.eximg.jp") {
            // https://s.eximg.jp/exnews/feed/President/President_24421_0d46_1_s.jpg
            // https://s.eximg.jp/exnews/feed/Reuters/Reuters_newsml_KCN1G009M_1_s.jpg
            //   https://s.eximg.jp/exnews/feed/Reuters/Reuters_newsml_KCN1G009M_1.jpeg
            //
            // https://s.eximg.jp/exnews/feed/Getnews/Getnews_1869376_84b6_1_s.jpg
            //   https://s.eximg.jp/exnews/feed/Getnews/Getnews_1869376_84b6_1.jpg
            return src.replace(/(_[0-9]+)_s(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "imgc.eximg.jp") {
            // https://imgc.eximg.jp/i=https%253A%252F%252Fs.eximg.jp%252Fexnews%252Ffeed%252FShouhin%252FShouhin_93784_1.jpg,zoom=400,type=jpg
            //   https://s.eximg.jp/exnews/feed/Shouhin/Shouhin_93784_1.jpg
            return decodeURIComponent(decodeURIComponent(src.replace(/.*?\/i=([^,]*).*?$/, "$1")));
        }

        if (domain === "image.itmedia.co.jp" &&
            !src.match(/\/l_[^/]*$/) &&
            !src.match(/\/[0-9]+_[^/]*$/)) {
            // http://image.itmedia.co.jp/news/articles/1802/16/koya_AP18039560928544.jpg
            //   http://image.itmedia.co.jp/news/articles/1802/16/l_koya_AP18039560928544.jpg
            // http://image.itmedia.co.jp/news/articles/1802/16/mm_houseten_02.jpg
            //   http://image.itmedia.co.jp/news/articles/1802/16/l_mm_houseten_02.jpg
            // http://image.itmedia.co.jp/news/articles/1802/16/nu_nec0216_02.jpg
            // doesn't work:
            // http://image.itmedia.co.jp/news/articles/1802/16/240_news084.jpg
            return src.replace(/\/([^/]*)$/, "/l_$1");
        }

        if (domain_nosub === "bigcommerce.com" && domain.match(/cdn[0-9]*\.bigcommerce\.com/)) {
            // http://cdn7.bigcommerce.com/s-aeyni5y9/images/stencil/500x659/products/517/520/bear_papa_7328_2__12787.1400287249.jpg?c=2
            //   http://cdn7.bigcommerce.com/s-aeyni5y9/images/stencil/original/products/517/520/bear_papa_7328_2__12787.1400287249.jpg?c=2
            // https://cdn7.bigcommerce.com/s-c14n6tful3/images/stencil/735x374/products/136/460/checkbox-categories-filter-for-product-search-preview-734x374__10327.1518675514.jpg?c=2&imbypass=on
            //   https://cdn7.bigcommerce.com/s-c14n6tful3/images/stencil/original/products/136/460/checkbox-categories-filter-for-product-search-preview-734x374__10327.1518675514.jpg?c=2&imbypass=on -- zero length head
            return {
                url: src.replace(/\/images\/stencil\/[0-9]+x[0-9]+\//, "/images/stencil/original/"),
                head_wrong_contentlength: true
            };
        }

        if (domain_nosub === "behance.net" &&
            src.indexOf("/project_modules/") >= 0) {
            // https://mir-s3-cdn-cf.behance.net/project_modules/max_1200/9e81bc25691931.5634a6d5ee11a.png
            // https://mir-s3-cdn-cf.behance.net/project_modules/1400/9e81bc25691931.5634a6d5ee11a.png
            // https://mir-s3-cdn-cf.behance.net/project_modules/disp/9e81bc25691931.5634a6d5ee11a.png
            // https://mir-s3-cdn-cf.behance.net/project_modules/hd/9e81bc25691931.5634a6d5ee11a.png
            // https://mir-s3-cdn-cf.behance.net/project_modules/fs/9e81bc25691931.5634a6d5ee11a.png
            //
            // https://mir-s3-cdn-cf.behance.net/project_modules/1400/828dc625691931.5634a721e19dd.jpg
            // https://mir-cdn.behance.net/v1/rendition/project_modules/1400/828dc625691931.5634a721e19dd.jpg
            // https://mir-s3-cdn-cf.behance.net/project_modules/fs/828dc625691931.5634a721e19dd.jpg
            //
            // https://mir-s3-cdn-cf.behance.net/project_modules/hd/ad62c919260569.562e23ee8f6be.jpg
            // https://mir-s3-cdn-cf.behance.net/project_modules/fs/ad62c919260569.562e23ee8f6be.jpg
            //
            // doesn't work for all:
            // https://mir-s3-cdn-cf.behance.net/project_modules/max_1200/1cd9f445156279.58286c59a16f6.jpg
            //   https://mir-s3-cdn-cf.behance.net/project_modules/fs/1cd9f445156279.58286c59a16f6.jpg -- doesn't work
            // https://mir-s3-cdn-cf.behance.net/project_modules/disp/568ec59308969.560cc39b2569a.jpg
            //   https://mir-cdn.behance.net/v1/rendition/project_modules/fs/568ec59308969.560cc39b2569a.jpg -- 404
            return src.replace(/\/project_modules\/[^/]*\//, "/project_modules/fs/");
        }

        if (domain === "www.worldatlas.com") {
            // https://www.worldatlas.com/r/w728-h425-c728x425/upload/22/a1/0a/shutterstock-330445028.jpg
            //   https://www.worldatlas.com/upload/22/a1/0a/shutterstock-330445028.jpg
            return src.replace(/(:\/\/[^/]*\/)r\/[^/]*\/(upload\/)/, "$1$2");
        }

        if (domain_nosub === "thrillist.com" && domain.match(/assets[0-9]*\.thrillist\.com/)) {
            // https://assets3.thrillist.com/v1/image/2642818/size/tmg-article_default_mobile.jpg
            // https://assets3.thrillist.com/v1/image/2642818/size/tl-horizontal_main.jpg
            // https://assets3.thrillist.com/v1/image/2729043/size/tl-right_rail_short.jpg
            // https://assets3.thrillist.com/v1/image/2728632/size/gn-gift_guide_variable_c.jpg
            // https://assets3.thrillist.com/v1/image/2442399/size/tmg-article_tall.jpg
            //   https://assets3.thrillist.com/v1/image/2442399
            // http://assets3.thrillist.com/v1/image/1210040
            return src.replace(/\/size\/[^/]*$/, "");
        }

        if (domain_nowww === "vacationidea.com" &&
            src.indexOf("/pix/") >= 0) {
            // http://vacationidea.com/pix/img25Hy8R/articles/t-b4_beautiful_places_oia,_santorin_27304_mobi.jpg
            //   http://vacationidea.com/pix/img25Hy8R/articles/t-b4_beautiful_places_oia,_santorin_27304.jpg
            return src.replace(/_mobi(\.[^/.]*)$/, "$1");
        }

        if (domain === "qph.fs.quoracdn.net") {
            // https://qph.fs.quoracdn.net/main-qimg-0f9434ad2ebdb0024bab1b334ce791a9-c
            return src.replace(/-[a-z]$/, "");
        }

        if (false && domain_nosub === "fan.pw" &&
            src.indexOf("/cpg/albums/") >= 0) {
            // coppermine
            // http://actresses.fan.pw/cpg/albums/userpics/10001/thumb_001~64.jpg
            // http://actresses.fan.pw/cpg/albums/userpics/10001/normal_002~51.jpg
            //   http://actresses.fan.pw/cpg/albums/userpics/10001/002~51.jpg
            return src.replace(/\/[a-z]*_([^/]*)$/, "/$1");
        }

        if (false && domain.match(/c[0-9]*\.haibao\.cn/)) {
            // none work anymore
            // http://c3.haibao.cn/img/600_0_100_0/1258349756.6184/bigfiles/200946/1258349756.6184.jpg -- doesn't work
            // doesn't work: (any changes fail)
            // http://c3.haibao.cn/img/600_0_100_1/1443219715.4295/44ceff65db35a823fafb9572341a17e4.jpg
            // http://c2.haibao.cn/img/3620_5430_100_1/1498032292.4375/e2097b3504fdeefd6d94c0fbd8e3bcd6.jpg
            return src.replace(/\/img\/[0-9]+_[0-9]+_[0-9]+_[0-9]+\//, "/img/0_0_0_0/");
        }

        if (domain_nosub === "haibao.cn" && domain.match(/c[0-9]*\.haibao\.cn/)) {
            // http://c3.haibao.cn/pic/0_0_100_0/litQzsnR5qDSo/imagecut/0_400/piccommon/1215/12155/litQzsnR5qDSo.jpg
            //   http://c3.haibao.cn/pic/0_0_100_0/litQzsnR5qDSo/piccommon/1215/12155/litQzsnR5qDSo.jpg
            // http://c1.haibao.cn/pic/0_0_100_0/liJjsVbbnxshY/imagecut/0_400/piccommon/1218/12184/liJjsVbbnxshY.jpg
            //   http://c1.haibao.cn/pic/0_0_100_0/liJjsVbbnxshY/piccommon/1218/12184/liJjsVbbnxshY.jpg -- 404
            //   http://c3.haibao.cn/pic/0_0_100_0/liJjsVbbnxshY/piccommon/1218/12184/liJjsVbbnxshY.jpg -- works
            return {
                url: src.replace(/:\/\/[^/]*\/(.*)\/imagecut\/[0-9]+_[0-9]+\//, "://c3.haibao.cn/$1/"),
                can_head: false
            };
        }

        if (domain_nosub === "hbimg.cn" && domain.match(/cdn[0-9]*\.hbimg\.cn/)) {
            // http://cdn4.hbimg.cn/store/thumbs/130_165/piccommon/1214/12147/D52599CFADB3EFF2DCBE83AF.jpg
            //   http://cdn4.hbimg.cn/store/wm/piccommon/1214/12147/D52599CFADB3EFF2DCBE83AF.jpg
            return src.replace(/\/thumbs\/[0-9]+(?:_[0-9]+)\//, "/wm/");
        }

        if (domain === "wallpaperset.com") {
            // https://wallpaperset.com/w/small/6/7/2/314686.jpg
            return src.replace(/(:\/\/[^/]*\/w\/)[^/]*\//, "$1full/");
        }

        // disabled due to redirects
        if (domain_nosub === "wallpapermania.eu") {
            // http://www.wallpapermania.eu/download/2012-04/1037/emma-roberts-11-sexy-hd-wallpaper_1366x768.jpg
            //   http://www.wallpapermania.eu/images/data/2012-04/1037_emma-roberts-11-sexy-hd-wallpaper.jpg
            // http://static.wallpapermania.eu/images/thumbs/2012-04/1030_emma-roberts-4-sexy-hd-wallpaper.jpg
            //   http://www.wallpapermania.eu/images/data/2012-04/1030_emma-roberts-4-sexy-hd-wallpaper.jpg
            // http://www.wallpapermania.eu/wallpaper/victoria-justice-6-sexy-hd-wallpaper
            // http://www.wallpapermania.eu/images/lthumbs/2012-04/2210_victoria-justice-6-sexy-hd-wallpaper.jpg
            //   http://www.wallpapermania.eu/images/data/2012-04/2210_victoria-justice-6-sexy-hd-wallpaper.jpg
            newsrc = src
                .replace("://static.wallpapermania.eu/", "://www.wallpapermania.eu/")
                .replace(/\/images\/[a-z]?thumbs\//, "/images/data/")
                .replace(/\/download\/([^/]*)\/([0-9]*)\/([^/.]*)_[0-9]+x[0-9]+(\.[^/.]*)$/, "/images/data/$1/$2_$3$4");
            if (newsrc !== src) {
                var referer = newsrc.replace(/.*\/[0-9]+_([^/.]*)(?:_[0-9]+x[0-9]+)?\.[^/.]*$/,
                                             "http://www.wallpapermania.eu/wallpaper/$1");
                return {
                    url: newsrc,
                    headers: {
                        "Referer": referer
                    }
                };
            }
            //return newsrc;
        }

        if (domain === "img-aws.ehowcdn.com" ||
            domain === "img.aws.ehowcdn.com" ||
            domain === "img.aws.livestrongcdn.com" ||
            domain === "img-aws.livestrongcdn.com") {
            // wip
            // https://img-aws.ehowcdn.com/750x428p/photos.demandstudios.com/getty/article/165/202/96162194.jpg
            //   http://photos.demandstudios.com/getty/article/165/202/96162194.jpg
            //
            // https://img-aws.ehowcdn.com/1440x520/cme/uploadedimages.demandmedia/chocmouse.jpg
            //
            // https://img-aws.ehowcdn.com/640/cme/photography.prod.demandstudios.com/8f9cba5d-f28d-47e7-bcc7-985cc310ce6a.jpg
            // https://img-aws.ehowcdn.com/1440/cme/photography.prod.demandstudios.com/8f9cba5d-f28d-47e7-bcc7-985cc310ce6a.jpg
            // http://img.aws.ehowcdn.com/intl-300m200/ds-photo/getty/article/129/156/86543427.jpg
            // http://img.aws.ehowcdn.com/intl-1200x630/ehow/images/a04/8n/pn/sell-wholesale-pandora-jewelry-800x800.jpg
            // http://img-aws.ehowcdn.com/default/ds-photo/getty/article/190/38/153473402_XS.jpg
            // https://img-aws.ehowcdn.com/default/getty/xc/87706466.jpg?v=1&c=EWSAsset&k=2&d=910C62E22B9F47AA92D0F6B5F9282134E184698B84D1D7E2E240CBB021893A9E
            //
            // http://img.aws.livestrongcdn.com/ls-article-image-400/cme/cme_public_images/www_livestrong_com/photos.demandstudios.com/getty/article/106/30/113475809_XS.jpg
            /*newsrc = src.replace(/.*?:\/\/[^/]*\/[0-9]+x[0-9]+p\//, "http://")
            if (newsrc !== src) {
                return newsrc;
            }*/
            newsrc = src
                .replace(/(:\/\/[^/]*\/)[^/]*\//, "$1default/");
            // breaks some urls:
            // https://img-aws.ehowcdn.com/150X100/getty/xc/87613263.jpg?v=1&c=EWSAsset&k=2&d=860EC25688CC8B2E9617B166F6C00C467D8EB72EFB52D4B89BE18AFE639C03A0
            //   https://img-aws.ehowcdn.com/default/getty/xc/87613263.jpg?v=1&c=EWSAsset&k=2&d=860EC25688CC8B2E9617B166F6C00C467D8EB72EFB52D4B89BE18AFE639C03A0
            //.replace(/\?.*$/, "");
            if (newsrc !== src) {
                return newsrc;
            }

            // http://img-aws.ehowcdn.com/300x200/photos.demandstudios.com/getty/article/88/150/87682980.jpg
            // http://img.aws.livestrongcdn.com/default/cme/cme_public_images/www_livestrong_com/photos.demandstudios.com/getty/article/92/185/472711312_XS.jpg
            newsrc = src.replace(/.*?:\/\/[^/]*\/.*?\/(photos\.demandstudios\.com\/)/, "http://$1");
            if (newsrc !== src) {
                return newsrc;
            }

            // https://img-aws.ehowcdn.com/640/ehow-food-blog-us/files/2014/12/edits-2282-1024x682.jpg
            // http://food-ehow-com.blog.ehow.com/files/2014/12/edits-2282-1024x682.jpg
            //   http://food-ehow-com.blog.ehow.com/files/2014/12/edits-2282.jpg
            newsrc = src.replace(/.*?:\/\/[^/]*\/[^/]*\/ehow-([^-/.]*)-blog-([^/.]*)\//, "http://$1-ehow-com.blog.ehow.com/");
            if (newsrc !== src) {
                return newsrc;
            }

            // http://img-aws.ehowcdn.com/615x200/cpi-studiod-com/www_ehow_com/i.ehow.com/images/a07/ai/07/prevent-soggy-graham-cracker-crust-800x800.jpg
            //   http://i.ehow.com/images/a07/ai/07/prevent-soggy-graham-cracker-crust-800x800.jpg
            // https://img-aws.ehowcdn.com/default/cme/cme_public_images/www_ehow_com/i.ehow.com/images/a04/pc/d6/season-pizza-stone-800x800.jpg
            // http://img-aws.ehowcdn.com/default/cme/cme_public_images/www_ehow_com/cdn-write.demandstudios.com/upload/image/18/2F/99D61A9C-FD10-4110-9241-BAA39E072F18/99D61A9C-FD10-4110-9241-BAA39E072F18.jpg
            //   http://cdn-write.demandstudios.com/upload/image/18/2F/99D61A9C-FD10-4110-9241-BAA39E072F18/99D61A9C-FD10-4110-9241-BAA39E072F18.jpg
            // doesn't work:
            // https://img-aws.ehowcdn.com/default/s3.amazonaws.com/cme_public_images/www_demandstudios_com/sitelife.studiod.com/ver1.0/Content/images/store/5/12/45fe6090-8ca0-4f71-9cb1-14efedc73b2e.Small.jpg
            newsrc = src.replace(/.*?:\/\/[^/]*\/.*?\/www_ehow_com\/([^/.]*\.[^/]*)\//, "http://$1/");
            if (newsrc !== src) {
                return newsrc;
            }

            // https://img-aws.ehowcdn.com/default/s3.amazonaws.com/cme_public_images/www_demandstudios_com/sitelife.studiod.com/ver1.0/Content/images/store/5/12/45fe6090-8ca0-4f71-9cb1-14efedc73b2e.Small.jpg
            newsrc = src.replace(/.*?:\/\/[^/]*\/[^/]*\/s3\.amazonaws\.com\//, "https://s3.amazonaws.com/");
            if (newsrc !== src) {
                return newsrc;
            }
        }

        if (domain === "s3.amazonaws.com" &&
            src.indexOf("s3.amazonaws.com/cme_public_images/") >= 0) {
            // http://s3.amazonaws.com/cme_public_images/www_livestrong_com/photos.demandstudios.com/getty/article/142/9/78291574_XS.jpg
            newsrc = src.replace(/.*?:\/\/[^/]*\/.*?\/(photos\.demandstudios\.com\/)/, "http://$1");
            if (newsrc !== src) {
                return newsrc;
            }
        }

        if (domain === "imageproxy.themaven.net") {
            // https://imageproxy.themaven.net/http%3A%2F%2Fimg.aws.livestrongcdn.com%2Fls-1200x630%2Fcme%2Fcme_public_images%2Fwww_livestrong_com%2Fphotos.demandstudios.com%2Fgetty%2Farticle%2F178%2F99%2F79711775_XS.jpg
            // https://imageproxy.themaven.net/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fmaven-user-photos%2Fthe-maven%2Fpress%2FhAfH0nLTEU-5d4pCxu-TUA%2F2wNFvsqAbUaqAch2Ndhq9w?w=688&q=75&h=512&auto=format&fit=crop
            //   https://s3-us-west-2.amazonaws.com/maven-user-photos/the-maven/press/hAfH0nLTEU-5d4pCxu-TUA/2wNFvsqAbUaqAch2Ndhq9w
            return decodeURIComponent(src.replace(/^.*?:\/\/[^/]*\//, "").replace(/\?.*/, ""));
        }

        if ((domain_nosub === "demandstudios.com" && domain.match(/photos[0-9]*\.demandstudios\.com/)) &&
            src.indexOf("/dm-resize/") >= 0) {
            // http://photos2.demandstudios.com/dm-resize/s3.amazonaws.com%2Fcme_public_images%2Fwww_livestrong_com%2Fphotos.demandstudios.com%2Fgetty%2Farticle%2F142%2F9%2F78291574_XS.jpg?w=267&h=10000&keep_ratio=1
            return decodeURIComponent(src.replace(/.*?\/dm-resize\/([^/?]*).*/, "http://$1"));
        }

        if (domain_nosub === "demandstudios.com" && domain.match(/photos[0-9]*\.demandstudios\.com/)) {
            // http://photos.demandstudios.com/getty/article/92/121/114336181_XS.jpg
            //   http://photos.demandstudios.com/getty/article/92/121/114336181.jpg
            // http://photos.demandstudios.com/getty/article/94/77/145190904_XS.jpg
            // http://photos.demandstudios.com/getty/article/225/172/476257962_XS.jpg
            // doesn't work:
            // photos.demandstudios.com/74/208/fotolia_608243_XS.jpg
            return src.replace(/(\/[0-9]+)_XS(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "abcnews.com") {
            // https://s.abcnews.com/images/International/WireAP_118c1517b7f34b8bb7746eedfc01c12d_12x5_992.jpg
            //   https://s.abcnews.com/images/International/WireAP_118c1517b7f34b8bb7746eedfc01c12d.jpg
            // https://s.abcnews.com/images/US/chicago-pd-funeral-02-ap-jrl-180217_16x9t_240.jpg
            //   https://s.abcnews.com/images/US/chicago-pd-funeral-02-ap-jrl-180217.jpg
            // http://a.abcnews.com/images/Entertainment/GTY_sophie_turner_jef_150528_7x10_1600.jpg
            //   http://a.abcnews.com/images/Entertainment/GTY_sophie_turner_jef_150528.jpg
            return src.replace(/_[0-9]+x[0-9]+[a-z]?_[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "www.nationmultimedia.com") {
            // http://www.nationmultimedia.com/img/gallery/2017/10/14/194/9ef48d31930c4bbe00957654ab1aaf1a-vps.jpeg
            //   http://www.nationmultimedia.com/img/gallery/2017/10/14/194/9ef48d31930c4bbe00957654ab1aaf1a.jpeg
            // http://www.nationmultimedia.com/img/news/2018/02/18/30339149/b4065a2adeea2230b7d230a13eda5701-atwb.jpeg
            //   http://www.nationmultimedia.com/img/news/2018/02/18/30339149/b4065a2adeea2230b7d230a13eda5701.jpeg
            return src.replace(/-[^/.]*(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "indiatimes.com" ||
            // https://img.etimg.com/thumb/msid-63592870,width-643,imgsize-125649,resizemode-4/how-rihannas-song-became-howard-universitys-protest-anthem.jpg
            //   https://img.etimg.com/photo/63592870.cms
            domain === "img.etimg.com" ||
            // https://etimg.etb2bimg.com/thumb/msid-62837430,imgsize-,width-800,height-434,overlay-etenergyworld/canada-s-meg-energy-to-sell-pipeline-storage-assets-for-c-1-61-bln.jpg
            //   https://etimg.etb2bimg.com/photo/62837430.cms
            domain === "etimg.etb2bimg.com" ||
            domain === "static.toiimg.com") {
            // https://timesofindia.indiatimes.com/thumb/msid-62829284,width-400,resizemode-4/62829284.jpg
            //   https://timesofindia.indiatimes.com/photo/62829284.cms
            // http://photogallery.indiatimes.com/thumb/62742103.cms?width=164&height=122
            //   http://photogallery.indiatimes.com/photo/62742103.cms
            // https://economictimes.indiatimes.com/thumb/msid-62966896,width-274,height-198/how-the-rs-11k-cr-nirav-modi-scandal-will-affect-diamantaires.jpg
            //   https://economictimes.indiatimes.com/photo/62966896.cms
            // https://static.toiimg.com/thumb/imgsize-376350,msid-62972146,width-200,resizemode-4/62972146.jpg
            //   https://static.toiimg.com/photo/62972146.cms
            newsrc = src.replace(/\/(?:thumb|photo)\/[^/]*msid-([0-9]*)[,/].*$/, "/photo/$1.cms");
            if (newsrc !== src)
                return newsrc;

            newsrc = src.replace(/\/(?:thumb|photo)\/(?:[^/]*\/)?([0-9]*)\.[^/.]*$/, "/photo/$1.cms");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain === "www.jawapos.com") {
            // https://www.jawapos.com/thumbs/xs/news/2018/02/18/tips-menghadapi-kulit-kering-di-musim-hujan_m_189572.jpeg
            //   https://www.jawapos.com/thumbs/l/news/2018/02/18/tips-menghadapi-kulit-kering-di-musim-hujan_m_189572.jpeg
            //   https://www.jawapos.com/uploads/news/2018/02/18/tips-menghadapi-kulit-kering-di-musim-hujan_m_189572.jpeg
            return src.replace(/\/thumbs\/[^/]*\//, "/uploads/");
        }

        if (domain === "www.tnnthailand.com") {
            // http://www.tnnthailand.com/stocks/media/thumb_big/0656a4.jpg
            //   http://www.tnnthailand.com/stocks/media/0656a4.jpg
            return src.replace(/\/media\/[^/]*\/([^/]*)$/, "/media/$1");
        }

        if ((domain_nosub === "ibtimes.co.in" ||
             domain_nosub === "ibtimes.sg") &&
            domain.match(/data[0-9]*\.ibtimes\./)) {
            // http://data1.ibtimes.co.in/cache-img-0-450/en/full/554638/1420537417_beant-singh.jpg
            //   http://data1.ibtimes.co.in/en/full/554638/1420537417_beant-singh.jpg
            // https://data1.ibtimes.co.in/cache-img-900-0-photo/en/full/66506/-62170003800_cannes-2017-aishwarya-rai-bachchan-looks-stunning-she-walks-red-carpet.jpg
            //   https://data1.ibtimes.co.in/en/full/66506/-62170003800_cannes-2017-aishwarya-rai-bachchan-looks-stunning-she-walks-red-carpet.jpg -- doesn't work
            //   The requested URL /en/full/6/65/66506.jpg was not found on this server.
            // https://data.ibtimes.sg/en/full/16882/changi-airport.jpg?w=564&h=340&l=50&t=40
            // https://data.ibtimes.sg/en/thumb/21008/finance-minister-heng-swee-keat.jpg
            return src
                .replace(/(:\/\/[^/]*\/)cache-img-[0-9]*-[0-9]*(?:-photo)?\//, "$1")
                .replace(/\/[a-z]*(\/[0-9]+\/[^/]*)$/, "/full$1")
                .replace(/\?.*$/, "");
        }

        if (amazon_container === "astro-image-resizer") {
            // http://astro-image-resizer.s3-ap-southeast-1.amazonaws.com/17/resize/rojakdaily/media/jessica-chua/news/2018/jan/saying%20goodbye%20to%20anw%20pj%20outlet/115x76_a-w.png
            //   http://astrokentico.s3.amazonaws.com/rojakdaily/media/jessica-chua/news/2018/jan/saying%20goodbye%20to%20anw%20pj%20outlet/a-w.png?ext=.png
            //   http://astrokentico.s3.amazonaws.com/rojakdaily/media/jessica-chua/news/2018/jan/saying%20goodbye%20to%20anw%20pj%20outlet/a-w.png
            // http://s3-ap-southeast-1.amazonaws.com/astro-image-resizer/17/resize/rojakdaily/media/jessica-chua/news/2018/jan/saying%20goodbye%20to%20anw%20pj%20outlet/115x76_a-w.png
            //   http://astrokentico.s3.amazonaws.com/rojakdaily/media/jessica-chua/news/2018/jan/saying%20goodbye%20to%20anw%20pj%20outlet/a-w.png
            return src
                .replace(/astro-image-resizer\.([^.]*\.)?amazonaws\.com/, "astrokentico.s3.amazonaws.com")
                .replace(/(:\/\/s3[^/.]*\.amazonaws\.com\/)astro-image-resizer\//, "://astrokentico.s3.amazonaws.com/")
                .replace(/(:\/\/[^/]*)\/[0-9]*\/resize\//, "$1/")
                .replace(/\/[0-9]+x[0-9]+_/, "/");
        }

        if ((amazon_container && amazon_container.indexOf("nxs-wkrgtv-media") >= 0) ||
            // http://pic1.win4000.com/pic/f/bd/9db51148625_130_170.jpg
            //   http://pic1.win4000.com/pic/f/bd/9db51148625.jpg
            (domain_nosub === "win4000.com" && domain.match(/^pic[0-9]*\.win4000\.com/)) ||
            // https://media.fox29.com/media.fox29.com/photo/2018/07/09/GETTY_thai_cave_rescue_ambulance_070918%20_OP_2_CP__1531142830871.jpg_5770639_ver1.0_640_360.jpg
            //   https://media.fox29.com/media.fox29.com/photo/2018/07/09/GETTY_thai_cave_rescue_ambulance_070918%20_OP_2_CP__1531142830871.jpg_5770639_ver1.0.jpg
            domain === "media.fox29.com" ||
            // https://mediaassets.wxyz.com/photo/2018/05/22/poster_22074aded9dd4214ae42eb62a4404769_87749608_ver1.0_320_240.jpg
            //   https://mediaassets.wxyz.com/photo/2018/05/22/poster_22074aded9dd4214ae42eb62a4404769_87749608_ver1.0.jpg
            domain === "mediaassets.wxyz.com") {
            // http://s3.amazonaws.com/nxs-wkrgtv-media-us-east-1/photo/2018/02/17/Bail_Bonds_0_34542427_ver1.0_320_180.jpg
            //   http://s3.amazonaws.com/nxs-wkrgtv-media-us-east-1/photo/2018/02/17/Bail_Bonds_0_34542427_ver1.0.jpg
            return src.replace(/_[0-9]+_[0-9]+(\.[^/.]*)$/, "$1");
        }

        if ((domain === "image.photohito.k-img.com" ||
             domain === "photohito.k-img.com") &&
            src.indexOf("/uploads/") >= 0) {
            // http://image.photohito.k-img.com/uploads/photo33/user32067/a/7/a77a9f46cca054d6d488ab039382d140/a77a9f46cca054d6d488ab039382d140_s.jpg
            //   http://image.photohito.k-img.com/uploads/photo33/user32067/a/7/a77a9f46cca054d6d488ab039382d140/a77a9f46cca054d6d488ab039382d140_o.jpg
            // http://photohito.k-img.com/uploads/photo82/user81866/5/4/54cc586ea0191c8ad108c74bfff0a09d/54cc586ea0191c8ad108c74bfff0a09d_l.jpg
            //   http://photohito.k-img.com/uploads/photo82/user81866/5/4/54cc586ea0191c8ad108c74bfff0a09d/54cc586ea0191c8ad108c74bfff0a09d_o.jpg -- 4000x6016
            // o, l, s
            return src.replace(/_[a-z]*(\.[^/]*)/, "_o$1");
        }

        if (domain === "eiga.k-img.com") {
            // https://eiga.k-img.com/images/person/83193/300x.jpg
            //   https://eiga.k-img.com/images/person/83193/original.jpg
            // https://eiga.k-img.com/images/buzz/67970/b4763ecf68d81f0e/160.jpg?1505989880
            //   https://eiga.k-img.com/images/buzz/67970/b4763ecf68d81f0e.jpg?1505989880
            // https://eiga.k-img.com/images/movie/87956/photo/2a98637bcfd5c2c2/640.jpg?1531358070
            //   https://eiga.k-img.com/images/movie/87956/photo/2a98637bcfd5c2c2.jpg?1531358070
            return src
                .replace(/(\/images\/[a-z]+\/[0-9]+\/)[0-9]+x(?:[0-9]+)?(\.[^/.]*)$/, "$1original$2")
                .replace(/(\/images\/[a-z]+\/[0-9]+\/(?:[a-z]+\/)?[0-9a-f]+)\/[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "image.yes24.com") {
            // http://image.yes24.com/goods/24213246/S
            // http://image.yes24.com/goods/24213246
            //   http://image.yes24.com/goods/24213246/L
            // http://image.yes24.com/dms/201802/%EC%8A%A4%EC%B9%B4%EC%9D%B4-%EA%B3%A0%EC%A0%95%EC%9A%B1.jpg
            return src.replace(/(:\/\/[^/]*\/goods\/[0-9]+)(?:\/.*)?$/, "$1/L");
        }

        if (domain === "img.danawa.com" ||
            // http://wallpoper.com/images/00/26/57/27/taylor-momsen_00265727_thumb.jpg
            //   http://wallpoper.com/images/00/26/57/27/taylor-momsen_00265727.jpg
            domain === "wallpoper.com" ||
            // https://cdn.maximsfinest.com/930d55d5bae81ab5ab5c4bca2a2eab8b42e503f85bbd48086c9a9c89945f12e7_thumb.jpg
            domain === "cdn.maximsfinest.com" ||
            // https://www.phileweb.com/news/photo/d-av/437/43780/2_thumb.jpg
            //   https://www.phileweb.com/news/photo/d-av/437/43780/2.jpg
            domain === "www.phileweb.com" ||
            // https://imgpic.org/upload/images/e91e1c3d-938d-f6b0-ab71-593bcbf52253_thumb.jpg
            //   https://imgpic.org/upload/images/e91e1c3d-938d-f6b0-ab71-593bcbf52253.jpg
            (domain_nowww === "imgpic.org" && src.indexOf("/upload/images/") >= 0) ||
            // http://img10.imgdino.com/images/21620746826144988852_thumb.jpg
            //   http://img10.imgdino.com/images/21620746826144988852.jpg
            (domain_nosub === "imgdino.com" && domain.match(/img[0-9]*\.imgdino\.com/) && src.indexOf("/images/") >= 0) ||
            // https://storage.cobak.co/uploads/1524570414485762_2d28e314d0_thumb.jpg
            (domain === "storage.cobak.co" && src.indexOf("/uploads/") >= 0) ||
            // https://mycotopia.net/uploads/monthly_11_2016/post-147969-0-17237500-1479361240_thumb.jpg
            (domain_nowww === "mycotopia.net" && src.indexOf("/uploads/") >= 0) ||
            // http://static.becomegorgeous.com/img/arts/2011/Apr/28/4386/pixielotthairstyles_thumb.jpg
            (domain === "static.becomegorgeous.com" && src.indexOf("/img/") >= 0) ||
            // http://i.imagepow.com/2-68/barbara-palvin-10_thumb.jpg
            domain === "i.imagepow.com" ||
            // https://www.bellazon.com/main/uploads/monthly_01_2015/post-40923-0-58758100-1422215257_thumb.jpg
            domain_nowww === "bellazon.com") {
            // http://img.danawa.com/cms/img/2010/11/19/%C7%D6%C6%D1_thumb.png
            return src.replace(/_thumb(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "pcgames.com.cn" && domain.match(/^img[0-9]*\./)) {
            // http://img.pcgames.com.cn/images/upload/upc/tx/gamephotolib/1510/29/c3/14626065_1446106131090_small.jpg
            //   http://img.pcgames.com.cn/images/upload/upc/tx/gamephotolib/1510/29/c3/14626065_1446106131090.jpg
            // http://img0.pcgames.com.cn/pcgames/1412/19/4672783_11386975_980x1200_0_thumb.jpg
            //   http://img0.pcgames.com.cn/pcgames/1412/19/4672783_11386975_980x1200_0.jpg
            //   http://img0-arch.pconline.com.cn/pcgames/1412/19/4672783_11386975.jpg -- doesn't work
            //   http://img0-arch.pconline.com.cn/pcgames/1412/19/4672783_11386975_0.jpg -- doesn't work
            return src.replace(/_(?:thumb|small|medium)(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "mosaicon.hu" && src.indexOf("/wallpapers/") >= 0) {
            // http://mosaicon.hu/wallpapers/sztarok/fullhd-hatterkep-368046462-rihanna_thumb.jpg
            //   http://mosaicon.hu/wallpapers/sztarok/fullhd-hatterkep-368046462-rihanna_largethumb.jpg
            //   http://mosaicon.hu/wallpapers/sztarok/fullhd-hatterkep-368046462-rihanna.jpg
            return src.replace(/_(?:large)?thumb(\.[^/.]*)$/, "$1");
        }

        if (domain === "item.ssgcdn.com") {
            // http://item.ssgcdn.com/58/31/79/item/1000023793158_i1_1000.jpg
            //   http://item.ssgcdn.com/58/31/79/item/1000023793158_i1.jpg
            return src.replace(/(\/item\/[^/]*)_[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "coupangcdn.com" && domain.match(/thumbnail[0-9]*\.coupangcdn\.com/)) {
            // https://thumbnail3.coupangcdn.com/thumbnails/remote/48x48ex/image/product/image/vendoritem/2016/11/02/3054079121/95e6ce14-cd6e-43ef-89af-6f50046c19e8.jpg
            //   https://image3.coupangcdn.com/image/product/image/vendoritem/2016/11/02/3054079121/95e6ce14-cd6e-43ef-89af-6f50046c19e8.jpg
            return src
                .replace(/thumbnail([0-9]*\.coupangcdn\.com)/, "image$1")
                .replace(/\/thumbnails\/remote\/[^/]*\//, "/");
        }

        if (domain === "image.notepet.co.kr") {
            // http://image.notepet.co.kr/resize/540x-/seimage/20160127%2F201601271000_61120010294826_1.jpg
            return src.replace(/\/resize\/[^/]*\//, "/");
        }

        if (domain_nowww === "koreamg.com" ||
            domain_nowww === "yufit.co.kr" ||
            domain_nowww === "fncstore.com") {
            // http://koreamg.com/web/product/big/201511/1198_shop1_844046.jpg
            // http://yufit.co.kr/web/product/medium/201802/1402_shop1_771117.jpg
            // http://fncstore.com/web/product/small/201805/624_shop1_15268628600267.jpg
            return src.replace(/\/web\/product\/(?:small|medium)\//, "/web/product/big/");
        }

        if (domain_nosub === "mynavi.jp") {
            // https://news.mynavi.jp/article/20160717-a030/images/004.jpg
            //   https://news.mynavi.jp/article/20160717-a030/images/004l.jpg
            // https://news.mynavi.jp/article/20180219-586202/index_images/index.jpg/iapp
            //   https://news.mynavi.jp/article/20180219-586202/index_images/index.jpg
            //   https://news.mynavi.jp/article/20180219-586202/images/001l.jpg
            return src
                .replace(/\/index_images\/[^/]*(?:\/[^/]*)?$/, "/images/001l.jpg")
                .replace(/\/images\/([0-9]+)(\.[^/.]*)$/, "/images/$1l$2");
        }

        if (domain === "cdn.deview.co.jp") {
            // https://cdn.deview.co.jp/imgs/news_image.img.php?am_file=757f7eac8208248ef689a9c8f195cc0a.jpg&am_width=10&am_height=10
            // https://cdn.deview.co.jp/imgs/news_image.img.php?am_file=8a0abbef91348f3b44e2225c761fe8e8.jpg&am_width=0&am_height=0
            //   https://cdn.deview.co.jp/imgs/news/8/a/0/8a0abbef91348f3b44e2225c761fe8e8.jpg
            //return src.replace(/\/imgs\/news_image\.img\.php.*?(am_file=[^&]*).*/, "/imgs/news_image.img.php?$1&am_width=0&am_height=0");
            return src.replace(/\/imgs\/news_image\.img\.php.*?am_file=([^&])([^&])([^&])([^&]*).*/, "/imgs/news/$1/$2/$3/$1$2$3$4");
        }

        if (domain === "imgcache.dealmoon.com") {
            // http://imgcache.dealmoon.com/fsvr.dealmoon.com/dealmoon/082/3a3/a3a/e33/eed/93a/ffd/aae/d10/29e/37.jpg_600_0_15_363b.jpg
            //   http://fsvr.dealmoon.com/dealmoon/082/3a3/a3a/e33/eed/93a/ffd/aae/d10/29e/37.jpg
            return src.replace(/.*?:\/\/[^/]*\/(.*?)(\.[^/._]*)_[^/]*?$/, "http://$1$2");
        }

        // magento
        if (domain === "www.usmall.us" ||
            // http://www.sofiehouse.co/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/E/l/Elegant-Sweetheart-Long-Gold-Sequined-Taylor-Swift-Red-Carpet-Celebrity-Dress_2.jpg
            //   http://www.sofiehouse.co/media/catalog/product/E/l/Elegant-Sweetheart-Long-Gold-Sequined-Taylor-Swift-Red-Carpet-Celebrity-Dress_2.jpg
            domain === "www.sofiehouse.co" ||
            // https://www.thecelebritydresses.com/media/catalog/product/cache/1/small_image/295x/040ec09b1e35df139433887a97daa66f/t/a/taylor_swift_red_lace_party_dress_iheartradio_music_festival_2012_dresses_5.jpg
            //   https://www.thecelebritydresses.com/media/catalog/product/cache/1/image/650x/040ec09b1e35df139433887a97daa66f/t/a/taylor_swift_red_lace_party_dress_iheartradio_music_festival_2012_dresses_5.jpg
            //   https://www.thecelebritydresses.com/media/catalog/product/t/a/taylor_swift_red_lace_party_dress_iheartradio_music_festival_2012_dresses_5.jpg
            domain === "www.thecelebritydresses.com" ||
            // https://www.celebredcarpetdresses.com/media/catalog/product/cache/8/image/9df78eab33525d08d6e5fb8d27136e95/t/a/taylor-swift-at-the-2012-billboard-music-awards-2.jpg
            //   https://www.celebredcarpetdresses.com/media/catalog/product/t/a/taylor-swift-at-the-2012-billboard-music-awards-2.jpg
            domain === "www.celebredcarpetdresses.com" ||
            // https://www.minimal.co.id/media/catalog/product/cache/1/small_image/252x/7b8fef0172c2eb72dd8fd366c999954c/1/3/136_02_02dsc00253ed.jpg
            //   https://www.minimal.co.id/media/catalog/product/1/3/136_02_02dsc00253ed.jpg
            domain === "www.minimal.co.id" ||
            // http://www.bridesmaidca.ca/media/catalog/product/cache/1/thumbnail/56x90/9df78eab33525d08d6e5fb8d27136e95/B/D/BD2305-1832-01/BD2305CA1832-Mermaid-Trumpet-Blue-Stretch-Satin-V-Neck-Floor-Length-Bridesmaid-Dresses-11.jpg
            //   http://www.bridesmaidca.ca/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/B/D/BD2305-1832-01/BD2305CA1832-Mermaid-Trumpet-Blue-Stretch-Satin-V-Neck-Floor-Length-Bridesmaid-Dresses-31.jpg
            // http://www.bridesmaidca.ca/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/B/D/BD1749-03/Short-Lace-and-Tulle-Black-Bridesmaid-Dress-BD-CA1749-33.jpg
            // http://www.bridesmaidca.ca/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/B/D/BD1749-02/Short-Lace-and-Tulle-Black-Bridesmaid-Dress-BD-CA1749-32.jpg
            domain === "www.bridesmaidca.ca" || // doesn't work
            // http://www.sisley-paris.com/ko-KR/media/catalog/product/cache/3/sisley_hd_image/450x/9df78eab33525d08d6e5fb8d27136e95/sisley_hd_image/3473311704000.jpg
            //   http://www.sisley-paris.com/ko-KR/media/catalog/product/cache/3/sisley_hd_image/9df78eab33525d08d6e5fb8d27136e95/sisley_hd_image/3473311704000.jpg
            //   http://www.sisley-paris.com/ko-KR/media/catalog/product/sisley_hd_image/3473311704000.jpg
            domain === "www.sisley-paris.com" ||
            // https://d2ovdo5ynwfl3w.cloudfront.net/media/catalog/product/cache/5/image/03deeb199a85666540b12534551b8531/0/0/001CH-003-03172-1_1_1-DS.jpg
            domain === "d2ovdo5ynwfl3w.cloudfront.net" ||
            // https://d1cizyvjjqnss7.cloudfront.net/media/catalog/product/cache/1/image/700x700/af097278c5db4767b0fe9bb92fe21690/2/0/2017-9-26-isabelle-31991_2_2.jpg
            domain === "d1cizyvjjqnss7.cloudfront.net" ||
            // https://executiveponies.com/media/catalog/product/cache/2/thumbnail/90x144/9df78eab33525d08d6e5fb8d27136e95/3/2/327a6104_copy.jpg
            domain === "executiveponies.com" ||
            domain === "www.lizandliz.com" ||
            src.match(/(?:\/media)?\/catalog\/product\/cache\/(?:[0-9]*\/[^/]*\/)?(?:[0-9]+x(?:[0-9]+)?\/)?[0-9a-f]{32}\//)) {
            // https://www.sonassi.com/blog/knowledge-base/deconstructing-the-cache-image-path-on-magento
            //
            // http://www.usmall.us/media/catalog/product/cache/16/image/600x600/d58d44b981214661663244ef00ea7e30/1/7/17_9__2.jpg
            //   http://www.usmall.us/media/catalog/product/cache/16/image/d58d44b981214661663244ef00ea7e30/1/7/17_9__2.jpg
            // https://www.lizandliz.com/media/catalog/product/cache/4/thumbnail/492x705/9df78eab33525d08d6e5fb8d27136e95/t/a/taylor-swift-red-dress-cma-awards-2013-02.jpg
            //   https://www.lizandliz.com/media/catalog/product/cache/4/thumbnail/9df78eab33525d08d6e5fb8d27136e95/t/a/taylor-swift-red-dress-cma-awards-2013-02.jpg
            //   https://www.lizandliz.com/media/catalog/product/t/a/taylor-swift-red-dress-cma-awards-2013-02.jpg
            // https://www.lizandliz.com/media/catalog/product/cache/4/image/492x705/9df78eab33525d08d6e5fb8d27136e95/t/a/taylor-swift-red-dress-cma-awards-2013-01.jpg
            //   https://www.lizandliz.com/media/catalog/product/cache/4/image/9df78eab33525d08d6e5fb8d27136e95/t/a/taylor-swift-red-dress-cma-awards-2013-01.jpg
            //   https://www.lizandliz.com/media/catalog/product/t/a/taylor-swift-red-dress-cma-awards-2013-01.jpg
            // https://www.naturehills.com/media/catalog/product/cache/5643cdae475c4be953fc8c21f6960dc2/f/o/forsythia-fiesta-medium-shrub-425x425.jpg
            //   https://www.naturehills.com/media/catalog/product/f/o/forsythia-fiesta-medium-shrub-425x425.jpg
            /*return src
                .replace(/(\/cache\/[0-9]*\/)small_image\//, "$1/image/")
                .replace(/\/(thumbnail|image)\/[0-9]+x[0-9]+\//, "/$1/");*/
            return src.replace(/\/cache\/(?:[0-9]*\/[^/]*\/)?(?:[0-9]+x(?:[0-9]+)?\/)?[0-9a-f]{32}\/((?:.\/.\/)|(?:[^/]*\/))([^/]*)$/, "/$1$2");
            //return src.replace(/\/image\/[0-9]+x[0-9]+\//, "/image/");
        }

        if (domain === "cdn.okdress.co.nz" ||
            // https://www.promshopau.com/media/catalog/product/cache/1/small_image/400x600/va/cymz2697/5wxh3src.jpg?1496649473
            // forbidden
            (domain_nowww === "promshopau.com" && false)) {
            // https://cdn.okdress.co.nz/media/catalog/product/cache/1/small_image/400x600/va/crqx3207/yhhv4ee5.jpg?1497240049
            //   https://cdn.okdress.co.nz/media/catalog/product/va/crqx3207/yhhv4ee5.jpg?1497240049
            return src.replace(/(\/media\/catalog\/product\/)cache\/[0-9]*\/[^/]*\/[0-9]+x[0-9]+\//, "$1");
        }

        if (domain === "img.nextmag.com.tw") {
            // http://img.nextmag.com.tw//campaign/28/640x_dc09fc97b8f881555c21e8df08f39d01.jpg
            return src.replace(/\/[0-9]+x(?:[0-9]+)?_([^/]*)$/, "/$1");
        }

        if (domain_nosub === "meitudata.com") {
            // http://mvimg10.meitudata.com/568fd904846585397.jpg!thumb320
            return src.replace(/![^/]*$/, "");
        }

        if (domain === "www.shogakukan.co.jp") {
            // https://www.shogakukan.co.jp/thumbnail/books/09682221
            //   https://www.shogakukan.co.jp/thumbnail/snsbooks/09682221
            return src.replace(/\/thumbnail\/books\//, "/thumbnail/snsbooks/");
        }

        if (domain === "images.sysapi.mtg.now.com") {
            // https://images.sysapi.mtg.now.com/mposter/album/m/VASB00139622A_m.jpg
            //   https://images.sysapi.mtg.now.com/mposter/album/o/VASB00139622A_o.jpg
            return src.replace(/\/[a-z]\/([^/]*)_[a-z](\.[^/.]*)$/, "/o/$1_o$2");
        }

        if (domain_nosub === "lst.fm" && domain.match(/img[0-9]*[^.]*\.lst\.fm/)) {
            // http://img2-ak.lst.fm/i/u/174s/ac79a7aa21de5694760ad9228e15c6a5.png
            //   http://img2-ak.lst.fm/i/u/ac79a7aa21de5694760ad9228e15c6a5.png
            return src.replace(/(\/i\/[a-z]\/)[0-9]+s\//, "$1");
        }

        if (domain === "www.hdwallpapers.in" ||
            domain === "freshwallpapers.in" ||
            domain === "www.freshwallpapers.in") {
            // https://www.hdwallpapers.in/download/selena_gomez_2018_4k_8k-1440x2560.jpg
            // https://www.hdwallpapers.in/thumbs/2018/selena_gomez_2018_4k_8k-t2.jpg
            //   https://www.hdwallpapers.in/walls/selena_gomez_2018_4k_8k-wide.jpg
            // http://freshwallpapers.in/thumbs/sonam_kapoor_sexy_wallpaper-t1.jpg
            //   http://freshwallpapers.in/walls/sonam_kapoor_sexy_wallpaper-wide.jpg
            return src
                .replace(/\/(?:download|thumbs)\//, "/walls/")
                .replace(/-[^-_/.]*(\.[^/.]*)$/, "-wide$1");
        }

        if (false && (domain.indexOf("images.deezer.com") >= 0 ||
                      domain.indexOf("images.dzcdn.net") >= 0)) {
            // not reliable, can upscale
            // http://e-cdn-images.deezer.com/images/artist/7d026f08b34a098e270a663839d8ae8e/200x200-000000-80-0-0.jpg
            //   http://e-cdn-images.deezer.com/images/artist/7d026f08b34a098e270a663839d8ae8e/99999999999x99999999999-000000-100-0-0.jpg -- 1200x1200, unscaled
            //   http://e-cdn-images.deezer.com/images/artist/7d026f08b34a098e270a663839d8ae8e/99999999999x0-000000-100-0-0.jpg -- 800x1200, unscaled, more height, less detail
            // https://e-cdns-images.dzcdn.net/images/artist/aca61b38901f884503e9cb0fbf0b93b4/200x200-000000-80-0-0.jpg
            //   https://e-cdns-images.dzcdn.net/images/artist/aca61b38901f884503e9cb0fbf0b93b4/99999999999x0-000000-100-0-0.jpg -- 801x1200, definitely scaled
            // http://e-cdn-images.deezer.com/images/artist/076659ecd6d7dc5042df677a6a24ea9a/500x500.jpg
            return src.replace(/\/[0-9]+x[0-9]+-[0-9]+-[0-9]+-[0-9]+-[0-9]+(\.[^/.]*)$/, "/99999999999x0-000000-100-0-0$1");
        }

        if (domain === "cdn.wallpaper.com") {
            // https://cdn.wallpaper.com/main/styles/wp_medium_grid/s3/2018/02/astonmartindb11volantefrontsideview.jpg
            //   https://cdn.wallpaper.com/main/astonmartindb11volantefrontsideview.jpg
            // https://cdn.wallpaper.com/main/styles/wp_large/s3/2018/02/go_gardenofrussolo.jpg
            //   https://cdn.wallpaper.com/main/go_gardenofrussolo.jpg
            // https://cdn.wallpaper.com/main/styles/responsive_920w_scale/s3/baldacchino-by-stanton-williams-c-saverio-lombardi-vallauri_006_0.jpg
            //   https://cdn.wallpaper.com/main/baldacchino-by-stanton-williams-c-saverio-lombardi-vallauri_006_0.jpg
            // https://cdn.wallpaper.com/main/styles/wp_large/s3/l-kosmosbywonderglass_photoleonardoduggento02.jpg
            //   https://cdn.wallpaper.com/main/kosmosbywonderglass_photoleonardoduggento02.jpg
            // https://cdn.wallpaper.com/main/styles/wp_medium_grid/s3/2018/04/hermessalonedelmobile2018.jpg
            //   https://cdn.wallpaper.com/main/2018/04/hermessalonedelmobile2018.jpg
            //   https://cdn.wallpaper.com/main/hermessalonedelmobile2018.jpg -- doesn't work
            regex = /\/main\/styles\/[^/]*\/[^/]*\/(.*\/)?(?:l-)?([^/]*)/;
            return [src.replace(regex, "/main/$2"), src.replace(regex, "/main/$1$2")];
            //return src.replace(/\/styles\/[^/]*\/s[0-9]*\/[0-9]+\/[0-9]+\/([^/]*)$/, "/$1");
        }

        if (domain === "cdn.wallpaper.com") {
            // https://cdn.wallpaper.com/main/styles/responsive_920w_scale/s3/baldacchino-by-stanton-williams-c-saverio-lombardi-vallauri_006_0.jpg
            return src.replace(/\/main\/styles\/[^/]*\/[^/]*\//, "/");
        }

        if (domain === "static.warthunder.com") {
            // https://static.warthunder.com/upload/image/wallpapers/_thumbs/280x/magach_3_1920x1080_logo_com_73e9f4582d0d841a6abf1f2c75beaf4d.jpg
            //   https://static.warthunder.com/upload/image/wallpapers/magach_3_1920x1080_logo_com_73e9f4582d0d841a6abf1f2c75beaf4d.jpg
            return src.replace(/\/_thumbs\/[0-9]+x(?:[0-9]+)?\//, "/");
        }

        if (domain === "cdn.wallpaperdirect.com") {
            // https://cdn.wallpaperdirect.com/shared-assets/images/products/094269_163x163_thumb.jpg
            //   https://cdn.wallpaperdirect.com/shared-assets/images/products/094269orig.jpg
            return src.replace(/(\/[0-9]*)_[^/.]*(\.[^/.]*)$/, "$1orig$2");
        }

        if (domain_nosub === "bamcontent.com") {
            // https://nhl.bamcontent.com/images/photos/291203200/2568x1444/cut.jpg
            //   https://nhl.bamcontent.com/images/photos/291203200/raw.jpg
            return src.replace(/(\/images\/photos\/[0-9]*\/)[0-9]+x[0-9]+\/[^/.]*(\.[^/.]*)$/, "$1raw$2");
        }

        if (domain_nosub === "mail.ru" &&
            domain.match(/filed.*\.mail\.ru$/) &&
            src.match(/:\/\/[^/]*\/pic/)) {
            // https://filed17-26.my.mail.ru/pic?url=https%3A%2F%2Fcontent-17.foto.my.mail.ru%2Fmail%2Faudioknigi.online%2F_musicplaylistcover%2Fi-760.jpg&sigt=a2f820fc2604a1526688be9b380e7e24&ts=1519171200&mw=156&mh=156&croped=1
            //   https://content-17.foto.my.mail.ru/mail/audioknigi.online/_musicplaylistcover/i-760.jpg
            // https://filed17-26.my.mail.ru/pic?url=https%3A%2F%2Fcontent-25.foto.my.mail.ru%2Fdraw%2Fmusic%2Fplaylist%2F4649700154%2Ftracks%2Fcover%3F1505444126&mw=&mh=&sig=7f6083a07f204187e8d76ecde06923a9
            //   https://content-25.foto.my.mail.ru/draw/music/playlist/4649700154/tracks/cover?1505444126
            return decodeURIComponent(src.replace(/.*\/pic.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        if (domain === "mg.soupingguo.com") {
            // http://mg.soupingguo.com/attchment2/AppImg/110x73/2016/01/26/c2d275d9-ffc4-4ca3-86d0-70f717f789dc.jpg
            //   http://mg.soupingguo.com/attchment2/AppImg/0x0/2016/01/26/c2d275d9-ffc4-4ca3-86d0-70f717f789dc.jpg
            return src.replace(/(\/attchment[^/]*\/[^/]*Img\/)[0-9]+x[0-9]+\//, "$10x0/");
        }

        if (domain === "img.yaplog.jp") {
            // http://img.yaplog.jp/img/17/mo/y/a/m/yamu98/24/24094.jpg
            //   http://img.yaplog.jp/img/17/pc/y/a/m/yamu98/24/24094.jpg
            return src.replace(/(\/img\/[^/]*\/)mo\//, "$1pc/");
        }

        if (domain === "www.hochi.co.jp") {
            // http://www.hochi.co.jp/photo/20180220/20180220-OHT1I50164-L.jpg
            // L, T, N
            return src.replace(/-[A-Z](\.[^/.]*)$/, "-L$1");
        }

        if (domain_nosub === "wikispaces.com") {
            // https://sweetteaandscience.wikispaces.com/file/view/111.jpg/539497268/460x315/111.jpg
            //   https://sweetteaandscience.wikispaces.com/file/view/111.jpg
            return src.replace(/(\/view\/[^/]*\.[^/]*)\/.*?$/, "$1");
        }

        if (false && domain === "cdn.mdpr.jp") {
            // wip
            // https://cdn.mdpr.jp/photo/images/9b/c4b/244c1e_129677c70cb47761dc2243224aee09db43068c042b172144.jpg
            // aligned:
            //   https://cdn.mdpr.jp/photo/images/9b/c4b/244c1e_  129677c70cb47761dc2243224aee09db43068c042b172144.jpg
            //   https://cdn.mdpr.jp/photo/images/9b/c4b/w700c-ez_129677c70cb47761dc22432245d7f66fdae68c042b172144.jpg
            // https://mdpr.jp/photo/images/2016/02/21/e_1997280.jpg
            //   https://mdpr.jp/photo/images/2016/02/21/1997280.jpg
            // https://mdpr.jp/photo/detail/3179461
            //   https://cdn.mdpr.jp/photo/images/73/014/w700c-ez_923f6fd535f050dd50a0c1844e00845cfda81f02f814a731.jpg
            // https://mdpr.jp/news/detail/1319088
            //   https://mdpr.jp/photo/images/2014/01/17/600c-_1181978.jpg
            //   https://mdpr.jp/photo/images/2014/01/17/e_1181978.jpg
            //   https://cdn.mdpr.jp/photo/images/de/f96/w700c-ez_5f31b9207ce33a447ceff0069f5057adc853bf29a07018d6.jpg
            // https://cdn.mdpr.jp/photo/images/ff/357/w720c-e_86733135a9e323a66d900f9f12614d8db65c8521f7b16fdc.jpg
            // http://mdpr.jp/news/detail/1672412
            //   https://cdn.mdpr.jp/photo/images/cb/aba/0_3c3602ff62198c52f8e11a287cfbf2542e7a8470e1cfdbc2.jpg
            //  https://mdpr.jp/photo/detail/2714005
            //   https://cdn.mdpr.jp/photo/images/4d/9be/0_eb892aca2b6f152631f04dbe0b7ec6d67bad6240e6373cd5.jpg
            //   https://cdn.mdpr.jp/photo/images/4d/9be/0_eb892aca2b6f152631f04dbe05759594bb7ec6d6e6373cd5.jpg - broken
            //   https://cdn.mdpr.jp/photo/images/4d/9be/w700c-ez_eb892aca2b6f152631f04dbe05759594bb7ec6d6e6373cd5.jpg
            //   https://cdn.mdpr.jp/photo/images/4d/9be/eb892aca2b6f152631f04dbe0b7ec6d67bad6240e6373cd5.jpg
        }

        if (domain === "www.sponichi.co.jp") {
            // http://www.sponichi.co.jp/entertainment/news/2017/12/12/jpeg/20171211s00041000381000p_thum.jpg
            //   http://www.sponichi.co.jp/entertainment/news/2017/12/12/jpeg/20171211s00041000381000p_view.jpg
            return src.replace(/_thum(\.[^/.]*)$/, "_view$1");
        }

        if (domain === "thumbnail.image.rakuten.co.jp") {
            // source:
            // https://books.rakuten.co.jp/rb/12499383/?scid=af_pc_etc&sc2id=af_111_1_10000673
            //
            // https://thumbnail.image.rakuten.co.jp/@0_mall/book/cabinet/3966/4907953093966.jpg?_ex=76x76
            //   https://tshop.r10s.jp/book/cabinet/3966/4907953093966.jpg?fitin=200:300&composite-to=*,*|200:300
            //   https://shop.r10s.jp/book/cabinet/3966/4907953093966.jpg
            return src.replace(/.*?:\/\/[^/]*\/@[^/]*\/([^?]*).*?$/, "http://shop.r10s.jp/$1");
        }

        if (domain_nowww === "billboard-japan.com" ||
            // https://fotos.jornaldacidadeonline.com.br/uploads/fotos/650x0_1472919049_979715540.jpeg -- upscaled
            //   https://fotos.jornaldacidadeonline.com.br/uploads/fotos/1472919049_979715540.jpeg
            domain === "fotos.jornaldacidadeonline.com.br") {
            // http://www.billboard-japan.com/scale/news/00000057/57632/800x_image.jpg - upscaled
            //   http://www.billboard-japan.com/scale/news/00000057/57632/image.jpg
            // http://www.billboard-japan.com/scale/news/00000057/57981/170x170_image.jpg
            //   http://www.billboard-japan.com/scale/news/00000057/57981/image.jpg
            return src.replace(/\/[0-9]+x(?:[0-9]+)?_([^/]*)$/, "/$1");
        }

        if (domain_nosub === "tsite.jp" &&
            domain.indexOf("top.tsite.jp") >= 0 &&
            src.indexOf("/contents_image/") >= 0) {
            // http://cdn.top.tsite.jp/static/top/sys/contents_image/038/778/192/38778192_0_sl.jpg
            //   http://cdn.top.tsite.jp/static/top/sys/contents_image/038/778/192/38778192_0.jpg
            // http://cdn.top.tsite.jp/static/top/sys/contents_image/034/410/417/34410417_0_rl.jpg
            //   http://cdn.top.tsite.jp/static/top/sys/contents_image/034/410/417/34410417_0.jpg
            // http://top.tsite.jp/static/top/sys/contents_image/038/780/255/38780255_133963.jpg
            // http://cdn.top.tsite.jp/static/top/sys/contents_image/media_image/035/136/128/35136128_0.jpeg
            //return src.replace(/_sl(\.[^/.]*)$/, "$1");
            return src.replace(/(\/[0-9]+)_[0-9]+(?:_[^/.]+)?(\.[^/.]*)$/, "$1_0$2");
        }

        if (domain === "www.sanspo.com") {
            // http://www.sanspo.com/geino/images/20171108/geo17110807000004-m1.jpg
            //   http://www.sanspo.com/geino/images/20171108/geo17110807000004-p1.jpg
            // http://www.sanspo.com/geino/images/20140818/oth14081805030011-s3.jpg
            //   http://www.sanspo.com/geino/images/20140818/oth14081805030011-p3.jpg
            // http://www.sanspo.com/geino/images/20140818/oth14081805030011-m1.jpg
            //   http://www.sanspo.com/geino/images/20140818/oth14081805030011-p1.jpg
            //
            // p, m, n, s
            // https://sankei2img.durasite.net/images//uploads/creative/image1/111885/20180221_bmw_150x150.jpg
            //   http://www.sankei.com/images/news/180221/lif1802210001-p1.jpg -- unrelated?
            return src.replace(/(\/images\/[0-9]*\/[^/]*-)[a-z]([0-9]+\.[^/.]*)$/, "$1p$2");
        }

        if (domain === "www.sonymusicshop.jp") {
            // https://www.sonymusicshop.jp/img/1/item/SRC/L00/000/SRCL000009658_SHOP__576_320_102400_jpg.jpg?tf=gray
            //   https://www.sonymusicshop.jp/img/1/item/SRC/L00/000/SRCL000009658_SHOP__9999999999999999_9999999999999999_102400_jpg.jpg?tf=gray
            //   https://www.sonymusicshop.jp/img/1/item/SRC/L00/000/SRCL000009658_SHOP_jpg.jpg
            //return src.replace(/__[0-9]+_[0-9]+(_[0-9]+_[a-z]+\.[a-z]*)(?:\?.*)?$/, "__9999999999999999_9999999999999999$1");
            return src.replace(/__[0-9]+_[0-9]+_[0-9]+_([a-z]+\.[a-z]*)(?:\?.*)?$/, "_$1");
        }

        if (domain === "prtimes.jp") {
            // https://prtimes.jp/i/13546/1204/thumb/68x45/d13546-1204-280004-0.jpg
            //   https://prtimes.jp/i/13546/1204/original/d13546-1204-280004-0.jpg
            // https://prtimes.jp/i/13546/826/resize/d13546-826-654115-3.jpg
            //   https://prtimes.jp/i/13546/826/original/d13546-826-654115-3.jpg
            return src
                .replace(/\/thumb\/[0-9]+x[0-9]+\//, "/original/")
                .replace(/\/resize\/([^/]*)$/, "/original/$1");
        }

        if (domain_nosub === "vietbao.vn") {
            // http://vietbao.vn/The-gioi-giai-tri/Hot-girl-Le-Huyen-Anh-Mong-xuan-nay-co-nguoi-som-hoi-cuoi/2147799797/235/ - article
            // http://img.vietbao.vn/images/280/vn888/hot/v2014/cropping-1518416661-27540512-1833666450263816-461803420186171326-n.jpeg
            //   http://img.vietbao.vn/images/0/vn888/hot/v2014/cropping-1518416661-27540512-1833666450263816-461803420186171326-n.jpeg - larger, not full
            //      http://a9.vietbao.vn/images/vn888/hot/v2014/cropping-1518416661-27540512-1833666450263816-461803420186171326-n.jpeg - same
            //
            //   filename can be anything for img.vietbao.vn, but not for a9.vietbao.vn
            //   http://img.vietbao.vn/images/0/vn999/upload/hangct/27540512_1833666450263816_461803420186171326_n.jpg - full
            //      http://a9.vietbao.vn/images/vn999/upload/hangct/27540512_1833666450263816_461803420186171326_n.jpg - orig
            //
            // http://vietbao.vn/The-gioi-giai-tri/Thieu-gia-giau-nhat-Trung-Quoc-lao-dao-vi-tin-chong-lung-tang-sieu-xe-tien-ty-cho-Tara/55932319/235/ - article
            // http://a9.vietbao.vn/images/vn888/hot/v2014/cropping-1515483333-nhat-trung-quoc-lao-dao-vi-tin-chong-lung-tang-sieu-xe-tien-ty-cho-t-ara-1.jpeg
            //   http://a9.vietbao.vn/images/vn999/55/2018/01/20180109-ia-giau-nhat-trung-quoc-lao-dao-vi-tin-chong-lung-tang-sieu-xe-tien-ty-cho-t-ara-1.jpg
            return src
                //.replace(/\/images\/[0-9]+\//, "/images/0/")
                .replace(/:\/\/img\.vietbao\.vn\/images\/[0-9]+\//, "://a9.vietbao.vn/images/");
        }

        if (domain === "www.vir.com.vn") {
            // http://www.vir.com.vn/stores/news_dataimages/hung/022018/22/09/in_article/croped/fred-gives-shakhtar-edge-over-roma.jpg
            //   http://www.vir.com.vn/stores/news_dataimages/hung/022018/22/09/fred-gives-shakhtar-edge-over-roma.jpg
            return src
                .replace(/\/in_article\//, "/")
                .replace(/\/croped\//, "/");
        }

        if (domain === "media.tinnong.net.vn") {
            // http://media.tinnong.net.vn/uploaded/Images/Thumb/2018/02/22/Toi_dau_don_roi_bo_anh_de_den_voi_mot_nguoi_khong_binh_thuong_vi_mot_chu_hieu2_2202144833.jpg
            //   http://media.tinnong.net.vn/uploaded/Images/Original/2018/02/22/Toi_dau_don_roi_bo_anh_de_den_voi_mot_nguoi_khong_binh_thuong_vi_mot_chu_hieu2_2202144833.jpg
            return src.replace(/\/Images\/[^/]*\//, "/Images/Original/");
        }

        if (domain === "images.kienthuc.net.vn" ||
            // https://images.khoeplus24h.vn/zoomh/500/uploaded/anhtuan/2016_09_27/3/taylor-switt-dep-the-nao-moi-lan-xuat-hien-ben-ban-trai.jpg
            //   https://images.khoeplus24h.vn/uploaded/anhtuan/2016_09_27/3/taylor-switt-dep-the-nao-moi-lan-xuat-hien-ben-ban-trai.jpg
            domain === "images.khoeplus24h.vn") {
            // http://images.kienthuc.net.vn/zoomh/500/uploaded/nguyenvan/2018_02_22/vang/vang-1_CUMV.jpg
            //   http://images.kienthuc.net.vn/uploaded/nguyenvan/2018_02_22/vang/vang-1_CUMV.jpg
            return src.replace(/\/zoom[a-z]\/[0-9]*\//, "/");
        }

        if (domain === "rez.cdn.kul.vn" ||
            // https://www.glamour.pl/media/cache/gallery_view/uploads/media/default/0003/13/8ad84df2c40d8f28bf21ef23b50967e212f697fc.jpeg
            //   https://www.glamour.pl/uploads/media/default/0003/13/8ad84df2c40d8f28bf21ef23b50967e212f697fc.jpeg
            domain_nowww === "glamour.pl" ||
            // https://al3arabi.com/media/cache/homepage_editors_pick_content/uploads/cms/standalone-content/thumbnail/5acb65aedaa4d.jpg
            //   https://al3arabi.com/uploads/cms/standalone-content/thumbnail/5acb65aedaa4d.jpg
            domain_nowww === "al3arabi.com" ||
            // http://www.starwars-holocron.net/media/cache/iloweb_news_front_blog/uploads/media/files/actualites/star-wars-rogue-one/emilia-clarke-1.jpg
            //   http://www.starwars-holocron.net/uploads/media/files/actualites/star-wars-rogue-one/emilia-clarke-1.jpg
            domain_nowww === "starwars-holocron.net" ||
            // http://longtake.it/media/cache/medium_poster/uploads/du/dunkirk/poster-dunkirk.jpeg
            //   http://longtake.it/uploads/du/dunkirk/poster-dunkirk.jpeg
            domain_nowww === "longtake.it") {
            // http://rez.cdn.kul.vn/media/cache/thumbnail_16x10_672x420/uploads/media/thumbnail/59db/29/thumbnail_16x9_t-ara4.jpg
            //   http://rez.cdn.kul.vn/uploads/media/kul/59db/28/kul_news_t-ara4.jpg
            return src.replace(/\/media\/cache\/[^/]*\//, "/");
        }

        if (domain === "static.kstyle.com") {
            // http://static.kstyle.com/stf/ad622b862613fa27895446d446bca918.jpg/r.580x0
            //   http://static.kstyle.com/stf/ad622b862613fa27895446d446bca918.jpg
            return src.replace(/\/r\.[0-9]+x[0-9]+$/, "");
        }

        if (amazon_container === "lifesite-cache" ||
            // http://www.golocalprov.com/cache/images/cached/cache/images/remote/http_s3.amazonaws.com/images.golocalprov.com/Emma_Watson_dress_360_533_90.jpg
            //   http://s3.amazonaws.com/images.golocalprov.com/Emma_Watson_dress.jpg
            domain_nowww === "golocalprov.com" ||
            // https://cdn2.thelineofbestfit.com/images/remote/https_cdn2.thelineofbestfit.com/galleries/2014/11_clean_bandit-bts_rdn1016_bc.jpg
            //   https://cdn2.thelineofbestfit.com/galleries/2014/11_clean_bandit-bts_rdn1016_bc.jpg
            (domain_nosub === "thelineofbestfit.com" && domain.match(/^cdn[0-9]*\.thelineofbestfit\.com/))) {
            // https://lifesite-cache.s3.amazonaws.com/images/made/images/remote/https_s3.amazonaws.com/lifesite/man_and_woman_arguing_with_signs_810_500_55_s_c1.jpg
            //   https://s3.amazonaws.com/lifesite/man_and_woman_arguing_with_signs.jpg
            // https://lifesite-cache.s3.amazonaws.com/images/made/images/remote/https_s3.amazonaws.com/lifesite/Billy_Graham__finger_pointing_720_470_55_s_c1.jpg
            //   https://s3.amazonaws.com/lifesite/Billy_Graham__finger_pointing.jpg
            // https://s3.amazonaws.com/lifesite-cache/images/made/images/remote/https_s3.amazonaws.com/lifesite/man_and_woman_arguing_with_signs_810_500_55_s_c1.jpg
            //   https://s3.amazonaws.com/lifesite/man_and_woman_arguing_with_signs.jpg
            return src
                .replace(/.*\/images\/remote\/([^_]*)_(.*?)(?:_[0-9]+_[0-9]+_[0-9]+(?:_[a-z]_[a-z][0-9])?)?(\.[^/.]*)$/, "$1://$2$3");
        }

        if (domain_nosub === "fap.to") {
            // http://x3.fap.to/images/thumb/62/114/1146416891.jpg
            //   http://x3.fap.to/images/full/62/114/1146416891.jpg
            // http://x.fap.to/h175q90/images/full/57/401/401519803.jpg
            //   http://x.fap.to/images/full/57/401/401519803.jpg
            // http://x.fap.to/h60q90c35.444444x10.666667x57.555556x25.407407/images/full/57/401/401519803.jpg
            //   http://x.fap.to/images/full/57/401/401519803.jpg
            return src
                .replace(/(:\/\/[^/]*\/)[a-z0-9.]+\/images\//, "$1images/")
                .replace(/\/images\/[a-z]*\//, "/images/full/");
        }

        if (domain === "www.gannett-cdn.com" &&
            src.indexOf("/-ip-/") >= 0) {
            // https://www.gannett-cdn.com/-ip-/https://media.gannett-cdn.com/29906170001/29906170001_5720100432001_5720093419001-vs.jpg?pubId=29906170001&quality=10
            //   https://media.gannett-cdn.com/29906170001/29906170001_5720100432001_5720093419001-vs.jpg
            return src.replace(/.*?\/-ip-\//, "");
        }

        if (domain === "cdn.mainichi.jp") {
            // https://cdn.mainichi.jp/vol1/2018/02/19/20180219p2g00m0sp060000p/4.jpg
            //   https://cdn.mainichi.jp/vol1/2018/02/19/20180219p2g00m0sp060000p/9.jpg
            return src.replace(/\/[0-9]+(\.[^/.]*)$/, "/9$1");
        }

        if (domain === "img.evbuc.com") {
            // forces download?
            // https://img.evbuc.com/https%3A%2F%2Fcdn.evbuc.com%2Fimages%2F37338904%2F45878487997%2F1%2Foriginal.jpg?w=1000&rect=0%2C236%2C1890%2C945&s=53555af848d3afd2d9a9b2cb603d9516
            return decodeURIComponent(src.replace(/.*:\/\/[^/]*\/([^?]*).*/, "$1"));
        }

        if (domain === "img.cdandlp.com") {
            // https://img.cdandlp.com/2017/08/imgL/118890893.jpg
            // https://img.cdandlp.com/2017/08/imgS/118890893.jpg
            // https://img.cdandlp.com/img_ssl/1274211304-73249-1.jpg
            // https://ring.cdandlp.com/sleazyx/photo_grande/115030078-3.jpg
            // https://content.cdandlp.com/superflyrecords/catalogue/40106.jpg
            // https://www.soundfinder.jp/img/products/102065/1507215600/59d727b5-151c-4c14-8768-62417697bade/1180602.jpg
            // https://img.cdandlp.com/2014/09/imgM/117153395.jpg
            return src.replace("/imgS/", "/imgL/").replace("/imgM/", "/imgL/");
        }

        if (domain === "walter.trakt.tv") {
            // https://walter.trakt.tv/images/shows/000/082/248/fanarts/thumb/04342b5daf.jpg.webp
            //   https://walter.trakt.tv/images/shows/000/082/248/fanarts/full/04342b5daf.jpg.webp
            return src.replace(/\/thumb\/([^/]*)$/, "/full/$1");
        }

        if (domain === "cdn.apk-cloud.com") {
            // http://cdn.apk-cloud.com/detail/screenshot/sYpEJNqANEbHAkHjLbYOOdRyn3sIhEtHgF8qSEpKXE38UR0RpI4X7b2eQfTQIiiljCrL.png
            // http://cdn.apk-cloud.com/detail/screenshot/sYpEJNqANEbHAkHjLbYOOdRyn3sIhEtHgF8qSEpKXE38UR0RpI4X7b2eQfTQIiiljCrL=h400.png
            return src
                .replace(/(?:=[a-z][0-9]*)?(\.[^/.]*)$/, "=h0$1");
        }

        if (domain_nosub === "polyvoreimg.com") {
            // down?
            // https://ak2.polyvoreimg.com/cgi/img-thing/size/l/tid/3884489.jpg
            //   https://www.polyvore.com/cgi/img-thing?.out=jpg&size=l&tid=3884489
            // https://cfc.polyvoreimg.com/cgi/img-set/.sig/9ndQlKC89OQ6ut3OULMg/cid/230139023/id/tsrtpPy65xGAdEGMmAc2pA/size/c1024x1024.jpg
            //   https://cfc.polyvoreimg.com/cgi/img-set/cid/230139023/id/tsrtpPy65xGAdEGMmAc2pA/size/c1024x1024.jpg
            //   https://cfc.polyvoreimg.com/cgi/img-set/cid/230139023/size/c1024x1024.jpg
            //   https://www.polyvore.com/cgi/img-set?.out=jpg&.sig=9ndQlKC89OQ6ut3OULMg&cid=230139023&id=tsrtpPy65xGAdEGMmAc2pA&size=c1024x1024
            // http://ak2.polyvoreimg.com/cgi/img-set/cid/39051735/id/XHw8HlYH4RGZj34mPmiMmg/size/y.jpg
            // http://ak2.polyvoreimg.com/cgi/img-set/cid/39051735/size/y.jpg
            // y, x, e, l, g, m, s, t
            var cginame = src.replace(/.*\/cgi\/([^/]*)\/.*/, "$1");
            var paramsbase = src.replace(/.*\/cgi\/[^/]*/, "");
            var params = paramsbase.replace(/\/([^/]*)\/([^/]*)/g, "$1=$2&");
            params = params
                .replace(/(.*)\.([^/.&]*)&$/, ".out=$2&$1");
            return "https://www.polyvore.com/cgi/" + cginame + "?" + params;
        }

        if (domain === "www.polyvore.com" &&
            src.indexOf("/cgi/") >= 0) {
            // https://www.polyvore.com/cgi/img-thing?.out=jpg&size=l&tid=95293327
            //   https://www.polyvore.com/cgi/img-thing?.out=jpg&size=y&tid=95293327
            // https://www.polyvore.com/cgi/img-set?.out=jpg&.sig=9ndQlKC89OQ6ut3OULMg&cid=230139023&id=tsrtpPy65xGAdEGMmAc2pA&size=c1024x1024
            //   https://www.polyvore.com/cgi/img-set?.out=jpg&.sig=9ndQlKC89OQ6ut3OULMg&cid=230139023&id=tsrtpPy65xGAdEGMmAc2pA&size=c99999x99999
            return src
                .replace(/\/img-set(.*?)&size=[^&]*/, "/img-set$1&size=c99999x99999");
                //.replace(/\/img-thing(.*?)&size=[^&]*/, "/img-thing$1&size=y"); // doesn't work well
        }

        if (domain === "aliyun-cdn.hypebeast.cn" &&
            src.indexOf("/hypebeast.com/") >= 0) {
            // https://aliyun-cdn.hypebeast.cn/hypebeast.com/wp-content/blogs.dir/4/files/2018/01/louis-vuitton-2018-fall-winter-50.jpg?q=75&w=400
            return src.replace(/.*:\/\/[^/]*\//, "http://");
        }

        if (domain_nowww === "girlscene.nl") {
            // https://www.girlscene.nl/thumb/782x0/ckfinder/userfiles/images/Beauty/2015/mei/Braun%20Silk-epil%209%20-%20Jessica%20Alba.jpg -- stretched
            //   https://www.girlscene.nl/ckfinder/userfiles/images/Beauty/2015/mei/Braun%20Silk-epil%209%20-%20Jessica%20Alba.jpg
            return src.replace(/\/thumb\/[0-9]+x[0-9]+\//, "/");
        }

        if (domain_nowww === "hdfullfilmizle.com") {
            // http://www.hdfullfilmizle.com/thumb/131x150/uploads/oyuncu/2018/04/milla-jovovich-744.jpg
            //   http://www.hdfullfilmizle.com/uploads/oyuncu/2018/04/milla-jovovich-744.jpg
            return src.replace(/\/thumb\/[0-9]+x[0-9]+\/uploads\//, "/uploads/");
        }

        if (domain === "www.hairstyleinsider.com" ||
            // https://sites.eveyo.com/thumbnail.php?file=images/Lady_Amelia_279174293.jpg&size=article_large
            //   https://sites.eveyo.com/files.php?file=images/Lady_Amelia_279174293.jpg
            //   https://sites.eveyo.com/files/images/Lady_Amelia_279174293.jpg
            domain === "sites.eveyo.com" ||
            // http://24sata.info/files.php?file=news/2016/Mart_2016/lopez_haljina_1_199914503.jpg
            //   http://24sata.info/files/news/2016/Mart_2016/lopez_haljina_1_199914503.jpg
            domain_nowww === "24sata.info" ||
            // http://www.alankabout.com/thumbnail.php?file=photo_galleries/celebrities/western_celebrities/milla_jovovich/Milla-Jovovich-37.JPG&size=article_medium
            //   http://www.alankabout.com/files/photo_galleries/celebrities/western_celebrities/milla_jovovich/Milla-Jovovich-37.JPG
            domain_nowww === "alankabout.com" ||
            domain === "www.elle.rs") {
            // https://www.hairstyleinsider.com/thumbnail.php?file=2015/Emma_Watson_Bobby_Pinned_Updo_629726963.jpg&size=article_large
            //   https://www.hairstyleinsider.com/files/2015/Emma_Watson_Bobby_Pinned_Updo_629726963.jpg
            //   https://www.hairstyleinsider.com/files.php?file=2015/Emma_Watson_Bobby_Pinned_Updo_629726963.jpg
            // http://www.elle.rs/files.php?file=images/2018/01/kate_i_naomi_na_reviji_1_169904615.jpg
            // http://www.elle.rs/thumbnail.php?file=images/2018/02/gucci_moschino_fall_winter_2018_abs___983890735.jpg&size=summary_large
            //   http://www.elle.rs/files.php?file=images/2018/02/gucci_moschino_fall_winter_2018_abs___983890735.jpg
            //   https://www.elle.rs/files/images/2018/02/gucci_moschino_fall_winter_2018_abs___983890735.jpg
            //return src.replace(/\/thumbnail.php.*?file=([^&]*).*/, "/files.php?file=$1");
            return src.replace(/\/(?:thumbnail|files).php.*?file=([^&]*).*/, "/files/$1");
        }

        if (domain === "www.zkpm.net" ||
            // http://img.viyuedu.com/img.php?url=http://mmbiz.qpic.cn/mmbiz/HiaNy8LPboMzo9U0Dg38XibJQia6sicM2D26icquxZic0eRPVRNLGDSMYu2tgnZ6RjqOaZEJ3608def8gpZEicX2WAM2Q/0?wx_fmt=jpeg
            //   http://mmbiz.qpic.cn/mmbiz/HiaNy8LPboMzo9U0Dg38XibJQia6sicM2D26icquxZic0eRPVRNLGDSMYu2tgnZ6RjqOaZEJ3608def8gpZEicX2WAM2Q/0?wx_fmt=jpeg
            domain === "img.viyuedu.com") {
            // http://www.zkpm.net/img.php?url=http://mmbiz.qpic.cn/mmbiz_jpg/Hey2N7g1r13EPyvv9cxxvy7uYsT9NZuAkbahJGeFoQGO9r0Wwicu7Oh2YiceaMgfObxznBkn4hx61JzCYnwWwMNA/0?wx_fmt=jpeg
            return src.replace(/.*\/img\.php.*?url=(.*)/, "$1");
        }

        if (domain === "img.xiaohuazu.com") {
            // http://img.xiaohuazu.com/?tag=a&url=mmbizz-zqpicz-zcn/mmbiz_jpg/bm1gUegOAnjmwzCcibTuzlH2uqYZnAgPqZHUjew7icxAIAGIkfUdxFaBMuGs5wVEiboyXw4dS94DHATt6ibPhgCK1Q/0?wx_fmt=jpeg
            //   http://mmbiz.qpic.cn/mmbiz_jpg/bm1gUegOAnjmwzCcibTuzlH2uqYZnAgPqZHUjew7icxAIAGIkfUdxFaBMuGs5wVEiboyXw4dS94DHATt6ibPhgCK1Q/0?wx_fmt=jpeg
            return src.replace(/.*?[?&]url=(.*)/, "$1").replace(/z-z/g, ".").replace(/^/, "http://");
        }

        if (domain === "www.viewsofia.com") {
            // https://www.viewsofia.com/upload/fck_editor_thumb/fck_editor/Image/LV18/_VUI0653.jpg
            //   https://www.viewsofia.com/upload/fck_editor/fck_editor/Image/LV18/_VUI0653.jpg
            return src.replace("/fck_editor_thumb/", "/fck_editor/");
        }

        if (domain_nosub === "condenast.ru" && domain.indexOf(".static.media.condenast.ru") >= 0) {
            // https://d6.static.media.condenast.ru/vogue/collection/49d7fa92bdcb9696c7ebac700ca6983e.jpg/0ce73d99/o/t214x320
            //   https://d6.static.media.condenast.ru/vogue/collection/49d7fa92bdcb9696c7ebac700ca6983e.jpg/0ce73d99/o/w99999999
            // http://static.glamour.ru/iblock/d4c/71048307.jpg
            return src.replace(/\/[a-z][0-9]*(?:x[0-9]+)?$/, "/w99999999");
        }

        if (domain === "www.vogue.co.jp") {
            // https://www.vogue.co.jp/uploads/media/2017/01/25/ALEXANDRE_VAUTHIER_2017SS_Haute_Couture_Collection_runway_gallery-26-171-256.jpg
            //   https://www.vogue.co.jp/uploads/media/2017/01/25/ALEXANDRE_VAUTHIER_2017SS_Haute_Couture_Collection_runway_gallery-26.jpg
            return src.replace(/-[0-9]+-[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "cdn.vogue.mx" ||
            // https://cdn.glamour.mx/uploads/images/thumbs/mx/glam/2/s/2018/20/looks_de_billboard_awards_2018_3250_413x620.jpg
            //   https://cdn.glamour.mx/uploads/images/mx/glam/s/2018/20/looks_de_billboard_awards_2018_3250.jpg
            domain === "cdn.glamour.mx" ||
            // http://cdn.vogue.es/uploads/images/thumbs/201541/top_looks_las_mejor_vestidas_de_la_semana_del_2_al_9_de_octubre_de_2015_758656006_800x.jpg
            //   http://cdn.vogue.es/uploads/images/201541/top_looks_las_mejor_vestidas_de_la_semana_del_2_al_9_de_octubre_de_2015_758656006.jpg
            domain === "cdn.vogue.es") {
            // http://cdn.vogue.mx/uploads/images/thumbs/mx/vog/2/c/2017/04/alexandre_vauthier_pasarela_387309230_377x566.jpg
            //   http://cdn.vogue.mx/uploads/images/thumbs/mx/vog/2/c/2017/04/alexandre_vauthier_pasarela_387309230_1200x1800.jpg
            //   http://cdn.vogue.mx/uploads/images/mx/vog/c/2017/04/alexandre_vauthier_pasarela_170811342.jpg
            // http://cdn.vogue.mx/uploads/images/thumbs/mx/vog/2/c/2017/04/alexandre_vauthier_pasarela_170811342_185x278.jpg
            //   http://cdn.vogue.mx/uploads/images/mx/vog/c/2017/04/alexandre_vauthier_pasarela_170811342.jpg
            // http://cdn.vogue.mx/uploads/images/mx/vog/s/2016/10/familia_real_britanica_780685680.jpg
            return src
                .replace(/\/uploads\/images\/thumbs(?:(\/mx\/(?:vog|glam)\/)[0-9]*)?\/(.*)_[0-9]+x(?:[0-9]+)?(\.[^/.]*)$/, "/uploads/images/$1$2$3");
        }

        if (domain_nosub === "ykt.ru" ||
            domain_nosub === "ykt2.ru") {
            // http://cs-msk-fd-4.ykt2.ru/media/upload/photo/2015/11/16/thumb/561772143a52dw350h530cr.jpeg
            // http://www.news.ykt.ru/upload/image/2017/04/55619/thumb/58ec2ea7219bd.jpg
            return src.replace(/\/thumb\/([^/]*)$/, "/$1");
        }

        if (domain === "i.guim.co.uk") {
            // https://static.guim.co.uk/sys-images/Guardian/Pix/pictures/2014/6/2/1401727592551/Jeremy-Paxman--014.jpg
            // https://i.guim.co.uk/img/media/25e99cf42defaf460da04eb3fa08fac1f10aac55/0_138_3500_2100/master/3500.jpg?w=600&q=20&auto=format&usm=12&fit=max&dpr=2&s=5366bc1d02c96c9062f7c1c19318626f
            //   https://media.guim.co.uk/25e99cf42defaf460da04eb3fa08fac1f10aac55/0_138_3500_2100/master/3500.jpg
            // https://i.guim.co.uk/img/static/sys-images/Guardian/Pix/pictures/2015/2/18/1424261816248/34329776-7c4a-488a-a767-57ee9477cad3-2060x1236.jpeg
            //   https://static.guim.co.uk/sys-images/Guardian/Pix/pictures/2015/2/18/1424261816248/34329776-7c4a-488a-a767-57ee9477cad3-2060x1236.jpeg
            return src.replace(/:\/\/[^/]*\/img\/([^/]*)\/([^?]*).*?$/, "://$1.guim.co.uk/$2");
        }

        if (domain === "media.guim.co.uk") {
            // https://media.guim.co.uk/25e99cf42defaf460da04eb3fa08fac1f10aac55/0_138_3500_2100/master/3500.jpg
            //   https://media.guim.co.uk/25e99cf42defaf460da04eb3fa08fac1f10aac55/0_138_3500_2100/3500.jpg
            // https://media.guim.co.uk/5cef1f5322cece5683b42385ce834bdb45b153a3/0_0_1994_2993/666.jpg -- 666x1000
            //   https://media.guim.co.uk/5cef1f5322cece5683b42385ce834bdb45b153a3/0_0_1994_2993/1994.jpg -- 1994x2993
            return src
                .replace(/\/((?:[0-9]*_){3}[0-9]*)\/[^/]*\/([0-9]*\.[^/.]*)$/, "/$1/$2")
                .replace(/(\/[0-9]+_[0-9]+_([0-9]+)_[0-9]+\/)[0-9]+(\.[^/.]*)$/, "$1$2$3");
        }

        if (domain_nowww === "myproana.com" ||
            // http://tesall.ru/uploads/gallery/category_82/sml_gallery_304485_82_403628.jpeg
            //   http://tesall.ru/uploads/gallery/category_82/gallery_304485_82_403628.jpeg
            // http://tesall.ru/uploads/profile/photo-thumb-304485.png?_r=1482876452
            //   http://tesall.ru/uploads/profile/photo-304485.png?_r=1482876452
            domain_nowww === "tesall.ru") {
            // http://www.myproana.com/uploads/gallery/album_28122/med_gallery_463850_28122_30414.jpg
            //   https://www.myproana.com/uploads/gallery/album_28122/gallery_463850_28122_30414.jpg
            // https://www.myproana.com/uploads/gallery/album_56930/sml_gallery_970690_56930_32825.jpg
            //   https://www.myproana.com/uploads/gallery/album_56930/gallery_970690_56930_32825.jpg
            //return src.replace(/\/med_([^/]*)$/, "/$1");
            return src
                .replace(/(\/uploads\/gallery\/(?:album|category)_[0-9]+\/)[a-z]+_(gallery_[0-9]+[^/]*\.[^/.]*)$/, "$1$2")
                .replace(/(\/uploads\/profile\/photo-)thumb-([0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "vogue.gjstatic.nl") {
            // https://vogue.gjstatic.nl/thumbnails/GenjArticleBundle/Article/fileUpload/medium/00/58/12/dit-heeft-gigi-hadid-te-zeggen-tegen-al-haar-body-shamers-5812.jpg
            //   https://vogue.gjstatic.nl/thumbnails/GenjArticleBundle/Article/fileUpload/big/00/58/12/dit-heeft-gigi-hadid-te-zeggen-tegen-al-haar-body-shamers-5812.jpg
            // https://vogue.gjstatic.nl/thumbnails/GenjArticleBundle/Article/fileUpload/detail/01/06/15/glitter-sparkle-shine-alexa-chung-staat-op-de-cover-van-vogue-december-2017-10615.jpg -- 1000x1295
            //   https://vogue.gjstatic.nl/thumbnails/GenjArticleBundle/Article/fileUpload/big/01/06/15/glitter-sparkle-shine-alexa-chung-staat-op-de-cover-van-vogue-december-2017-10615.jpg -- 1600x2072
            // https://vogue.gjstatic.nl/uploads/media/image/dolce-gabbana-make-capri-a-paparazzi-free-zone_9.jpg
            // https://vogue.gjstatic.nl/uploads/media/image/singer-songwriter-angela-vertelt-de-californie-hea-1.jpg
            // https://vogue.gjstatic.nl/thumbnails/GenjArticleBundle/Article/teaserFileUpload/teaser/00/84/17/tommy-x-gigi-has-landed-dit-zijn-vogue-s-favorieten-uit-de-ultieme-cali-girl-collectie-8417.jpg
            //   https://vogue.gjstatic.nl/thumbnails/GenjArticleBundle/Article/fileUpload/detail/00/84/17/tommy-x-gigi-has-landed-dit-zijn-vogue-s-favorieten-uit-de-ultieme-cali-girl-collectie-8417.jpg
            // https://vogue.gjstatic.nl/thumbnails/GenjArticleBundle/Article/fileUpload/detail/00/89/30/gigi-hadid-verlengt-samenwerking-met-tommy-hilfiger-8930.jpg
            //   https://vogue.gjstatic.nl/thumbnails/GenjArticleBundle/Article/fileUpload/big/00/89/30/gigi-hadid-verlengt-samenwerking-met-tommy-hilfiger-8930.jpg
            // https://designer-vintage.gjstatic.nl/thumbnails/GenjArticleBundle/Article/fileUpload/detail/00/13/27/the-exclusive-designer-vintage-summer-sale-1327.jpg -- 1000x1249
            //   https://designer-vintage.gjstatic.nl/uploads/media/image/the-exclusive-designer-vintage-summer-sale.jpg -- 4048x5059
            // https://designer-vintage.gjstatic.nl/thumbnails/GenjArticleBundle/Article/fileUpload/detail/00/19/42/the-top-5-best-snow-white-winter-bags-1942.jpg
            //   https://designer-vintage.gjstatic.nl/uploads/medi/image/the-top-5-best-snow-white-winter-bags.jpg -- doesn't work, error 500
            return src
                .replace(/\/teaserFileUpload\//, "/fileUpload/") // doesn't work on all
                .replace(/\/fileUpload\/[^/]*\//, "/fileUpload/big/");
        }

        if (domain_nosub === "favim.com" && domain.match(/s[0-9]*\.favim\.com/)) {
            // https://s10.favim.com/mini/171202/book-Favim.com-5265965.jpeg
            //   https://s10.favim.com/orig/171202/book-Favim.com-5265965.jpeg
            // https://s8.favim.com/mini/151114/girls-generation-icons-snsd-taeyeon-Favim.com-3566828.png
            //   https://s8.favim.com/orig/151114/girls-generation-icons-snsd-taeyeon-Favim.com-3566828.png
            return src.replace(/(:\/\/[^/]*\/)[^/]*\//, "$1orig/");
        }

        if (domain === "derpicdn.net") {
            // https://derpicdn.net/img/2018/2/24/1664344/thumb.png
            //   https://derpicdn.net/img/2018/2/24/1664344/large.png
            //   https://derpicdn.net/img/2018/2/24/1664344/full.png
            // https://derpicdn.net/img/2016/10/9/1268708/large.png -- 1280x973
            //   https://derpicdn.net/img/2016/10/9/1268708/full.png -- 4603x3500
            return src.replace(/\/(?:thumb|large)(\.[^/.]*)$/, "/full$1");
        }

        if (domain_nosub === "iimg.me") {
            // http://mnetjapan.iimg.me/interest.php?url=http%3A%2F%2Fjp.mnet.com%2Fdata%2Fwww.mnetjapan.com%2Fadmin%2F000%2F172%2F494
            //   http://jp.mnet.com/data/www.mnetjapan.com/admin/000/172/494
            // http://s.iimg.me/profile.php?url=http%3A%2F%2Fs.iimg.me%2FprofileImage%2Fg%2F9%2F98g_1423385594_profile
            newsrc = src.replace(/.*\/[a-z]*\.php.*?[?&]url=([^&]*).*?$/, "$1");
            if (newsrc !== src && newsrc.indexOf("http") === 0) {
                return decodeURIComponent(newsrc);
            }
        }

        if (domain === "pix.avaxnews.com" ||
            // https://pxhst.co/avaxhome/90/ce/0029ce90_medium.jpeg
            //   https://pxhst.co/avaxhome/90/ce/0029ce90.jpeg
            domain_nowww === "pxhst.co") {
            // http://pix.avaxnews.com/avaxnews/99/e2/0002e299_medium.jpeg
            //   http://pix.avaxnews.com/avaxnews/99/e2/0002e299.jpeg
            // https://pix.avaxnews.com/avaxnews/9c/e2/0002e29c_medium.jpeg
            //   https://pix.avaxnews.com/avaxnews/9c/e2/0002e29c.jpeg
            return src.replace(/_[^/]*(\.[^/.]*)$/, "$1");
        }

        if (domain === "i.hurimg.com" ||
            // http://img.posta.com.tr/img/78/567x391/5ae22558ae298b8e001426ff
            //   http://img.posta.com.tr/img/78/0x0/5ae22558ae298b8e001426ff
            //   http://img.posta.com.tr/img/100/0x0/5ae22558ae298b8e001426ff
            domain === "img.posta.com.tr" ||
            // http://icdn.pstimg.com/img/80/700x410/5ae2c6f066a97c82afd94131
            //   http://icdn.pstimg.com/img/100/0x0/5ae2c6f066a97c82afd94131
            domain === "icdn.pstimg.com" ||
            // http://img.fanatik.com.tr/img/78/394x0/5b0d157966a97c43510a1c3d
            //   http://img.fanatik.com.tr/img/100/0x0/5b0d157966a97c43510a1c3d
            domain === "img.fanatik.com.tr" ||
            // https://assets.dogannet.tv/img/10/640x0/5ac6231aae298b8e01213bed
            //   https://assets.dogannet.tv/img/100/0x0/5ac6231aae298b8e01213bed
            domain === "assets.dogannet.tv" ||
            // https://i.cnnturk.com/ps/cnnturk/75/630x0/582064a15659341ab0aea248.jpg
            //   https://i.cnnturk.com/ps/cnnturk/75/0x0/582064a15659341ab0aea248.jpg
            //   https://i.cnnturk.com/ps/cnnturk/100/0x0/582064a15659341ab0aea248.jpg
            domain === "i.cnnturk.com") {
            // http://i.hurimg.com/i/hdn/10/100x0/5a8becad18c7731320697a39.jpg
            //   http://i.hurimg.com/i/hdn/100/0x0/5a8becad18c7731320697a39.jpg
            // http://i.hurimg.com/i/hurriyet/75/770x0/563f20410f2544733cbe7185
            //   http://i.hurimg.com/i/hurriyet/100/0x0/563f20410f2544733cbe7185

            //return src.replace(/(\/i\/[a-z]+\/)[0-9]+\/[0-9]+x[0-9]+\//, "$1100/0x0/");
            //return src.replace(/\/[0-9]+x[0-9]+\/([0-9a-f]+)$/, "/0x0/$1");
            //return src.replace(/\/img\/[0-9]+\/[0-9]+x[0-9]+\/([0-9a-f]+)(?:[?#].*)?$/, "/img/100/0x0/$1")
            return src.replace(/\/[0-9]+\/[0-9]+x[0-9]+\/([0-9a-f]+(?:\.[^/.]*)?)(\?.*)?$/, "/100/0x0/$1");
        }

        if (domain === "www.kurtkomaromi.com" ||
            // http://fashionweddingdress.typepad.com/.a/6a0147e0f2fc76970b01901cf76eda970b-800wi
            // http://attheloft.typepad.com/.a/6a00e54ecca8b9883301901f038a73970b-pi
            domain_nosub === "typepad.com" ||
            // http://blogs.elpais.com/.a/6a00d8341bfb1653ef01a511bd02ef970c-pi
            //   http://blogs.elpais.com/.a/6a00d8341bfb1653ef01a511bd02ef970c
            domain === "blogs.elpais.com" ||
            // http://www.summerofdan.net/.a/6a00d83431352e53ef01b8d2d8eada970c-500wi
            domain === "www.summerofdan.net" ||
            // http://www.thequeenofstyle.com/.a/6a00e554e5d8fe883301bb097df669970d-pi
            //   http://www.thequeenofstyle.com/.a/6a00e554e5d8fe883301bb097df669970d
            domain_nowww === "thequeenofstyle.com" ||
            // http://www.thequestforit.com/.a/6a00d83451b1d169e2017c36ac73b8970b-320wi
            //   http://www.thequestforit.com/.a/6a00d83451b1d169e2017c36ac73b8970b
            domain_nowww === "thequestforit.com" ||
            // http://www.weeklystorybook.com/.a/6a0105369e6edf970b01b8d0ebd465970c-400wi
            //   http://www.weeklystorybook.com/.a/6a0105369e6edf970b01b8d0ebd465970c
            domain === "www.weeklystorybook.com") {
            // http://www.kurtkomaromi.com/.a/6a00d8341c764653ef01b8d144082f970c-500wi
            //   http://www.kurtkomaromi.com/.a/6a00d8341c764653ef01b8d144082f970c
            return src.replace(/(\/\.a\/[^-/]*)-[^/]*$/, "$1");
        }

        if (domain_nowww === "bathingnews.com") {
            // http://www.bathingnews.com/.a/6a01156ef01963970c0133f527312d970b-pi -- head: 500
            //   http://www.bathingnews.com/.a/6a01156ef01963970c0133f527312d970b
            return {
                can_head: false,
                url: src.replace(/(\/\.a\/[^-/]*)-[^/]*$/, "$1")
            };
        }

        if (domain === "img.jakpost.net" ||
            // https://gd.image-qoo10.jp/ai/059/846/1044846059_07.g_80-w-st_g.jpg
            //   https://gd.image-qoo10.jp/ai/059/846/1044846059_07.jpg -- 900x1200
            domain === "gd.image-qoo10.jp") {
            // http://img.jakpost.net/c/2017/08/11/2017_08_11_30875_1502421112._small.jpg
            //   https://img.jakpost.net/c/2017/08/11/2017_08_11_30875_1502421112.jpg -- 1360x910
            return src.replace(/\.[^/.]*(\.[^/.]*)$/, "$1");
        }

        if (domain === "r.ddmcdn.com") {
            // http://r.ddmcdn.com/w_1330/s_f/o_1/cx_0/cy_0/cw_1330/ch_1995/TLC/uploads/2016/03/SYTTD_ep1407_051.jpg
            //   http://r.ddmcdn.com/cx_0/cy_0/cw_0/ch_0/TLC/uploads/2016/03/SYTTD_ep1407_051.jpg
            //   http://static.ddmcdn.com/TLC/uploads/2016/03/SYTTD_ep1407_051.jpg
            // http://r.ddmcdn.com/s_f/o_1/APL/uploads/2015/11/pangolin-ARTICLE-PAGE.jpg
            //   http://static.ddmcdn.com/APL/uploads/2015/11/pangolin-ARTICLE-PAGE.jpg
            // http://r.ddmcdn.com/w_2574/s_f/o_1/cx_7/cy_0/cw_2574/ch_1716/DSC/uploads/2015/01/mythbusters-228-07.jpg
            //   http://static.ddmcdn.com/DSC/uploads/2015/01/mythbusters-228-07.jpg
            return src.replace(/:\/\/[^/]*\/(?:[^/_]*_[^/_]*\/)*/, "://static.ddmcdn.com/");
        }

        if (domain_nosub === "newegg.com" && domain.match(/images[0-9]*\.newegg\.com/)) {
            // https://images10.newegg.com/ProductImageCompressAll300/A24G_131515246497615592Gsxgghs342.jpg
            //   https://images10.newegg.com/ProductImageOriginal/A24G_131515246497615592Gsxgghs342.jpg
            // https://images10.newegg.com/NeweggImage/ProductImage/11-129-212-Z01.jpg
            //   https://images10.newegg.com/NeweggImage/ProductImageCompressAll1280/11-129-212-Z01.jpg
            //   https://images10.newegg.com/ProductImageOriginal/11-129-212-Z01.jpg
            // https://images10.newegg.com/NeweggImage/productimage/11-154-087-13.jpg
            //   https://images10.newegg.com/ProductImageOriginal/11-154-087-13.jpg
            // ignore:
            // https://images10.newegg.com/BizIntell/item/11/129/11-129-209/a6_120817.jpg
            return src.replace(/(:\/\/[^/]*\/)(?:NeweggImage\/)?(?:ProductImage|productimage)[^/]*\//, "$1ProductImageOriginal/");
        }

        if (domain === "images.costco-static.com" ||
            domain === "images.costcobusinesscentre.ca") {
            // https://images.costco-static.com/ImageDelivery/imageService?profileId=12026539&imageId=1660214-894__1&recipeName=350
            //   https://images.costco-static.com/ImageDelivery/imageService?profileId=12026539&imageId=1660214-894__1
            // https://images.costcobusinesscentre.ca/ImageDelivery/imageService?profileId=12027981&imageId=1030100__1&recipeName=350
            //   https://images.costcobusinesscentre.ca/ImageDelivery/imageService?profileId=12027981&imageId=1030100__1
            return src
                .replace(/([?&])recipeName=[^&]*/, "$1")
                .replace(/&$/, "");
        }

        if (amazon_container === "emerge-tech") {
            // https://emerge-tech.s3.amazonaws.com/content/thumb/24764608_main_thumb.jpeg
            //   https://emerge-tech.s3.amazonaws.com/content/full/24764608_main_full.jpeg
            // https://s3.amazonaws.com/emerge-tech/content/thumb/24764608_main_thumb.jpeg
            //   https://s3.amazonaws.com/emerge-tech/content/full/24764608_main_full.jpeg
            return src.replace(/\/[a-z]*\/([0-9]*_[a-z]*_)[a-z]*(\.[^/.]*)$/, "/full/$1full$2");
        }

        if (domain_nosub === "wfcdn.com" && domain.match(/img[0-9]*(?:-[^.]*)?\.wfcdn\.com/)) {
            // https://secure.img1-fg.wfcdn.com/im/46823086/resize-h800%5Ecompr-r85/1292/12924520/Water+Resistant+Combination+Security+Safe+with+Dial+/+Combination/Key/Dual-Lock.jpg
            //   https://secure.img1-fg.wfcdn.com/im/46823086/compr-r85/1292/12924520/Water+Resistant+Combination+Security+Safe+with+Dial+/+Combination/Key/Dual-Lock.jpg
            // https://secure.img1-fg.wfcdn.com/lf/maxsquare/hash/11510/9457200/1/Waverly-Imperial-Dress-Porcelain-50-Curtain-Valance.jpg
            return src.replace(/(\/im\/[0-9]+\/)[^/]*\//, "$1compr-r85/");
        }

        if (domain_nosub === "hdnux.com") {
            // https://s.hdnux.com/photos/71/36/40/15067141/3/1024x1024.jpg
            //   https://s.hdnux.com/photos/71/36/40/15067141/3/rawImage.jpg
            // http://ww2.hdnux.com/photos/70/63/07/14889457/3/1024x1024.jpg
            //   https://s.hdnux.com/photos/70/63/07/14889457/3/rawImage.jpg
            // https://s.hdnux.com/photos/70/63/07/14889457/3/1024x1024.jpg
            return src.replace(/\/[0-9]+x[0-9]+(\.[^/.]*)$/, "/rawImage$1");
        }

        if (domain_nosub === "busan.com" && domain.match(/news[0-9]*\.busan\.com/)) {
            // http://news20.busan.com/content/image/2018/02/28/20180228000313_t.jpg
            //   http://news20.busan.com/content/image/2018/02/28/20180228000313_0.jpg
            return src.replace(/_t(\.[^/.]*)$/, "_0$1");
        }

        if (amazon_container === "bucket.scribblelive.com" ||
            // http://images.scribblelive.com/2016/2/29/7cb26c6a-fa29-46cb-8917-26885e458232_500.jpg
            //   http://images.scribblelive.com/2016/2/29/7cb26c6a-fa29-46cb-8917-26885e458232.jpg
            domain === "images.scribblelive.com") {
            // http://s3.amazonaws.com/bucket.scribblelive.com/12554/2016/6/27/9509e65e-3508-415c-9517-e378eec731b9_1000.jpg
            //   http://s3.amazonaws.com/bucket.scribblelive.com/12554/2016/6/27/9509e65e-3508-415c-9517-e378eec731b9.jpg
            return src.replace(/_[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (false && domain === "cdn.images.express.co.uk") {
            // wip
            // https://cdn.images.express.co.uk/img/dynamic/mps/110x120/Barry-McElduff.jpg
            // https://cdn.images.express.co.uk/img/dynamic/79/590x/secondary/Sophie-Turner-295434.jpg - 590x832
            // https://cdn.images.express.co.uk/img/dynamic/59/590x/secondary/windows-10-creators-update-security-centre-settings-884921.png - 5464x2912
            // https://cdn.images.express.co.uk/img/dynamic/galleries/x701/45523.jpg
            // https://cdn.images.express.co.uk/img/dynamic/79/590x/361211_1.jpg
            // https://cdn.images.express.co.uk/img/dynamic/139/590x/secondary/screen-660225.png -- 3190x1790
            // https://cdn.images.dailystar.co.uk/dynamic/140/photos/491000/BEYONCE-4-924491.jpg
            // http://cdn.images.dailystar.co.uk/dynamic/1/281x351/205610_1.jpg
            // https://cdn.images.dailystar.co.uk/dynamic/45/281x351/120690_1.jpg
        }

        if (domain === "www.dhresource.com" ||
            domain === "image.dhgate.com") {
            // https://www.dhresource.com/webp/m/100x100/f2/albu/g5/M01/44/8F/rBVaI1mBeuGAZgrYAAERdzyHfFk078.jpg
            //   https://www.dhresource.com/0x0/f2/albu/g5/M01/44/8F/rBVaI1mBeuGAZgrYAAERdzyHfFk078.jpg
            // https://www.dhresource.com/albu_385099241_00-1.0x0/ms-lure-large-size-sexy-lingerie-lace-thong.jpg
            // http://www.dhresource.com/albu_281896403_00/1.0x0.jpg
            // https://www.dhresource.com/100x100s/f2-albu-g5-M00-DC-58-rBVaI1kBY-yAf6R4AB3gjDk3S28974.jpg/new-arrive-lady-fashion-jumpsuits-long-palazzo.jpg
            //   https://www.dhresource.com/0x0s/f2-albu-g5-M00-DC-58-rBVaI1kBY-yAf6R4AB3gjDk3S28974.jpg/new-arrive-lady-fashion-jumpsuits-long-palazzo.jpg
            // http://www.dhresource.com/albu_1061302516_00-1.600x600/wholesale-mens-travel-holster-shoulder-wallet.jpg
            //   http://www.dhresource.com/albu_1061302516_00-1.0x0/wholesale-mens-travel-holster-shoulder-wallet.jpg
            // https://image.dhgate.com/albu_381865235_00/1.0x0.jpg
            return src
                .replace(/(:\/\/[^/]*\/albu_[0-9]+_[0-9]+[-/].*?)[0-9]+x[0-9]+/, "$10x0")
                .replace(/(:\/\/[^/]*\/)[0-9]+x[0-9]+/, "$10x0")
                .replace(/(:\/\/[^/]*\/)[^/]*\/[^/]*\/[0-9]+x[0-9]+\//, "$10x0/");
        }

        if (domain === "storify.com" &&
            src.indexOf("/services/proxy/") >= 0) {
            // https://storify.com/services/proxy/2/X3vpwL2T19SKqyTM4tGayg/http/www.navy.mil/management/photodb/photos/131112-N-TG831-184.JPG
            //   http://www.navy.mil/management/photodb/photos/131112-N-TG831-184.JPG
            // https://storify.com/services/proxy/2/zCwCS2c37byorPhrTXxeJQ/https/pbs.twimg.com/media/CnHZuSZWIAAfesh.jpg:large
            return src.replace(/.*\/services\/proxy\/[0-9]+\/[^/]*\/([a-z]+)\/(.*)$/, "$1://$2");
        }

        if (domain === "www.mbcsportsplus.com") {
            // http://www.mbcsportsplus.com/images/img.php?srv=1&type=m&src=/201803/99908540_2018030209204161.jpg&gImg=1&refresh=&w=300
            //   http://www.mbcsportsplus.com/data/home/data/msplMain/201803/99908540_2018030209204161.jpg
            if (src.match(/[?&]type=m[^a-z0-9A-Z]/))
                return src.replace(/\/images\/img\.php.*?[?&]src=([^&]*).*/, "/data/home/data/msplMain");
        }

        if (domain_nosub === "joomag.com" && domain.match(/s[0-9]*cdn\.joomag\.com/)) {
            // https://view.joomag.com/%EB%85%84-%EC%9B%94%ED%98%B8-maxim%EB%A7%A5%EC%8B%AC-%ED%91%9C%EC%A7%80%EB%AA%A8%EB%8D%B8-%EB%A0%88%EC%9D%B8%EB%B3%B4%EC%9A%B0-%EC%A7%80%EC%88%99-%EC%B5%9C%ED%98%84%EC%84%9D-new-07-2015/0970864001438089053
            // https://s2cdn.joomag.com/mobile/0/548/548615/102_1-0.PNG?.1520177124
            //   https://s2cdn.joomag.com/mobile/0/548/548615/102_0-0.PNG?.1520177124
            //   https://www.joomag.com/Frontend/WebService/getPageCopy.php?uID=0/548/548615/102_0-0.PNG
            // https://s2cdn.joomag.com/res_mag/0/305/305387/548615/thumbs/spread/102.jpg?1458945882
            //   https://s2cdn.joomag.com/res_mag/0/305/305387/548615/thumbs/spread/101.jpg?1458945882 - 101 == 102
            return src.replace(/(\/mobile\/.*\/[0-9]+_)[0-9]+(-[0-9]*\.[^/]*)$/, "$10$2");
        }

        if (domain === "i.pximg.net") {
            // only works if the referrer is correct
            // https://i.pximg.net/c/600x600/img-master/img/2017/06/25/17/53/43/63558968_p0_master1200.jpg
            //   https://i.pximg.net/img-original/img/2017/06/25/17/53/43/63558968_p0.jpg
            // https://i.pximg.net/c/600x600/img-master/img/2017/06/10/23/13/15/63320604_p0_master1200.jpg
            //   https://i.pximg.net/c/600x600/img-master/img/2017/06/10/23/13/15/63320604_p0_master1200.jpg
            // https://i.pximg.net/c/600x600/img-master/img/2017/06/10/23/13/15/63320604_p0_master1200.jpg
            //   https://i.pximg.net/img-original/img/2017/06/10/23/13/15/63320604_p0.jpg
            //   https://i.pximg.net/img-original/img/2017/06/10/23/13/15/63320604_p0.jpg
            //   referer: https://www.pixiv.net/member_illust.php?mode=medium&illust_id=63320604
            // https://i.pximg.net/c/600x1200_90/img-master/img/2017/12/26/20/00/02/66469686_p0_master1200.jpg
            //   https://i.pximg.net/img-master/img/2017/12/26/20/00/02/66469686_p0_master1200.jpg
            //   https://i.pximg.net/img-original/img/2017/12/26/20/00/02/66469686_p0.jpg
            //   https://www.pixiv.net/member_illust.php?mode=manga&illust_id=66469686
            // https://i.pximg.net/c/128x128/img-master/img/2017/07/15/21/52/41/63880467_p0_square1200.jpg
            //   https://i.pximg.net/img-original/img/2017/07/15/21/52/41/63880467_p0.jpg
            // https://i.pximg.net/c/128x128/img-master/img/2016/04/20/21/54/33/56447170_p0_square1200.jpg
            //   https://i.pximg.net/img-original/img/2016/04/20/21/54/33/56447170_p0.png
            var newsrc = src
                .replace(/\/c\/[0-9]+x[0-9]+(?:_[0-9]+)?\//, "/")
                .replace(/\/img-master\//, "/img-original/")
                .replace(/(\/[0-9]+_p[0-9]+)_[^/]*(\.[^/.]*)$/, "$1$2");

            return fillobj_urls(add_extensions(newsrc), {
                headers: {
                    Referer: "https://www.pixiv.net/member_illust.php?mode=manga&illust_id=" + src.replace(/.*\/([0-9]+)_[^/]*$/, "$1")
                }
            });
        }

        if (domain_nosub === "booth.pm" && domain.match(/s[0-9]*\.booth\.pm/)) {
            // https://s2.booth.pm/c/c_300/57b9c1d2-83c2-43ca-8368-8caef0f77ecf/i/740855/ce009797-aea2-4084-a029-a766159fa233.jpg
            //   https://s2.booth.pm/c/c_300/57b9c1d2-83c2-43ca-8368-8caef0f77ecf/i/740855/ce009797-aea2-4084-a029-a766159fa233.jpg
            // https://s2.booth.pm/c/f_128/users/4030105/icon_image/2a5bf25c-cf1e-4aaa-a537-483ce0a7cbb7.jpg
            //   https://s2.booth.pm/users/4030105/icon_image/2a5bf25c-cf1e-4aaa-a537-483ce0a7cbb7.jpg
            // https://s2.booth.pm/7279e569-4081-41f9-9188-21d28fa637cc/i/674179/e994efb8-f8a2-45e9-9b5b-27815aec0abc_c_72x72.jpg
            //   https://s2.booth.pm/7279e569-4081-41f9-9188-21d28fa637cc/i/674179/e994efb8-f8a2-45e9-9b5b-27815aec0abc.jpg
            // https://s.booth.pm/c/f_620/5ee95071-e09f-4178-bf7a-8e91d5520f91/i/422674/60a4c70c-a57d-421a-bd0b-89bd3e3be1bf.jpg
            //   https://s.booth.pm/5ee95071-e09f-4178-bf7a-8e91d5520f91/i/422674/60a4c70c-a57d-421a-bd0b-89bd3e3be1bf.jpg
            // doesn't work for all:
            // https://s.booth.pm/c/f_620/c9fda5ec-b0a8-4ed6-971e-72629be03365/i/752229/c723db57-697e-4bde-8d6f-307a52747400.jpg
            //   https://s.booth.pm/c9fda5ec-b0a8-4ed6-971e-72629be03365/i/752229/c723db57-697e-4bde-8d6f-307a52747400.jpg -- doesn't work
            // doesn't work for all, some are ".JPG" in the end instead of ".jpg"
            newsrc = src
                .replace(/\/c\/[a-z]_[0-9]+\//, "/")
                .replace(/_c_[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
            if (newsrc !== src) {
                if (newsrc.match(/\.jpg$/)) {
                    return [newsrc, newsrc.replace(/\.jpg$/, ".JPG")];
                }
                return newsrc;
            }

            //return src
            //    .replace(/\/c\/[^/]*\//, "/")
            //    .replace(/(\/[^/.]*)_c_[0-9]+x[0-9]+(\.[^/.]*$)/, "$1$2");
        }

        if (domain === "booth.pximg.net") {
            // https://booth.pximg.net/c/128x128/users/30729/icon_image/8036b56a-897e-44ec-a192-aa418b9df730_base_resized.jpg
            //   https://booth.pximg.net/users/30729/icon_image/8036b56a-897e-44ec-a192-aa418b9df730_base_resized.jpg
            //   https://booth.pximg.net/users/30729/icon_image/8036b56a-897e-44ec-a192-aa418b9df730.jpg
            // https://booth.pximg.net/c/300x300_a2_g5/c363684d-1871-4a28-bab5-361cc883ffb4/i/921726/52ebec3e-b6fb-489b-aa7e-c6b610e1a4a8_base_resized.jpg
            //   https://booth.pximg.net/c363684d-1871-4a28-bab5-361cc883ffb4/i/921726/52ebec3e-b6fb-489b-aa7e-c6b610e1a4a8_base_resized.jpg
            //   https://booth.pximg.net/c363684d-1871-4a28-bab5-361cc883ffb4/i/921726/52ebec3e-b6fb-489b-aa7e-c6b610e1a4a8.jpg -- 404
            // https://booth.pximg.net/c/300x300_a2_g5/0008efae-fa87-4871-84c3-d7ae38577fb0/i/963716/52fccf85-ab15-4585-a551-00d347553ccb_base_resized.jpg -- 300x300
            //   https://booth.pximg.net/0008efae-fa87-4871-84c3-d7ae38577fb0/i/963716/52fccf85-ab15-4585-a551-00d347553ccb.jpg -- 2000x3000
            // https://booth.pximg.net/c/150x150/3c32475d-0f04-4157-b5bb-6a56cd5d633f/i/178794/1174b9d1-9f8a-4525-88e8-77c7fc7cf858_base_resized.jpg -- works
            //   https://booth.pximg.net/3c32475d-0f04-4157-b5bb-6a56cd5d633f/i/178794/1174b9d1-9f8a-4525-88e8-77c7fc7cf858_base_resized.jpg -- works
            //   https://booth.pximg.net/3c32475d-0f04-4157-b5bb-6a56cd5d633f/i/178794/1174b9d1-9f8a-4525-88e8-77c7fc7cf858.jpg -- 404
            newsrc = src.replace(/(:\/\/[^/]*\/)c\/[0-9]+x[0-9]+(?:_[^/]*)?\//, "$1");
            if (newsrc !== src)
                return newsrc;

            return src.replace(/(\/[-0-9a-f]+)_[^/.]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "cache-graphicslib.viator.com") {
            // http://cache-graphicslib.viator.com/graphicslib/media/e0/mt-vesuvius-photo_987616-770tall.jpg
            //   http://cache-graphicslib.viator.com/graphicslib/media/e0/mt-vesuvius-photo_987616-raw.jpg
            // https://cache-graphicslib.viator.com/graphicslib/thumbs360x240/2958/SITours/naples-shore-excursion-mt-vesuvius-half-day-trip-from-naples-in-naples-45216.jpg
            //   https://cache-graphicslib.viator.com/graphicslib/thumbs674x446/2958/SITours/naples-shore-excursion-mt-vesuvius-half-day-trip-from-naples-in-naples-45216.jpg
            //   https://cache-graphicslib.viator.com/graphicslib/2958/SITours/naples-shore-excursion-mt-vesuvius-half-day-trip-from-naples-in-naples-45216.jpg -- smaller
            // https://cache-graphicslib.viator.com/graphicslib/mm/28/the-original-london-sightseeing-tour-hop-on-hop-off-156128-raw.jpg
            // https://cache-graphicslib.viator.com/graphicslib/mm/83/i-amsterdam-card-city-pass-for-amsterdam-155183-raw.jpg
            return {
                url: src.replace(/([-_][0-9]+)-[^-_/.]*(\.[^/.]*)$/, "$1-raw$2"),
                head_wrong_contentlength: true
            };
        }

        if (domain === "igx.4sqi.net") {
            // https://igx.4sqi.net/img/general/200x200/14154508__KFDGWAVvjjTcK6pEKNuQER_10kmzcBR7eU3BWbYGG4.jpg
            //   https://igx.4sqi.net/img/general/original/14154508__KFDGWAVvjjTcK6pEKNuQER_10kmzcBR7eU3BWbYGG4.jpg
            return src.replace(/\/img\/general\/[^/]*\//, "/img/general/original/");
        }

        if (domain === "static.panoramio.com" ||
            // http://commondatastorage.googleapis.com/static.panoramio.com/photos/small/43008410.jpg -- same as below
            //   http://commondatastorage.googleapis.com/static.panoramio.com/photos/original/43008410.jpg -- doesn't work, "Anonymous caller does not have storage.objects.get access to ..."
            // https://static.panoramio.com.storage.googleapis.com/photos/large/8327198.jpg
            //   https://static.panoramio.com.storage.googleapis.com/photos/original/8327198.jpg
            googlestorage_container === "static.panoramio.com") {
            //(domain === "commondatastorage.googleapis.com" && src.match(/:\/\/[^/]*\/static\.panoramio\.com\//))) {
            // http://static.panoramio.com/photos/small/6106783.jpg
            // http://static.panoramio.com/photos/large/6106783.jpg
            // http://static.panoramio.com/photos/original/6106783.jpg
            return src.replace(/\/photos\/[^/]*\//, "/photos/original/");
        }

        if (domain_nosub === "myportfolio.com" && domain.match(/.*cdn.*\.myportfolio\.com$/)) {
            // https://pro2-bar-s3-cdn-cf.myportfolio.com/4b7b32c34c99b966ad6f0ba84341a0df/8c698e4c5561ed288f2350a6_rw_3840.jpg?h=ec899b0e004e5d1cd5bcf474b259302d
            //   https://pro2-bar-s3-cdn-cf.myportfolio.com/4b7b32c34c99b966ad6f0ba84341a0df/8c698e4c5561ed288f2350a6.jpg
            //   https://pro2-bar.myportfolio.com/v1/assets/4b7b32c34c99b966ad6f0ba84341a0df/8c698e4c5561ed288f2350a6.jpg -- hash is required
            // https://pro2-bar-s3-cdn-cf2.myportfolio.com/fc87a328b5563b3948ee90b56bb47c80/df42aa71-c29a-4ccb-b40d-70e9f87872bf_car_202x158.jpg?h=8332ff2d4ba2a81d4cd8957d4a8f9d85
            //   https://pro2-bar-s3-cdn-cf2.myportfolio.com/fc87a328b5563b3948ee90b56bb47c80/df42aa71-c29a-4ccb-b40d-70e9f87872bf_car_202x158.jpg - still works
            //   https://pro2-bar.myportfolio.com/v1/assets/fc87a328b5563b3948ee90b56bb47c80/df42aa71-c29a-4ccb-b40d-70e9f87872bf_car_202x158.jpg -- hash is required
            //   https://pro2-bar-s3-cdn-cf2.myportfolio.com/fc87a328b5563b3948ee90b56bb47c80/df42aa71-c29a-4ccb-b40d-70e9f87872bf.jpg:
            //     https://pro2-bar.myportfolio.com/v1/assets/fc87a328b5563b3948ee90b56bb47c80/df42aa71-c29a-4ccb-b40d-70e9f87872bf.jpg -- hash is required
            // https://pro2-bar-s3-cdn-cf2.myportfolio.com/fc703cfcf746a4d9e06fa9a2d703067c/d454466e-51ca-4b6e-8714-04bcec8991e5_rw_1200.jpg
            //   https://pro2-bar-s3-cdn-cf2.myportfolio.com/fc703cfcf746a4d9e06fa9a2d703067c/d454466e-51ca-4b6e-8714-04bcec8991e5.jpg -- redirects to:
            //   https://pro2-bar.myportfolio.com/v1/assets/fc703cfcf746a4d9e06fa9a2d703067c/d454466e-51ca-4b6e-8714-04bcec8991e5.jpg -- hash is required
            return src.replace(/_rw_[0-9]+(\.[^/.?]*)(?:\?.*)?$/, "$1");
        }

        if (domain === "i.dell.com") {
            // http://i.dell.com/das/xa.ashx/global-site-design%20web/00000000-0000-0000-0000-000000000000/1/LargePNG?id=Dell/Product_Images/Dell_Client_Products/Desktops/Inspiron_Desktops/Inspiron_3250_SFF/global_spi/desktop-inspiron-3250-small-form-factor-black-right-hero-504x350.psd
            //   http://i.dell.com/das/xa.ashx/global-site-design%20web/00000000-0000-0000-0000-000000000000/1/originalpng?id=Dell/Product_Images/Dell_Client_Products/Desktops/Inspiron_Desktops/Inspiron_3250_SFF/global_spi/desktop-inspiron-3250-small-form-factor-black-right-hero-504x350.psd
            // http://i.dell.com/sites/imagecontent/app-merchandizing/responsive/HomePage/en/PublishingImages/22437-home-desktop-inspiron-3650-silver-3656-red-150x120.png
            // http://i.dell.com/das/dih.ashx/189w/das/xa_____/global-site-design%20web/c09863ef-2675-4682-0704-6dc976226db3/1/originalpng?id=Dell/Product_Images/Dell_Client_Products/Desktops/Inspiron_Desktops/Inspiron_3250_SFF/global_spi/desktop-inspiron-3250-small-form-factor-black-left-bestof-500-ng.psd
            // http://si.cdn.dell.com/sites/imagecontent/consumer/merchandizing/en/publishingimages/24031-desktop-inspiron-3268-169x121.png
            return src.replace(/(\/(?:[0-9a-f]+-){4}[0-9a-f]+\/[0-9]+\/)LargePNG/, "$1originalpng");
        }

        if (domain === "thumb.zumst.com") {
            // http://thumb.zumst.com/530x0/http://static.news.zumst.com/images/23/2018/03/09/73abd6e986ec4160b1e9a8459532eed2.jpg
            //   http://static.news.zumst.com/images/23/2018/03/09/73abd6e986ec4160b1e9a8459532eed2.jpg
            // http://news.zum.com/articles/5254413
            //   http://static.news.zum.com/images/18/2013/01/18/20130118_1358493810.jpg - 2132x2845
            return src.replace(/.*:\/\/[^/]*\/[0-9]+[^/]*\//, "");
        }

        if (domain === "file.mk.co.kr") {
            // http://file.mk.co.kr/meet/2018/03/image_listtop_2018_156502_1520579288.jpg.thumb
            //   http://file.mk.co.kr/meet/2018/03/image_listtop_2018_156502_1520579288.jpg - slightly larger
            //   http://file.mk.co.kr/meet/2018/03/image_readtop_2018_156502_1520578294.jpg
            return src
                .replace(/\.thumb$/, "");
        }

        if (domain === "kobis.or.kr") {
            // http://kobis.or.kr/common/mast/movie/2016/04/thumb/thn_4ddde64e76f64663998f4123ae837fcc.jpg
            //   http://kobis.or.kr/common/mast/movie/2016/04/4ddde64e76f64663998f4123ae837fcc.jpg
            return src.replace("/thumb/thn_", "/");
        }

        if (domain === "www.breaknews.com" ||
            domain === "breaknews.com") {
            // http://www.breaknews.com/data/breaknews_com/mainimages/201803/2018020713038427.jpg
            //   http://www.breaknews.com/imgdata/breaknews_com/201802/2018020713038427.jpg
            // http://www.breaknews.com/sub_read.html?uid=488764&section=sc4
            //   http://www.breaknews.com/imgdata/breaknews_com/201701/2017012752287231.jpg - 2000x3159
            // http://breaknews.com/data/breaknews_com/mainimages/201803/2018030742107604.jpg
            // doesn't always work:
            // http://breaknews.com/data/breaknews_com/mainimages/201803/2018030742107604.jpg
            //   http://www.breaknews.com/imgdata/breaknews_com/201803/2018030742107604.jpg -- doesn't work
            //   http://www.breaknews.com/imgdata/breaknews_com/201803/2018030604302058.jpg -- works
            // http://breaknews.com/data/breaknews_com/mainimages/201803/2017090815222839.jpg
            //   http://breaknews.com/imgdata/breaknews_com/201709/2017090815222839.jpg -- works (not a problem with www.)
            return src.replace(/\/data\/([^/]*)\/mainimages\/[0-9]*\/([0-9]{6})/, "/imgdata/$1/$2/$2");
        }

        if (domain_nowww === "ilyo.co.kr" ||
            // http://www.ohfun.net/contents/article/images/2014/0925/thm200_1411630979197969.jpg
            //   http://www.ohfun.net/contents/article/images/2014/0925/1411630979197969.jpg
            domain_nowww === "ohfun.net") {
            // http://ilyo.co.kr/contents/article/images/2015/0306/thm200_1425610033458142.jpg
            //   http://ilyo.co.kr/contents/article/images/2015/0306/1425610033458142.jpg - 1788x2698
            return src.replace(/\/thm[0-9]+_/, "/");
        }

        if (domain === "www.joseilbo.com") {
            // http://www.joseilbo.com/gisa_img_origin/15090052681509005268_yumju423_origin.jpg - 5312x2988
            // http://www.joseilbo.com/gisa_img/1518397320.thumbnail.jpg
            //   http://www.joseilbo.com/gisa_img/1518397320.jpg
            // http://www.joseilbo.com/gisa_img/15199713541519971354_kiruki54.jpg
            //   http://www.joseilbo.com/gisa_img_origin/15199713541519971354_kiruki54_origin.jpg
            // http://www.joseilbo.com/xml/racing/image/6f1f52ac11d533a84f41705a5f09411f.thumbnail.jpg
            //   http://www.joseilbo.com/xml/racing/image/6f1f52ac11d533a84f41705a5f09411f.jpg
            return src
                .replace(/\.thumbnail(\.[^/.]*)$/, "$1")
                .replace(/\/gisa_img\/([0-9]+_[^/._]+)(\.[^/.]*)$/, "/gisa_img_origin/$1_origin$2");
        }

        if (domain_nosub === "phncdn.com") {
            // https://ci.phncdn.com/pics/albums/000/430/541/4503569/(m=eiJ_8b)(mh=EvXtHOjNcliZ7ja0)original_4503569.jpg
            //   https://ci.phncdn.com/pics/albums/000/430/541/4503569/original_4503569.jpg
            return add_extensions_gif(src.replace(/\/(?:\([a-z]+=[^/)]*\))*([^/]*)$/, "/$1"));
        }

        if (domain_nosub === "t8cdn.com") {
            // https://ei1.t8cdn.com/201707/10/37854111/originals/1(m=eqw4mgaaaa).jpg
            //   https://ei1.t8cdn.com/201707/10/37854111/originals/1.jpg
            return src.replace(/(\/originals\/[0-9]+)(?:\([a-z]+=[^/)]*\))*([^/]*)$/, "$1$2");
        }

        if (domain === "img.fril.jp") {
            // https://img.fril.jp/img/102398107/s/288867076.jpg?1506827930
            // l, m, s
            return src.replace(/\/[a-z]\/([^/]*)$/, "/l/$1");
        }

        if (domain === "img.cinematoday.jp") {
            // https://img.cinematoday.jp/a/E0000548/_size_c640x/_v_1337344420/18.JPG
            //   https://img.cinematoday.jp/a/E0000548/_v_1337344420/18.JPG
            // https://img.cinematoday.jp/res/GA/2015/0725_05/v1437812942/DSC_0027-cx.JPG
            //   https://img.cinematoday.jp/res/GA/2015/0725_05/v1437812942/DSC_0027.JPG
            // http://img.cinematoday.jp/res/GA/2014/0712_02/v1405139653/IMG_2930-x.JPG
            // https://img.cinematoday.jp/a/E0010088/_size_1200x/_v_1473853900/19.jpg
            // https://img.cinematoday.jp/res/GA/2015/1028_08/v1446033979/07-0x0.JPG
            //   https://img.cinematoday.jp/res/GA/2015/1028_08/v1446033979/07.JPG
            // http://s.cinematoday.jp/res/N0/04/86/v1355451846/N0048658_l.jpg
            //   http://s.cinematoday.jp/res/N0/04/86/v1355451846/N0048658.jpg -- smaller
            //   https://img.cinematoday.jp/res/N0/04/86/v1355451846/N0048658.jpg -- same
            // https://img.cinematoday.jp/res/GA/2016/0624_01/v1466737624/IMG_1177-560x600.JPG
            // https://img.cinematoday.jp/a/A0005070/_size_/_v_1469826000/11.jpg
            // https://img.cinematoday.jp/a/E0011605/_size_c640x/_v_1499569440/02.jpg
            return src
                .replace(/-[a-z0-9]*x[a-z0-9]*(\.[^/.]*)$/, "$1")
                .replace(/\/_size_[^/]*\//, "/");
        }

        if (domain_nosub === "seesaa.net") {
            // http://flamant.up.seesaa.net/image/1981AAA9-2780-4445-8DF7-C72FA57A6738-thumbnail2.jpg
            //   http://flamant.up.seesaa.net/image/1981AAA9-2780-4445-8DF7-C72FA57A6738.jpg
            return src.replace(/-thumbnail[0-9]*(\.[^/.]*)$/, "$1");
        }

        if (false && domain_nosub === "biglobe.ne.jp") {
            // wip
            // https://news.biglobe.ne.jp/entertainment/1227/5332001629/nrn_2016-12-27-050012_thum630.jpg
            // https://news.biglobe.ne.jp/animal/0309/8840287090/pec_301481_thum500.png
            // removing thum[0-9]* makes it smaller
        }

        if (domain_nosub === "ledevoir.com" && domain.match(/media[0-9]*\.ledevoir\.com/)) {
            // http://media2.ledevoir.com/images_galerie/nwl_602637_453756/image.jpg
            //   http://media2.ledevoir.com/images_galerie/nwdp_602637_453756/image.jpg
            // http://media1.ledevoir.com/images_galerie/nwlb_602533_453783/image.jpg
            //   http://media1.ledevoir.com/images_galerie/nwdp_602533_453783/image.jpg
            // http://media2.ledevoir.com/images_galerie/1_453723/le-coup-de-crayon-du-10-mars.jpg
            //   http://media2.ledevoir.com/images_galerie/nwdp_1_453723/le-coup-de-crayon-du-10-mars.jpg
            // http://media1.ledevoir.com/images_galerie/app_1_452365/le-coup-de-crayon-du-7-mars.jpg
            //   http://media1.ledevoir.com/images_galerie/nwdp_1_452365/le-coup-de-crayon-du-7-mars.jpg
            return src.replace(/\/images_galerie\/(?:[^-/._]*_)?([0-9]+_[0-9]+)\//, "/images_galerie/nwdp_$1/");
        }

        if (domain === "infotel.ca") {
            // https://infotel.ca/news/medialibrary/image/hl-mediaitemid50826-1365.jpg
            //   https://infotel.ca/news/medialibrary/image/hd-mediaitemid50826-1365.jpg
            //   https://infotel.ca/news/medialibrary/image/orig-mediaitemid50826-1365.jpg
            return src.replace(/\/medialibrary\/image\/[^-_/.]*-/, "/medialibrary/image/orig-");
        }

        if ((domain === "www.eleconomista.com.mx" && src.indexOf("/img/") >= 0) ||
            // https://www.informador.mx/__export/1531502739399/sites/elinformador/img/2018/07/13/iceberg_en_groenlandia_efe_k__petersen_crop1531502120593.jpg_195882809.jpg
            //   https://www.informador.mx/__export/1531502739399/sites/elinformador/img/2018/07/13/iceberg_en_groenlandia_efe_k__petersen_crop1531502120593.jpg
            (domain_nowww === "informador.mx" && src.indexOf("/img/") >= 0) ||
            // https://www.eldeber.com.bo/__export/1531611838470/sites/eldeber/img/2018/07/14/_102530719_mediaitem102524830.jpg_1739845681.jpg
            //   https://www.eldeber.com.bo/__export/1531611838470/sites/eldeber/img/2018/07/14/_102530719_mediaitem102524830.jpg
            (domain_nowww === "eldeber.com.bo" && src.indexOf("/img/") >= 0) ||
            // https://www.chispa.tv/__export/1531501223040/sites/debate/img/2018/07/13/el-iceberg-puede-generar-un_0_64_1259_784.jpg_497593902.jpg
            //   https://www.chispa.tv/__export/1531501223040/sites/debate/img/2018/07/13/el-iceberg-puede-generar-un_0_64_1259_784.jpg
            (domain_nowww === "chispa.tv" && src.indexOf("/img/") >= 0) ||
            // https://www.debate.com.mx/export/sites/debate/img/2016/12/02/rr.jpg_854719774.jpg -- stretched?
            //   https://www.debate.com.mx/export/sites/debate/img/2016/12/02/rr.jpg
            // https://www.debate.com.mx/__export/1520548870968/sites/debate/img/2018/03/08/ramal_1_crop1520548767730.jpg_1425355029.jpg
            //   https://www.debate.com.mx/__export/1520548870968/sites/debate/img/2018/03/08/ramal_1_crop1520548767730.jpg
            (domain_nowww === "debate.com.mx" && src.indexOf("/img/") >= 0) ||
            // https://www.diarioshow.com/export/sites/cronica/img/2018/05/19/asia_argento.jpg_515674892.jpg
            //   https://www.diarioshow.com/export/sites/cronica/img/2018/05/19/asia_argento.jpg
            (domain_nowww === "diarioshow.com" && src.indexOf("/img/") >= 0) ||
            // https://wp.eldeber.com.bo/__export/1523667548231/sites/eldeber/img/2018/04/13/poster-tour-eiffel-jour-nuit.jpg_1775534641.jpg
            //   https://wp.eldeber.com.bo/__export/1523667548231/sites/eldeber/img/2018/04/13/poster-tour-eiffel-jour-nuit.jpg
            (domain === "wp.eldeber.com.bo" && src.indexOf("/img/") >= 0) ||
            // https://www.tribuna.com.mx/export/sites/tribuna/img/2018/08/06/3_1.jpg_498273042.jpg
            //  https://www.tribuna.com.mx/export/sites/tribuna/img/2018/08/06/3_1.jpg
            (domain_nowww === "tribuna.com.mx" && src.indexOf("/img/") >= 0) ||
            // https://laverdadnoticias.com/__export/1514576574761/sites/laverdad/img/2017/12/29/camila_cabello.jpg_2024461655.jpg
            //   https://laverdadnoticias.com/__export/1514576574761/sites/laverdad/img/2017/12/29/camila_cabello.jpg
            (domain === "laverdadnoticias.com" && src.indexOf("/img/") >= 0)) {
            // https://www.eleconomista.com.mx/__export/1518538244604/sites/eleconomista/img/2018/02/13/mario_draghi.jpg_332989735.jpg
            //   https://www.eleconomista.com.mx/__export/1518538244604/sites/eleconomista/img/2018/02/13/mario_draghi.jpg
            return src.replace(/(\/[^/.]*\.[^/._]*)_[^/.]*\.[^/.]*$/, "$1");
        }

        if (domain === "gcm-v2.omerlocdn.com") {
            // https://gcm-v2.omerlocdn.com/production/global/files/image/16c89c8b-58a1-490f-b9a6-323adb16ca75_1024.jpg
            //   https://gcm-v2.omerlocdn.com/production/global/files/image/16c89c8b-58a1-490f-b9a6-323adb16ca75.jpg
            return src.replace(/_[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "www.dailystar.com.lb" ||
            domain === "dailystar.com.lb") {
            // https://www.dailystar.com.lb/dailystar/Comics/23-02-2018/7cartoon%20New%20maths%20teacher_636549414776995725_main.jpg
            //   https://www.dailystar.com.lb/dailystar/Comics/23-02-2018/7cartoon%20New%20maths%20teacher_636549414776995725.jpg
            // http://www.dailystar.com.lb/dailystar/Pictures/2011/06/27/SaudiSpecialForces03_634448139672228001_img900x550_img900x550_crop.jpg
            //   http://www.dailystar.com.lb/dailystar/Pictures/2011/06/27/SaudiSpecialForces03_634448139672228001.jpg
            // http://www.dailystar.com.lb/dailystar/Pictures/2011/05/06/Mirna-Chaker-Jeita-Grotto-4_634403009433363875_img900x550_img900x550_crop.jpg
            // http://www.dailystar.com.lb/dailystar/Pictures/2011/07/04/13_634453800140116703_img900x550_img900x550_crop.jpg
            // http://www.dailystar.com.lb/dailystar/Pictures/2018/01/11/669500_img900x550_img900x550_crop.jpg
            //   http://www.dailystar.com.lb/dailystar/Pictures/2018/01/11/669500.jpg
            // http://www.dailystar.com.lb/dailystar/Pictures/2015/04/27/411756_img900x550_img900x550_crop.jpg
            //   http://www.dailystar.com.lb/dailystar/Pictures/2015/04/27/411756.jpg
            // http://www.dailystar.com.lb/dailystar/Pictures/2014/02/26/253362_img900x550_img900x550_crop.jpg
            //   http://www.dailystar.com.lb/dailystar/Pictures/2014/02/26/253362.jpg
            // http://www.dailystar.com.lb/dailystar/Pictures/2011/07/12/IMG_0080_634461096008782915_img900x550_img900x550_crop.JPG
            //   http://www.dailystar.com.lb/dailystar/Pictures/2011/07/12/IMG_0080_634461096008782915.JPG
            // https://dailystar.com.lb/dailystar/Pictures/2018/02/18/679287_img650x420_img650x420_crop.jpg
            //   https://dailystar.com.lb/dailystar/Pictures/2018/02/18/679287.jpg
            return src.replace(/([0-9]+)(?:_[^0-9][^/.]*)*(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "images.dailykos.com") {
            // https://images.dailykos.com/images/359004/story_image/2016_Comparison_of_Presidential_and_House_Election_Margins_-_Republican_Incumbents.png?1485791213
            //   https://images.dailykos.com/images/359004/original/2016_Comparison_of_Presidential_and_House_Election_Margins_-_Republican_Incumbents.png?1485791213
            // https://images.dailykos.com/images/402092/small/GettyImages-135785191.jpg?1495062293
            //   https://images.dailykos.com/images/402092/original/GettyImages-135785191.jpg?1495062293
            // https://images.dailykos.com/images/489359/small/GpfQTnJ_1_.gif?1514432636
            //   https://images.dailykos.com/images/489359/original/GpfQTnJ_1_.gif?1514432636
            // https://images.dailykos.com/avatars/363/small/image.jpg?1454078865
            //   https://images.dailykos.com/avatars/363/original/image.jpg?1454078865
            return src.replace(/(\/(?:images|avatars)\/[0-9]+\/)[^/]*\/([^/]*)$/, "$1original/$2");
        }

        // chevereto
        if (domain_nowww === "imgmax.com" ||
            domain_nowww === "404store.com" ||
            // https://www.imgpost.co.uk/images/2018/01/07/HagpiwP.md.jpg
            domain_nowww === "imgpost.co.uk" ||
            // http://ap.imagensbrasil.org/images/2017/07/26/3855442_orig.md.jpg
            domain === "ap.imagensbrasil.org" ||
            // https://www.picture-post.com/images/2018/01/15/701ddw_15.md.jpg
            domain_nowww === "picture-post.com" ||
            // http://stakimages.me/images/2018/07/08/DAZn.md.jpg
            domain_nowww === "stakimages.me" ||
            // https://imgsnap.com/images/2017/07/13/victoria-justice-out-and-about-on-broadway-in-new-york-06-21-2017_1.md.jpg
            domain_nowww === "imgsnap.com" ||
            // http://img.imgmax.com/images/2018/02/11/Q6tWj.th.jpg
            domain === "img.imgmax.com" ||
            // https://imgpile.com/images/nnHvi2.md.jpg
            domain_nowww === "imgpile.com" ||
            // https://i.img.ie/uST.md.jpg
            domain === "i.img.ie" ||
            // https://i.lensdump.com/i/8UiN2c.md.jpg
            domain === "i.lensdump.com" ||
            // https://img.faploads.com/2018/06/21/Mandy-Moore-223.md.jpg
            domain === "img.faploads.com" ||
            // http://celebact.org/images/2017/03/09/DakotaFanning.4.th.jpg
            (domain_nowww === "celebact.org" && src.indexOf("/images/") >= 0) ||
            // https://imghost.io/images/2018/06/15/11.md.jpg
            domain_nosub === "imghost.io" ||
            // http://s18.img26.com/2018/04/22/127_Page_15.md.jpg
            domain_nosub === "img26.com" ||
            // http://cheapesthosting.xyz/i/images/2018/03/11/bHlx.th.jpg
            (domain_nowww === "cheapesthosting.xyz" && src.indexOf("/i/images/") >= 0) ||
            // http://www.s4tu.com/images/2018/08/01/289571b.md.jpg
            domain_nowww === "s4tu.com" ||
            // http://image-bugs.com/images/2017/09/09/CelebsFlash.com_NP_Harpers_Bazaar_090817__3_.md.jpg
            domain_nowww === "image-bugs.com") {
            // http://imgmax.com/images/2017/03/20/0OQhE.th.jpg
            //   http://imgmax.com/images/2017/03/20/0OQhE.jpg
            // https://404store.com/2017/11/12/b1Ik9Cj-emma-watson-wallpapers.th.jpg
            // https://404store.com/2017/05/18/wc1715233.md.jpg
            return src.replace(/\.(?:th|md)(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "cheapesthosting.xyz") {
            // http://cheapesthosting.xyz/upload/small/2018/03/06/5a9e9814dbc47.jpeg
            //   http://cheapesthosting.xyz/upload/big/2018/03/06/5a9e9814dbc47.jpeg
            return src.replace(/\/upload\/[a-z]+(\/[0-9]+\/[0-9]+\/[0-9]+\/)/, "/upload/big$1");
        }

        if (domain === "static.maxmodels.pl") {
            // https://static.maxmodels.pl/photos/1/c/b8/1cb801e95b178afa97bd106362bdec15_320123_thumb.jpg
            //   https://static.maxmodels.pl/photos/1/c/b8/1cb801e95b178afa97bd106362bdec15_320123.jpg
            // https://static.maxmodels.pl/article/e/f/e/efe5e8884994e41861fa95c6b48f4723_thumb.jpg
            //   https://static.maxmodels.pl/article/e/f/e/efe5e8884994e41861fa95c6b48f4723.jpg
            if (src.indexOf("/photos/") >= 0 || src.indexOf("/article/") >= 0) {
                return src.replace(/_thumb(\.[^/.]*)$/, "$1");
            }

            if (src.indexOf("/profile/") >= 0) {
                // https://static.maxmodels.pl/profile/6/c/9/6c9fd60f434f2a06212844dc6c073bf0_428915_428915_tinythumb.jpg
                //   https://static.maxmodels.pl/profile/6/c/9/6c9fd60f434f2a06212844dc6c073bf0_428915_428915_profile.jpg
                return src.replace(/_[a-z]+(\.[^/.]*)$/, "_profile$1");
            }
        }

        if (domain_nosub === "img.yt") {
            // dead?
            // https://x001.img.yt/small/2015/04/19/5532fb62ba401.jpg
            //   https://x001.img.yt/big/2015/04/19/5532fb62ba401.jpg
            return src.replace("/small/", "/big/");
        }

        if (domain === "cdn.wallpaperjam.com") {
            // http://cdn.wallpaperjam.com/static/images/m/2b/35/2b359c913f740935e350c0b42c8c5b9da9804763.jpg
            //   https://cdn.wallpaperjam.com/2b359c913f740935e350c0b42c8c5b9da9804763/image.jpg
            return src.replace(/\/static\/images\/.*?\/([a-f0-9]+)(\.[^/.]*)$/, "/$1/image$2");
        }

        if (domain === "media.tabloidbintang.com") {
            // https://media.tabloidbintang.com/files/thumb/yoona-snsd_dira_2.jpg/1500
            //   https://media.tabloidbintang.com/files/yoona-snsd_dira_2.jpg
            // https://media.tabloidbintang.com/files/thumb/8bb22765c251c7b2741c1f69d06f2f93.jpg/222/140/fit
            return src.replace(/\/thumb\/([^/]*\.[^/.]*)(?:\/.*)/, "/$1");
        }

        if (domain === "media.teen.co.id") {
            // https://media.teen.co.id/files/thumb/tay6.jpg?p=trias93/&w=300&h=220&m=fit
            // https://media.teen.co.id/files/thumb/bianca_hello_4.jpg?p=trias93/&w=1024&m=fit
            //   https://media.teen.co.id/files/view/bianca_hello_4.jpg?p=trias93/
            return src.replace(/\/thumb\/([^/?]*\.[^/.?]*).*?[?&](p=[^&]*).*/, "/view/$1?$2");
        }

        if ((domain_nosub === "hudong.com" && domain.indexOf(".att.hudong.com") >= 0) ||
            // https://www.kaigai-drama-board.com/assets/medias/2017/12/20171224-getty_884684510_s.jpg
            (domain_nowww === "kaigai-drama-board.com" && src.indexOf("/assets/medias/") >= 0)) {
            // http://a0.att.hudong.com/62/10/20200000013920144739106585140_s.jpg
            //   http://a0.att.hudong.com/62/10/20200000013920144739106585140.jpg
            // http://a4.att.hudong.com/41/08/300022729906133502080921900_s.jpg
            //   http://a4.att.hudong.com/41/08/300022729906133502080921900.jpg
            newsrc = src.replace(/_s(\.[^/.]*)$/, "$1");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nosub === "hudong.com" && domain.indexOf(".att.hudong.com") >= 0) {
            // http://a4.att.hudong.com/21/51/01200000032935136113511508746_140.jpg
            //   http://a4.att.hudong.com/21/51/01200000032935136113511508746.jpg
            return src.replace(/_[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "ihanyu.com") {
            // http://www.ihanyu.com/cache/yiren/photo/0/2/130/2871.jpg
            //   http://www.ihanyu.com/uploadfile/yiren/photo/0/2/2871.jpg
            return src.replace(/\/cache\/([^/]*)\/([^/]*\/[0-9]+\/[0-9]+\/)[0-9]+\/([0-9]+\.[^/.]*)$/, "/uploadfile/$1/$2$3");
        }

        if (domain === "imgsh.jpnxcn.com" ||
            // http://gongl8.com/uploadfile/2018/0228/thumb_0_300_20180228054831686.jpg
            //   http://gongl8.com/uploadfile/2018/0228/20180228054831686.jpg
            domain_nowww === "gongl8.com" ||
            // http://upload.mcchina.com/2014/0908/thumb_600_800_1410147115827.jpg
            //   http://upload.mcchina.com/2014/0908/1410147115827.jpg
            domain === "upload.mcchina.com" ||
            // http://www.suanning.com/uploadfile/2015/0413/thumb_100_137_20150413011609783.jpg
            //   http://www.suanning.com/uploadfile/2015/0413/20150413011609783.jpg
            domain_nowww === "suanning.com" ||
            // http://upload.site.cnhubei.com/2015/0915/thumb_200_200_1442309977981.jpg
            //   http://upload.site.cnhubei.com/2015/0915/1442309977981.jpg
            domain === "upload.site.cnhubei.com" ||
            // http://www.artsbj.com/uploadfile/2018/0807/thumb_100_137_20180807020554237.jpg
            //   http://www.artsbj.com/uploadfile/2018/0807/20180807020554237.jpg
            domain_nowww === "artsbj.com" ||
            // https://img.94hnr.com/160711/thumb_600_0_38_162716_1.jpg
            //   https://img.94hnr.com/160711/38_162716_1.jpg
            domain === "img.94hnr.com" ||
            // http://m1.ablwang.com/uploadfile/2018/0430/thumb_110_69_20180430070256125.jpg
            //   http://m1.ablwang.com/uploadfile/2018/0430/20180430070256125.jpg
            (domain_nosub === "ablwang.com" && domain.match(/m[0-9]*\.ablwang\.com/))) {
            // http://imgsh.jpnxcn.com/pics/star/pic/thumb_180_0_5de4fc683a33a8e1731ecc044918e3b3.jpg
            //   http://imgsh.jpnxcn.com/pics/star/pic/5de4fc683a33a8e1731ecc044918e3b3.jpg
            return src.replace(/\/thumb_[0-9]+_[0-9]+_/, "/");
        }

        if (domain_nowww === "gaobei.com" &&
            src.indexOf("/upload/") >= 0) {
            // s resizes up, b seems to be original
            // http://www.gaobei.com/upload/10001/article/2018_03/12175401_ace4sg_s.jpg
            //   http://www.gaobei.com/upload/10001/article/2018_03/12175401_ace4sg_b.jpg
            // http://www.gaobei.com/upload/10001/article/2015_12/28013712_kmxwsc_b.jpg - 2000x3000
            // http://www.gaobei.com/upload/10001/article/2016_05/10175130_1f7z15_b.jpg
            //   http://www.gaobei.com/upload/10001/article/2016_05/10175130_1f7z15.jpg -- doesn't work
            // http://www.gaobei.com/upload/10001/article/2017_10/20220510_cesgua.jpg
            //   http://www.gaobei.com/upload/10001/article/2017_10/20220510_cesgua_b.jpg -- doesn't work
            return src.replace(/_[a-z](\.[^/.]*)$/, "_b$1");
        }

        if (domain_nosub === "pstatp.com" && domain.match(/[pi][a-z]?[0-9]*\.pstatp\.com/)) {
            // http://p3.pstatp.com/medium/30f1001008f9067618b8
            //   http://p3.pstatp.com/large/30f1001008f9067618b8
            //   http://p3.pstatp.com/origin/30f1001008f9067618b8
            // https://p3.pstatp.com/list/190x124/12340017b4ef97c42e83
            //   https://p3.pstatp.com/origin/12340017b4ef97c42e83
            // http://p9.pstatp.com/large/1234001893bf059b82cf -- desaturated slightly
            //   http://p9.pstatp.com/origin/1234001893bf059b82cf
            // https://pb1.pstatp.com/aweme/1080x1080/330a00018476bb9c1e8c.jpeg
            //   https://pb1.pstatp.com/origin/330a00018476bb9c1e8c.jpeg
            // http://pb3.pstatp.com/obj/v0201/e369221678f0420b91913850354a67ab
            //   http://pb3.pstatp.com/origin/v0201/e369221678f0420b91913850354a67ab
            // http://i0.pstatp.com/large/6ebf0008169e56582256
            //   http://i0.pstatp.com/origin/6ebf0008169e56582256
            return src.replace(/(:\/\/[^/]*\/)[a-z]*\/(?:[0-9]+x[0-9]+\/)?/, "$1origin/");
        }

        if (domain === "img-bcy-qn.pstatp.com") {
            // https://img-bcy-qn.pstatp.com/coser/8816/post/c0c4i/en6yuxycdg7zzcvublf3vnowstzelqh7.jpg/tl640 -- 640x640
            //   https://img-bcy-qn.pstatp.com/coser/8816/post/c0c4i/en6yuxycdg7zzcvublf3vnowstzelqh7.jpg -- 2976x3968
            // https://img-bcy-qn.pstatp.com/coser/8816/post/c0c4i/rguwkd8k1n1nxusj02riziiqof1ud9j2.jpg/2X2 -- 200x200
            //   https://img-bcy-qn.pstatp.com/coser/8816/post/c0c4i/rguwkd8k1n1nxusj02riziiqof1ud9j2.jpg -- 2976x3968
            // https://img-bcy-qn.pstatp.com/Public/Upload/avatar/48018/7821a87235884bdf98f24948ec407d93/fat.jpg/abig
            //   https://img-bcy-qn.pstatp.com/Public/Upload/avatar/48018/7821a87235884bdf98f24948ec407d93/fat.jpg -- upscaled? 500x500
            //   https://img-bcy-qn.pstatp.com/Public/Upload/avatar/48018/7821a87235884bdf98f24948ec407d93/small.jpg -- 30x30
            //   https://img-bcy-qn.pstatp.com/Public/Upload/avatar/48018/7821a87235884bdf98f24948ec407d93/big.jpg -- 150x150
            return src
                .replace(/(\/post\/[a-z0-9]+\/[a-z0-9]+\.[^/.]*)\/[^/]*(?:[?#].*)?$/, "$1")
                .replace(/(\/avatar\/[0-9]+\/[a-f0-9]+\/[^/]*\.[^/.]*)\/[^/]*(?:[?#].*)?$/, "$1");
        }

        if (domain === "img.jizy.cn") {
            // l, m, s
            // https://img.jizy.cn/img/m/276318
            //   https://img.jizy.cn/img/l/276318
            return src.replace(/\/img\/[a-z]\//, "/img/l/");
        }

        if (domain === "v.img.pplive.cn") {
            // http://v.img.pplive.cn/sp240/ac/70/ac70a84165ea6782446f267948a0cd4e/3.jpg.webp
            //   http://v.img.pplive.cn/ac/70/ac70a84165ea6782446f267948a0cd4e/3.jpg.webp
            return src.replace(/(:\/\/[^/]*\/)sp[0-9]+\//, "$1");
        }

        if (domain === "uploadfile.bizhizu.cn") {
            // http://uploadfile.bizhizu.cn/2015/0821/20150821111539262.jpg
            //   http://uploadfile.bizhizu.cn/2015/0821/20150821111539262.jpg.source.jpg
            // http://uploadfile.bizhizu.cn/2017/1014/f9ddc2a68f0f516dcdbdbc0a32a7d187.jpg
            //   https://uploadfile.bizhizu.cn/2017/1014/f9ddc2a68f0f516dcdbdbc0a32a7d187.jpg.source.jpg
            return src.replace(/(\/[0-9a-f]*\.)([^/.]*)$/, "$1$2.source.$2");
        }

        if (domain_nosub === "tgbusdata.cn" ||
            domain_nosub === "tuwandata.com") {
            // http://tv05.tgbusdata.cn/v3/thumb/jpg/YzhlMyw2MDAsNjAwLDQsMywxLC0xLDE=/u/shouji.tgbus.com/uploads/allimg/1508/17/3200-150QG32232.jpg
            //   http://shouji.tgbus.com/uploads/allimg/1508/17/3200-150QG32232.jpg
            // http://img2.tgbusdata.cn/v2/thumb/jpg/YzQ0NSw4MzAsNjQwLDQsMywxLC0xLDAscms1MA==/u/olpic.tgbusdata.cn/uploads/allimg/160324/238-160324160031.jpg
            //   http://olpic.tgbusdata.cn/uploads/allimg/160324/238-160324160031.jpg
            // http://img2.tgbusdata.cn/v2/thumb/jpg/MmIwZCw3MzAsNzMwLDQsMSwxLC0xLDAscms1MA==/u/olpic.tgbusdata.cn/uploads/allimg/121107/62-12110G34539.jpg
            //   http://olpic.tgbusdata.cn/uploads/allimg/121107/62-12110G34539.jpg
            // http://olpic.tgbusdata.cn/uploads/allimg/130415/62-1304151Q4110-L.jpg
            // http://ol04.tgbusdata.cn/v2/thumb/jpg/NmIxMSwwLDAsNCwzLDEsLTEsMCxyazUw/u/olpic.tgbusdata.cn/uploads/allimg/150408/144-15040QI505.jpg
            //   http://olpic.tgbusdata.cn/uploads/allimg/150408/144-15040QI505.jpg
            // http://img2.tgbusdata.cn/v2/thumb/jpg/NWM0NywwLDAsNCwzLDEsLTEsMCxyazUw/u/olpic.tgbusdata.cn/uploads/allimg/160321/274-160321115611.jpg
            //   http://olpic.tgbusdata.cn/uploads/allimg/160321/274-160321115611.jpg
            // http://img1.tuwandata.com/v2/thumb/all/NWI3OSw4MDEsMjAwLDQsMywxLC0xLDAsLCw5MA==/u/www.tuwan.com/uploads/allimg/1712/20/793-1G220135S0.jpg
            //   http://www.tuwan.com/uploads/allimg/1712/20/793-1G220135S0.jpg
            return src.replace(/.*\/thumb\/[^/]*\/[^/]*\/u\//, "http://");
        }

        if (domain_nowww === "dajiazhao.com") {
            // http://www.dajiazhao.com/uploads/allimg/180517/1-1P51G00459264-lp.jpg -- 240x135
            //   http://www.dajiazhao.com/uploads/allimg/180517/1-1P51G00459264.jpg -- 1920x1080
            return src.replace(/(\/uploads\/allimg\/[0-9]+\/[0-9]+-[0-9A-Z]+)(?:-lp)(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "www.renwenjun.com") {
            // http://www.renwenjun.com/uploads/allimg/170929/12012X635_lit.jpg
            //   http://www.renwenjun.com/uploads/allimg/170929/12012X635_0.jpg
            return src.replace(/_lit(\.[^/.]*)$/, "_0$1");
        }

        if (domain_nowww === "lrfczp.com") {
            // http://lrfczp.com/uploads/allimg/17090908/co1FZ9201H5-0_160_220.jpg
            //   http://lrfczp.com/uploads/allimg/17090908/co1FZ9201H5-0.jpg
            return src.replace(/_[0-9]+_[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "img-toutiao.mia.com") {
            // https://img-toutiao.mia.com/d78e5392e7c518f7870c4ef9941b9809_img@base@tag=imgScale&q=60
            return src.replace(/\&.*/, ""); // removing @ works, but forces download, and very big images have imgScale so it's probably fine
        }

        if (domain_nosub === "xeeok.com" && domain.indexOf("pic.xeeok.com") >= 0) {
            // http://spic.xeeok.com/uploads/20171228/201712281413013469/297453_001_s.jpg
            //   http://spic.xeeok.com/uploads/20171228/201712281413013469/297453_001.jpg
            // http://pic.xeeok.com/uploads/20170406/201704060839007259/257437_001.jpg
            // http://pic.xeeok.com/uploads/20171208/201712080649411660/11988_007_s1024.jpg
            //   http://pic.xeeok.com/uploads/20171208/201712080649411660/11988_007.jpg
            //
            // http://pic.xeeok.com/uploads/20170902/201709021724546130/9683_010.jpg -- 001 = first image in album, not size
            return src.replace(/_s[0-9]*(\.[^/.]*)$/, "$1");
        }

        if (domain === "img.laonanren.com" ||
            // http://cf.whl4u.jp/wh27/images/gallery/products/415t.jpg
            //   http://cf.whl4u.jp/wh27/images/gallery/products/415.jpg
            domain === "cf.whl4u.jp") {
            // https://img.laonanren.com/upload2/2015-02/15020914251864t.jpg
            //   https://img.laonanren.com/upload2/2015-02/15020914251864.jpg
            return src.replace(/t(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "xuite.net" && domain.indexOf(".share.photo.xuite.net") >= 0) {
            // https://4.share.photo.xuite.net/sm06059201/1469f4f/2721202/257867165_c.jpg
            // https://e.share.photo.xuite.net/esther1793/1e6a1d9/19835410/1124368327_x.jpg
            // https://7.share.photo.xuite.net/anber314/17e2d43/16287589/875503326_z.jpg (z > y, but y = 1.9mb, z = 900kb. larger, but a bit of quality is lost)
            // x and X are the same etc., o doesn't work
            // z, y, x, l, m, s, c, q, t (c is larger than x for gifs)
            return src.replace(/_[a-zA-Z](\.[^/.]*)$/, "_y$1");
        }

        if (domain === "img.sportsv.net") {
            // https://img.sportsv.net/img/ablheadline/cover/6/56/fit-fcc38HPLxU-1045x340.jpg
            //   https://img.sportsv.net/img/ablheadline/cover/6/56/fcc38HPLxU.jpg
            // https://img.sportsv.net/img/photo/image/5/78295/aspect-f3qjUcGTB2-1000xauto.jpg
            //   https://img.sportsv.net/img/photo/image/5/78295/f3qjUcGTB2.jpg
            // https://img.sportsv.net/img/photo/image/1/161211/tPkQGdrO3s.jpg
            return src.replace(/\/[a-z]+-([^-/]*)-[0-9a-z]*x[0-9a-z]*(\.[^/.]*)$/, "/$1$2");
        }

        if (domain_nosub === "espncdn.com") {
            // http://a3.espncdn.com/combiner/i?img=%2Fphoto%2F2017%2F0115%2Fr171425.jpg
            //   http://a3.espncdn.com/photo/2017/0115/r171425.jpg
            // http://a.espncdn.com/photo/2014/0615/nba_a_gindunc_288x162.jpg
            // http://a3.espncdn.com/photo/2016/0114/r44141_1296x729_16-9.jpg
            //   http://a3.espncdn.com/photo/2016/0114/r44141.jpg
            // http://a3.espncdn.com/combiner/i?img=%2Fphoto%2F2015%2F0429%2Fnba_g_crittenton1x_1296x729.jpg
            //   http://a3.espncdn.com/photo/2015/0429/nba_g_crittenton1x_1296x729.jpg
            // http://a3.espncdn.com/photo/2013/0209/nba_jordan_36.jpg
            // http://a.espncdn.com/photo/2012/0930/rn_georgiatennessee_ms_21.jpg
            // http://a.espncdn.com/photo/2013/0922/nfl_u_darnelldockett_cmg_600.jpg
            // http://a.espncdn.com/combiner/i?img=/i/headshots/nba/players/full/2968436.png&w=350&h=254
            //   http://a.espncdn.com/i/headshots/nba/players/full/2968436.png
            newsrc = decodeURIComponent(src.replace(/\/combiner\/i\?img=([^&]*).*/, "$1"));
            if (newsrc !== src)
                return newsrc;

            newsrc = src.replace(/(\/r[0-9]+)(?:_[^/.]*)(\.[^/.]*)$/, "$1$2");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nosub === "fc2.com" && domain.match(/blog-imgs-[0-9]*(?:-[^.]*)?.*\.fc2\.com/)) {
            // https://blog-imgs-118.fc2.com/s/h/i/shiomusubinokasu/20171212120106s.jpg
            //   https://blog-imgs-118-origin.fc2.com/s/h/i/shiomusubinokasu/20171212120106.jpg
            // https://blog-imgs-77-origin.fc2.com/t/r/e/trendbooks/IMG_0012_201804162120240e6s.jpg
            //   https://blog-imgs-77-origin.fc2.com/t/r/e/trendbooks/IMG_0012_201804162120240e6.jpg
            return src
                .replace(/:\/\/(blog-imgs-[0-9]*)\./, "://$1-origin.")
                .replace(/([/_][0-9]{8,}[^-/._]+)s(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "photos.hancinema.net" ||
            domain === "www.hancinema.net") {
            // https://photos.hancinema.net/photos/posterphoto679289.jpg
            //   https://photos.hancinema.net/photos/fullsizephoto679289.jpg
            // https://www.hancinema.net/photos/photo954334.jpg
            //   https://www.hancinema.net/photos/fullsizephoto954334.jpg
            return src.replace(/\/photos\/[a-z]*(photo[0-9]*\.[^/.]*)$/, "/photos/fullsize$1");
        }

        if (domain === "inimura.com" ||
            // https://www.celebritydresses.shop/image/cache/data/category_59/1133Lisa%20Rinna%20Red%20Sexy%20Prom%20Dress%20For%20Women%202009%20SAG%20Awards%20Red%20Carpet-800x800.jpg
            //   https://www.celebritydresses.shop/image/data/category_59/1133Lisa%20Rinna%20Red%20Sexy%20Prom%20Dress%20For%20Women%202009%20SAG%20Awards%20Red%20Carpet.jpg
            domain_nowww === "celebritydresses.shop" ||
            // http://www.customcelebritydresses.com/image/cache/data/02014-08-20/Rita-Ora-Red-Sexy-High-Slit-Backless-V-neck-Prom-Dress-MTV-VMAs-2014-Red-Carpet-600x600.jpg
            domain_nowww === "customcelebritydresses.com" ||
            // https://realistgold.com/Cart/image/cache/catalog/product_oldschoolgold-500x500.png -- stretched
            //    https://realistgold.com/Cart/image/catalog/product_oldschoolgold.png
            domain_nowww === "realistgold.com" ||
            // https://supersoccershop.com/image/cache/catalog/jersey-16-17/National%20team%2016-17/France/france-griezmann-jersey-2016-soccer-shirt-kit-maillot-600x600.jpg
            //   https://supersoccershop.com/image/catalog/jersey-16-17/National%20team%2016-17/France/france-griezmann-jersey-2016-soccer-shirt-kit-maillot.jpg
            domain_nowww === "supersoccershop.com" ||
            // http://cheap-promdresses.com/image/cache/catalog/160714/celebrity_dress_keira_knightley_grey_strapless_chiffon_gown_the_duchess_premiere...-228x380.jpg
            //   http://cheap-promdresses.com/image/catalog/160714/celebrity_dress_keira_knightley_grey_strapless_chiffon_gown_the_duchess_premiere....jpg
            domain_nowww === "cheap-promdresses.com" ||
            // http://www.weandestudio.com/image/cache/data/category_12/20180717105918738802368-200x200-product_list.jpg
            //   http://www.weandestudio.com/image/data/category_12/20180717105918738802368.jpg
            domain_nowww === "weandestudio.com" ||
            // https://www.black-leatherjacket.com/image/cache/data/Olive-green-leann-rimes-leather-jacket/olive-green-leather-jacket-900x900.jpg
            //   https://www.black-leatherjacket.com/image/data/Olive-green-leann-rimes-leather-jacket/olive-green-leather-jacket.jpg
            domain_nowww === "black-leatherjacket.com" ||
            // https://kpopultra.net/image/cache/catalog/bts-kpop-kawaii-harajuku/harajuku-fashion/swimwear-bikini/2/harajuku-swimwear-21-250x250.jpg
            //   https://kpopultra.net/image/catalog/bts-kpop-kawaii-harajuku/harajuku-fashion/swimwear-bikini/2/harajuku-swimwear-21.jpg
            domain_nowww === "kpopultra.net" ||
            domain_nowww === "honeydear.my") {
            // https://inimura.com/image/cache/catalog/product/lingerie/0068-01-270x360.jpg
            //   https://inimura.com/image/catalog/product/lingerie/0068-01.jpg
            // http://www.honeydear.my/image/cache/data/YW1031WH/213%20(4)-850x1300.jpg
            //   http://www.honeydear.my/image/data/YW1031WH/213%20(4).jpg
            return src.replace(/\/cache\/(.*)-[0-9]+x[0-9]*(?:-[a-z_]+)?(\.[^/.]*)$/, "/$1$2");
        }

        if (domain === "www.outlookweekly.net" &&
            src.indexOf("/images/") >= 0) {
            // http://www.outlookweekly.net/images/cfile5.uf.tistory.com/image/2338CD4D5312E8CF036158
            //   http://cfile5.uf.tistory.com/image/2338CD4D5312E8CF036158
            // http://www.outlookweekly.net/thumbnail/s/styles-and-latest-fashion-trends-on-krazyfashionrocksblogspotcom-32.jpeg
            return src.replace(/.*:\/\/[^/]*\/images\//, "http://");
        }

        if (domain === "www.cdn.tv2.no") {
            // http://www.cdn.tv2.no/images?imageId=8999096&width=3000
            return src.replace(/\/images.*?[?&]imageId=([0-9]+).*/, "/images?imageId=$1&height=-1");
        }

        if (domain === "media-spiceee.net") {
            // https://media-spiceee.net/uploads/content/image/828907/small_zzzzzzzzzzzzzzzzzzzzzzzz156.jpg
            //   https://media-spiceee.net/uploads/content/image/828907/large_zzzzzzzzzzzzzzzzzzzzzzzz156.jpg
            //   https://media-spiceee.net/uploads/content/image/828907/zzzzzzzzzzzzzzzzzzzzzzzz156.jpg
            // https://media-spiceee.net/uploads/article/image/36221/thumb_lg_ee41b4b3-5fc8-453d-b160-2fa8c3f2ee07.png
            //   https://media-spiceee.net/uploads/article/image/36221/ee41b4b3-5fc8-453d-b160-2fa8c3f2ee07.png
            // https://media-spiceee.net/uploads/shopper/product_image/extra_image/2086/thumb_a8.jpg
            //   https://media-spiceee.net/uploads/shopper/product_image/extra_image/2086/a8.jpg
            return src.replace(/\/(?:large|small|thumb_lg|thumb)_([^/]*)$/, "/$1");
        }

        if (domain_nowww === "vettri.net") {
            // http://www.vettri.net/gallery/celeb/emma_watson/2015-Time-100-Gala/thumb/Emma_Watson_2015Time100Gala_Vettri.Net-03_resize.jpg
            //   http://www.vettri.net/gallery/celeb/emma_watson/2015-Time-100-Gala/Emma_Watson_2015Time100Gala_Vettri.Net-03.jpg
            return src.replace(/\/thumb\/([^/]*)_resize(\.[^/.]*)$/, "/$1$2");
        }

        // PrestaShop
        if (domain === "www.tiarashop.eu" ||
            // http://streetstylestore.com/img/p/7/4/7/7/3/74773-home_default.jpg
            //   http://streetstylestore.com/img/p/7/4/7/7/3/74773.jpg
            domain === "streetstylestore.com" ||
            // https://cdn.poplook.com/15360-92883-large_default/lane-bubble-sleeve-blouse-dusty-teal.jpg
            domain === "cdn.poplook.com" ||
            // https://www.directgardening.com/878-large_default/forsythia.jpg
            domain === "www.directgardening.com" ||
            // https://kanedashop.com/6388-large_default/outlet-taito-anohana-naruko-anjou-anaru-figure-ano-hi-mita-hana-no-namae.jpg
            //   https://kanedashop.com/6388/outlet-taito-anohana-naruko-anjou-anaru-figure-ano-hi-mita-hana-no-namae.jpg
            domain_nowww === "kanedashop.com" ||
            // https://www.myamericanmarket.com/9477-large_default/kelloggs-super-mario-cereal.jpg
            domain === "www.myamericanmarket.com" ||
            // http://lapakfiguremiina.com/1071-thickbox_default/figma-tv-animation-black-rock-shooter-chariot-tv-animation-ver.jpg
            domain_nowww === "lapakfiguremiina.com" ||
            // https://media2.nin-nin-game.com/21296-pos_product/black-rock-shooter-dead-master-anime-ver-good-smile-comapny-fr.jpg
            (domain_nosub === "nin-nin-game.com" && domain.match(/^media[0-9]*\.nin/)) ||
            // https://adintime.com/844-large_default/marie-claire-arabia.jpg
            domain_nowww === "adintime.com" ||
            // http://shop.marymary.gr/7505-large_default/xyesil-forma.jpg.pagespeed.ic.o2bHh4izla.webp
            domain === "shop.marymary.gr" ||
            // http://flyhighstore.pl/2210-home_default/fh-cool-red-winter-jacket.jpg
            //   http://flyhighstore.pl/2210/fh-cool-red-winter-jacket.jpg
            domain === "flyhighstore.pl") {
            // https://www.tiarashop.eu/3412-home_default/o.jpg
            //   https://www.tiarashop.eu/3412/o.jpg
            return src
                .replace(/(:\/\/[^/]*\/img\/.*\/[0-9]*)[-_][^/.]*(\.[^/.]*)$/, "$1$2")
                .replace(/(:\/\/[^/]*\/[0-9]+(?:-[0-9]+)?)(?:[-_][^/]*?)?(\/[^/]*)$/, "$1$2");
        }

        if (domain === "skinzwearphotography.com") {
            // https://skinzwearphotography.com/prodMids/sexy-animal-print-boy-shorts-B78L-6517-F.jpg
            //   https://skinzwearphotography.com/prodImages/sexy-animal-print-boy-shorts-B78L-6517-F.jpg
            return src.replace(/\/prod[A-Z][a-z]*\//, "/prodImages/");
        }

        if (domain_nowww === "shelot.com") {
            // https://www.shelot.com/images/com_hikashop/upload/thumbnails/500x500f/0479_1199671901.jpg
            //   https://www.shelot.com/images/com_hikashop/upload/0479_1199671901.jpg
            //   https://www.shelot.com/images/BIKINI0400-0500/0479.jpg
            // https://www.shelot.com/images/com_hikashop/upload/thumbnails/500x500f/0480-5.jpg
            //   https://www.shelot.com/images/com_hikashop/upload/0480-5.jpg
            return src.replace(/\/upload\/thumbnails\/[0-9]+x[0-9]+[^/]*\//, "/upload/");
        }

        if (domain === "xo.lulus.com") {
            // https://xo.lulus.com/images/product/small-medium/2192052_408952.jpg
            //   https://xo.lulus.com/images/product/xlarge/2192052_408952.jpg
            //   https://xo.lulus.com/images/product/w_1.0/2192052_408952.jpg
            // https://xo.lulus.com/images/content/w_1.0/content_298_15400_holidaylanding02.jpg
            return src.replace(/(\/images\/[^/]*\/)[^/]*\/([^/]*)$/, "$1w_1.0/$2");
        }

        if (domain === "in-tense.se") {
            // http://in-tense.se/shop/thumbnails/shop/32353/art53/h1698/115801698-origpic-011d3c.jpg_0_0_100_100_405_654_85.jpg
            //   http://in-tense.se/shop/32353/art53/h1698/115801698-origpic-011d3c.jpg
            return src
                .replace(/\/thumbnails\/[^/]*\//, "/")
                .replace(/(\.[^/._])*_[^/]*$/, "$1");
        }

        if (domain === "image.brazilianbikinishop.com") {
            // https://image.brazilianbikinishop.com/images/products/cache_images/set-laplaya-aguas-do-mar-0_80_80_defined.jpg
            //   https://image.brazilianbikinishop.com/images/products/set-laplaya-aguas-do-mar-0.jpg
            return src.replace(/\/cache_images\/([^/_]*)_[^/.]*(\.[^/.]*)$/, "/$1$2");
        }

        if (domain === "greasyfork.org" &&
            src.search(/\/system\/screenshots\//) >= 0) {
            // https://greasyfork.org/system/screenshots/screenshots/000/010/208/thumb/Snipaste_2018-03-05_12-28-39.png?1520224343
            //   https://greasyfork.org/system/screenshots/screenshots/000/010/208/original/Snipaste_2018-03-05_12-28-39.png?1520224343
            return src.replace("/thumb/", "/original/");
        }

        if (domain === "i.embed.ly") {
            // https://i.embed.ly/1/display?key=fc778e44915911e088ae4040f9f86dcd&url=http://www.mixtapesaga.com/tapes/mixtape-covers/431.jpg
            //   http://www.mixtapesaga.com/tapes/mixtape-covers/431.jpg
            // https://i.embed.ly/1/display?key=fc778e44915911e088ae4040f9f86dcd&url=http%3A%2F%2Fis5.mzstatic.com%2Fimage%2Fthumb%2FMusic6%2Fv4%2F05%2Fd2%2Fdb%2F05d2db2b-a4a9-b1a4-53ef-36e192631a18%2Fsource%2F2400x2400bb.jpg
            // https://i.embed.ly/1/image?url=https%3A%2F%2Fscontent-iad3-1.cdninstagram.com%2Fvp%2Fbd3ac9237f46bffab2d0265b5e6c0cd7%2F5B335D8F%2Ft51.2885-15%2Fe35%2F25013144_505639503145174_6650174657859158016_n.jpg&key=fc778e44915911e088ae4040f9f86dcd
            return decodeURIComponent(src.replace(/.*\/(?:display|image).*?[?&]url=([^&]*).*/, "$1"));
        }

        if (domain === "i.genius.com") {
            // https://i.genius.com/1d14e3ce755b87a963559b9e1f888e097d194c9e?url=http%3A%2F%2Fis5.mzstatic.com%2Fimage%2Fthumb%2FMusic6%2Fv4%2F05%2Fd2%2Fdb%2F05d2db2b-a4a9-b1a4-53ef-36e192631a18%2Fsource%2F2400x2400bb.jpg
            return decodeURIComponent(src.replace(/.*\/[0-9a-f]+.*?[?&]url=([^&]*).*/, "$1"));
        }

        if (domain_nowww === "hdqwalls.com") {
            // http://www.hdqwalls.com/wallpapers/bthumb/victoria-justice-4-do.jpg
            //   http://www.hdqwalls.com/wallpapers/victoria-justice-4-do.jpg
            // http://hdqwalls.com/wallpapers/thumb/victoria-justice.jpg
            //   http://hdqwalls.com/wallpapers/victoria-justice.jpg
            // http://hdqwalls.com/wallpapers/thumb/emma-watson-16-pic.jpg
            //   http://hdqwalls.com/wallpapers/emma-watson-16-pic.jpg
            //
            // https://hdqwalls.com/camila-cabello-fotos-2017-wallpaper -- Original Resolution: 5792x4624
            // https://hdqwalls.com/walls/thumb/camila-cabello-fotos-2017-k0.jpg -- 200x300
            //   https://hdqwalls.com/wallpapers/thumb/camila-cabello-fotos-2017-k0.jpg -- 304x204
            //   https://hdqwalls.com/download/1/camila-cabello-fotos-2017-k0-5792x8688.jpg -- not cropped
            //   https://hdqwalls.com/download/1/camila-cabello-fotos-2017-k0-5792x9000.jpg -- 5792x9000, stretched
            //   https://hdqwalls.com/wallpapers/camila-cabello-fotos-2017-k0.jpg -- 5792x4624, but cropped
            // https://hdqwalls.com/download/camren-bicondova-2018-mp-1080x2160.jpg
            //   https://hdqwalls.com/wallpapers/camren-bicondova-2018-mp.jpg -- but cropped
            //   https://hdqwalls.com/download/1/camren-bicondova-2018-mp.jpg -- still cropped
            // http://hdqwalls.com/leslie-grace-5k-wallpaper
            //   http://hdqwalls.com/wallpapers/leslie-grace-5k-4v.jpg -- 6144x4096

            return src
                //.replace(/\/walls\/thumb\//, "/wallpapers/") //-- crops
                .replace(/\/wallpapers\/[a-z]?thumb\//, "/wallpapers/");
                //.replace(/\/wallpapers\//, "/download/")
                //.replace(/(\/download\/)([^/]*)-[0-9]+x[0-9]+(\.[^/.]*)$/, "$11/$2$3"); // still crops, and forces download
        }

        if (domain === "wallpaperclicker.com") {
            // http://wallpaperclicker.com/storage/Thumb/Emma-Watson-Hot-Photos-65420656.jpg
            //   https://wallpaperclicker.com/storage/wallpaper/Emma-Watson-Hot-Photos-65420656.jpg
            return src.replace(/\/storage\/Thumb\//, "/storage/wallpaper/");
        }

        if (domain_nosub === "prothomalo.com") {
            // http://en.prothomalo.com/contents/cache/images/300x0x1/uploads/media/2016/07/24/b2e9a47e2b605b04351f740d816b6bdc-Emmavv.jpg
            //   http://en.prothomalo.com/contents/uploads/media/2016/07/24/b2e9a47e2b605b04351f740d816b6bdc-Emmavv.jpg
            return src.replace(/\/cache\/images\/[0-9]+x[0-9]+(?:x[0-9]+)\//, "/");
        }

        if (domain === "c.tribune.com.pk") {
            // https://c.tribune.com.pk/2016/05/1101624-image-1462981240-590-640x480.JPG
            //   https://c.tribune.com.pk/2016/05/1101624-image-1462981240.JPG
            return src.replace(/-[0-9]+-[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "reutersmedia.net") {
            // https://s1.reutersmedia.net/resources/r/?m=02&d=20140708&t=2&i=924720732&r=LYNXMPEA670U0&w=900
            //   https://s1.reutersmedia.net/resources/r/?d=20140708&t=2&i=924720732
            // https://pictures.reuters.com/Doc/RTR/Media/TR3_UNWATERMARKED/d/5/8/2/RTS1NLQY.jpg
            // https://s3.reutersmedia.net/resources/r/?d=20180418&t=2&i=1252629147
            var querystr = src.replace(/.*\/r\/\?/, "&");
            var d = querystr.replace(/.*&d=([^&]*).*/, "$1");
            var t = "2";//querystr.replace(/.*&t=([^&]*).*/, "$1");
            i = querystr.replace(/.*&i=([^&]*).*/, "$1");
            return src.replace(/\/r\/\?.*/, "/r/?d=" + d + "&t=" + t + "&i=" + i);
        }

        if (domain === "r.fod4.com") {
            // https://r.fod4.com/c=ar16x9/s=w400,pd1/o=80/http://t.fod4.com/t/1a93d97833/c1920x1080_1.jpg
            //   http://t.fod4.com/t/1a93d97833/c1920x1080_1.jpg
            return src.replace(/^[a-z]*:\/\/[^/]*\/.*\/([a-z]*:\/\/)/, "$1");
        }

        if (domain === "p.fod4.com") {
            // http://p.fod4.com/p/media/ed608625ad/c=sq/s=w700/o=90/wAkqh8LKRVWWJohZfCCl_Screen%20Shot%202014-07-02%20at%207.03.49%20PM.png
            //   http://p.fod4.com/p/media/ed608625ad/wAkqh8LKRVWWJohZfCCl_Screen%20Shot%202014-07-02%20at%207.03.49%20PM.png
            // depends on repetition
            return src.replace(/(\/media\/[0-9a-f]+\/)[a-z]=[a-z0-9]+\//, "$1");
        }

        if (domain_nowww === "xdressy.com" ||
            // https://starcelebritydresses.com/uploads/product/1/R/1R284/dove-cameron-blush-lace-and-chiffon-short-sweet-16-dress-ted-baker-ss-2016-1-thumb.jpg
            domain_nowww === "starcelebritydresses.com") {
            // https://www.xdressy.com/uploads/product/1/R/1R550/emma-watson-vintage-queen-anne-neck-short-navy-cocktail-dress-lancome-dinner-1-thumb.jpg
            //   https://www.xdressy.com/uploads/product/1/R/1R550/emma-watson-vintage-queen-anne-neck-short-navy-cocktail-dress-lancome-dinner-1.jpg
            return src.replace(/-thumb(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "wallpaperflare.com" && src.indexOf("/static/") >= 0) {
            // https://www.wallpaperflare.com/static/691/945/100/leslie-grace-hot-5k-woman-wallpaper-preview.jpg
            //   https://www.wallpaperflare.com/static/691/945/100/leslie-grace-hot-5k-woman-wallpaper.jpg
            // https://www.wallpaperflare.com/static/532/54/508/rihanna-saturday-night-live-singer-face-wallpaper-thumb.jpg
            //   https://www.wallpaperflare.com/static/532/54/508/rihanna-saturday-night-live-singer-face-wallpaper.jpg
            return src.replace(/-(?:thumb|preview)(\.[^/.]*)$/, "$1");
        }

        if (domain === "cdn.store-assets.com") {
            // https://cdn.store-assets.com/s/5319/i/1058445_480x.jpeg
            //   https://cdn.store-assets.com/s/5319/i/1058445.jpeg
            return src.replace(/_[0-9]+x(?:[0-9]+)?(\.[^/.]*)$/, "$1");
        }

        if (domain === "img.shopperboard.com") {
            // https://img.shopperboard.com/1184938/5a20a29ecfdea-small.jpg
            //   https://img.shopperboard.com/1184938/5a20a29ecfdea.jpg
            return src.replace(/-[a-z]+(\.[^/.]*)$/, "$1");
        }

        // OpenCart
        if (domain_nowww === "i-aurai.com" ||
            // http://www.onesieponatime.com/image/cache/data/NHL%20Edmongton%20Oilers%20Onesie-500x500.jpg
            //   http://www.onesieponatime.com/image/data/NHL%20Edmongton%20Oilers%20Onesie.jpg
            domain_nowww === "onesieponatime.com" ||
            // http://ucanstarjob.com/image/cache/catalog/651525photo_1478496700262_m-600x600.product_main.jpg
            //   http://ucanstarjob.com/image/catalog/651525photo_1478496700262_m.jpg
            domain_nowww === "ucanstarjob.com" ||
            // https://www.malaysiadropship.com/image/creativeffects/image/cache/data/all_product_images/product-1707/1sexy-bikini-babydoll-yw672-536-850x1000-700x700.jpg
            //   https://www.malaysiadropship.com/image/creativeffects/image/data/all_product_images/product-1707/1sexy-bikini-babydoll-yw672-536-850x1000.jpg
            domain_nowww === "malaysiadropship.com") {
            // http://www.i-aurai.com/OpenCart/image/cache/data/demo/apple_cinema_30-80x80.jpg
            //   http://www.i-aurai.com/OpenCart/image/data/demo/apple_cinema_30.jpg
            return src.replace(/\/image\/cache\/([a-z]+)\/(.*)-[0-9]+x(?:[0-9]+)?(?:\.[a-z_]+)?(\.[^/.]*)$/, "/image/$1/$2$3");
        }

        if (domain_nosub === "gog.com" && domain.match(/images.*\.gog\.com/)) {
            // https://images-2.gog.com/859a7d00d0c0d46c8c4a215906479580f06837daa13d90837deba59ad51fdd8a_product_card_screenshot_112.jpg
            //   https://images-2.gog.com/859a7d00d0c0d46c8c4a215906479580f06837daa13d90837deba59ad51fdd8a.jpg
            return src.replace(/(\/[0-9a-f]*)_[^/.]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "www.destructoid.com") {
            // https://www.destructoid.com/ul/494427-AB-t.jpg
            //   https://www.destructoid.com//ul/494427-AB.jpg'); -- yes, not a typo
            //   https://www.destructoid.com//ul/494427-AB.jpg
            // https://www.destructoid.com/ul/493655-review-surviving-mars/DWawyA4XcAAHojb-noscale.jpg
            //   https://www.destructoid.com/ul/493655-review-surviving-mars/DWawyA4XcAAHojb.jpg
            // https://www.destructoid.com//ul/492359-h1-t.jpg
            //   https://www.destructoid.com//ul/492359-h1.jpg
            return src.replace(/-(?:t|noscale)(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "xboxlive.com" &&
            domain.match(/images.*\.xboxlive\.com/) &&
            src.match(/\/image\?/)) {
            // https://images-eds-ssl.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTc6mdXIF7EzzBzjbCi0PAFFm9oIFRURAIJY671mz65mpafwXTRitZCcs1mXngtlGKXGL6FtVwx1C9b1AIuJhv8KnSQBHdQ22A122Oh6Fpn5ncAYey7_nKGGXB7mkCs9jnrsclui.l_ItF9D7zgF8n0o3RXWpfe8IGE7Wkqn5ZMTac-&w=200&h=300&format=jpg
            //   https://images-eds-ssl.xboxlive.com/image?url=8Oaj9Ryq1G1_p3lLnXlsaZgGzAie6Mnu24_PawYuDYIoH77pJ.X5Z.MqQPibUVTc6mdXIF7EzzBzjbCi0PAFFm9oIFRURAIJY671mz65mpafwXTRitZCcs1mXngtlGKXGL6FtVwx1C9b1AIuJhv8KnSQBHdQ22A122Oh6Fpn5ncAYey7_nKGGXB7mkCs9jnrsclui.l_ItF9D7zgF8n0o3RXWpfe8IGE7Wkqn5ZMTac-
            newsrc = src.replace(/\/image[^/]?[?&]url=([^&]*).*/, "/image?url=$1");
            if (newsrc !== src)
                return newsrc;

            return {
                url: src,
                head_wrong_contenttype: true
            };
        }

        if (domain === "musicimage.xboxlive.com") {
            // https://musicimage.xboxlive.com/catalog/video.contributor.EF755600-0200-11DB-89CA-0019B92A3933/image?locale=en-CA&target=circle&mode=crop&q=90&h=373&w=373
            return {
                url: src.replace(/\/image\?.*/, "/image?locale=en-US"),
                can_head: false // GET, OPTIONS
            };
        }

        if (domain === "media.withtank.com") {
            // http://media.withtank.com/e077b4d7c8/img_6535_690_wide.jpg
            //   http://media.withtank.com/e077b4d7c8/img_6535.jpg
            // http://media.withtank.com/1d7cdaeb6c/bb_colour_swatch_720_wide.jpg
            //   http://media.withtank.com/1d7cdaeb6c/bb_colour_swatch.jpg
            return src.replace(/_[0-9]+_wide(\.[^/.]*)$/, "$1");
        }

        if (domain === "images.cdn.realviewdigital.com") {
            // http://images.cdn.realviewdigital.com/rvimageserver/Intimo%20Lingerie/The%20Intimo%20Opportunity/The%20Intimo%20Opportunity/page0000002.jpg?type=3&width=920&quality=70&v=v2
            //   http://images.cdn.realviewdigital.com/rvimageserver/Intimo%20Lingerie/The%20Intimo%20Opportunity/The%20Intimo%20Opportunity/page0000002.jpg?type=3
            var type = src.match(/[?&]type=([^&]*)/);
            return src.replace(/\?.*/, "?type=" + type[1]);
        }

        if (domain === "proxy.duckduckgo.com") {
            // https://proxy.duckduckgo.com/iu/?u=https%3A%2F%2Ftse1.mm.bing.net%2Fth%3Fid%3DOIP.-fIJ70TgJpidmW2R6qcp3QHaE1%26pid%3D15.1&f=1
            //   https://tse1.mm.bing.net/th?id=OIP.-fIJ70TgJpidmW2R6qcp3QHaE1
            return decodeURIComponent(src.replace(/.*\/iu\/.*?[?&]u=([^&]*).*/, "$1"));
        }

        // Mura CMS (http://www.getmura.com/)
        if (domain === "static.scientificamerican.com") {
            // https://static.scientificamerican.com/blogs/cache/file/95AC5EF1-B21C-4B68-8A6CA35ED072425A_medium.jpg?w=170&h=113&fit=crop
            //   https://static.scientificamerican.com/blogs/cache/file/95AC5EF1-B21C-4B68-8A6CA35ED072425A.jpg
            //   https://static.scientificamerican.com/blogs/cache/file/95AC5EF1-B21C-4B68-8A6CA35ED072425A_source.jpg
            // https://static.scientificamerican.com/sciam/cache/file/DD410F93-4B85-4031-90CEF95B8C722F36.jpg?w=590&h=393
            //   https://static.scientificamerican.com/sciam/cache/file/DD410F93-4B85-4031-90CEF95B8C722F36.jpg
            //   https://static.scientificamerican.com/sciam/cache/file/DD410F93-4B85-4031-90CEF95B8C722F36_source.jpg
            // https://static.scientificamerican.com/sciam/cache/file/6A6323ED-DC05-47CA-B132FF74AAEC4163_agenda.jpg?w=210&amp;h=140
            //   https://static.scientificamerican.com/sciam/cache/file/6A6323ED-DC05-47CA-B132FF74AAEC4163.jpg
            //   https://static.scientificamerican.com/sciam/cache/file/6A6323ED-DC05-47CA-B132FF74AAEC4163_source.jpg
            // https://static.scientificamerican.com/blogs/cache/file/95AC5EF1-B21C-4B68-8A6CA35ED072425A_small.jpg?fit=crop
            //   https://static.scientificamerican.com/blogs/cache/file/95AC5EF1-B21C-4B68-8A6CA35ED072425A.jpg
            //   https://static.scientificamerican.com/blogs/cache/file/95AC5EF1-B21C-4B68-8A6CA35ED072425A_source.jpg
            // https://static.scientificamerican.com/sciam/cache/file/E82AEBA1-0A06-4B0F-9B1CFF1CE6BD8745_source.png?w=220&amp;h=100
            //   https://static.scientificamerican.com/sciam/cache/file/E82AEBA1-0A06-4B0F-9B1CFF1CE6BD8745_source.png
            return src.replace(/(?:_[^/.]*)?(\.[^/.?]*)(?:\?.*)?$/, "_source$1");
        }

        if (domain_nosub === "qwant.com" && domain.match(/s[0-9]*\.qwant\.com/) &&
            src.indexOf("/thumbr/") >= 0) {
            // https://s1.qwant.com/thumbr/0x110/a/6/415e8905eb30e1a48a6374550f1852/b_1_q_0_p_0.jpg?u=https%3A%2F%2Fb.fssta.com%2Fuploads%2Fcontent%2Fdam%2Ffsdigital%2Ffscom%2Fnfl%2Fimages%2F2016%2F09%2F19%2F9034572-kyle-fuller-nfl-detroit-lions-chicago-bears.vresize.1200.630.high.0.jpg&q=0&b=1&p=0&a=0
            //   https://b.fssta.com/uploads/content/dam/fsdigital/fscom/nfl/images/2016/09/19/9034572-kyle-fuller-nfl-detroit-lions-chicago-bears.vresize.1200.630.high.0.jpg
            return decodeURIComponent(src.replace(/.*[?&]u=([^&]*).*/, "$1"));
        }

        if (domain === "b.fssta.com") {
            // https://b.fssta.com/uploads/content/dam/fsdigital/fscom/nfl/images/2016/09/19/9034572-kyle-fuller-nfl-detroit-lions-chicago-bears.vresize.1200.630.high.0.jpg -- stretched
            //   https://b.fssta.com/uploads/content/dam/fsdigital/fscom/nfl/images/2016/09/19/9034572-kyle-fuller-nfl-detroit-lions-chicago-bears.jpg
            return src.replace(/(\/[^/.]*)\.[^/]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "espn.com" && domain.match(/media\..*\.espn\.com$/)) {
            // http://media.video-cdn.espn.com/motion/2018/0316/dm_180316_ncb_bilas_on_buffalo/dm_180316_ncb_bilas_on_buffalo_default.jpg
            //   http://media.video-cdn.espn.com/motion/2018/0316/dm_180316_ncb_bilas_on_buffalo/dm_180316_ncb_bilas_on_buffalo.jpg
            return src.replace(/(\/[0-9]+\/[0-9]+\/)([^/]*)\/[^/]*(\.[^/.]*)$/, "$1$2\/$2$3");
        }

        if (domain === "img.skysports.com" ||
            domain_nosub === "365dm.com") {
            // http://img.skysports.com/18/02/768x432/skysports-matt-patricia-detroit-lions_4225501.jpg?20180208065403
            //   http://img.skysports.com/18/02/master/skysports-matt-patricia-detroit-lions_4225501.jpg?20180208065403
            // http://img.skysports.com/18/02/1-1/40/skysports-matt-patricia-detroit-lions_4225501.jpg?20180208065403
            //   http://img.skysports.com/18/02/master/skysports-matt-patricia-detroit-lions_4225501.jpg?20180208065403
            // http://e2.365dm.com/18/02/1-1/40/skysports-matt-patricia-detroit-lions_4225501.jpg?20180208065403
            //   http://e2.365dm.com/18/02/master/skysports-matt-patricia-detroit-lions_4225501.jpg?20180208065403
            return src.replace(/(:\/\/[^/]*\/[0-9]*\/[0-9]*\/)[^/]*\/(?:[0-9]*\/)?([^/]*)$/, "$1master/$2");
        }

        if (domain_nosub === "bcbits.com" &&
            domain.match(/f[0-9]*\.bcbits\.com/) &&
            src.indexOf("/img/") >= 0) {
            // https://f4.bcbits.com/img/0012903078_36.jpg
            //   https://f4.bcbits.com/img/0012903078_0.jpg
            return src.replace(/_[0-9]+(\.[^/.]*)$/, "_0$1");
        }

        if (domain_nosub === "motherlessmedia.com") {
            // http://cdn4.thumbs.motherlessmedia.com/thumbs/FDE845E-zoom.jpg?fs=opencloud
            //   http://cdn4.images.motherlessmedia.com/images/FDE845E.jpg
            return src
                .replace(/(:\/\/cdn[0-9]*\.)thumbs(\.motherlessmedia\.com\/)/, "$1images$2")
                .replace(/\/thumbs\//, "/images/")
                .replace(/-[a-z]*(\.[^/.?]*)(?:\?.*)?$/, "$1");
        }

        if (domain_nosub === "kiev.ua" &&
            domain.indexOf("shram.kiev.ua") >= 0 &&
            src.indexOf("/img/") >= 0) {
            // http://en.shram.kiev.ua/img/fun/emilia-clarke/Emilia_Clarke_2013-small.jpg
            //   http://en.shram.kiev.ua/img/fun/emilia-clarke/Emilia_Clarke_2013-big.jpg
            // http://en.shram.kiev.ua/img/fun/emilia-clarke/emilia-clarke2-w370.jpg
            //   http://en.shram.kiev.ua/img/fun/emilia-clarke/emilia-clarke2.jpg
            return src
                .replace(/-small(\.[^/.]*)$/, "-big$1")
                .replace(/-w[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (googlestorage_container === "cr-resource" &&
            src.indexOf("/image/") >= 0) {
            // http://storage.googleapis.com/cr-resource/image/5a1100e09ab0cc45cb108bbcd5d1238d/nosenter/800/151e456e844516e04e222d9d9487e79c.jpg
            //   http://storage.googleapis.com/cr-resource/image/5a1100e09ab0cc45cb108bbcd5d1238d/nosenter/151e456e844516e04e222d9d9487e79c.jpg
            return src.replace(/\/[0-9]+(\/[0-9a-f]*\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "iol.pt" &&
            src.indexOf("/multimedia/") >= 0) {
            // http://www.iol.pt/multimedia/oratvi/multimedia/imagem/id/13513489/800
            // http://www.iol.pt/multimedia/oratvi/multimedia/imagem/id/5903556c0cf2572470620c62/800
            // http://www.tvi24.iol.pt/multimedia/oratvi/multimedia/imagem/id/5734c40c0cf209b36b78bd3a/600.jpg
            // http://www.iol.pt/multimedia/oratvi/multimedia/imagem/id/13734488/600.5423278f3004574342d70571.jpg
            //   http://www.iol.pt/multimedia/oratvi/multimedia/imagem/id/13734488/
            return src.replace(/(\/id\/[0-9a-f]+)\/[0-9]+(?:\.[0-9a-f]+)?(?:\.[^/.]*)?$/, "$1");
        }

        if (domain === "img.purch.com") {
            // https://img.purch.com/w/660/aHR0cDovL3d3dy5saXZlc2NpZW5jZS5jb20vaW1hZ2VzL2kvMDAwLzAwMy8xMjQvb3JpZ2luYWwvMDkwNjA4LWNvcm4tc25ha2UtMDIuanBn -- mildly stretched
            //   https://img.purch.com/o/aHR0cDovL3d3dy5saXZlc2NpZW5jZS5jb20vaW1hZ2VzL2kvMDAwLzAwMy8xMjQvb3JpZ2luYWwvMDkwNjA4LWNvcm4tc25ha2UtMDIuanBn
            // https://img.purch.com/rc/317x177/aHR0cDovL3d3dy5saXZlc2NpZW5jZS5jb20vaW1hZ2VzL2kvMDAwLzA2MC84MzQvb3JpZ2luYWwvYW5jaWVudC1mYWJyaWMzLmpwZw==
            //   https://img.purch.com/o/aHR0cDovL3d3dy5saXZlc2NpZW5jZS5jb20vaW1hZ2VzL2kvMDAwLzA2MC84MzQvb3JpZ2luYWwvYW5jaWVudC1mYWJyaWMzLmpwZw==
            // https://img.purch.com/nxgl7xz4-400x400-jpg/o/aHR0cDovL21lZGlhLmJlc3RvZm1pY3JvLmNvbS81L0IvODA3NTk5L29yaWdpbmFsL054Z2w3eHo0XzQwMHg0MDAuanBn
            //   https://img.purch.com/o/aHR0cDovL21lZGlhLmJlc3RvZm1pY3JvLmNvbS81L0IvODA3NTk5L29yaWdpbmFsL054Z2w3eHo0XzQwMHg0MDAuanBn
            return src
                .replace(/\/[a-z]+\/[0-9]+(?:x[0-9]+)?\//, "/o/")
                .replace(/\/[a-z0-9]+-[0-9]+x[0-9]+(?:-[^/]*)?\/o\//, "/o/");
        }

        if (domain_nosub === "taobaocdn.com" && domain.match(/img[0-9]*\.taobaocdn\.com/)) {
            // http://img03.taobaocdn.com/bao/uploaded/i3/14462022101110112/T1vwOaXppbXXXXXXXX_!!0-item_pic.jpg_310x310.jpg
            //   http://img03.taobaocdn.com/bao/uploaded/i3/14462022101110112/T1vwOaXppbXXXXXXXX_!!0-item_pic.jpg
            return src.replace(/(\.[^/._]*)_[^/.]*\.[^/.]*$/, "$1");
        }

        if (domain === "www.musictory.com" &&
            src.match(/\/pictures\//)) {
            // http://www.musictory.com/pictures/thumbnails/78647.jpg
            return src.replace(/\/pictures\/[a-z]*\//, "/pictures/originali/");
        }

        if (domain_nosub === "santabanta.com" && domain.match(/media[0-9]*\.santabanta\.com/)) {
            // http://media1.santabanta.com/full1/Music%20Bands/The%20Pussycat%20Dolls/the-pussycat-dolls-33a.jpg
            //   http://media1.santabanta.com/full8/Music%20Bands/The%20Pussycat%20Dolls/the-pussycat-dolls-33a.jpg
            // http://media.santabanta.com/gallery/Global%20Celebrities(F)/Alejandra%20Guilmant/Alejandra-Guilmant-3-d_th.jpg
            //   http://media.santabanta.com/gallery/Global%20Celebrities(F)/Alejandra%20Guilmant/Alejandra-Guilmant-3-d.jpg
            // http://media.santabanta.com/medium1/global%20celebrities(f)/alejandra%20guilmant/alejandra-guilmant-2a.jpg
            //   http://media1.santabanta.com/full1/global%20celebrities(f)/alejandra%20guilmant/alejandra-guilmant-2a.jpg
            //   http://media1.santabanta.com/full6/global%20celebrities(f)/alejandra%20guilmant/alejandra-guilmant-2a.jpg (7 and 8 don't work)
            newsrc = src
                .replace(/_th(\.[^/.]*)$/, "$1")
                .replace(/:\/\/media\.santabanta\.com\/medium[0-9]*\//, "://media1.santabanta.com/full1/");
            if (newsrc !== src)
                return newsrc;

            if (src.match(/\/full[0-9]*\//)) {
                return [
                    src.replace(/\/full[0-9]*\//, "/full8/"),
                    src.replace(/\/full[0-9]*\//, "/full7/"),
                    src.replace(/\/full[0-9]*\//, "/full6/"),
                    src.replace(/\/full[0-9]*\//, "/full5/")
                ];
            }
        }

        if (domain === "www.movieinsider.com" &&
            src.indexOf("/images/p/") >= 0) {
            // https://www.movieinsider.com/images/p/600//18408_m1273372143.jpg
            //   https://www.movieinsider.com/images/p//18408_m1273372143.jpg
            return src.replace(/\/images\/p\/[0-9]+\//, "/images/p/");
        }

        if (domain_nosub === "kastden.org") {
            // https://selca.kastden.org/thumb/1271876
            //   https://selca.kastden.org/original/1271876
            return src.replace(/\/thumb\//, "/original/");
        }

        if (domain === "img.hani.co.kr") {
            // http://img.hani.co.kr/imgdb/resize/2018/0324/53_1521866554_00500158_20180324.JPG
            //   http://img.hani.co.kr/imgdb/resize/2018/0324/00500158_20180324.JPG
            //   http://img.hani.co.kr/imgdb/original/2018/0324/00500158_20180324.JPG
            // http://img.hani.co.kr/imgdb/resize/2018/0325/52_1521866282_152186627183_20180325.JPG
            //   http://img.hani.co.kr/imgdb/resize/2018/0325/152186627183_20180325.JPG
            //   http://img.hani.co.kr/imgdb/original/2018/0325/152186627183_20180325.JPG
            // http://img.hani.co.kr/imgdb/thumbnail/2018/0223/151928494178_20180223.JPG
            //   http://img.hani.co.kr/imgdb/resize/2018/0223/151928494178_20180223.JPG
            //   http://img.hani.co.kr/imgdb/original/2018/0223/151928494178_20180223.JPG
            return src
                .replace(/\/(?:thumbnail|resize)\//, "/original/")
                .replace(/\/[0-9]+_[0-9]+_([0-9]+_[0-9]+\.[^/.]*)$/, "/$1");
        }

        if (domain === "flexible.img.hani.co.kr") {
            // http://flexible.img.hani.co.kr/flexible/box/120/120/imgdb/resize/2018/0320/00503324_20180320.JPG
            //   http://img.hani.co.kr/imgdb/resize/2018/0320/00503324_20180320.JPG
            // http://flexible.img.hani.co.kr/flexible/box/120/120/imgdb/resize/2012/0823/1345624227_134562400908_20120823.JPG
            //   http://img.hani.co.kr/imgdb/resize/2012/0823/1345624227_134562400908_20120823.JPG
            //   original doesn't work
            return src.replace(/:\/\/[^/]*\/flexible\/.*?\/imgdb\//, "://img.hani.co.kr/imgdb/");
        }

        if (domain === "static.ok.co.uk" ||
            // http://static.ok.co.uk.s3.amazonaws.com/media/images/625x938_ct/635516_1433940709_dani-dyer-age-of-kill-private-screening_ba3b9a6ae1c2f94238d6371b18ab9c9d.jpg
            //   http://static.ok.co.uk.s3.amazonaws.com/media/images/original/635516_1433940709_dani-dyer-age-of-kill-private-screening_ba3b9a6ae1c2f94238d6371b18ab9c9d.jpg -- same size
            amazon_container === "static.ok.co.uk" ||
            // https://images.24ur.com/media/images/884xX/Mar2017/57e99fb58d_61899670.jpg?v=2316 -- stretched
            //   https://images.24ur.com/media/images/original/Mar2017/57e99fb58d_61899670.jpg?v=2316
            domain === "images.24ur.com" ||
            // https://image.dnevnik.hr/media/images/1024xX/Jun2018/61512291-jennifer-aniston-courteney-cox.jpg
            //   https://image.dnevnik.hr/media/images/original/Jun2018/61512291-jennifer-aniston-courteney-cox.jpg
            domain === "image.dnevnik.hr" ||
            // https://img.bg.sof.cmestatic.com/media/images/640x/Aug2013/61160739.jpg
            //   https://img.bg.sof.cmestatic.com/media/images/original/Aug2013/61160739.jpg
            domain === "img.bg.sof.cmestatic.com" ||
            // http://ns.hitcreative.com.s3.amazonaws.com/media/images/640x960/651.jpg
            //   http://ns.hitcreative.com.s3.amazonaws.com/media/images/original/651.jpg
            amazon_container === "ns.hitcreative.com") {
            // https://static.ok.co.uk/media/images/625x938_ct/1060392_GettyImages_488606950_ddcc7556b12de0d94bf5118cda2310d2.jpg
            //   https://static.ok.co.uk/media/images/original/1060392_GettyImages_488606950_ddcc7556b12de0d94bf5118cda2310d2.jpg
            return src.replace(/\/media\/images\/[^/]*\//, "/media/images/original/");
        }

        if (domain_nosub === "galaxypub.vn" && domain.match(/rs[0-9]*\.galaxypub\.vn/)) {
            // http://rs100.galaxypub.vn/staticFile/Subject/2018/02/14/361011/2_141343791.jpg?w=300&h=168
            //   http://st.galaxypub.vn/staticFile/Subject/2018/02/14/361011/2_141343791.jpg
            return src.replace(/:\/\/[^/]*(\/.*?)(?:\?.*)?$/, "://st.galaxypub.vn$1");
        }

        if (domain_nowww === "implanetcorp.com" &&
            src.indexOf("/upload/ctoon/") >= 0) {
            // http://www.implanetcorp.com/upload/ctoon/gravure/15/2cx368d9b03d25a21839e3ff2c8b4ff3e266gyv5/15_thumb_0f4b73d6eb051c635a246df3e36d712c.jpg
            //   http://www.implanetcorp.com/upload/ctoon/gravure/15/2cx368d9b03d25a21839e3ff2c8b4ff3e266gyv5/resize/001.JPG
            //   http://www.implanetcorp.com/upload/ctoon/gravure/15/2cx368d9b03d25a21839e3ff2c8b4ff3e266gyv5/original/001.JPG
            // http://www.implanetcorp.com/upload/ctoon/gravure/15/m1648d5a7d3f7856e668c7fa20336f9a97bc6vro/15_thumb_fecc0a9e6650bca40094b86194629705.jpg
            //   http://www.implanetcorp.com/upload/ctoon/gravure/15/m1648d5a7d3f7856e668c7fa20336f9a97bc6vro/original/001.jpg
            return src
                //.replace(/\/[0-9]+_thumb_[0-9a-f]+(\.[^/.]*)$/, "/original/001.JPG")
                .replace(/\/[a-z]*\/([0-9]+\.[^/.]*)$/, "/original/$1");
        }

        if (domain === "doramakun.ru") {
            // http://doramakun.ru/thumbs/users/15581/photo/84/TQPg5IWwQTQ-185.jpg
            //   http://doramakun.ru/users/15581/photo/84/TQPg5IWwQTQ.jpg
            // http://doramakun.ru/thumbs/users/15581/photo/84/bRhbKntPXhI-185.jpg
            //   http://doramakun.ru/thumbs/users/15581/photo/84/bRhbKntPXhI-413.jpg
            //   http://doramakun.ru/users/15581/photo/84/bRhbKntPXhI.jpg -- same size
            return src.replace(/\/thumbs\/(.*)-[0-9]+(\.[^/.]*)$/, "/$1$2");
        }

        if (domain === "1gr.cz") {
            // https://1gr.cz/fotky/idnes/15/043/cl5/ZAR5ab634_MA210_USA_ENTERTAINMENT_0421_11.JPG
            //   https://1gr.cz/fotky/idnes/15/043/org/ZAR5ab634_MA210_USA_ENTERTAINMENT_0421_11.JPG
            return src.replace(/(\/[0-9]+\/[0-9]+\/)[^/]*\/([^/]*)$/, "$1org/$2");
        }

        if (domain_nosub === "ancensored.com" &&
            src.match(/\/files\/images\//)) {
            // http://ancensored.com/files/images/vthumbs/r/f284d8efea6df08d1df56ced003397f2.jpg
            //   http://ancensored.com/files/images/vthumbs/r/f284d8efea6df08d1df56ced003397f2_full.jpg
            // http://es.ancensored.com/files/images/vthumbs/r/f284d8efea6df08d1df56ced003397f2.jpg
            //   http://es.ancensored.com/files/images/vthumbs/r/f284d8efea6df08d1df56ced003397f2_full.jpg
            return src.replace(/(\/[0-9a-f]*)(?:_[a-z]*)?(\.[^/.]*)$/, "$1_full$2");
        }

        if (domain === "www.desktopbackground.org") {
            // https://www.desktopbackground.org/download/800x600/2014/11/15/856176_hd-wallpapers-4users-rachel-riley-hd-wallpapers-1080p_1600x1000_h.jpg
            //   https://www.desktopbackground.org/p/2014/11/15/856176_hd-wallpapers-4users-rachel-riley-hd-wallpapers-1080p_1600x1000_h.jpg
            //   https://www.desktopbackground.org/download/o/2014/11/15/856176_hd-wallpapers-4users-rachel-riley-hd-wallpapers-1080p_1600x1000_h.jpg
            // https://www.desktopbackground.org/t/2011/05/11/201347_stella-with-a-sword-black-rock-shooter-desktop-wallpapers-28850_2560x1600_h.jpg
            //   https://www.desktopbackground.org/download/o/2011/05/11/201347_stella-with-a-sword-black-rock-shooter-desktop-wallpapers-28850_2560x1600_h.jpg
            return src
                .replace(/\/download\/[^/]*\//, "/download/o/")
                .replace(/(:\/\/[^/]*)\/[pt]\//, "$1/download/o/");
        }

        if (domain === "image.mlive.com" ||
            // http://image.nj.com/home/njo-media/width600/img/sixers_main/photo/embiid-rihannajpg-f2240659a535f626.jpg
            //   http://media.nj.com/sixers_main/photo/embiid-rihannajpg-f2240659a535f626.jpg
            domain === "image.nj.com" ||
            // https://image.cleveland.com/home/cleve-media/width600/img/ent_impact_home/photo/rihanna-1075cbb4ed700882.jpg
            //   https://media.cleveland.com/ent_impact_home/photo/rihanna-1075cbb4ed700882.jpg
            domain === "image.cleveland.com") {
            // http://image.mlive.com/home/mlive-media/width307/img/grpress/news_impact/photo/24285148-standard.jpg
            //   https://image-api.advance.net/prod/resize?key=home/mlive-media/width307/img/grpress/news_impact/photo/24285148-standard.jpga
            //   http://media.mlive.com/grpress/news_impact/photo/24285148-standard.jpg
            return src.replace(/:\/\/image\.([^/]*)\/home\/[a-z]+-media\/[^/]*\/img\//, "://media.$1/");
        }

        if (domain_nosub === "hwcdn.net") {
            // https://s9v7j7a4.ssl.hwcdn.net/galleries/new_big/58/df/5c/58df5c4f13e698517e6a9aa00e311f9a/3.jpg
            //   https://s9v7j7a4.ssl.hwcdn.net/galleries/full/58/df/5c/58df5c4f13e698517e6a9aa00e311f9a/3.jpg
            return src.replace(/\/galleries\/[^/]*\//, "/galleries/full/");
        }

        if (domain === "aws-foto.amateri.com") {
            // https://aws-foto.amateri.com/foto/4/9/7/1/g1778419/14400873/170x220c.jpg
            //   https://aws-foto.amateri.com/foto/4/9/7/1/g1778419/14400873/x.jpg
            return src.replace(/\/[0-9]+x[^/.]*(\.[^/.]*)$/, "/x$1");
        }

        if (domain === "cdn.tobi.com") {
            // https://cdn.tobi.com/product_images/sm/1/natural-infinite-glow-layered-bracelet-set.jpg
            //   https://cdn.tobi.com/product_images/lg/1/natural-infinite-glow-layered-bracelet-set@2x.jpg
            // https://cdn.tobi.com/product_images/md/1/rose-eyes-on-you-knotted-maxi-dress.jpg
            //   https://cdn.tobi.com/product_images/lg/1/rose-eyes-on-you-knotted-maxi-dress@2x.jpg
            // https://cdn.tobi.com/product_images/xs/1/black-zeira-top.jpg
            //   https://cdn.tobi.com/product_images/lg/1/black-zeira-top@2x.jpg
            return src
                .replace(/\/product_images\/[a-z]+\//, "/product_images/lg/")
                .replace(/(\/[^/.@]*)(\.[^/.]*)$/, "$1@2x$2");
        }

        if (domain === "www.rfa.org") {
            // https://www.rfa.org/english/commentaries/energy_watch/tariff-row-may-do-little-economic-damage-in-china-04022018101727.html/china-shopper-supermarket-beijing-apr2-2018.jpg/@@images/0fe75452-e65b-4e6b-a5b3-3db87b335e19.jpeg
            //   https://www.rfa.org/english/commentaries/energy_watch/tariff-row-may-do-little-economic-damage-in-china-04022018101727.html/china-shopper-supermarket-beijing-apr2-2018.jpg
            // https://www.rfa.org/english/news/china/surveillance-03302018111415.html/china-security-camera-beijing-march-2018.jpg/@@images/87f9b6b7-fcea-43d1-845b-a1ae6a022908.jpeg
            //   https://www.rfa.org/english/news/china/surveillance-03302018111415.html/china-security-camera-beijing-march-2018.jpg
            return src.replace(/\/@@images\/.*/, "");
        }

        if (domain === "resize.blogsys.jp") {
            // http://resize.blogsys.jp/94afa543ba574167ccfea7dfa414f8f2672f474a/crop1/70x70/http://livedoor.blogimg.jp/destinychild/imgs/2/e/2eed2325.jpg
            //   http://livedoor.blogimg.jp/destinychild/imgs/2/e/2eed2325.jpg
            return src.replace(/^[a-z]*:\/\/.*\/([a-z]*:\/\/.*)$/, "$1");
        }

        if (amazon_container === "bw-1651cf0d2f737d7adeab84d339dbabd3-gallery") {
            // https://bw-1651cf0d2f737d7adeab84d339dbabd3-gallery.s3.amazonaws.com/images/image_2766690/b3c7292a567fb4de95fbf3cadfcecc67_thumbnail.jpg
            //   https://bw-1651cf0d2f737d7adeab84d339dbabd3-gallery.s3.amazonaws.com/images/image_2766690/b3c7292a567fb4de95fbf3cadfcecc67_large.jpg
            //   https://bw-1651cf0d2f737d7adeab84d339dbabd3-gallery.s3.amazonaws.com/images/image_2766690/b3c7292a567fb4de95fbf3cadfcecc67_original.jpg
            // https://s3.amazonaws.com/bw-1651cf0d2f737d7adeab84d339dbabd3-gallery/images/image_2766690/b3c7292a567fb4de95fbf3cadfcecc67_thumbnail.jpg
            //   https://s3.amazonaws.com/bw-1651cf0d2f737d7adeab84d339dbabd3-gallery/images/image_2766690/b3c7292a567fb4de95fbf3cadfcecc67_original.jpg
            return src.replace(/_[a-z]+(\.[^/.]*)$/, "_original$1");
        }

        if (domain_nosub === "rl0.ru" && domain.match(/img[0-9]*\.rl0\.ru/)) {
            // https://img09.rl0.ru/a4a2e0b13fb27ee8aed0196cebf4a0bc/c500x281/i.imgur.com/a5MASCq.gif
            //   http://i.imgur.com/a5MASCq.gif
            // https://img02.rl0.ru/f0ae2d1540ad72f10378305af4ff7201/563x1000/news.rambler.ru/img/2017/09/18140001.943169.900.jpeg
            //   https://news.rambler.ru/img/2017/09/18140001.943169.900.jpeg
            // https://img.rl0.ru/afisha/144x144/newid.afisha.ru/StaticContent/UserPhoto/f0/8a/e4f2dc0aa41d4aaa99f508853432f08a.jpg
            //   http://newid.afisha.ru/StaticContent/UserPhoto/f0/8a/e4f2dc0aa41d4aaa99f508853432f08a.jpg
            // https://img02.rl0.ru/36ce9f16fe7e2f1ea50222bac271ac8a/500x-/news.rambler.ru/img/2017/12/30144958.211648.7624.jpg
            //   https://news.rambler.ru/img/2017/12/30144958.211648.7624.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/[a-z0-9]+\/c?[-0-9]+x[-0-9]+\//, "http://");
        }

        if (domain_nosub === "wanelo.com" && domain.match(/cdn-img-[0-9]+\.wanelo\.com/)) {
            // https://cdn-img-1.wanelo.com/p/914/ad1/157/33d5c0fef57bd90c33c7fd0/x354-q80.jpg
            //   https://cdn-img-1.wanelo.com/p/914/ad1/157/33d5c0fef57bd90c33c7fd0/full_size.jpg
            return src.replace(/\/[^/.]*(\.[^/.]*)$/, "/full_size$1");
        }

        if (domain === "static.kvraudio.com") {
            // https://static.kvraudio.com/i/s/g-sonique-neurofunker-xg6.jpg
            //   https://static.kvraudio.com/i/b/g-sonique-neurofunker-xg6.jpg
            return src.replace(/(:\/\/[^/]*\/i\/)[a-z]\//, "$1b/");
        }

        if (domain === "contents.dt.co.kr") {
            // http://contents.dt.co.kr/thum/99/2018040602100932052001_99_3.jpg
            //   http://contents.dt.co.kr/images/201804/2018040602100932052001[1].jpg
            //   http://contents.dt.co.kr/images/201804/2018040602100932052001.jpg
            return src.replace(/\/thum\/[0-9]+\/([0-9]{6})([0-9]+)_[^/.]*(\.[^/.]*)/, "/images/$1/$1$2$3");
        }

        if (domain === "eng.dt.co.kr") {
            // http://eng.dt.co.kr/images/thum/20180405111518001543.jpg
            //   http://eng.dt.co.kr/images/oriimg/20180405111518001543[0].jpg
            return src.replace(/\/images\/thum\/([0-9]+)/, "/images/oriimg/$1[0]");
        }

        // http://image.ytn.co.kr/general/jpg/2017/0831/201708311021406804_d.jpg
        if (domain === "image.ytn.co.kr" ||
            // http://img.sciencetv.kr/sciencetv/jpg/vod1142/2018/201801301101561712_h.jpg
            //   http://img.sciencetv.kr/sciencetv/jpg/vod1142/2018/201801301101561712_d.jpg
            domain === "img.sciencetv.kr") {
            // http://image.ytn.co.kr/general/jpg/2018/0402/201804022235469141_h.jpg -- doesn't work:
            //   http://image.ytn.co.kr/general/jpg/2018/0402/201804022235469141_t.jpg -- works
            //   http://www.ytn.co.kr/_ln/0102_201804022235469141_002 -- is video thumbnail
            // d, t, h, k, j
            return src.replace(/(:\/\/[^/]*\/[^/]*\/jpg\/[^/]*\/[^/]*\/[0-9]+_)[a-z](\.[^/.]*)$/, "$1d$2");
        }

        if (domain === "photo.kmib.co.kr") {
            //http://photo.kmib.co.kr/index.asp?number=4925&page=6
            // http://photo.kmib.co.kr/data/4925/thumb_20150825103025.jpg
            //   http://photo.kmib.co.kr/data/4925/20150825103025.jpg
            return src.replace(/\/thumb_([0-9]+\.[^/.]*)$/, "/$1");
        }

        if (domain === "r.kelkoo.com") {
            // http://r.kelkoo.com/r/uk/15002013/146501/auto/auto/https%253A%252F%252Fdyson-h.assetsadobe2.com%252Fis%252Fimage%252Fcontent%252Fdam%252Fdyson%252Fimages%252Fproducts%252Fprimary%252F231868-01.png%253F%2524responsive%2524%2526fmt%253Dpng-alpha%2526cropPathE%253Ddesktop%2526fit%253Dstretch%252C1%2526wid%253D800/T5JylUsrxw8XjkR2zJUTmqQIfK8oIrzwXgEbTo_Jtn0-?searchId=10769920122096_1520492759094_270260&offerId=206b270741bc0810a4c2fc0d1b48d86f
            //   https://dyson-h.assetsadobe2.com/is/image/content/dam/dyson/images/products/primary/231868-01.png?$responsive$&fmt=png-alpha&cropPathE=desktop&fit=stretch,1&wid=800
            return decodeURIComponent(decodeURIComponent(src.replace(/^[a-z]*:\/\/(?:[^/]*\/){7}(http[^/]*).*?$/, "$1")));
        }

        if (domain_nosub === "assetsadobe2.com") {
            // https://dyson-h.assetsadobe2.com/is/image//content/dam/dyson/products/hair-care/dyson-supersonic/customisation/personal-care-dyson-supersonic-customisation-homepage.jpg?scl=1
            // https://dyson-h.assetsadobe2.com/is/image//content/dam/dyson/icons/owner-footer/register-my-machine.png?scl=1&fmt=png-alpha
            // https://airbus-h.assetsadobe2.com/is/image/content/dam/products-and-solutions/commercial-aircraft/beluga/belugaxl/BelugaXL.jpg?wid=1920&fit=fit,1&qlt=85,0
            // https://dyson-h.assetsadobe2.com/is/image//content/dam/dyson/services-and-support/troubleshoot/hassle-free-repalcement.png
            // https://airbus-h.assetsadobe2.com/is/image/content/dam/products-and-solutions/commercial-aircraft/beluga/belugaxl/BelugaXL.jpg?wid=1920&fit=fit,1&qlt=85,0
            //   https://airbus-h.assetsadobe2.com/is/image/content/dam/products-and-solutions/commercial-aircraft/beluga/belugaxl/BelugaXL.jpg -- much smaller (300x203)
            //   https://airbus-h.assetsadobe2.com/is/image/content/dam/products-and-solutions/commercial-aircraft/beluga/belugaxl/BelugaXL.jpg?scl=1
            if (src.match(/\.jpg(?:\?.*)?$/))
                return src.replace(/(?:\?.*)?$/, "?scl=1");
            else
                return src.replace(/(?:\?.*)?$/, "?scl=1&fmt=png-alpha");
        }

        if (domain === "sm.ign.com") {
            // http://sm.ign.com/t/ign_in/feature/a/afl-clubs-/afl-clubs-recognise-that-esports-are-sports-why-hasnt-everyo_azz8.300.jpg
            //   http://sm.ign.com/t/ign_in/feature/a/afl-clubs-/afl-clubs-recognise-that-esports-are-sports-why-hasnt-everyo_azz8.999999999999999.jpg
            return src.replace(/\.[0-9]+\.([^/.]*)$/, ".999999999999999.$1");
        }

        // nopCommerce
        if (domain === "shop.unitedcycle.com" &&
            src.indexOf("/images/thumbs/") >= 0) {
            // https://shop.unitedcycle.com/content/images/thumbs/0277134_mens-nhl-edmonton-oilers-connor-mcdavid-authentic-home-jersey_276.jpeg
            //   https://shop.unitedcycle.com/content/images/thumbs/0277134_mens-nhl-edmonton-oilers-connor-mcdavid-authentic-home-jersey.jpeg
            return src.replace(/_[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "imgr.es") {
            // https://imgr.es/4AVP/thumb
            //   https://imgr.es/4AVP
            return src.replace(/\/thumb$/, "");
        }

        if (domain_nosub === "frgimages.com" ||
            domain === "images.footballfanatics.com") {
            // http://nhl.frgimages.com/FFImage/thumb.aspx?i=/productImages/_2799000/ff_2799544_full.jpg&w=340
            //   http://nhl.frgimages.com/productImages/_2799000/ff_2799544_full.jpg
            // http://images.footballfanatics.com/FFImage/thumb.aspx?i=/productImages/_821000/ff_821054_xl.jpg&amp;w=200
            //   http://images.footballfanatics.com/productImages/_821000/ff_821054_xl.jpg
            //   http://images.footballfanatics.com/productImages/_821000/ff_821054_full.jpg
            // http://images.footballfanatics.com/FFImage/thumb.aspx?i=%2fproductImages%2f_1759000%2fff_1759679_xl.jpg&w=400
            //   http://images.footballfanatics.com/productImages/_1759000/ff_1759679_full.jpg
            newsrc = decodeURIComponent(src.replace(/\/FFImage\/thumb.aspx.*?[?&]i=([^&]*).*/, "$1"));
            if (newsrc !== src)
                return newsrc;

            return src
                .replace(/_[a-z]+(\.[^/.?&]*)$/, "_full$1");
        }

        if (domain === "myanimelist.cdn-dena.com") {
            // https://myanimelist.cdn-dena.com/r/23x32/images/characters/5/303016.webp?s=3e198afde53adfb2b47dc59782dc82f7
            //   https://myanimelist.cdn-dena.com/images/characters/5/303016.webp?s=3e198afde53adfb2b47dc59782dc82f7
            return src.replace(/\/r\/[0-9]+x[0-9]+\//, "/");
        }

        if (domain === "picture-cdn.wheretoget.it") {
            // http://picture-cdn.wheretoget.it/qey8wu-i-c60x60.jpg
            //   http://picture-cdn.wheretoget.it/qey8wu-i.jpg
            return src.replace(/(\/[a-z0-9]*-[a-z])[^/.]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "sl.sbs.com.au") {
            // https://sl.sbs.com.au/public/image/file/4f4cf0a2-ec64-46e8-9958-faa712440c28/crop/16x9_medium
            //   https://sl.sbs.com.au/public/image/file/4f4cf0a2-ec64-46e8-9958-faa712440c28
            // https://sl.sbs.com.au/public/image/file/0c3ca54a-0cfa-400e-9cb0-d09631c81769/crop/1x1_small
            //   https://sl.sbs.com.au/public/image/file/0c3ca54a-0cfa-400e-9cb0-d09631c81769
            return src.replace(/(\/public\/image\/file\/[-a-f0-9]*)\/.*/, "$1");
        }

        if ((domain_nosub === "prezly.com" && domain.indexOf(".assets.prezly.com") >= 0) ||
            // https://cdn.slant.co/999bce7d-6fb0-4b6b-9820-24e58633edf8/-/format/jpeg/-/progressive/yes/-/preview/480x480/
            //   https://cdn.slant.co/999bce7d-6fb0-4b6b-9820-24e58633edf8/-
            domain === "cdn.slant.co") {
            // https://cdn.uc.assets.prezly.com/d24b5696-a65c-48d6-9cfd-1b0b98ca1f3c/-/preview/1108x1108/
            //   https://cdn.uc.assets.prezly.com/d24b5696-a65c-48d6-9cfd-1b0b98ca1f3c/-
            // https://cdn.uc.assets.prezly.com/6201f512-e09d-440f-95e3-d1aa316f70e6/-/resize/1108x/-/quality/best/
            //   https://cdn.uc.assets.prezly.com/6201f512-e09d-440f-95e3-d1aa316f70e6/-
            // https://cdn.uc.assets.prezly.com/c204db5f-a17a-4c64-96b2-112b0876cb84/-/preview/1108x1108/
            //   https://cdn.uc.assets.prezly.com/c204db5f-a17a-4c64-96b2-112b0876cb84/-
            return src.replace(/(:\/\/[^/]*\/[-a-f0-9]*\/).*/, "$1-");
        }

        if (domain === "leonardo.osnova.io") {
            // https://leonardo.osnova.io/f90ba5cd-3995-4708-f20f-312472809618/-/scale_crop/590x881/center/
            //   https://leonardo.osnova.io/f90ba5cd-3995-4708-f20f-312472809618/
            return src.replace(/(:\/\/[^/]*\/[-a-f0-9]*\/)-\/.*/, "$1");
        }

        if (domain === "cdn.iview.abc.net.au") {
            // https://cdn.iview.abc.net.au/thumbs/460/nn/NN1603D568368a49e2fa8.38197525_940.jpg
            //   https://cdn.iview.abc.net.au/thumbs/i/nn/NN1603D568368a49e2fa8.38197525_940.jpg
            return src.replace(/\/thumbs\/[0-9]+\//, "/thumbs/i/");
        }

        if (domain_nosub === "ipstatic.net") {
            // http://ipstatic.net/img?url=http%3A%2F%2Fstatic.independent.co.uk%2Fs3fs-public%2Fthumbnails%2Fimage%2F2015%2F12%2F22%2F23%2FSesame-Credit.jpg
            //   http://static.independent.co.uk/s3fs-public/thumbnails/image/2015/12/22/23/Sesame-Credit.jpg
            // http://ipstatic.net/img?url=http%3A%2F%2Fi.imgur.com%2FfauqaqC.png
            newsrc = decodeURIComponent(src.replace(/.*\/img.*?[?&]url=([^&]*).*?$/, "$1"));
            if (newsrc !== src)
                return newsrc;

            // https://th1-us.ipstatic.net/thumbs/100x100/57/26/700x699_830169982986518529_830172363316953088.jpg
            //   https://us.ipstatic.net/photos/57/26/700x699_830169982986518529_830172363316953088.jpg
            return src.replace(/\/thumbs\/[0-9]+x[0-9]+\//, "/photos/");
        }

        if (domain === "image.fnnews.com") {
            // http://image.fnnews.com/resource/paper/image/2018/02/22/f201802222005_s.jpg - 150x252
            //   http://image.fnnews.com/resource/paper/image/2018/02/22/f201802222005_m.jpg - 1024x1826
            //   http://image.fnnews.com/resource/paper/image/2018/02/22/f201802222005_l.jpg - 2048x3452
            //   http://image.fnnews.com/resource/paper/image/2018/02/22/f201802222005.jpg - 2294x3867
            // http://image.fnnews.com/resource/media/image/2015/01/07/201501071226571964.jpg
            // http://image.fnnews.com/resource/media/image/2015/02/09/201502091020442956_s.jpg
            //
            // http://image.fnnews.com/resource/crop_image/2018/03/28/thumb/201803280955183839_1522283684662.jpg
            //   http://image.fnnews.com/resource/media/image/2018/03/28/201803281002583124.jpg
            return src
                .replace(/(\/[a-z]?[0-9]+)_[a-z](\.[^/.]*)/, "$1$2");
        }

        if (domain_nosub === "kym-cdn.com") {
            // http://i0.kym-cdn.com/featured_items/icons/wide/000/007/926/46b.jpg
            //   http://i0.kym-cdn.com/featured_items/icons/original/000/007/926/46b.jpg
            // http://i0.kym-cdn.com/photos/images/newsfeed/001/318/958/c7d.png
            //   http://i0.kym-cdn.com/photos/images/original/001/318/958/c7d.png
            // http://i0.kym-cdn.com/entries/icons/mobile/000/025/888/the-problem-with-apu.jpg
            //   http://i0.kym-cdn.com/entries/icons/original/000/025/888/the-problem-with-apu.png
            // https://i.kym-cdn.com/entries/icons/mobile/000/018/847/e4a829e2-502a-42d4-898f-f3169442026b-bestSizeAvailable.jpg
            //   https://i.kym-cdn.com/entries/icons/original/000/018/847/e4a829e2-502a-42d4-898f-f3169442026b-bestSizeAvailable.png
            return add_extensions(src.replace(/(:\/\/[^/]*\/[^/]*\/(?:images|icons)\/)[^/]*\//, "$1original/"));
        }

        if (domain === "cmeimg-a.akamaihd.net" ||
            domain === "leafimg-a.akamaihd.net") {
            // https://cmeimg-a.akamaihd.net/640/photos.demandstudios.com/getty/article/144/8/178883146.jpg
            //   http://photos.demandstudios.com/getty/article/144/8/178883146.jpg
            // http://cmeimg-a.akamaihd.net/640/photos.demandstudios.com/getty/article/56/93/78034732.jpg
            //   http://photos.demandstudios.com/getty/article/56/93/78034732.jpg
            // https://cmeimg-a.akamaihd.net/640/ppds/1ad05338-0679-4fa1-b259-631df59b4a89.png -- default doesn't work
            // https://cmeimg-a.akamaihd.net/400x400/ppds/53e36ed7-8bb2-4448-b7f5-96acdc58ee1b.jpg
            //   https://cmeimg-a.akamaihd.net/default/ppds/53e36ed7-8bb2-4448-b7f5-96acdc58ee1b.jpg
            // https://cmeimg-a.akamaihd.net/x650/clsd/4/3/11bf5d91994d4b90a21192a6c464390c
            //   https://cmeimg-a.akamaihd.net/default/clsd/4/3/11bf5d91994d4b90a21192a6c464390c
            // https://cmeimg-a.akamaihd.net/400x269/photos.demandstudios.com/getty/article/181/85/492145443.jpg
            //   http://photos.demandstudios.com/getty/article/181/85/492145443.jpg
            // https://cmeimg-a.akamaihd.net/default/clsd/4/3/fb64bd3f01f541f3bbcd4fd0f3c821fc
            // https://cmeimg-a.akamaihd.net/default/ppds/d88f0042-735e-404f-8156-519ba9c85d8c.png
            // https://cmeimg-a.akamaihd.net/cute-article-rcp/photos.demandstudios.com/getty/article/110/112/87490270.jpg
            //   http://photos.demandstudios.com/getty/article/110/112/87490270.jpg
            // https://leafimg-a.akamaihd.net/640/ppds/00e86e6a-fcfc-4bea-b451-4b58187cf0cf.jpg
            //   https://leafimg-a.akamaihd.net/default/ppds/00e86e6a-fcfc-4bea-b451-4b58187cf0cf.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/(?:[0-9]+(?:x[0-9]+)?|x[0-9]+|cute-article-rcp)\/([^/.]*\.[^/]*\/.*)/, "http://$1");
            if (newsrc !== src)
                return newsrc;

            return src.replace(/^([a-z]+:\/\/[^/]*\/)(?:[0-9]+(?:x[0-9]+)?|x[0-9]+)\//, "$1default/");
        }

        if ((domain_nosub === "luxnet.ua" && domain.match(/imagecdn[0-9]*\.luxnet\.ua/)) ||
            // https://beztabu.net/uploads/640_DIR/media_news/2018/08/5b6960963029e998726219.jpg
            //   https://beztabu.net/uploads/media_news/2018/08/5b6960963029e998726219.jpg
            domain_nowww === "beztabu.net" ||
            // https://24tv.ua/resources/photos/news/620_DIR/201808/1010954_2349563.jpg?201808163040
            //   https://24tv.ua/resources/photos/news/201808/1010954_2349563.jpg?201808163040
            domain_nowww === "24tv.ua" ||
            // https://lux.fm/uploads/640_DIR/media_news/2018/01/6e57fff0aac4c5d6707b1e3a4df76f575e6d34f8.jpg
            //   https://lux.fm/uploads/media_news/2018/01/6e57fff0aac4c5d6707b1e3a4df76f575e6d34f8.jpg
            domain_nowww === "lux.fm") {
            // https://imagecdn1.luxnet.ua/football24/resources/photos/news/660x364_DIR/201803/443933.jpg?201803090027
            //   https://imagecdn1.luxnet.ua/football24/resources/photos/news/201803/443933.jpg?201803090027
            // https://imagecdn1.luxnet.ua/radio24/uploads/640_DIR/media_news/2017/07/16340fc3f938eec4245df2c441b49bf67fb0ad28.jpg
            //   https://imagecdn1.luxnet.ua/radio24/uploads/media_news/2017/07/16340fc3f938eec4245df2c441b49bf67fb0ad28.jpg
            return src.replace(/\/[0-9]+(?:x[0-9]+)?_DIR\//, "/");
        }

        if (domain === "userstyles.org") {
            // https://userstyles.org/style_screenshot_thumbnails/139772_after.jpeg
            //   https://userstyles.org/style_screenshots/139772_after.jpeg
            return src.replace("/style_screenshot_thumbnails/", "/style_screenshots/");
        }

        if (domain_nosub === "narvii.com" &&
            domain.match(/^[a-z]+[0-9]*\./)) {
            // https://pm1.narvii.com/6144/3af419d28deec398f490c7b1e0106d41165f84e0_128.jpg
            //   https://pm1.narvii.com/6144/3af419d28deec398f490c7b1e0106d41165f84e0_hq.jpg
            // https://pm1.narvii.com/6795/59948b2d6d93878fcfbcbf091d9edfa9399b93c4v2_00.jpg
            //   https://pm1.narvii.com/6795/59948b2d6d93878fcfbcbf091d9edfa9399b93c4v2_hq.jpg
            // https://pm1.narvii.com/6893/a215fc0f8d3bf92b03a4c9b6aef84042e3c2a190r1-738-1107v2_00.jpg
            //   https://pm1.narvii.com/6893/a215fc0f8d3bf92b03a4c9b6aef84042e3c2a190r1-738-1107v2_hq.jpg
            // https://pa1.narvii.com/6504/323454eb6137f5366c3a0df14c662d0ad81cc253_hq.gif
            // http://s3.narvii.com/image/wgy27on3h5wthe4ix2nhzqvbdok65mnd_00.jpg
            //   http://s3.narvii.com/image/wgy27on3h5wthe4ix2nhzqvbdok65mnd_hq.jpg
            // http://cm1.narvii.com/6735/9a9cd2eb50d2305358eebd487da63ab06a9549f6_00.jpg
            //   http://cm1.narvii.com/6735/9a9cd2eb50d2305358eebd487da63ab06a9549f6_hq.jpg -- doesn't work
            // doesn't work for all:
            // https://pm1.narvii.com/6516/5a012772e565ae7b0e6cd1f9ecae669afea0d0a2_00.jpg -- bg
            //   https://pm1.narvii.com/6516/5a012772e565ae7b0e6cd1f9ecae669afea0d0a2_hq.jpg -- doesn't work
            //return src.replace(/(\/[0-9a-frv]+(?:-[-0-9a-z]+)?_)[^/.]*(\.[^/.]*)/, "$1hq$2");
            return src.replace(/(\/[0-9a-z]+(?:-[-0-9a-z]+)?_)[^/.]*(\.[^/.]*)/, "$1hq$2");
        }

        if (domain === "img.oastatic.com") {
            // https://img.oastatic.com/img2/14456082/671x335r/view-from-zumstein.jpg
            //   https://img.oastatic.com/img/14456082/view-from-zumstein.jpg -- much smaller
            //   https://img.oastatic.com/imgmax/14456082/view-from-zumstein.jpg -- smaller (2048x1149)
            //   https://img.oastatic.com/img2/14456082/full/view-from-zumstein.jpg (3648x2048)
            //   https://img.oastatic.com/imgsrc/14456082/view-from-zumstein.jpg (3648x2048)
            // https://img.oastatic.com/img/671/335/fit/3159891/baeume-im-urwald-reinhardswald.jpg
            //   https://img.oastatic.com/img2/3159891/full/baeume-im-urwald-reinhardswald.jpg
            // http://img.oastatic.com/img/800/600/7214820/7214820.jpg
            //   http://img.oastatic.com/img2/7214820/full/7214820.jpg
            // http://img.oastatic.com/img/22917128/.jpg
            //   http://img.oastatic.com/img2/22917128/full/.jpg
            // http://img.oastatic.com/imgmax/8078056/das-alte-oesterreichische-zollhaus-am-krimmler-tauern.jpg (2000x1328)
            //   http://img.oastatic.com/img2/8078056/full/das-alte-oesterreichische-zollhaus-am-krimmler-tauern.jpg (2000x1328)
            // https://img.oastatic.com/img2/4273466/671x335r/der-historic-firetower-am-gipfel-des-mount-revelstoke..jpg
            //   https://img.oastatic.com/img2/4273466/full/der-historic-firetower-am-gipfel-des-mount-revelstoke..jpg (4320x2880)
            //   https://img.oastatic.com/imgsrc/4273466/der-historic-firetower-am-gipfel-des-mount-revelstoke..jpg (4320x2880)
            // http://img.oastatic.com/imgsrc/6128163/.jpg
            // https://img.oastatic.com/img/6351623/der-septimer-pass-wo-koenige-und-kaiser-die-alpen-ueberschritten.jpg
            //   https://img.oastatic.com/img2/6351623/full/der-septimer-pass-wo-koenige-und-kaiser-die-alpen-ueberschritten.jpg -- doesn't work
            //   https://img.oastatic.com/imgsrc/6351623/der-septimer-pass-wo-koenige-und-kaiser-die-alpen-ueberschritten.jpg -- doesn't work
            return src
                .replace(/\/img\/[0-9]+\/[0-9]+(?:\/fit)?\/([0-9]+)\/([^/]*)$/, "/img/$1/$2")
                .replace(/\/img\/([0-9]+)\/([^/]*)$/, "/img2/$1/full/$2")
                .replace(/\/imgmax\/([0-9]+)\/([^/]*)$/, "/img2/$1/full/$2")
                .replace(/(\/img2\/[0-9]+\/)[^/]*\/([^/]*)$/, "$1full/$2")
                .replace(/\/img2\/([0-9]+)\/full\/([^/]*)$/, "/imgsrc/$1/$2");
        }

        if (domain === "img.valais.ch" ||
            // https://images.weserv.nl/?url=i.imgur.com%2FQL25lgF.jpg&h=300&w=300&t=square
            //   http://i.imgur.com/QL25lgF.jpg
            domain === "images.weserv.nl" ||
            // http://nimg.ws.126.net/?url=http://dingyue.nosdn.127.net/jb2e85NSJvtbKrQdYP4op3hynHZMQ5TiYL0tR=t5jOnSn1533830845266compressflag.jpeg&thumbnail=260x150&quality=75&type=jpeg
            //   http://dingyue.nosdn.127.net/jb2e85NSJvtbKrQdYP4op3hynHZMQ5TiYL0tR=t5jOnSn1533830845266compressflag.jpeg
            domain === "nimg.ws.126.net") {
            // https://img.valais.ch/?url=img.oastatic.com%2Fimg%2F22917128%2F.jpg&w=940&h=580&t=square&q=75
            //   http://img.oastatic.com/img/22917128/.jpg
            return add_http(decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/.*?[?&]url=([^&]*).*/, "$1")));
        }

        if (domain_nosub === "etsystatic.com" &&
            (domain.match(/img[0-9]*\.etsystatic\.com/) ||
             domain === "i.etsystatic.com")) {
            // https://img.etsystatic.com/il/ee4147/687832738/il_340x270.687832738_akcv.jpg?version=3
            //   https://img.etsystatic.com/il/ee4147/687832738/il_570xN.687832738_akcv.jpg?version=3
            //   https://img.etsystatic.com/il/ee4147/687832738/il_fullxfull.687832738_akcv.jpg?version=3
            // https://img0.etsystatic.com/024/0/41472418/icm_fullxfull.34237406_jkqru58m5s84804o448s.jpg
            // https://img0.etsystatic.com/204/0/116068862/iusa_fullxfull.52864766_sco2.jpg
            // https://img1.etsystatic.com/188/0/14551365/isla_fullxfull.26904175_4smpme6j.jpg
            // https://img1.etsystatic.com/182/0/6993388/iss_fullxfull.12517843_i8l62k59.jpg
            // https://img0.etsystatic.com/196/0/7799858/igwp_fullxfull.1357445390_9pt1mltn.jpg
            // https://img0.etsystatic.com/189/0/274695830074/inv_fullxfull.1434228736_9e2pmqxr.jpg
            // https://img1.etsystatic.com/191/0/96548065/imfs_fullxfull.22421_y67munzc.jpg
            // https://img.etsystatic.com/il/ed3eab/845091829/il_570xN.845091829_qcz9.jpg?version=0
            //   https://img.etsystatic.com/il/ed3eab/845091829/il_fullxfull.845091829_qcz9.jpg?version=0
            // https://i.etsystatic.com/5313083/r/il/cbef0a/1250159710/il_570xN.1250159710_lwnm.jpg
            //   https://i.etsystatic.com/5313083/r/il/cbef0a/1250159710/il_fullxfull.1250159710_lwnm.jpg
            return src.replace(/(\/[a-z]+_)[0-9a-zA-Z]+x[0-9a-zA-Z]+\./, "$1fullxfull.");
        }

        if (domain_nosub === "twnmm.com") {
            // https://s1.twnmm.com/thumb?src=http://pelmorexpd-a.akamaihd.net/img/1942203455001/201804/1942203455001_5769239466001_5769162032001-vs.jpg?pubId=1942203455001&videoId=5769162032001&w=268&h=151&scale=1&crop=1
            //   http://pelmorexpd-a.akamaihd.net/img/1942203455001/201804/1942203455001_5769239466001_5769162032001-vs.jpg
            // https://s1.twnmm.com/thumb?src=//s1.twnmm.com/images/en_ca/12/GETTY%20-%20Snow%20and%20freezing%20rain-99295.jpg&w=145&h=80&scale=1&crop=1
            //   https://s1.twnmm.com/images/en_ca/12/GETTY%20-%20Snow%20and%20freezing%20rain-99295.jpg -- zero length image?
            return urljoin(src, src.replace(/^[a-z]+:\/\/[^/]*\/thumb.*?[?&]src=([^?&]*).*/, "$1"));
        }

        if (domain === "www.findx.com" &&
            src.indexOf("/api/images/assets/") >= 0) {
            // https://www.findx.com/api/images/assets/500,sJb7dhfdfn7FbXJ9txRO2ZJNsRJNSBrHH5D-lTi8zPa8/https://image.shutterstock.com/display_pic_with_logo/3323144/524606014/stock-vector-la-vie-est-belle-postcard-life-is-beautiful-in-french-ink-illustration-modern-brush-calligraphy-524606014.jpg
            //   https://image.shutterstock.com/display_pic_with_logo/3323144/524606014/stock-vector-la-vie-est-belle-postcard-life-is-beautiful-in-french-ink-illustration-modern-brush-calligraphy-524606014.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/api\/images\/assets\/[^/]*\//, "");
        }

        if (domain_nowww === "konsolinet.fi") {
            // https://www.konsolinet.fi/tuotekuvat/900x600/dims-quality-100-image_uri-http-3A-2F-2Fo-aolcdn-com-2Fhss-2Fstorage-2Fmidas-2Fc580709e7625f4ae45b7728ca8e4c68c-2F205370453-2Fmatterfall-cutscene-jpg-client-cbc79c14efcebee57402-signature-d89cb8da745b275966310f72eeb47f993dd3f470.jpg
            //   https://www.konsolinet.fi/tuotekuvat/dims-quality-100-image_uri-http-3A-2F-2Fo-aolcdn-com-2Fhss-2Fstorage-2Fmidas-2Fc580709e7625f4ae45b7728ca8e4c68c-2F205370453-2Fmatterfall-cutscene-jpg-client-cbc79c14efcebee57402-signature-d89cb8da745b275966310f72eeb47f993dd3f470.jpg
            return src.replace(/(:\/\/[^/]*\/[^/]*\/)[0-9]+x[0-9]+\//, "$1");
        }

        if ((domain_nosub === "vigbo.com" ||
             domain_nosub === "gophotoweb.com") &&
            domain.match(/^static[0-9]*\./)) {
            // http://static1.vigbo.com/u19820/22951/photos/3065711/1500-gophotoweb-5e9e0caa00352abf3c64dd6656552c8c.JPG
            //   http://static1.vigbo.com/u19820/22951/photos/3065711/2000-gophotoweb-5e9e0caa00352abf3c64dd6656552c8c.JPG
            // http://static1.gophotoweb.com/u4419/3425/photos/680943/500-alexey_trofimov-170b44c09e9fdabd1446bf2f125c2836.jpg
            // http://static1.gophotoweb.com/u5132/6272/photos/956409/1000-ilona_bitz-d03e78a0cbf053ad6f528185a36adb6e.jpg -- 2574x3861
            //   http://static1.gophotoweb.com/u5132/6272/photos/956409/2000-ilona_bitz-d03e78a0cbf053ad6f528185a36adb6e.jpg -- 2000x3000
            // http://static1.vigbo.com/u27635/36776/photos/2923250/27995e8e47fa8ce68f3bd8d453d39ef7.jpg
            // http://static1.vigbo.com/u25048/31970/blog/2516051/1515299/section/54291811154e5322f8bd5bb20dea92c9.JPG
            // http://static1.gophotoweb.com/u6358/7237/news/20481/olgailyina_011_small_size.jpg
            // http://static1.gophotoweb.com/u4846/4148/photos/3915482/500-angelina_popova-18dc621c7a32c1e2713004d4da7a448a.jpg -- 2832x3964
            //   http://static1.gophotoweb.com/u4846/4148/photos/3915482/2000-angelina_popova-18dc621c7a32c1e2713004d4da7a448a.jpg -- 2000x2799
            // http://static1.gophotoweb.com/u5582/8320/photos/1020204/1500-579c1845b3d10ee7c47879da356f7c96.jpg
            // http://static1.gophotoweb.com/u4101/2850/photos/68038/2000-MAXIM_PRUSAKOV-a9d75cf62aab8acd8b63bd08344f53e1.jpg
            // http://static1.gophotoweb.com/u3610/2156/photos/53740/1000-marinasapega%20%20-853ebe2afa24da5b6b817b6dbc97f492.jpg -- 3644x5466
            //   http://static1.gophotoweb.com/u3610/2156/photos/53740/2000-marinasapega%20%20-853ebe2afa24da5b6b817b6dbc97f492.jpg -- same size
            return src.replace(/\/[0-9]+-((?:[^/]*-)?[a-f0-9]{20,}\.[^/.]*)$/, "/2000-$1");
        }

        if (domain_nosub === "feelway.com" && domain.match(/img[0-9]*.feelway\.com/)) {
            // http://img016.feelway.com/3188/smallbd305pd3188424229ed1.jpg
            //   http://img016.feelway.com/3188/bd305pd3188424229ed1.jpg
            //   http://img016.feelway.com/goods_image/fpho_3188_bd305pd3188424229ed1/Amiri_%EB%B9%84%EB%B9%84%EC%95%84%EB%85%B8_17SSMDT01DST_%EB%94%94%EC%8A%A4%EB%8D%94%ED%8B%B0%EC%98%A4%EC%9D%BC_%EB%8D%B0%EB%8B%98%EC%9E%90%EC%BC%93_%EC%95%84%EB%AF%B8%EB%A6%AC_AM_1.jpg -- same size
            return src.replace(/(\/[0-9]+\/)small([^/]*)$/, "$1$2");
        }

        if (domain_nosub === "pichunter.com") {
            // https://y2.pichunter.com/3550353_9_t.jpg
            //   https://y2.pichunter.com/3550353_9.jpg
            //   https://y2.pichunter.com/3550353_9_o.jpg
            return src.replace(/(:\/\/[^/]*\/[0-9]+_[0-9]+)(?:_[a-z])?(\.[^/.]*)$/, "$1_o$2");
        }

        if (domain === "appdb.winehq.org") {
            // https://appdb.winehq.org/appimage.php?iId=27878&bThumbnail=true
            //   https://appdb.winehq.org/appimage.php?iId=27878
            return src.replace(/(\/appimage\.php.*?)([?&])bThumbnail=[^&]*/, "$1$2").replace(/&$/, "");
        }

        if (domain_nosub === "ikea.com" &&
            src.indexOf("/images/") >= 0) {
            // https://www.ikea.com/us/en/images/products/gurli-throw-green__0587646_PE672711_S4.JPG
            //   https://www.ikea.com/us/en/images/products/gurli-throw-green__0587646_PE672711_S5.JPG
            // https://www.ikea.com/ie/en/images/homepage/ikea-april-news-at-ikea__1364530466290-s2.jpg
            //   https://www.ikea.com/ie/en/images/homepage/ikea-april-news-at-ikea__1364530466290-s5.jpg
            // doesn't work:
            // https://www.ikea.com/gb/en/images/gb-img-fy15/ikea-sofa-guarantee__1364342102206-s4.jpg
            //   https://www.ikea.com/gb/en/images/gb-img-fy15/ikea-sofa-guarantee__1364342102206-s5.jpg -- doesn't work
            return src.replace(/([-_][sS])[0-9](\.[^/.]*)/, "$15$2");
        }

        if (domain === "img.onestore.co.kr") {
            // http://img.onestore.co.kr/thumbnails/img_sac/0_423_F20_95/data6/android/201411/19/IF1423406830820110607140552/0000677987/img/preview/0000677987_DP000103.jpg
            //   http://img.onestore.co.kr/thumbnails/img_sac/0_0_100/data6/android/201411/19/IF1423406830820110607140552/0000677987/img/preview/0000677987_DP000103.jpg
            // http://img.onestore.co.kr/thumbnails/img_sac/182_182_F10_95/data6/android/201411/19/IF1423406830820110607140552/0000677987/img/original/0000677987_DP000101.png
            //   http://img.onestore.co.kr/thumbnails/img_sac/0_0_100/data6/android/201411/19/IF1423406830820110607140552/0000677987/img/original/0000677987_DP000101.png
            return src.replace(/\/[0-9]+_[0-9]+_(?:F[0-9]+_)?[0-9]+\//, "/0_0_100/");
        }

        if (domain_nosub === "ismcdn.jp" ||
            // http://www.afpbb.com/mwimgs/c/5/810x540/img_c5f0f05a10b37771fc7fc89f3e02ad86302635.jpg
            //   http://www.afpbb.com/mwimgs/c/5/-/img_c5f0f05a10b37771fc7fc89f3e02ad86302635.jpg
            domain_nowww === "afpbb.com") {
            // http://www.afpbb.com/articles/-/3171540
            //   http://afpbb.ismcdn.jp/mwimgs/3/4/320x280/img_34b67f980d17e0eeb91b850dedddbfcd64467.jpg - thumbnail
            //     http://afpbb.ismcdn.jp/mwimgs/3/4/full//img_34b67f980d17e0eeb91b850dedddbfcd64467.jpg
            //     http://afpbb.ismcdn.jp/mwimgs/3/4/-//img_34b67f980d17e0eeb91b850dedddbfcd64467.jpg -- same
            //     http://afpbb.ismcdn.jp/mwimgs/6/b/full//img_6b3d3ed08132ac948cb47d119a152aad174843.jpg -- much larger
            // http://dol.ismcdn.jp/mwimgs/3/8/670m/img_38ec77dc8d6e7438877c3cf39207e20a26382.jpg
            //   http://dol.ismcdn.jp/mwimgs/3/8/-/img_38ec77dc8d6e7438877c3cf39207e20a26382.jpg
            return src.replace(/\/[0-9]+[xm](?:[0-9]+)?(\/[^/]*)$/, "/-$1");
        }

        if (domain_nosub === "yomiuri.co.jp" && src.indexOf("/photo/") >= 0) {
            // http://sp.yomiuri.co.jp/photo/20161027/20161027-OYT8I50121-L.jpg (1003x2393)
            //   http://sp.yomiuri.co.jp/photo/20161027/20161027-OYT8I50121-1.jpg (209x500)
            // http://sp.yomiuri.co.jp/photo/20180418/20180418-OYT1I50024-T.jpg
            //   http://sp.yomiuri.co.jp/photo/20180418/20180418-OYT1I50024-L.jpg
            // http://www.yomiuri.co.jp/photo/20180417/20180417-OYT8I50039-N.jpg
            //   http://www.yomiuri.co.jp/photo/20180417/20180417-OYT8I50039-L.jpg
            return src.replace(/-[A-Z0-9](\.[^/.]*)$/, "-L$1");
        }

        if (domain_nosub === "newswitch.jp" && domain.match(/c[0-9]*\.newswitch\.jp/)) {
            // https://c01.newswitch.jp/cover?url=http%3A%2F%2Fnewswitch.jp%2Fimg%2Fupload%2FphpG8O8Wr_585240ce5a647.JPG
            //   http://newswitch.jp/img/upload/phpG8O8Wr_585240ce5a647.JPG
            return decodeURIComponent(src.replace(/^[a-z]*:\/\/[^/]*\/cover.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        if (domain === "www.fashion-headline.com") {
            // https://www.fashion-headline.com/api/image/width/2000/images/migration/2015/01/a9201396f5dfc04a665e58a118f8f6cf.jpg
            //   https://www.fashion-headline.com/images/migration/2015/01/a9201396f5dfc04a665e58a118f8f6cf.jpg
            return src.replace(/\/api\/image\/(?:width|height)\/[0-9]+\//, "/");
        }

        if (domain_nosub === "stream.ne.jp" && domain.indexOf("cdnext.stream.ne.jp") >= 0) {
            // https://c799eb2b0cad47596bf7b1e050e83426.cdnext.stream.ne.jp/img/article/000/227/336/0f58889dfd526d5ad4588cf35b598b5320180417142350635_262_262.jpg
            //   https://c799eb2b0cad47596bf7b1e050e83426.cdnext.stream.ne.jp/img/article/000/227/336/0f58889dfd526d5ad4588cf35b598b5320180417142350635.jpg
            return src.replace(/(\/[0-9a-f]+)_[0-9]*_[0-9]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "kn3.net") {
            // https://k61.kn3.net/taringa/2/7/6/8/4/7/96/drporn/c_147x147_46D.jpg
            //   https://k61.kn3.net/taringa/2/7/6/8/4/7/96/drporn/46D.jpg
            // https://t3.kn3.net/taringa/8/C/A/1/F/5/Theylor-/92x70_213.jpg
            //   https://t3.kn3.net/taringa/8/C/A/1/F/5/Theylor-/213.jpg
            return src.replace(/\/(?:c_)?[0-9]+x[0-9]+_([0-9A-Z]*\.[^/.]*)$/, "/$1");
        }

        if (domain_nosub === "ptcdn.info") {
            // https://ptcdn.info/movies/2018/NDeXUJq0TD-1522146022_s.jpg
            //   https://ptcdn.info/movies/2018/NDeXUJq0TD-1522146022_o.jpg
            // https://f.ptcdn.info/406/056/000/p4x3357tsNw7rwRxtqs-s.jpg
            //   https://f.ptcdn.info/406/056/000/p4x3357tsNw7rwRxtqs-o.jpg
            // doesn't work with all:
            // https://ptcdn.info/pick/185/000/000/p7aa3c5czjptg1MsPPd-s.jpg
            //   https://pantip.com/topic/37569184
            //   https://f.ptcdn.info/118/057/000/p7aa3c5czjptg1MsPPd-o.jpg
            return src.replace(/([-_])[a-z](\.[^/.]*)$/, "$1o$2");
        }

        if (domain_nosub === "pikabu.ru") {
            // https://cs7.pikabu.ru/post_img/2018/04/17/4/1523941253189748852.jpg
            //   https://cs7.pikabu.ru/post_img/big/2018/04/17/4/1523941253189748852.jpg
            // doesn't work for all:
            // https://cs8.pikabu.ru/post_img/big/2016/10/28/8/147765812818422511.jpg
            return src.replace(/\/post_img\/([0-9]+)\//, "/post_img/big/$1/");
        }

        if (domain_nosub === "podium.life") {
            // https://c.podium.life/content/r/80/photo/2409/2409496/533aaf0ded61d.jpg
            //   https://c.podium.life/content/photo/2409/2409496/533aaf0ded61d.jpg
            // https://c.podium.life/content/r/2/p/28765/8112/5a81580060110.jpg
            //   https://c.podium.life/content/p/28765/8112/5a81580060110.jpg
            return src.replace(/\/content\/r\/[wh]?[0-9]*(?:x[0-9]+)?\//, "/content/");
        }

        if (domain_nosub === "filesor.com") {
            // http://ist5-1.filesor.com/pimpandhost.com/1/_/_/_/1/5/S/b/y/5Sbyx/IE001955316_ORG_l.jpg
            //   http://ist5-1.filesor.com/pimpandhost.com/1/_/_/_/1/5/S/b/y/5Sbyx/IE001955316_ORG.jpg
            // http://ist3-2.filesor.com/pimpandhost.com/1/_/_/_/1/3/4/Q/V/34QVp/1_0.jpg
            //   http://ist3-2.filesor.com/pimpandhost.com/1/_/_/_/1/3/4/Q/V/34QVp/1.jpg
            return src.replace(/_(?:[a-z]|[0-9])(\.[^/.]*)/, "$1");
        }

        if (domain_nowww === "namooactors.com") {
            // http://www.namooactors.com/data/file/nm3002/thumb_latest/latest_120X160_2072965477_kGZly3he_HB_CHA-PO4_7.jpg.jpg
            //   http://www.namooactors.com/data/file/nm3002/2072965477_kGZly3he_HB_CHA-PO4_7.jpg
            // http://www.namooactors.com/data/file/nm3402/thumb/list_175px_2072965478_ZIMqombp_13419267_1093373410756804_4684262674469315848_n__1_.jpg.jpg
            //   http://www.namooactors.com/data/file/nm3402/2072965478_ZIMqombp_13419267_1093373410756804_4684262674469315848_n__1_.jpg
            return src.replace(/\/thumb(?:_[^/]*)?\/[a-z]+_[0-9]+(?:px|X[0-9]+)_(.*?\.[^/.]*)\.[^/.]*$/, "/$1");
        }

        if (domain === "ftopx.com") {
            // https://ftopx.com/mini/201801/5a6b3a6bbc364.jpg
            //   https://ftopx.com/pic/1280x1024/201801/5a6b3a6bbc364.jpg
            //   https://ftopx.com/images/201801/ftopx.com_5a6b3a6bbc364.jpg
            // https://ftopx.com/mini/201709/59c718085fb87.jpg
            //   https://ftopx.com/images/201709/ftop.ru_59c718085fb87.jpg
            var timestamp = parseInt(src.replace(/.*[/_]([a-f0-9]{10,})\.[^/.]*$/, "$1"), 16);
            var prefix = "ftop.ru";
            if (timestamp > 1579484587755500)
                prefix = "ftopx.com";
            return src
                .replace(/\/(?:mini|large)\/([0-9]+)\/([^/]*)$/, "/images/$1/" + prefix + "_$2")
                .replace(/\/pic\/[0-9]+x[0-9]+\/([0-9]+)\/([^/]*)$/, "/images/$1/" + prefix + "_$2");
        }

        if (domain_nowww === "artleo.com") {
            // https://www.artleo.com/mini/201608/322769.jpg
            //   https://www.artleo.com/images/201608/artleo.com_322769.jpg
            var prefix = "artleo.com";
            return src
                .replace(/\/(?:mini|large)\/([0-9]+)\/([^/]*)$/, "/images/$1/" + prefix + "_$2")
                .replace(/\/pic\/[0-9]+x[0-9]+\/([0-9]+)\/([^/]*)$/, "/images/$1/" + prefix + "_$2");
        }

        if (domain_nowww === "goodwp.com") {
            // http://www.goodwp.com/large/201410/31901.jpg
            //   http://www.goodwp.com/images/201410/goodwp.com_31901.jpg
            var prefix = "goodwp.com";
            return src
                .replace(/\/(?:mini|large)\/([0-9]+)\/([^/]*)$/, "/images/$1/" + prefix + "_$2")
                .replace(/\/pic\/[0-9]+x[0-9]+\/([0-9]+)\/([^/]*)$/, "/images/$1/" + prefix + "_$2");
        }

        if (domain_nowww === "wykop.pl" && src.indexOf("/cdn/") >= 0) {
            // https://www.wykop.pl/cdn/c3201142/comment_N6Pmm34BPk025H5hqkRnulsYFT9SvVHc,w400.jpg
            //   https://www.wykop.pl/cdn/c3201142/comment_N6Pmm34BPk025H5hqkRnulsYFT9SvVHc.jpg
            // https://www.wykop.pl/cdn/c3397993/link_AtyRCGO0byZiykQx9SX8p0KO34BFHSoB,w113h64.jpg
            //   https://www.wykop.pl/cdn/c3397993/link_AtyRCGO0byZiykQx9SX8p0KO34BFHSoB.jpg
            return src.replace(/,[^/.]*(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "phoronix.net") {
            // https://www.phoronix.net/image.php?id=tomb-raider-20&image=tomb_vulkan_1_med
            // https://www.phoronix.net/image.php?id=tomb-raider-20&image=tomb_vulkan_4_med
            return src.replace(/(\/image\.php.*?[?&]image=[^&]*)_med/, "$1");
        }

        if (domain === "image.diyidan.net") {
            // https://www.diyidan.com/main/post/6294360860111032652/detail/1
            //   https://image.diyidan.net/post/2017/11/19/bWeT79y7vwR4GETq.jpg!weblarge
            //   https://image.diyidan.net/post/2017/11/19/bWeT79y7vwR4GETq.jpg
            // https://image.diyidan.net/user/2017/11/6/OKw88SkGjXLjINKS.jpg!tiny
            // it requires either a redirect from that page, or no headers whatsoever
            return {
                url: src.replace(/!.*/, ""),
                headers: {
                    Referer: "https://www.diyidan.com/"
                }
            };
        }

        if (domain === "www.hrkgame.com" &&
            src.indexOf("/.thumbnails/") >= 0) {
            // https://www.hrkgame.com/media/screens/245280/.thumbnails/ss_1fd48fdc4cc57663dbc04e87e5f131076eac11d6.600x338.jpg/ss_1fd48fdc4cc57663dbc04e87e5f131076eac11d6.600x338-800x500.jpg
            //   https://www.hrkgame.com/media/screens/245280/ss_1fd48fdc4cc57663dbc04e87e5f131076eac11d6.600x338.jpg
            return src.replace(/\/\.thumbnails\/([^/]*)\/.*/, "/$1");
        }

        if (domain_nowww === "dlcompare.com" &&
            src.indexOf("/upload/cache/") >= 0) {
            // http://www.dlcompare.com/upload/cache/game_screenshot/img/enslaved-odyssey-to-the-west-screenshot-2.jpg
            //   http://www.dlcompare.com/upload/cache/slider/img/enslaved-odyssey-to-the-west-screenshot-2.jpg
            //   http://www.dlcompare.com:8042/img/enslaved-odyssey-to-the-west-img-4.jpg
            // http://www.dlcompare.com/upload/cache/slider/upload/gameimage/file/36257.jpeg - 3840x2160
            //   http://www.dlcompare.com/upload/gameimage/file/36257.jpeg -- same size
            // http://www.dlcompare.com/upload/cache/game_widget/upload/gameimage/file/21574.jpeg
            //   http://www.dlcompare.com/upload/gameimage/file/21574.jpeg
            //   http://www.dlcompare.com:8042/upload/gameimage/file/21575.jpeg -- much bigger
            return src.replace(/\/upload\/cache\/[^/]*\//, "/");
            /*newsrc = src.replace(/\/upload\/cache\/[^/]*\/upload\//, "/upload/");
            if (newsrc !== src)
                return newsrc;
            return src.replace(/\/upload\/cache\/[^/]*\//, "/upload/cache/slider/");*/
        }

        if (domain_nosub === "alphacoders.com" &&
            (domain.match(/images[0-9]*\.alphacoders\.com/) ||
             // https://artfiles.alphacoders.com/741/thumb-74141.jpg
            //   https://artfiles.alphacoders.com/741/74141.jpg
             domain === "artfiles.alphacoders.com" ||
             // https://picfiles.alphacoders.com/172/thumb-172338.jpg
             //   https://picfiles.alphacoders.com/172/172338.jpg
             domain === "picfiles.alphacoders.com" ||
             // https://avatarfiles.alphacoders.com/130/thumb-130907.jpg
             //   https://avatarfiles.alphacoders.com/130/130907.jpg
             domain === "avatarfiles.alphacoders.com" ||
             // https://photofiles.alphacoders.com/421/thumb-42184.jpg
             //   https://photofiles.alphacoders.com/421/42184.jpg
             domain === "photofiles.alphacoders.com")) {
            // https://images2.alphacoders.com/728/thumb-350-728780.jpg
            //   https://images2.alphacoders.com/728/728780.jpg
            return src.replace(/\/thumb(?:-[0-9]*)?-([0-9]*\.[^/.]*)$/, "/$1");
        }

        if (domain === "mfiles.alphacoders.com" &&
            options && options.cb && options.do_request) {
            // https://mfiles.alphacoders.com/184/18416.jpg
            //   https://images5.alphacoders.com/414/414660.jpg
            // https://mfiles.alphacoders.com/586/thumb-586777.jpg
            //   https://images2.alphacoders.com/152/152200.jpg
            // https://mobile.alphacoders.com/wallpapers/view/18416/
            var id = src.replace(/.*\/thumb(?:-[0-9]*)?-([0-9]+)\.[^/.]*$/, "$1");
            if (id !== src) {
                options.do_request({
                    url: "https://mobile.alphacoders.com/wallpapers/view/" + id + "/",
                    method: "GET",
                    onload: function(resp) {
                        if (resp.readyState === 4) {
                            var match = resp.responseText.match(/"([a-z]+:\/\/wall\.alphacoders\.com\/big\.php\?i=[0-9]+)"/);
                            if (match) {
                                options.do_request({
                                    url: match[1],
                                    method: "GET",
                                    onload: function(resp) {
                                        if (resp.readyState === 4) {
                                            var match = resp.responseText.match(/<meta *property="og:image" *content="([^"]*)"/);
                                            if (match) {
                                                options.cb(match[1]);
                                            } else {
                                                options.cb(null);
                                            }
                                        }
                                    }
                                });
                            } else {
                                options.cb(null);
                            }
                        }
                    }
                });

                return {
                    waiting: true
                };
            }
        }

        if (domain_nowww === "gpstatic.com") {
            // https://gpstatic.com/acache/11/67/1/uk/s2_thumb-c5e9b414fd43a81842692da09938a394.jpg
            //   https://gpstatic.com/acache/11/67/1/uk/s2-c5e9b414fd43a81842692da09938a394.jpg
            return src.replace(/\/(s[0-9]*)_thumb(-[a-f0-9]*\.[^/.]*)$/, "/$1$2");
        }

        if (domain_nosub === "walldevil.com") {
            // https://www.walldevil.com/wallpapers/a81/thumb/enslaved-enslaved-odyssey-to-the-west.jpg
            //   https://www.walldevil.com/wallpapers/a81/enslaved-enslaved-odyssey-to-the-west.jpg
            // https://wallpapers.walldevil.com/wallpapers/a75/preview/wallpaper-anime-dark.jpg
            //   https://wallpapers.walldevil.com/wallpapers/a75/wallpaper-anime-dark.jpg
            return src.replace(/\/(?:thumb|preview)\//, "/");
        }

        if (domain === "www.peency.com" &&
            src.indexOf("/images/") >= 0) {
            // http://www.peency.com/images/2016/09/28/6b7af02546a41cd54_full.png
            //   http://www.peency.com/images/2016/09/28/6b7af02546a41cd54.png
            // http://www.peency.com/images/2014/10/21/jessica-alba-hot-photoshoot-wallpaper-2560x1440_240x200.jpg
            //   http://www.peency.com/images/2014/10/21/jessica-alba-hot-photoshoot-wallpaper-2560x1440.jpg
            return src.replace(/_[^/._]*(\.[^/.]*)$/, "$1");
        }

        if (domain === "www.wallpaperbetter.com" &&
            src.indexOf("/wallpaper/") >= 0) {
            // http://www.wallpaperbetter.com/wallpaper/659/286/567/sergey-fat-1080P-wallpaper-thumb.jpg
            //   http://www.wallpaperbetter.com/wallpaper/659/286/567/sergey-fat-1080P-wallpaper-middle-size.jpg
            //   http://www.wallpaperbetter.com/wallpaper/659/286/567/sergey-fat-1080P-wallpaper.jpg
            return src.replace(/-(?:thumb|middle-size)(\.[^/.]*)$/, "$1");
        }

        if (domain === "thiswallpaper.com" &&
            src.indexOf("/cdn/") >= 0) {
            // https://thiswallpaper.com/cdn/thumb/796/amazing%20rihanna%20full%20screen%20image.jpg
            //   https://thiswallpaper.com/cdn/hdwallpapers/796/amazing%20rihanna%20full%20screen%20image.jpg
            return src.replace("/cdn/thumb/", "/cdn/hdwallpapers/");
        }

        if (domain === "booklikes.com" &&
            src.indexOf("/upload/") >= 0) {
            // http://booklikes.com/photo/max/600/0/upload/post/a/8/azure_a8af8e2f197da5d3c84dbec44eb0ffed.jpg
            //   http://booklikes.com/upload/post/a/8/azure_a8af8e2f197da5d3c84dbec44eb0ffed.jpg
            return src.replace(/\/photo\/max\/[0-9]*\/[0-9]*\//, "/");
        }

        if (domain === "hdwallsource.com" &&
            src.indexOf("/img/") >= 0) {
            // https://hdwallsource.com/img/2016/6/thumb/jamie-bell-actor-wallpaper-background-hd-55539-57284-hd-wallpapers-thumb.jpg
            //   https://hdwallsource.com/img/2016/6/jamie-bell-actor-wallpaper-background-hd-55539-57284-hd-wallpapers.jpg
            return src.replace(/\/thumb\/([^/.]*)-thumb(\.[^/.]*)/, "/$1$2");
        }

        if ((domain === "www.customity.com" &&
             src.indexOf("/storage/public/") >= 0) ||
            // https://www.wisebread.com/files/fruganomics/imagecache/605x340/blog-images/man_with_cash_000073068135.jpg
            //   https://www.wisebread.com/files/fruganomics/blog-images/man_with_cash_000073068135.jpg
            (domain === "www.wisebread.com" &&
             src.indexOf("/files/") >= 0)) {
            // http://www.customity.com/storage/public/imagecache/0100x0100/image/wallpaper/201007/507-charlize-theron-wallpaper-1600x1200-customity.jpg
            //   http://www.customity.com/storage/public/image/wallpaper/201007/507-charlize-theron-wallpaper-1600x1200-customity.jpg
            return src.replace(/\/imagecache\/[0-9]+x[0-9]+\//, "/");
        }

        if ((domain === "www.desktopimages.org" ||
             // http://www.hdbilder.eu//pictures/2012/1002/1/th1_214136.jpg
             //   http://www.hdbilder.eu//pictures/2012/1002/1/orig_214136.jpg
             // http://www.hdbilder.eu/p/get_photo/214136/960/600
             domain_nowww === "hdbilder.eu" ||
             // http://www.fondsecran.eu//pictures/2015/1106/1/th1_637032.jpg
             //   http://www.fondsecran.eu//pictures/2015/1106/1/orig_637032.jpg
             domain_nowww === "fondsecran.eu")) {
            // http://www.desktopimages.org/pictures/2015/0713/1/th1_144184.jpg
            //   http://www.desktopimages.org/pictures/2015/0713/1/apple-os-x-el-capitans-wallpaper-144184.jpg
            //   http://www.desktopimages.org/pictures/2015/0713/1/orig_144184.jpg
            if (src.indexOf("/pictures/") >= 0) {
                newsrc = src.replace(/\/[^/]*[-_]([0-9]+\.[^/.]*)$/, "/orig_$1");
                if (newsrc !== src)
                    return newsrc;
            }

            if (options && options.cb && options.do_request &&
                src.match(/\/p\/get_photo\/[0-9]+\/[0-9]+/)) {
                var querysrc = src.replace(/\/p\/get_photo\/([0-9]+\/[0-9]+)(?:\/.*)?$/, "/p/$1/0/o");
                options.do_request({
                    url: querysrc,
                    method: "GET",
                    onload: function(resp) {
                        if (resp.readyState === 4) {
                            var match = resp.responseText.match(/<img *src="([^">]*\/orig_[^/">]*)"/);
                            if (match) {
                                options.cb(match[1]);
                            } else {
                                options.cb(null);
                            }
                        }
                    }
                });

                return {
                    waiting: true
                };
            }
        }

        if (domain === "www.bikerpunks.com" &&
            src.indexOf("/media/") >= 0) {
            // https://www.bikerpunks.com/media/thumbs/79687f0c3d11.jpg
            //   https://www.bikerpunks.com/media/largethumbs/79687f0c3d11.jpg
            //   https://www.bikerpunks.com/media/79687f0c3d11.jpg
            // doesn't work for all:
            // https://www.bikerpunks.com/media/thumbs/6c6820f9fb17.jpg
            //   https://www.bikerpunks.com/media/gallery/061e37dea07d99618dba00438d5f87ff.jpg
            return src.replace(/\/media\/[^/]*\/([0-9a-f]*\.[^/.]*)$/, "/media/$1");
        }

        if (domain_nosub === "livejournal.com" && domain.match(/i[a-z]*\.pics\.livejournal\.com/)) {
            // https://i.pics.livejournal.com/babymelaw/34311960/10819/10819_900.jpg
            //   https://i.pics.livejournal.com/babymelaw/34311960/10819/10819_original.jpg
            // https://ic.pics.livejournal.com/babymelaw/34311960/10819/10819_900.jpg
            //   https://ic.pics.livejournal.com/babymelaw/34311960/10819/10819_original.jpg
            // https://ic.pics.livejournal.com/zoyanailru/46712907/10570/300.jpg
            //   https://ic.pics.livejournal.com/zoyanailru/46712907/10570/original.jpg
            // https://pics.livejournal.com/feenal/pic/000h5zaw/s640x480 -- redirects to:
            //   https://ic.pics.livejournal.com/feenal/17315534/121949/121949_640.jpg
            // https://pics.livejournal.com/feenal/pic/000h5zaw/ -- redirects to:
            //   https://ic.pics.livejournal.com/feenal/17315534/121949/121949_original.jpg
            return src
                .replace(/(\/pic\/[0-9a-z]+\/)s[0-9]+x[0-9]+(?:[?#].*)?$/, "$1")
                .replace(/_[0-9]*(\.[^/.]*)$/, "_original$1")
                .replace(/(\/[0-9]+\/)[0-9]+(\.[^/.]*)$/, "$1original$2");
        }

        if (domain === "img-fotki.yandex.ru") {
            // http://img-fotki.yandex.ru/get/4606/142895192.a/0_6776c_3e548a9d_XL.gif
            //   http://img-fotki.yandex.ru/get/4606/142895192.a/0_6776c_3e548a9d_orig.gif
            // http://img-fotki.yandex.ru/get/4606/142895192.a/0_6776c_3e548a9d_XL
            //   http://img-fotki.yandex.ru/get/4606/142895192.a/0_6776c_3e548a9d_orig
            return src.replace(/_[^-/._]*(\.[^/.]*)?$/, "_orig$1");
        }

        if (domain_nosub === "steemitimages.com") {
            // deprecated, it's returning hashed urls now
            // https://steemitimages.com/0x0/https://steemitimages.com/DQmUXTDZ82P2K8iK1naLZETucmAcz7W9vvReEbTi5osSh4U/quantstamp_network-1.png
            //   https://steemitimages.com/DQmUXTDZ82P2K8iK1naLZETucmAcz7W9vvReEbTi5osSh4U/quantstamp_network-1.png
            // https://cdn.steemitimages.com/0x0/https://i.redd.it/satbsuymrzwz.jpg
            //   https://i.redd.it/satbsuymrzwz.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/[0-9]+x[0-9]+\//, "");
        }

        if (amazon_container &&
            amazon_container.match(/steemit-production-imageproxy-[^-.]*/)) {
            // doesn't work in all cases? private images maybe?
            // https://steemit-production-imageproxy-thumbnail.s3.amazonaws.com/DQmUXTDZ82P2K8iK1naLZETucmAcz7W9vvReEbTi5osSh4U_1680x8400
            //   https://steemit-production-imageproxy-upload.s3.amazonaws.com/DQmUXTDZ82P2K8iK1naLZETucmAcz7W9vvReEbTi5osSh4U
            // https://s3.amazonaws.com/steemit-production-imageproxy-thumbnail/DQmUXTDZ82P2K8iK1naLZETucmAcz7W9vvReEbTi5osSh4U_1680x8400
            //   https://s3.amazonaws.com/steemit-production-imageproxy-upload/DQmUXTDZ82P2K8iK1naLZETucmAcz7W9vvReEbTi5osSh4U
            return src
                .replace(/-imageproxy-thumbnail((?:\.[^/]*)?\/[A-Za-z0-9]*)_[0-9]+x[0-9]+$/, "-imageproxy-upload$1")
        }

        if (domain_nowww === "newsprom.ru") {
            // http://newsprom.ru/i/n/913/237913/237913_b78a299e453f.jpg
            //   http://newsprom.ru/i/n/913/237913/tn_237913_b78a299e453f.jpg
            return src.replace(/\/([0-9]+_[a-f0-9]+\.[^/.]*)$/, "/tn_$1");
        }

        if (domain_nosub === "fotocdn.net" && domain.match(/i[0-9]*\.fotocdn\.net/)) {
            // https://i07.fotocdn.net/s26/177/user_m/279/2643400368.jpg
            //   https://i07.fotocdn.net/s26/177/user_xl/279/2643400368.jpg
            // https://i10.fotocdn.net/s11/185/gallery_m/239/2308894392.jpg
            //   https://i10.fotocdn.net/s11/185/gallery_l/239/2308894392.jpg
            // https://i03.fotocdn.net/s28/142/user_l/328/2680637325.jpg
            // https://i01.fotocdn.net/s13/206/gallery_m/79/2370850509.jpg
            //   https://i01.fotocdn.net/s13/206/gallery_l/79/2370850509.jpg
            // https://i03.fotocdn.net/s10/119/public_pin_l/473/2467682422.jpg -- don't believe there's a public_pin_xl
            // https://i07.fotocdn.net/s26/103/public_pin_3c/186/2651896166.jpg
            //   https://i07.fotocdn.net/s26/103/public_pin_l/186/2651896166.jpg
            regex = /_(?:[a-z]+|[0-9]+c)(\/[0-9]+\/[0-9]+\.[^/.]*)$/;
            return [
                src.replace(regex, "_xl$1"),
                src.replace(regex, "_l$1")
            ];
        }

        if (domain_nowww === "news-people.fr" &&
            src.indexOf("/galerie/") >= 0) {
            // http://www.news-people.fr/galerie/731658/2.jpg
            //   http://www.news-people.fr/galerie/731658/2_hd.jpg
            return src.replace(/\/([0-9]*)(\.[^/.]*)$/, "/$1_hd$2");
        }

        if (domain_nosub === "cdn107.com") {
            // http://album2.cdn107.com/70/4d/704d6c866c741cced6136951968c51a1_sm.jpg
            //   http://album2.cdn107.com/70/4d/704d6c866c741cced6136951968c51a1.jpg
            // http://artist1.cdn107.com/16a/16a9b15e1220b200bb67f5fb4a46004c_lg.jpg
            //   http://artist1.cdn107.com/16a/16a9b15e1220b200bb67f5fb4a46004c.jpg
            return src.replace(/_[a-z]*(\.[^/.]*)$/, "$1");
        }

        if (domain === "hairstyles.thehairstyler.com") {
            // https://hairstyles.thehairstyler.com/hairstyle_views/front_view_images/12346/icon/short-straight-hairstyle.jpg
            //   https://hairstyles.thehairstyler.com/hairstyle_views/front_view_images/12346/original/short-straight-hairstyle.jpg
            // https://hairstyles.thehairstyler.com/hairstyles/images/20324/tiny/short-straight-hairstyle-with-bangs.jpg
            //   https://hairstyles.thehairstyler.com/hairstyles/images/20324/original/short-straight-hairstyle-with-bangs.jpg
            // https://hairstyles.thehairstyler.com/hairstyles/images/20353/thumb/short-blonde-asymmetrical-hairstyle.jpg
            //   https://hairstyles.thehairstyler.com/hairstyles/images/20353/thumb/short-blonde-asymmetrical-hairstyle.jpg
            return src.replace(/(\/[0-9]*\/)[^/]*\/([^/]*)$/, "$1original/$2");
        }

        if (domain_nowww === "abload.de" ||
            // http://wallpaperpulse.com/thumb/2358346.jpg
            //   http://wallpaperpulse.com/img/2358346.jpg
            domain === "wallpaperpulse.com") {
            // http://www.abload.de/thumb/celebrity-paradise.coxdc2s.jpg
            //   http://www.abload.de/img/celebrity-paradise.coxdc2s.jpg
            return src.replace(/\/thumb\//, "/img/");
        }

        if (domain === "assets.capitalfm.com" ||
            domain === "assets.gcstatic.com") {
            // https://assets.capitalfm.com/2018/15/sprite-cucumber-1524239960-list-tablet-0.png
            //   https://assets.capitalfm.com/2018/15/sprite-cucumber-1524239960-herowidev4-0.png
            //   https://assets.capitalfm.com/2018/15/sprite-cucumber-1524239960.png
            // http://assets.gcstatic.com/u/apps/asset_manager/uploaded/2017/17/victorious--1493385031-custom-0.jpg
            //   http://assets.gcstatic.com/u/apps/asset_manager/uploaded/2017/17/victorious--1493385031.jpg
            // https://assets.capitalfm.com/2017/17/victorious-1493385935-herowidev4-0.jpg
            //   https://assets.capitalfm.com/2017/17/victorious-1493385935.jpg
            return src.replace(/(\/[^/]*-[0-9]{8,})-[^/]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "www.leathercelebrities.com") {
            // doesn't work
            // http://www.leathercelebrities.com/images/resized/victoria-justice-attends-lmdm-grand-opening-party-300x450.jpg
            //   http://www.leathercelebrities.com/images/uploads/Victoria-Justice-attends-LMDM-Grand005.jpg
            // http://www.leathercelebrities.com/images/uploads/21621/victoria_justice_attends_lmdm_grand002__thumb.jpg
            //   http://www.leathercelebrities.com/images/uploads/21621/victoria_justice_attends_lmdm_grand002.jpg
            //
            // http://www.leathercelebrities.com/download.php?file=http%3A%2F%2Fwww.leathercelebrities.com%2Fimages%2Fuploads%2F21058%2Fdanielle_panabaker_is_seen_leaving_craig10.jpg
            //   http://www.leathercelebrities.com/images/uploads/21058/danielle_panabaker_is_seen_leaving_craig10.jpg
            return decodeURIComponent(src
                                      .replace(/^[a-z]+:\/\/[^/]*\/download\.php.*?[?&]file=([^&]*).*?$/, "$1")
                                      .replace(/(\/uploads\/[0-9]*\/[^/]*)__thumb(\.[^/.]*)$/, "$1$2"));
        }

        if (domain === "img.cache.vevo.com") {
            // https://img.cache.vevo.com/thumb/cms/6adeb8f9fb65d67e94044181f4e102c6/281x159.jpg
            //   https://img.cache.vevo.com/thumb/cms/6adeb8f9fb65d67e94044181f4e102c6.jpg
            // https://img.cache.vevo.com/thumb/artist/victoria-justice/220x220.jpeg
            //   https://img.cache.vevo.com/thumb/artist/victoria-justice.jpeg
            return src.replace(/(\/thumb\/[^/]*\/[^/]*)\/[0-9]+x[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "www.superiorpics.com") {
            // http://www.superiorpics.com/pictures2/thumb168/1TeenChoRD2028754.jpg
            //   http://www.superiorpics.com/pictures2/1TeenChoRD2028754.jpg
            return src.replace(/\/thumb[0-9]+\//, "/");
        }

        if (domain === "www.celebjihad.com" ||
            // https://image.dek-d.com/27/0327/3957/t_126536551
            //   https://image.dek-d.com/27/0327/3957/126536551
            domain === "image.dek-d.com") {
            // https://www.celebjihad.com/celeb-jihad/harlots/victoria_justice38/t_victoria_justice1.jpg
            //   https://www.celebjihad.com/celeb-jihad/harlots/victoria_justice38/victoria_justice1.jpg
            return src.replace(/\/t_([^/]*)$/, "/$1");
        }

        if (domain === "www.looktothestars.org" &&
            src.indexOf("/photo/") >= 0 && false) {
            // https://www.looktothestars.org/photo/6950-victoria-justice-fronts-psa/story_wide.jpg
            //   https://www.looktothestars.org/photo/6950-victoria-justice-fronts-psa/large.jpg
            // https://www.looktothestars.org/photo/3-george-clooney/small_square-1503121378.jpg
            //   https://www.looktothestars.org/photo/3-george-clooney/large.jpg -- stretched
            return src.replace(/\/[^/]*(\.[^/.]*)$/, "/large$1");
        }

        if (domain === "cdn.teamcococdn.com") {
            // http://cdn.teamcococdn.com/image/1000x1000,scale:none/victoria-justice-54ed2693b4bf1.jpg -- stretched
            //   http://cdn.teamcococdn.com/file/victoria-justice-54ed2693b4bf1.jpg
            return src.replace(/\/image\/[^/]*\//, "/file/");
        }

        if ((domain_nosub === "staticflickr.com" ||
             (domain_nosub === "flickr.com" && domain.indexOf(".static.flickr.com") >= 0)) &&
            src.match(/\/[0-9]+_[0-9a-f]+(?:_[a-z]*)?\.[a-z]+.*$/) &&
            !src.match(/\/[0-9]+_[0-9a-f]+_o\.[a-z]+.*$/) &&
            options && options.do_request && options.cb) {
            // https://c1.staticflickr.com/5/4190/34341416210_29e6098b30.jpg
            //   https://farm5.staticflickr.com/4190/34341416210_9f14cc1576_o.jpg
            // https://farm5.static.flickr.com/4157/34467046051_631ea7efa7_b.jpg
            //   https://farm5.staticflickr.com/4157/34467046051_9b6f0e9a7c_o.jpg
            // http://farm8.staticflickr.com/7034/6693295971_22e55a1b42_z.jpg%3C/br%3E
            // http://farm8.staticflickr.com/7034/6693295971_22e55a1b42_z.jpg</undefined
            // http://farm8.staticflickr.com/7034/6693295971_22e55a1b42_z.jpg%3C/undefined.
            //   https://farm8.staticflickr.com/7034/6693295971_36acecc53b_o.jpg
            // https://farm8.staticflickr.com/7002/6432649813_4fe18483a6.jpg
            //   https://farm8.staticflickr.com/7002/6432649813_21c9e80f43_o.jpg
            src = src.replace(/(:\/\/[^/]*\/(?:[0-9]+\/)?[0-9]+\/[0-9]+_[0-9a-f]+(?:_[a-z])?\.[a-zA-Z0-9]*).*$/, "$1");
            options.do_request({
                url: "https://www.flickr.com/",
                method: "GET",
                headers: {
                    "Origin": "",
                    "Referer": "",
                    "Cookie": ""
                },
                onload: function(resp) {
                    if (resp.readyState === 4) {
                        var regex = /root\.YUI_config\.flickr\.api\.site_key *= *['"]([^'"]*)['"] *; */;
                        var matchobj = resp.responseText.match(regex);
                        if (!matchobj) {
                            cb(null);
                            return;
                        }

                        var key = matchobj[1];
                        var photoid = src.replace(/.*\/([0-9]+)_[^/]*$/, "$1");
                        var nexturl = "https://api.flickr.com/services/rest?csrf=&api_key=" + key + "&format=json&nojsoncallback=1&method=flickr.photos.getSizes&photo_id=" + photoid;
                        options.do_request({
                            url: nexturl,
                            method: "GET",
                            headers: {
                                "Origin": "",
                                "Referer": "",
                                "Cookie": ""
                            },
                            onload: function(resp) {
                                try {
                                    var out = JSON_parse(resp.responseText);
                                    var largesturl = null;
                                    var largestsize = 0;
                                    out.sizes.size.forEach(function (size) {
                                        var currentsize = parseInt(size.width) * parseInt(size.height);
                                        if (currentsize > largestsize || size.label === "Original") {
                                            largestsize = currentsize;
                                            largesturl = size.source;
                                        }
                                    });
                                    options.cb(largesturl);
                                    return;
                                } catch (e) {
                                    options.cb(null);
                                    return;
                                }
                            }
                        });
                    }
                }
            });

            return {
                "waiting": true
            };
        }

        if (domain === "www.imagozone.com" ||
            // http://www.imagozone.ro/var/thumbs/vedete/Victoria%20Justice/2010/Victoria%20Justice%2001.jpg?m=1312910214
            //   http://www.imagozone.ro/var/albums/vedete/Victoria%20Justice/2010/Victoria%20Justice%2001.jpg?m=1312910214
            domain_nowww === "imagozone.ro" ||
            // http://ohsohumorous.com/var/thumbs/Cosplay-Memes/cosplay8-16.jpg?m=1525371835
            //   http://ohsohumorous.com/var/albums/Cosplay-Memes/cosplay8-16.jpg?m=1525371835
            domain_nowww === "ohsohumorous.com" ||
            // http://www.celebritiestown.com/celebritypictures/var/resizes/Celebrity-Street-Style/Jessica-Alba-Best-Street-Style-09.jpg?m=1450092223
            //   http://www.celebritiestown.com/celebritypictures/var/albums/Celebrity-Street-Style/Jessica-Alba-Best-Street-Style-09.jpg?m=1450092223
            domain_nowww === "celebritiestown.com") {
            // http://www.imagozone.com/var/resizes/vedete/Victoria%20Justice/Victoria%20Justice%203012.jpg
            //   http://www.imagozone.com/var/albums/vedete/Victoria%20Justice/Victoria%20Justice%203012.jpg
            // http://www.imagozone.com/var/thumbs/vedete/Amber%20Heard/Amber%20Heard%20005.jpg?m=1312958883
            //   http://www.imagozone.com/var/albums/vedete/Amber%20Heard/Amber%20Heard%20005.jpg?m=1312958883
            // doesn't work:
            // http://www.imagozone.com/var/thumbs/vedete/Amber%20Heard/2007/.album.jpg?m=1312542209
            if (!src.match(/\/\.album\.[^/.]*$/))
                return src.replace(/\/var\/(?:resizes|thumbs)\//, "/var/albums/");
        }

        if (domain_nosub === "tunes.zone") {
            // http://ru.tunes.zone/poster/person/230x230/29/22/72/0/292272-fotografii-iz-victoria-justice.jpg
            //   http://tunes.zone/poster/person/full/29/22/72/0/292272-fotografii-iz-victoria-justice.jpg
            // http://ru.tunes.zone/poster/banner/400x250o/15/84/57/9/1584579/19572-spider-man-homecoming.jpg
            // doesn't work for all:
            // http://ru.tunes.zone/poster/person/100x100/29/22/68/0/292268-fotografii-iz-victoria-justice-4.jpg
            //   http://ru.tunes.zone/poster/person/full/29/22/68/0/292268-fotografii-iz-4.jpg
            // http://tunes.zone/poster/person/100x100/57/48/0/0/5748-photos-with-galia-albin-1.jpg
            //   http://tunes.zone/poster/person/full/57/48/0/0/5748-photos-with-1.jpg
            // http://es.tunes.zone/poster/person/full/33/52/63/0/335263-las-fotografias-de-2.jpg
            // http://jp.tunes.zone/poster/person/100x100/29/56/29/0/295629--maisie-richardson-sellers-14.jpg
            //   http://jp.tunes.zone/poster/person/full/29/56/29/0/295629--14.jpg
            // http://jp.tunes.zone/poster/person/230x230/29/56/18/0/295618--maisie-richardson-sellers.jpg
            //   http://jp.tunes.zone/poster/person/full/29/56/18/0/295618--maisie-richardson-sellers.jpg
            var basic = src.replace(/\/[0-9]+x[0-9]+[a-z]?\//, "/full/");
            if (basic !== src) {
                var other = basic.replace(/-[a-z]+-[a-z]+(-[0-9]+)?(\.[^/.]*)$/, "$1$2");
                var other1 = basic.replace(/(\/[0-9]+-+)[^/]*-([0-9]+\.[^/.]*)$/, "$1$2");
                if (basic.match(/\/[0-9]+--/))
                    return [other1, basic, other];
                else if (basic.match(/-[0-9]+\.[^/.]*$/))
                    return [other, basic, other1];
                else
                    return [basic, other, other1];
            }
        }

        if (domain === "sf.co.ua") {
            // http://sf.co.ua/16/12/tn-4358.jpg
            //   http://sf.co.ua/16/12/wallpaper-4358.jpg
            return src.replace(/\/tn-([0-9]*\.[^/.]*)/, "/wallpaper-$1");
        }

        if (domain_nosub === "zerochan.net" && domain.match(/^s[^.]*.zerochan.net/)) {
            // https://s3.zerochan.net/IA.240.878867.jpg
            //   https://static.zerochan.net/IA.240.878867.jpg
            //   https://static.zerochan.net/IA.full.878867.jpg
            // https://static.zerochan.net/Kirigaya.Kazuto.600.1450176.jpg
            //   https://static.zerochan.net/Kirigaya.Kazuto.full.1450176.jpg
            return src
                .replace(/:\/\/s[^.]*.zerochan.net\//, "://static.zerochan.net/")
                .replace(/(:\/\/[^/]*\/[^/]*\.)[0-9]+(\.[0-9]+\.[^/.]*)$/, "$1full$2");
        }

        if (domain_nosub === "donmai.us") {
            // https://hijiribe.donmai.us/data/sample/__nishimori_yusa_otosaka_ayumi_and_tomori_nao_charlotte_anime_and_newtype_drawn_by_higashiji_kazuki_inoue_katsue_kato_chie_satou_youko_sekiguchi_kanami_and_sugawara_mika__sample-5bae8d2a395e9b9b9f9f803a8c3eb4b1.jpg
            //   https://hijiribe.donmai.us/data/__nishimori_yusa_otosaka_ayumi_and_tomori_nao_charlotte_anime_and_newtype_drawn_by_higashiji_kazuki_inoue_katsue_kato_chie_satou_youko_sekiguchi_kanami_and_sugawara_mika__5bae8d2a395e9b9b9f9f803a8c3eb4b1.jpg
            // https://danbooru.donmai.us/data/preview/3f22b81d5d80e06bdb3f6e157f66ed00.jpg
            //   https://danbooru.donmai.us/data/__original__3f22b81d5d80e06bdb3f6e157f66ed00.jpg
            //   https://hijiribe.donmai.us/data/3f22b81d5d80e06bdb3f6e157f66ed00.jpg
            // https://hijiribe.donmai.us/data/sample/sample-1585a3ea7ca3c467b7631ce59850b2af.jpg
            //   https://hijiribe.donmai.us/data/1585a3ea7ca3c467b7631ce59850b2af.jpg
            // https://danbooru.donmai.us/data/preview/1585a3ea7ca3c467b7631ce59850b2af.jpg
            //   https://danbooru.donmai.us/data/__original__1585a3ea7ca3c467b7631ce59850b2af.jpg -- doesn't work
            //   https://hijiribe.donmai.us/data/1585a3ea7ca3c467b7631ce59850b2af.jpg
            // https://danbooru.donmai.us/data/preview/3ef47b49bd09e97a009eac8465b662f0.jpg
            //   https://hijiribe.donmai.us/data/3ef47b49bd09e97a009eac8465b662f0.png
            newsrc = src
                .replace(/\/data\/sample\/([^/]*__)?sample-([0-9a-f]*\.[^/.]*)$/, "/data/$1$2")
                .replace(/:\/\/danbooru\.donmai\.us\/data\/preview\//, "://hijiribe.donmai.us/data/")
                // the text doesn't matter, as long as it's __[a-z_]+__
                .replace(/\/data\/preview\/([^/]*)$/, "/data/__original__$1");

            if (newsrc !== src)
                return add_extensions(newsrc);
        }

        if (domain === "cdn.vor.us") {
            // https://cdn.vor.us/event/350763/thumbsm/458aa4c3a2c74b409282dd83a36cbf25.image!jpeg.9752676.jpg._Z5J5526.jpg
            //   https://cdn.vor.us/event/350763/og/458aa4c3a2c74b409282dd83a36cbf25.image!jpeg.9752676.jpg._Z5J5526.jpg
            // https://cdn.vor.us/event/350763/thumbsm/0aa7913a692d4f97b1a549660eb80eba.image!jpeg.16170343.jpg._Z5J4082.jpg
            //   https://cdn.vor.us/event/350763/og/0aa7913a692d4f97b1a549660eb80eba.image!jpeg.16170343.jpg._Z5J4082.jpg
            return src.replace(/\/thumbs[a-z]?\//, "/og/");
        }

        if (domain === "wallpapers.wallhaven.cc" ||
            // https://alpha.wallhaven.cc/wallpapers/thumb/small/th-527922.jpg
            //   https://alpha.wallhaven.cc/wallpapers/full/wallhaven-527922.jpg
            domain === "alpha.wallhaven.cc") {
            // https://wallpapers.wallhaven.cc/wallpapers/thumb/small/th-68352.jpg
            //   https://wallpapers.wallhaven.cc/wallpapers/full/wallhaven-68352.jpg
            return src.replace(/\/thumb\/[^/]*\/th-/, "/full/wallhaven-");
        }

        if (domain === "cdn.animenewsnetwork.com") {
            // https://cdn.animenewsnetwork.com/thumbnails/max350x1000/cms/interview/40076/keyart.jpg.jpg
            //   https://cdn.animenewsnetwork.com/thumbnails/hotlink-full/cms/interview/40076/keyart.jpg.jpg -- 3956x5373
            //   https://cdn.animenewsnetwork.com/images/cms/interview/40076/keyart.jpg.jpg -- same size
            // https://cdn.animenewsnetwork.com/images/cms/feature/111684/09.jpg -- 1920x1080
            // https://cdn.animenewsnetwork.com/thumbnails/cover400x200/cms/episode-review.2/135908/chioep8.jpg
            //   https://cdn.animenewsnetwork.com/images/cms/episode-review.2/135908/chioep8.jpg
            //return src.replace(/\/thumbnails\/[^/]*\//, "/thumbnails/hotlink-full/");
            return src.replace(/\/thumbnails\/[^/]*\/cms\//, "/images/cms/");
        }

        if ((domain === "digitalart.io" && src.indexOf("/storage/") >= 0) ||
            // https://www.fashion-press.net/img/news/23766/w300_rianna_13.jpg
            //   https://www.fashion-press.net/img/news/23766/rianna_13.jpg
            domain_nowww === "fashion-press.net" && src.indexOf("/img/") >= 0) {
            // https://digitalart.io/storage/artworks/1301/h250_anime_protagonist-wide.jpeg
            //   https://digitalart.io/storage/artworks/1301/anime_protagonist-wide.jpeg
            // https://digitalart.io/storage/artworks/709/h250_Asuka-Langley-Neon-Genesis-Evangelist-Wallpaper.jpeg
            //   https://digitalart.io/storage/artworks/709/Asuka-Langley-Neon-Genesis-Evangelist-Wallpaper.jpeg
            return src.replace(/(\/[0-9]*\/)[wh][0-9]+_([^/]*)$/, "$1$2");
        }

        if (domain_nowww === "4everstatic.com" ||
            domain === "pictures.4ever.eu") {
            // still has logo though
            // http://4everstatic.com/pictures/850xX/cartoons/anime-and-fantasy/anime-girl,-red-dress,-river-218133.jpg
            //   http://4everstatic.com/pictures/cartoons/anime-and-fantasy/anime-girl,-red-dress,-river-218133.jpg
            //   http://pictures.4ever.eu/data/download/cartoons/anime-and-fantasy/anime-girl,-red-dress,-river-218133.jpg?no-logo
            // http://4everstatic.com/bilderse/674xX/manniskor/musiker/rihanna,-rodharig-217524.jpg
            //   http://4everstatic.com/bilderse/manniskor/musiker/rihanna,-rodharig-217524.jpg
            //   http://4everstatic.com/pictures/people/musicians/rihanna,-redhead-217524.jpg
            //return src.replace(/\/pictures\/[0-9X]+x[0-9X]+\//, "/pictures/");

            if (!src.match(/:\/\/[^/]*\/data\/download\//)) {
                return [
                    // removes the logo, but forces download
                    src.replace(/:\/\/[^/]*\/[a-z]+\/(?:[0-9X]+x[0-9X]+\/)?([^?]*).*?$/, "://pictures.4ever.eu/data/download/$1?no-logo"),

                    //src.replace(/:\/\/[^/]*\/[a-z]+\/(?:[0-9X]+x[0-9X]+\/)?([^?]*).*?$/, "://pictures.4ever.eu/data/download/$1?no-logo"),
                    src.replace(/(:\/\/[^/]*\/[a-z]+\/)[0-9X]+x[0-9X]+\//, "$1")
                ];
            }
        }

        if (domain_nowww === "tapeciarnia.pl") {
            // https://tapeciarnia.pl/tapety/srednie/264402_dziewczyna_manga_anime.jpg
            //   https://tapeciarnia.pl/tapety/normalne/264402_dziewczyna_manga_anime.jpg
            return src.replace(/\/tapety\/[^/]*\//, "/tapety/normalne/");
        }

        if (domain === "files.yande.re") {
            // https://files.yande.re/sample/c3e3fd1d97b4e237e996e6b1bfafa4e6/yande.re%20190111%20sample%20anime_tenchou%20anizawa_meito%20cosplay%20hiiragi_kagami%20izumi_konata%20kusakabe_misao%20lucky_star%20seifuku%20sword%20takara_miyuki%20thighhighs%20vocaloid.jpg
            //   https://files.yande.re/image/c3e3fd1d97b4e237e996e6b1bfafa4e6/yande.re%20190111%20anime_tenchou%20anizawa_meito%20cosplay%20hiiragi_kagami%20izumi_konata%20kusakabe_misao%20lucky_star%20seifuku%20sword%20takara_miyuki%20thighhighs%20vocaloid.jpg
            return src
                .replace(/\/sample\//, "/image/");
        }

        if (domain === "assets.yande.re") {
            // https://assets.yande.re/data/preview/5c/0d/5c0dce008b820e531309e54a17c83f3a.jpg
            //   https://files.yande.re/image/5c0dce008b820e531309e54a17c83f3a.jpg
            return src.replace(/:\/\/assets.yande.re\/data\/preview\/[0-9a-f]+\/[0-9a-f]+\//, "://files.yande.re/image/");
        }

        if (domain_nowww === "zastavki.com") {
            // http://zastavki.com/pictures/640x480/2015/Anime_Picnic_on_the_lawn__anime_Klannad_102412_29.jpg
            //   http://zastavki.com/pictures/originals/2015/Anime_Picnic_on_the_lawn__anime_Klannad_102412_.jpg
            // http://www.zastavki.com/pictures/286x180/2015/Anime_Yuki_Asuna_smiles_092918_32.jpg
            //   http://www.zastavki.com/pictures/originals/2015/Anime_Yuki_Asuna_smiles_092918_.jpg
            // http://www.zastavki.com/pictures/640x480/2018Animals___Dogs_A_little_funny_puppy_with_his_tongue_hanging_out_122826_29.jpg
            //   http://www.zastavki.com/pictures/originals/2018Animals___Dogs_A_little_funny_puppy_with_his_tongue_hanging_out_122826_.jpg
            return src.replace(/\/pictures\/[0-9]+x[0-9]+\/(.*_[0-9]+)_[0-9]+(\.[^/.]*)$/, "/pictures/originals/$1_$2");
        }

        if (domain_nosub === "wallls.com" && domain.match(/w[0-9]*\.wallls.com/)) {
            // http://w4.wallls.com/uploads/high-thumbnail/201702/01/121462.jpg
            //   http://w4.wallls.com/uploads/original/201702/01/wallls.com_121462.jpg
            // http://w4.wallls.com/uploads/thumbnail/201711/21/157267.jpg
            //   http://w4.wallls.com/uploads/original/201711/21/wallls.com_157267.jpg
            return src.replace(/\/uploads\/[^/]*\/([0-9]*\/[0-9]*\/)([0-9]*\.[^/.]*)$/, "/uploads/original/$1wallls.com_$2");
        }

        if (domain === "www.wallpaperflare.com" &&
            src.indexOf("/static/") >= 0) {
            // https://www.wallpaperflare.com/static/786/500/37/girl-anime-automaton-guns-wallpaper-preview.jpg
            //   https://www.wallpaperflare.com/static/786/500/37/girl-anime-automaton-guns-wallpaper.jpg
            return src.replace(/-preview(\.[^/.]*)$/, "$1");
        }

        if (domain === "content.hardtunes.com") {
            // https://content.hardtunes.com/albums/6541/6815/248x248.jpg
            //   https://content.hardtunes.com/albums/6541/6815/original.jpg
            return src.replace(/\/[0-9]+x[0-9]+(\.[^/.]*)$/, "/original$1");
        }

        if (domain_nowww === "4kw.in" &&
            src.indexOf("/Wallpapers/") >= 0) {
            // http://4kw.in/Wallpapers/Beautiful-anime-girl-4k-3840x21601.jpg
            //   http://www.4kw.in/Wallpapers/Beautiful-anime-girl-4k-3840x2160.jpg
            // http://4kw.in/Wallpapers/Anime-girl-ice-cream-desert-4k1.jpg
            //   http://4kw.in/Wallpapers/Anime-girl-ice-cream-desert-4k.jpg
            return src.replace(/1(\.[^/.]*)$/, "$1");
        }

        if (domain === "imgs-art-dragoart-386112.c.cdn77.org") {
            // https://imgs-art-dragoart-386112.c.cdn77.org/anime-girl-running-into-the-light_1_000000074972_4.jpg
            //   https://imgs-art-dragoart-386112.c.cdn77.org/anime-girl-running-into-the-light_1_000000074972_1.jpg
            return src.replace(/_[0-9]*(\.[^/.]*)$/, "_1$1");
        }

        if (domain_nosub === "nyafuu.org" && domain.match(/archive-media-[0-9]*\.nyafuu\.org/)) {
            // https://archive-media-0.nyafuu.org/w/thumb/1524/41/1524414969310s.jpg
            //   https://archive-media-0.nyafuu.org/w/image/1524/41/1524414969310.jpg
            // doesn't work for all:
            // https://archive-media-0.nyafuu.org/w/thumb/1490/20/1490207933485s.jpg
            //   https://archive-media-0.nyafuu.org/w/image/1490/20/1490207933485.png
            return src
                .replace(/:\/\/archive-media-[0-9]*\./, "://archive-media-0.")
                .replace(/\/thumb\//, "/image/")
                .replace(/(\/[0-9]*)[a-z](\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "hulkshare.com" && domain.match(/s[0-9]*\.hulkshare\.com/)) {
            // http://s0.hulkshare.com//artists/180/c/3/6/c361bc7b2c033a83d663b8d9fb4be56e.jpg?dd=1513632152
            //   http://s0.hulkshare.com//artists/original/c/3/6/c361bc7b2c033a83d663b8d9fb4be56e.jpg?dd=1513632152
            // http://s3.hulkshare.com/song_images/120/a/3/4/a342dfe999a823948f4472afed3ecc74.jpg?dd=1405601334
            //   http://s3.hulkshare.com/song_images/original/a/3/4/a342dfe999a823948f4472afed3ecc74.jpg?dd=1405601334
            return src.replace(/\/[0-9]*\/([0-9a-f]\/[0-9a-f]\/[0-9a-f]\/[0-9a-f]*\.[^/.]*)$/, "/original/$1");
        }

        if (domain_nosub === "zumst.com" && domain.match(/static\.[^.]*\.zumst\.com/)) {
            // http://static.news.zumst.com/images/thumb/18/2018/04/17/a9f0d24d1aa64b9f868a5743640e8de8.jpg
            //   http://static.news.zumst.com/images/18/2018/04/17/a9f0d24d1aa64b9f868a5743640e8de8.jpg
            return src.replace("/thumb/", "/");
        }

        if (domain_nowww === "wikihow.com" &&
            src.indexOf("/images/") >= 0) {
            // https://www.wikihow.com/images/thumb/b/ba/Roll-Sod-Step-14-Version-3.jpg/aid1391676-v4-728px-Roll-Sod-Step-14-Version-3.jpg
            //   https://www.wikihow.com/images/b/ba/Roll-Sod-Step-14-Version-3.jpg
            return src.replace(/\/thumb\/(.*?\.[^/.]*)(?:\/.*)/, "/$1");
        }

        if (false && (domain_nosub === "kakaocdn.net" ||
                      domain_nosub === "kakao.co.kr")) {
            // https://dn-s-story.kakaocdn.net/dn/Qqfey/hytef1ArTx/qZmOLz8iP9oj5eZDEQEbDk/img_m.jpg?width=650&height=975&avg=%2523817f77&v=2
            //   http://dn-s-story.kakao.co.kr/dn/Qqfey/hytef1ArTx/qZmOLz8iP9oj5eZDEQEbDk/img_m.jpg
            //   https://dn-xl0-story.kakaocdn.net/dn/Qqfey/hytef1ArTx/qZmOLz8iP9oj5eZDEQEbDk/img_xl.jpg?width=650&height=975&avg=%2523817f77&v=2
            //   http://dn-s-story.kakao.co.kr/dn/Qqfey/hytef1ArTx/qZmOLz8iP9oj5eZDEQEbDk/img.jpg
            // http://dn-l1-story.kakao.co.kr/dn/bpU40i/hyglUiBxbK/TgKflthO9wKjHf1TemKnx0/img_l.jpg?width=1446&height=1920
            //   http://dn-l1-story.kakao.co.kr/dn/bpU40i/hyglUiBxbK/TgKflthO9wKjHf1TemKnx0/img_l.jpg
            //   http://dn-l1-story.kakao.co.kr/dn/bpU40i/hyglUiBxbK/TgKflthO9wKjHf1TemKnx0/img_xl.jpg -- stretched?
            //   http://dn-l1-story.kakao.co.kr/dn/bpU40i/hyglUiBxbK/TgKflthO9wKjHf1TemKnx0/img.jpg -- 404
        }

        if (domain === "obs.line-scdn.net") {
            // https://obs.line-scdn.net/0hHuiuzxHgF1pUDDvjJ95oDSBRETUtbw1SPnQAYCFaHXQhYABaPHYebDRcFjoqaAxUNzoQYm0OGQwONQBwIDgIQjpSPCl8YBUFNBxcfQleMT0BQQpJOHZYOHIJTWh4NVMMaGIKaXcLQW48PVkMODpcOnU/small
            //   https://obs.line-scdn.net/0hHuiuzxHgF1pUDDvjJ95oDSBRETUtbw1SPnQAYCFaHXQhYABaPHYebDRcFjoqaAxUNzoQYm0OGQwONQBwIDgIQjpSPCl8YBUFNBxcfQleMT0BQQpJOHZYOHIJTWh4NVMMaGIKaXcLQW48PVkMODpcOnU
            // https://obs.line-scdn.net/0hKIDhz0IEFGZ5ETjf-dFrMQ1MEgkAcg5uE2kDXAxHHkgMfQNmEWsdUBlBFQYHdQ9oGicTXkARHjcwVzJLLBYfaw5kPgYwegxiNjMJa1VXMwhdRzNZOmtbBF8UTlRRJlU4RX8JUFwZSFERIFowFSReCVo/small
            //   https://obs.line-scdn.net/0hKIDhz0IEFGZ5ETjf-dFrMQ1MEgkAcg5uE2kDXAxHHkgMfQNmEWsdUBlBFQYHdQ9oGicTXkARHjcwVzJLLBYfaw5kPgYwegxiNjMJa1VXMwhdRzNZOmtbBF8UTlRRJlU4RX8JUFwZSFERIFowFSReCVo
            // https://obs.line-scdn.net/0hC4kQ_ABvHBtWKDChhAhjTCJ1GnQvSwYTPFALISN-FjUjRAsbPlIVLTZ4HXsoTAcVNR4bI293JmJ8YBIxNBESKQEuR04wQyZPDDw3GwZMQlg-S10dPVJTeXAtRyN6GFpPakYBKHQvSi4-GVJNOk9UenU/small
            //   https://obs.line-scdn.net/0hC4kQ_ABvHBtWKDChhAhjTCJ1GnQvSwYTPFALISN-FjUjRAsbPlIVLTZ4HXsoTAcVNR4bI293JmJ8YBIxNBESKQEuR04wQyZPDDw3GwZMQlg-S10dPVJTeXAtRyN6GFpPakYBKHQvSi4-GVJNOk9UenU
            // https://obs.line-scdn.net/0hkNQBJYc8NGFsOxgIp3lLNiRmMg4VWC5pBkMjWxltPk8ZVyNhBEE4Vwt5LhIRVDZ1TCYNTk1aGQc2UiFvJikLRA96KRQ_YCx2LiQhDjZiAxADF3MzUFxzB088blNBAyFgUFp9AAw6bFQRXyY2VA/small
            //   https://obs.line-scdn.net/0hkNQBJYc8NGFsOxgIp3lLNiRmMg4VWC5pBkMjWxltPk8ZVyNhBEE4Vwt5LhIRVDZ1TCYNTk1aGQc2UiFvJikLRA96KRQ_YCx2LiQhDjZiAxADF3MzUFxzB088blNBAyFgUFp9AAw6bFQRXyY2VA - 4032x3168
            // https://obs.line-scdn.net/0hYJbHYMpsBmVfMSkJA2N5MmdsABImHwNhfRMIUSRtAAokHRNqf1FPA3I1XUlxAhEyY1FKAD8wX1B0B0dkZw/s375x375
            //   https://obs.line-scdn.net/0hYJbHYMpsBmVfMSkJA2N5MmdsABImHwNhfRMIUSRtAAokHRNqf1FPA3I1XUlxAhEyY1FKAD8wX1B0B0dkZw
            return {
                can_head: false,
                url: src.replace(/(:\/\/[^/]*\/[-_0-9A-Za-z]*)\/[a-z0-9]*$/, "$1")
            };
        }

        if (domain === "scdn.line-apps.com") {
            // https://scdn.line-apps.com/obs/0hYJbHYMpsBmVfMSkJA2N5MmdsABImHwNhfRMIUSRtAAokHRNqf1FPA3I1XUlxAhEyY1FKAD8wX1B0B0dkZw/s375x375
            //   https://scdn.line-apps.com/0hYJbHYMpsBmVfMSkJA2N5MmdsABImHwNhfRMIUSRtAAokHRNqf1FPA3I1XUlxAhEyY1FKAD8wX1B0B0dkZw/s375x375
            //   https://obs.line-scdn.net/0hYJbHYMpsBmVfMSkJA2N5MmdsABImHwNhfRMIUSRtAAokHRNqf1FPA3I1XUlxAhEyY1FKAD8wX1B0B0dkZw/s375x375
            //   https://obs.line-scdn.net/0hYJbHYMpsBmVfMSkJA2N5MmdsABImHwNhfRMIUSRtAAokHRNqf1FPA3I1XUlxAhEyY1FKAD8wX1B0B0dkZw
            return src.replace(/^[a-z]+:\/\/[^/]*\/(?:obs\/)?([-_0-9A-Za-z]*)(?:\/[a-z0-9]*)?$/, "https://obs.line-scdn.net/$1");
        }

        if (domain === "cdn-obs.line-apps.com") {
            // http://cdn-obs.line-apps.com/line/r/lineq/c/39502AA7-70E6-4CA0-BC5A-BAA75CFE9AAD.be1e14t04a16236/200x200.rf
            //   http://cdn-obs.line-apps.com/line/r/lineq/c/39502AA7-70E6-4CA0-BC5A-BAA75CFE9AAD.be1e14t04a16236
            return src.replace(/(\/[-0-9A-F]+\.[0-9a-z]+)\/[^/]*$/, "$1");
        }

        if (domain === "resize-image.lineblog.me") {
            // https://resize-image.lineblog.me/47c5e2ea477a5b48ce91fcca631bbd99655224b0/crop1/60x60/https://obs.line-scdn.net/0hKIDhz0IEFGZ5ETjf-dFrMQ1MEgkAcg5uE2kDXAxHHkgMfQNmEWsdUBlBFQYHdQ9oGicTXkARHjcwVzJLLBYfaw5kPgYwegxiNjMJa1VXMwhdRzNZOmtbBF8UTlRRJlU4RX8JUFwZSFERIFowFSReCVo/small
            return src.replace(/^[a-z]+:\/\/[^/]*\/[0-9a-f]*\/.*?\/([a-z]+:\/\/.*)/, "$1");
        }

        if (domain_nosub === "viki.io" && domain.match(/^[0-9]*\.viki\.io/)) {
            // https://6.viki.io/image/8c632348fc5d4e8b80db59c38fbf6f29.jpeg?x=b&a=0x0&s=780x436&q=h&e=t&f=t&cb=1
            //   https://6.viki.io/image/8c632348fc5d4e8b80db59c38fbf6f29.jpeg
            return {
                can_head: false,
                url: src.replace(/\?.*/, "")
            };
        }

        if (domain_nosub === "crunchyroll.com" && domain.match(/img[0-9]*\.[^/.]*\.crunchyroll\.com/)) {
            // http://img1.ak.crunchyroll.com/i/spire1/863ba423b729f58769a4004834e5554e1491069428_thumb.jpg
            //   http://img1.ak.crunchyroll.com/i/spire1/863ba423b729f58769a4004834e5554e1491069428_full.jpg
            return src.replace(/(\/[0-9a-f]+)_[a-z]*(\.[^/.]*)$/, "$1_full$2");
        }

        if (domain === "d3ieicw58ybon5.cloudfront.net") {
            // https://d3ieicw58ybon5.cloudfront.net/resize/1600/u/e33bc7c858c44506a860fc2409f80d7b.jpg.webp
            //   https://d3ieicw58ybon5.cloudfront.net/full/u/e33bc7c858c44506a860fc2409f80d7b.jpg.webp
            // https://d3ieicw58ybon5.cloudfront.net/ex/640.400/0.127.2455.1535/u/abbaffa834cc49f9aa318ae280fd10f0.jpg.webp
            //   https://d3ieicw58ybon5.cloudfront.net/full/u/abbaffa834cc49f9aa318ae280fd10f0.jpg.webp
            // https://d3ieicw58ybon5.cloudfront.net/ex/350.350/shop/product/bf108bdf69264ab9992775fbd8906521.jpg
            //   https://d3ieicw58ybon5.cloudfront.net/ex/350.350/shop/product/bf108bdf69264ab9992775fbd8906521.jpg
            return {
                url: src
                    .replace(/\/resize\/[0-9]+\//, "/full/")
                    .replace(/\/ex\/[0-9]+\.[0-9]+\/(?:(?:[0-9]+\.){3}[0-9]+\/)?/, "/full/"),
                can_head: false
            };
        }

        if (domain === "az616578.vo.msecnd.net") {
            // https://az616578.vo.msecnd.net/files/responsive/cover/main/desktop/2016/05/22/6359949242235344891413001074_All%20the%20anime.jpeg
            //   https://az616578.vo.msecnd.net/files/2016/05/22/6359949242235344891413001074_All%20the%20anime.jpeg
            return src.replace(/\/files\/responsive\/[^/]*\/[^/]*\/[^/]*\//, "/files/");
        }

        if ((domain_nosub === "dreamwiz.net" && domain.match(/img[0-9]*\.dreamwiz\.net/)) ||
            // https://kep.cdn.index.hu/1/0/1081/10818/108187/10818731_a9dd5fca6ef2c0a76289d40cdc7bfa3e_m.jpg -- has watermark
            //   https://kep.cdn.index.hu/1/0/1081/10818/108187/10818731_a9dd5fca6ef2c0a76289d40cdc7bfa3e_o.jpg -- no watermark
            // http://kep.cdn.index.hu/1/0/109/1095/10959/1095933_dac6c5cac679c316db35cc7d8f2c3342_wm.jpg
            //   http://kep.cdn.index.hu/1/0/109/1095/10959/1095933_dac6c5cac679c316db35cc7d8f2c3342_o.jpg
            domain === "kep.cdn.index.hu" ||
            // https://kep.cdn.indexvas.hu/1/0/1390/13903/139030/13903056_a12075627654662f42ea3dbf77b8e0bf_s.jpg
            //   https://kep.cdn.indexvas.hu/1/0/1390/13903/139030/13903056_a12075627654662f42ea3dbf77b8e0bf_o.jpg
            // doesn't work:
            // http://kep.cdn.indexvas.hu/1/0/1101/11010/110101/11010115_4822af4c84231b7d1bea46ce1f6e78db_wm.jpg
            //   http://kep.cdn.indexvas.hu/1/0/1101/11010/110101/11010115_4822af4c84231b7d1bea46ce1f6e78db_o.jpg -- doesn't work
            // changing to index.hu doesn't work either:
            // https://kep.cdn.index.hu/1/0/1101/11010/110101/11010115_4822af4c84231b7d1bea46ce1f6e78db_wm.jpg -- works
            //   https://kep.cdn.index.hu/1/0/1101/11010/110101/11010115_4822af4c84231b7d1bea46ce1f6e78db_o.jpg -- doesn't work
            domain === "kep.cdn.indexvas.hu") {
            // http://img77.dreamwiz.net/E/Z/T/EZTk3KA_m.jpg
            //   http://img77.dreamwiz.net/E/Z/T/EZTk3KA_l.jpg
            //   http://img77.dreamwiz.net/E/Z/T/EZTk3KA_o.jpg
            // doesn't work for all:
            // http://img77.dreamwiz.com/20180425/INI_DATA/hottopic/IMAGE/l/t/N/ltNNq0A_m.jpg
            //   http://img77.dreamwiz.com/l/t/N/ltNNq0A_m.jpg -- doesn't work
            return src.replace(/_(?:[a-z]|wm)(\.[^/.]*)$/, "_o$1");
        }

        if (false && (domain_nosub === "sportsworldi.com" ||
                      domain_nosub === "segye.com") &&
            src.indexOf("/content/image/") >= 0) {
            // http://img.sportsworldi.com/content/image/2018/04/23/20180423000784_t.jpg
            //   http://img.sportsworldi.com/content/image/2018/04/23/20180423000784_0.jpg -- not larger
            // http://img.sportsworldi.com/content/image/2018/04/25/20180425002868_t.jpg
            //   http://img.sportsworldi.com/content/image/2018/04/25/20180425002868_0.jpg
            // http://img.segye.com/content/image/2018/04/23/20180423000737_t.jpg
            //   http://img.segye.com/content/image/2018/04/23/20180423000737_0.jpg
            // http://img.sportsworldi.com/content/image/2018/06/15/20180615000548_t.jpg
            //   http://mimg.sportsworldi.com/content/image/2018/06/20/20180620000504_t.jpg
            //   http://m.sportsworldi.com/content/image/2018/06/20/20180620000504_p.jpg
            //   http://m.sportsworldi.com/content/image/2018/06/20/20180620000504_0.jpg
            // doesn't work for all:
            // http://m.sportsworldi.com/content/image/2018/01/01/20180101001612_t.jpg -- 960x1440
            //   http://mimg.sportsworldi.com/content/image/2018/01/01/20180101001612_p.jpg -- 310x465
            //   http://m.sportsworldi.com/content/image/2018/01/01/20180101001612_0.jpg -- smaller (same for img.sportsworldi.com too)
            // http://img.sportsworldi.com/content/image/2017/12/23/20171223000846_t.jpg
            //   http://img.sportsworldi.com/content/image/2017/12/23/20171223000846_0.jpg -- smaller
            // http://img.sportsworldi.com/content/image/2017/12/12/20171212001686_t.jpg -- 5208x3858
            //   http://img.sportsworldi.com/content/image/2017/12/12/20171212001686_0.jpg -- 500x370
            return src.replace(/_[a-z](\.[^/.]*)$/, "_0$1");
        }

        if (domain_nowww === "maximkorea.net" &&
            src.indexOf("/magdb/file/") >= 0) {
            // http://www.maximkorea.net/magdb/file/138/138_3289240590_img_400.jpg
            //   http://www.maximkorea.net/magdb/file/138/138_3289240590_img.jpg
            return src.replace(/_img_[0-9]+(\.[^/.]*)$/, "_img$1");
        }

        if (domain === "blogimgc.eximg.jp") {
            // https://blogimgc.eximg.jp/i=https%253A%252F%252Fpds.exblog.jp%252Fpds%252F1%252F201804%252F20%252F93%252Fd0150493_21520100.jpg,small=200,quality=75,type=jpg
            //   https://pds.exblog.jp/pds/1/201804/20/93/d0150493_21520100.jpg
            return decodeURIComponent(decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/.*?i=([^,]*).*?$/, "$1")));
        }

        if (domain === "i.gzn.jp" ||
            // https://galeri4.uludagsozluk.com/120/_168878_m.jpg
            //   https://galeri4.uludagsozluk.com/120/_168878.jpg -- 2164x2900
            (domain_nosub === "uludagsozluk.com" && domain.match(/^galeri[0-9]*\./))) {
            // https://i.gzn.jp/img/2016/05/05/costume-players-fashion-machiasobi16/P368001cf_m.jpg
            //   https://i.gzn.jp/img/2016/05/05/costume-players-fashion-machiasobi16/P368001cf.jpg
            // https://i.gzn.jp/img/2018/04/25/amazon-route-53-hacked/00_m.jpg
            //   https://i.gzn.jp/img/2018/04/25/amazon-route-53-hacked/00.jpg
            // doesn't work for all:
            // https://i.gzn.jp/img/2016/05/05/costume-players-fashion-machiasobi16/00_m.jpg
            return src.replace(/_[a-z](\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "okmusic.jp" ||
            // http://newsimg.music-book.jp/news_images/images/1131249/large.?1485747730
            //   http://newsimg.music-book.jp/news_images/images/1131249/original.?1485747730
            domain === "newsimg.music-book.jp") {
            // https://c.okmusic.jp/news_items/images/261768/more_large.jpg?1524641204
            //   https://c.okmusic.jp/news_items/images/261768/original.jpg?1524641204
            // https://c.okmusic.jp/app_artist_media_files/images/149/large.jpg
            //   https://c.okmusic.jp/app_artist_media_files/images/149/original.jpg
            // http://s.okmusic.jp/news_images/images/2103004/large.jpg?1485745865
            //   http://s.okmusic.jp/news_images/images/2103004/original.jpg?1485745865
            return src.replace(/(\/images\/[0-9]*\/)[^/.]*(\.[^/.]*)$/, "$1original$2");
        }

        if (domain === "ure.pia.co.jp" && src.indexOf("/mwimgs/") >= 0) {
            // http://ure.pia.co.jp/mwimgs/1/1/150/img_11e927362deb536d06a148164711f753324690.jpg
            //   http://ure.pia.co.jp/mwimgs/1/1/-/img_11e927362deb536d06a148164711f753324690.jpg
            return src.replace(/(\/mwimgs\/[0-9a-f]+\/[0-9a-f]+\/)[0-9]+\//, "$1-/");
        }

        if (domain === "kai-you.net") {
            // https://kai-you.net/r/img/a/752x/160814_kc90_0043.jpg?20180417135722
            //   https://kai-you.net/press/img/160814_kc90_0043.jpg?20180417135722
            // http://kai-you.net/r/img/a/c192x192/160814_kc90_0039.jpg
            //   http://kai-you.net/press/img/160814_kc90_0039.jpg
            // https://kai-you.net/images/a/2018/04/c672x416/37538746dc80daa2447b2652c73fb88a.jpg
            //   https://kai-you.net/images/a/2018/04/37538746dc80daa2447b2652c73fb88a.jpg
            //   https://kai-you.net/press/img/a7b4d4ab27d40caa23a964184b4903db.jpg?20180425182556
            return src
                .replace(/\/r\/img\/[a-z]\/[a-z]?[0-9]+x(?:[0-9]+)?\//, "/press/img/")
                .replace(/(\/images\/.*)\/[a-z]?[0-9]+x(?:[0-9]+)?\/([^/]*)$/, "$1/$2");
        }

        if (domain === "cdn.fortune-girl.com" ||
            // http://girlspolish.jp/system/item_images/images/000/017/452/medium/13c97c51-60d1-4dfc-b9e6-5b8df642af16.jpg?1468969209
            //   http://girlspolish.jp/system/item_images/images/000/017/452/original/13c97c51-60d1-4dfc-b9e6-5b8df642af16.jpg?1468969209
            domain_nowww === "girlspolish.jp" ||
            // http://joah-girls.com/system/item_images/images/000/112/476/medium/a9faac95-20df-48f5-a855-0c9791e1ec11.jpg?1513993165
            //   http://joah-girls.com/system/item_images/images/000/112/476/original/a9faac95-20df-48f5-a855-0c9791e1ec11.jpg?1513993165
            domain_nowww === "joah-girls.com") {
            // https://cdn.fortune-girl.com/medium/513f7c8a-e8a1-44e8-9eec-76b37b4e7e42.jpg?1496131561
            //   https://cdn.fortune-girl.com/original/513f7c8a-e8a1-44e8-9eec-76b37b4e7e42.jpg?1496131561
            //return src.replace(/(:\/\/[^/]*\/)[a-z]*\/([-0-9a-f]*\.[^/.]*)$/, "$1original/$2");
            return src.replace(/\/[a-z]*\/([-0-9a-f]*\.[^/.]*)$/, "/original/$1");
        }

        if (domain === "storage.withnews.jp" ||
            amazon_container === "storage.withnews.jp") {
            // http://storage.withnews.jp/2014/08/17/5/b4/5b4bd1e0-s.jpg
            //   http://storage.withnews.jp/2014/08/17/5/b4/5b4bd1e0.jpg
            // https://s3-ap-northeast-1.amazonaws.com/storage.withnews.jp/2016/10/06/9/c8/9c867eb1-ml.jpg
            //   https://s3-ap-northeast-1.amazonaws.com/storage.withnews.jp/2016/10/06/9/c8/9c867eb1-l.jpg
            //   https://s3-ap-northeast-1.amazonaws.com/storage.withnews.jp/2016/10/06/9/c8/9c867eb1.jpg -- 3205x2133
            return src.replace(/-[a-z]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "wowma.net" && domain.match(/ic[0-9]*-a\.wowma\.net/)) {
            // https://ic4-a.wowma.net/mi/gr/114/item5.goqsystem.com/goqdir/starriver/prodimg/30816_1.jpg
            //   http://item5.goqsystem.com/goqdir/starriver/prodimg/30816_1.jpg
            // https://ic4-a.wowma.net/mi/gr/115/item5.goqsystem.com/goqdir/starriver/prodimg/30816_2.jpg
            //   http://item5.goqsystem.com/goqdir/starriver/prodimg/30816_2.jpg
            // https://ic4-a.wowma.net/mi/w/1280/h/1280/q/90/bcimg1-a.wowma.net/plus/u10068283/pc/event/season/moccasin/img/mayumayu_img.jpg
            //   http://bcimg1-a.wowma.net/plus/u10068283/pc/event/season/moccasin/img/mayumayu_img.jpg
            // https://ic4-a.wowma.net/mis/gr/115/imgu-a.wowma.net/exu7/cb/1/11788337/13/mb/267355277_1.jpg
            //   http://imgu-a.wowma.net/exu7/cb/1/11788337/13/mb/267355277_1.jpg
            //   http://image.wowma.jp/11554363/img/srcl-9489.jpg
            return src.replace(/^[a-z]*:\/\/[^/]*\/mis?\/.*?\/([^/]*\.[^/]*\/.*)/, "http://$1");
        }

        if (domain === "sokuup.net") {
            // https://sokuup.net/imgm/soku_30203.jpg
            //   https://sokuup.net/imgs/soku_30203.jpg
            //   https://sokuup.net/img/soku_30203.jpg -- 4000x6016
            return src.replace(/\/img[a-z]\//, "/img/");
        }

        if (domain_nosub === "cosp.jp" && domain.match(/image[0-9]\.cosp\.jp/)) {
            // http://image7.cosp.jp/thumb/member/g/487/487029/12414133s.gif
            //   http://image7.cosp.jp/images/member/g/487/487029/12414133b.jpg
            //   http://image7.cosp.jp/images/member/g/487/487029/12414133.jpg
            // http://image7.cosp.jp/thumb/member/g/487/487029/12412384s.gif
            //   http://image7.cosp.jp/images/member/g/487/487029/12412384.jpg
            // https://image7.cosp.jp/thumb/member/g/208/208575/12524167m.jpg
            //   https://image7.cosp.jp/images/member/g/208/208575/12524167.jpg
            // https://image7.cosp.jp/images/member/g/350/350035/12015221_740.jpg
            //   https://image7.cosp.jp/images/member/g/350/350035/12015221.jpg
            return src
                .replace(/\/thumb\/(.*?\/[0-9]+)[a-z]\.(?:gif|jpg)$/, "/images/$1.jpg")
                .replace(/(\/images\/.*\/[0-9]+)_[0-9]+(\.[^/.]*)$/, "$1$2")
                .replace(/(\/[0-9]+)[a-z](\.[^/.]*)/, "$1$2");
        }

        if (domain_nowww === "gahag.net") {
            // can't have google's referrer
            // http://gahag.net/img/201605/11s/gahag-008493.jpg
            //   http://gahag.net/img/201605/11s/gahag-0084931896-1.jpg
            //   http://img01.gahag.net/201605/11o/gahag-0084931896.jpg
            // http://gahag.net/img/201605/12s/gahag-0085298715-1.jpg
            //   http://img01.gahag.net/201605/12o/gahag-0085298715.jpg
            return src.replace(/:\/\/[^/]*\/img\/([^/]*)\/([0-9]+)[a-z]\/([^-/]+-[0-9]+)-[0-9](\.[^/.]*)/,
                               "://img01.gahag.net/$1/$2o/$3$4");
        }

        if (domain === "img-cdn.jg.jugem.jp") {
            // http://img-cdn.jg.jugem.jp/584/719314/20131206_802592_t.jpg
            //   http://img-cdn.jg.jugem.jp/584/719314/20131206_802592.jpg
            //   http://img-cdn.jg.jugem.jp/584/719314/20131206_802592.jpg?guid=ON&view=mobile&tid=1 -- no difference
            return src.replace(/_[a-z](\.[^/.]*)$/, "$1");
        }

        if (domain === "public.muragon.com") {
            // https://public.muragon.com/6phbmj9m/16q9y7i0/crop/270x270.png
            //   https://public.muragon.com/6phbmj9m/16q9y7i0.png
            // https://public.muragon.com/6phbmj9m/y8zyxnww/resize/640x640.jpg?1508627308000
            //   https://public.muragon.com/6phbmj9m/y8zyxnww.jpg?1508627308000
            return src.replace(/\/(?:crop|resize)\/[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "base-ec2if.akamaized.net") {
            // https://base-ec2if.akamaized.net/w=76,a=0,q=90,u=1/images/item/origin/d38861ba6e9f258591fbbb495f133a62.jpg
            //   https://base-ec2if.akamaized.net/images/item/origin/d38861ba6e9f258591fbbb495f133a62.jpg
            return src.replace(/(:\/\/[^/]*\/)[^/]*[a-z]=[0-9][^/]*\//, "$1");
        }

        if (domain_nosub === "imageflux.jp") {
            // https://p1-e6eeae93.imageflux.jp/c!/a=2,w=460,h=460/mytown/6761e7b2ef74bca9a858.jpeg
            //   https://p1-e6eeae93.imageflux.jp/mytown/6761e7b2ef74bca9a858.jpeg
            return src.replace(/\/c!\/[^/]*[a-z]=[0-9][^/]*\//, "/");
        }

        if (domain_nosub === "bloguru.com" &&
            src.indexOf("/userdata/") >= 0) {
            // http://jp.bloguru.com/userdata/173/173/201504062228130.JPG
            //   http://jp.bloguru.com/userdata/173/173/orig_201504062228130.JPG
            // http://en.bloguru.com/userdata/173/173/201504062228130.JPG
            //   http://en.bloguru.com/userdata/173/173/orig_201504062228130.JPG
            return src.replace(/\/([^/_]*)$/, "/orig_$1");
        }

        if (domain === "www.atpress.ne.jp") {
            // https://www.atpress.ne.jp/releases/112459/js_img_112459_3.jpg
            //   https://www.atpress.ne.jp/releases/112459/img_112459_3.jpg
            // https://www.atpress.ne.jp/releases/112459/js_img_112459_2.jpg
            //   https://www.atpress.ne.jp/releases/112459/img_112459_2.jpg
            return src.replace(/(\/[0-9]+\/)[a-z]+_(img_[0-9]+[^/]*\.[^/.]*)$/, "$1$2");
        }

        if (domain === "img-proxy.blog-video.jp" ||
            // https://api.pddataservices.com/images?url=http://storage.torontosun.com/v1/dynamic_resize/sws_path/suns-prod-images/1297884869613_ORIGINAL.jpg%3Fsize=520x&w=840&h=560
            domain === "api.pddataservices.com") {
            // https://img-proxy.blog-video.jp/images?url=http%3A%2F%2Fuguisu.skr.jp%2Frecollection%2Fimg%2Fyudai121014.jpg
            //   http://uguisu.skr.jp/recollection/img/yudai121014.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/images.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        if (domain === "cdn.otamart.com") {
            // https://cdn.otamart.com/item-picture/18188083/0-1517534918796-thumbnail.jpg
            //   https://cdn.otamart.com/item-picture/18188083/0-1517534918796.jpg
            return src.replace(/-thumbnail(\.[^/.]*)$/, "$1");
        }

        if (domain === "www.pakutaso.com") {
            // https://www.pakutaso.com/shared/img/thumb/yuseiIMGL2091_TP_V1.jpg
            //   https://www.pakutaso.com/shared/img/thumb/yuseiIMGL2091.jpg
            return src.replace(/(\/img\/thumb\/[^/_.]*)_[^/.]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "cdn.atwiki.jp" ||
            // http://kinohron.mskcentrum.sk/data-files/kino/photogallery/155/small_3301.jpg
            //   http://kinohron.mskcentrum.sk/data-files/kino/photogallery/155/3301.jpg -- larger, but adds watermark
            (domain === "kinohron.mskcentrum.sk" && src.indexOf("/data-files/") >= 0) ||
            // https://www.neosite.pl/upload/user/15/89/33/small_1589337670.jpg
            //   https://www.neosite.pl/upload/user/15/89/33/1589337670.jpg
            (domain_nowww === "neosite.pl" && src.indexOf("/upload/user/"))) {
            // https://cdn.atwiki.jp/game/news/image/1553/small_2e8123c6-479e-4e49-a787-f20a36f5767e.jpg
            //   https://cdn.atwiki.jp/game/news/image/1553/2e8123c6-479e-4e49-a787-f20a36f5767e.jpg
            return src.replace(/\/small_([^/]*)$/, "/$1");
        }

        if (domain === "getfile.fmkorea.com") {
            // https://getfile.fmkorea.com/getfile.php?code=a210413ef29c311aa833f8b468e8d4dc&file=http%3A%2F%2Fimg.ruliweb.com%2Fdata%2Fnews18%2F06m%2F12%2Fmulti%2Fmai01s.jpg&r=
            //   http://img.ruliweb.com/data/news18/06m/12/multi/mai01s.jpg
            return decodeURIComponent(src.replace(/.*?\/getfile\.php.*?[?&]file=([^&]*).*/, "$1"));
        }

        if (domain === "img.ruliweb.com" ||
            // http://20.dtiblog.com/s/sstommy2/file/0701-5-7s.jpg
            //   http://20.dtiblog.com/s/sstommy2/file/0701-5-7.jpg
            // http://2.dtiblog.com/t/trackbackhonsya/file/eric-charlizes.jpg
            //   http://2.dtiblog.com/t/trackbackhonsya/file/eric-charlize.jpg
            (domain_nosub === "dtiblog.com" && domain.match(/[0-9]*\.dtiblog\.com/)) ||
            // http://img.korewaeroi.com/imgs07/1533651606/1_3s.jpg
            //   http://img.korewaeroi.com/imgs07/1533651606/1_3.jpg
            domain === "img.korewaeroi.com" ||
            // https://abc.imgxyqpdrs.xyz/tokimeki/img/otakara/201709/amuro_namie/ha170922-amuro_namie-50s.jpg
            //   https://abc.imgxyqpdrs.xyz/tokimeki/img/otakara/201709/amuro_namie/ha170922-amuro_namie-50.jpg
            domain === "abc.imgxyqpdrs.xyz" ||
            // http://image-bankingf25.com/tokimeki/img/otakara/201702/mikami_yua/ie17021605-mikami_yua-06s.jpg
            //   http://image-bankingf25.com/tokimeki/img/otakara/201702/mikami_yua/ie17021605-mikami_yua-06.jpg
            domain === "image-bankingf25.com") {
            // http://img.ruliweb.com/data/news18/06m/12/multi/mai01s.jpg
            //   http://img.ruliweb.com/data/news18/06m/12/multi/mai01.jpg
            return src.replace(/s(\.[^/.]*)$/, "$1");
        }

        if (domain === "img2.ruliweb.com") {
            // http://img2.ruliweb.com/mypi/gup/a/1/56/s/55816063001.jpg
            //   http://img2.ruliweb.com/mypi/gup/a/1/56/o/55816063001.jpg
            return src.replace(/(\/mypi\/gup\/a\/[0-9]+\/[0-9]+\/)[a-z]+(\/[0-9]+\.[^/.]*)$/, "$1o$2");
        }

        if (domain === "file.thisisgame.com") {
            // http://file.thisisgame.com/upload/nboard/news/2017/06/27/s_20170627110032_1557.jpg
            //   http://file.thisisgame.com/upload/nboard/news/2017/06/27/20170627110032_1557.jpg
            return src.replace(/\/s_([0-9]+_[0-9]+\.[^/.]*)$/, "/$1");
        }

        if (domain === "www.op.gg") {
            // http://www.op.gg/forum/outImage/https://attach.s.op.gg/forum/20180426004418_551404.png
            //   https://attach.s.op.gg/forum/20180426004418_551404.png
            return src.replace(/^.*?\/forum\/outImage\/(http.*)$/, "$1");
        }

        if (domain === "ssproxy.ucloudbiz.olleh.com") {
            // http://ssproxy.ucloudbiz.olleh.com/v1/AUTH_6a92e249-183a-47ef-870b-b6f2fb771cfa/gae9/trend/f4867c07f1d60768.small
            //   http://ssproxy.ucloudbiz.olleh.com/v1/AUTH_6a92e249-183a-47ef-870b-b6f2fb771cfa/gae9/trend/f4867c07f1d60768.orig
            return src.replace(/\.[a-z]*$/, ".orig");
        }

        if (domain_nosub === "artstation.com" && domain.match(/cdn[a-z]*\.artstation\.com/)) {
            // https://cdnb.artstation.com/p/assets/images/images/001/982/361/small/kevin-lourdel-2012-06-12-09-53-11.jpg?1455539239
            //   https://cdnb.artstation.com/p/assets/images/images/001/982/361/large/kevin-lourdel-2012-06-12-09-53-11.jpg?1455539239
            // there's also /original/, but it's forbidden for some?
            // https://cdnb.artstation.com/p/assets/images/images/011/367/353/original/alexandra-lavrentive-cold-winter-gif.gif -- works
            return [
                src.replace(/\/(?:small|medium)\/([^/]*)$/, "/original/$1"),
                src.replace(/\/(?:small|medium)\/([^/]*)$/, "/large/$1")
            ];
        }

        if (domain === "static.cosplay-it.com") {
            // forces download (binary/octet-stream)
            // https://static.cosplay-it.com/b391a71e-4306-46df-9d3e-ff61e3c2f73b_medium.jpg
            //   https://static.cosplay-it.com/b391a71e-4306-46df-9d3e-ff61e3c2f73b.jpg -- forces download
            return src.replace(/(\/[-0-9a-f]*)_[a-z]+(\.[^/.]*)/, "$1$2");
        }

        if (domain === "a.fsdn.com") {
            // https://a.fsdn.com/con/app/proj/paintball2/screenshots/build036_midnight2_1.jpg/245/183/1
            //   https://a.fsdn.com/con/app/proj/paintball2/screenshots/build036_midnight2_1.jpg
            return src.replace(/(\/screenshots\/[^/]*)\/[0-9]+\/.*/, "$1");
        }

        if (domain === "media.moddb.com" ||
            domain === "media.indiedb.com") {
            // http://media.moddb.com/cache/images/mods/1/4/3463/crop_120x90/62199.jpg
            //   http://media.moddb.com/cache/images/mods/1/4/3463/thumb_620x2000/62199.jpg
            //   http://media.moddb.com/images/mods/1/4/3463/62199.jpg
            // http://media.indiedb.com/cache/images/articles/1/253/252120/crop_120x90/DevStream_Thumbnail2.png
            //   http://media.indiedb.com/images/articles/1/253/252120/DevStream_Thumbnail2.png
            return src.replace(/\/cache\/images\/(.*?)\/[a-z]+_[0-9]+[^/]*(\/[^/]*\.[^/.]*)$/, "/images/$1$2");
        }

        if (domain === "static.gamefront.com" ||
            // https://cg.adultwork.com/G12/thumbnails/5928554.jpg
            //   https://cg.adultwork.com/G12/5928554.jpg -- 4080x2720
            domain === "cg.adultwork.com") {
            // https://static.gamefront.com/storage/images/games/thumbnails/Hd6mCPO4MFbqTI9c75olYsSgVXv5Za7EjEheIZ2L.jpeg
            //   https://static.gamefront.com/storage/images/games/Hd6mCPO4MFbqTI9c75olYsSgVXv5Za7EjEheIZ2L.jpeg
            return src.replace("/thumbnails/", "/");
        }

        if (domain === "thumb.test.mod.io") {
            // https://thumb.test.mod.io/mods/ca81/866/thumb_1020x2000/modio-bg.jpg
            //   https://image.test.mod.io/mods/ca81/866/modio-bg.jpg
            return src.replace(/:\/\/thumb\.([^/]*\..*?\/)[a-z]+_[0-9]+[^/]*\/([^/]*)$/, "://image.$1$2");
        }

        if (domain_nosub === "scirra.net" && domain.match(/static[0-9]*\.scirra\.net/)) {
            // https://static4.scirra.net/avatars/128/eadc0da9f707ff5a5a5195d405639f71.png
            //   https://static4.scirra.net/avatars/256/eadc0da9f707ff5a5a5195d405639f71.png
            // error when using size 0:
            // https://pastebin.com/UkcRAMwt
            return src.replace(/\/avatars\/[0-9]+\//, "/avatars/256/");
        }

        if (domain === "cdn.gamer-network.net" ||
            // https://d2skuhm0vrry40.cloudfront.net/2018/articles/2018-09-27-16-11/pokemon_milan_fashion_week_2.jpg/EG11/resize/300x-1/quality/75/format/jpg
            //   https://d2skuhm0vrry40.cloudfront.net/2018/articles/2018-09-27-16-11/pokemon_milan_fashion_week_2.jpg
            domain === "d2skuhm0vrry40.cloudfront.net") {
            // https://cdn.gamer-network.net/2018/articles/2018-04-25-13-25/fifa.png/EG11/resize/690x-1/quality/75/format/jpg
            //   https://cdn.gamer-network.net/2018/articles/2018-04-25-13-25/fifa.png
            // https://cdn.gamer-network.net/2013/articles//a/1/5/9/9/9/4/8/The_Crew_002.jpg.jpg/EG11/thumbnail/115x64/quality/60
            //   https://cdn.gamer-network.net/2013/articles//a/1/5/9/9/9/4/8/The_Crew_002.jpg.jpg
            return src.replace(/(\.[^/.]*)\/EG[0-9]+\/.*/, "$1");
        }

        if (domain_nosub === "wikiart.org" && domain.match(/uploads[0-9]*\.wikiart\.org/)) {
            // https://uploads5.wikiart.org/images/anton-melbye/laguna-di-venezia-1878.jpg!PinterestSmall.jpg
            //   https://uploads5.wikiart.org/images/anton-melbye/laguna-di-venezia-1878.jpg
            return src.replace(/![^/]*$/, "");
        }

        if ((domain_nosub === "fdncms.com" ||
             // https://images1.miaminewtimes.com/imager/u/745x420/10228444/https_3a_2f_2fcdn.evbuc.com_2fimages_2f42846199_2f213046196680_2f1_2foriginal.jpg_h_200_w_450_rect_0_2c50_2c1542_2c771_s_5cbbeb572f467a67fed17f3f68594108
             //   https://images1.miaminewtimes.com/imager/u/original/10228444/https_3a_2f_2fcdn.evbuc.com_2fimages_2f42846199_2f213046196680_2f1_2foriginal.jpg_h_200_w_450_rect_0_2c50_2c1542_2c771_s_5cbbeb572f467a67fed17f3f68594108
             //   https://cdn.evbuc.com/images/42846199/213046196680/1/original.jpg
             // improper, but still works
             // https://images1.miaminewtimes.com/imager/u/original/10228444/https_3a_2f_2fcdn.evbuc.com_2fimages_2f42846199_2f213046196680_2f1_2foriginal.jpg_h_200_w_450_rect_0_2c50_2c1542_2c771_s_5cbbeb572f467a67fed17f3f68594108/https:_2f_2fcdn.evbuc.com_2fimages_2f42846199_2f213046196680_2f1_2foriginal.jpg_h_200_w_450_rect_0_2c50_2c1542_2c771_s_5cbbeb572f467a67fed17f3f68594108
             domain_nosub === "miaminewtimes.com" ||
             // https://images1.phoenixnewtimes.com/imager/u/745x420/10442190/hidden_gems.jpg
             //   https://images1.phoenixnewtimes.com/imager/u/original/10442190/hidden_gems.jpg
             domain_nosub === "phoenixnewtimes.com") &&
            domain.match(/^images[0-9]*\./)) {
            // https://media2.fdncms.com/stranger/imager/u/small/26096836/1524685866-nether_render_2.jpg
            //   https://media2.fdncms.com/stranger/imager/u/original/26096836/1524685866-nether_render_2.jpg
            //return src.replace(/\/imager\/u\/[a-z]+\//, "/imager/u/original/");
            newsrc = src.replace(/\/imager\/u\/[^/]*\/([0-9]+\/[^/]*)(?:\/.*)?/, "/imager/u/original/$1");
            if (newsrc !== src)
                return newsrc;

            if (src.match(/\/imager\/u\/[^/]*\/[0-9]+\/https?_3[aA]/)) {
                newsrc = src
                    .replace(/.*?\/imager\/u\/[^/]*\/[0-9]+\/(https?_3[aA].*\.[^/._]*)(?:_[^/]*)?$/, "$1")
                    .replace(/_([0-9a-fA-F][0-9a-fA-F])/g, "%$1");
                newsrc = decodeURIComponent(newsrc);
                return newsrc;
            }
        }

        if (domain === "images.techhive.com" ||
            domain === "images.idgesg.net") {
            // https://images.techhive.com/images/article/2016/10/20161010210440_1-100687367-large.jpg
            //   https://images.techhive.com/images/article/2016/10/20161010210440_1-100687367-orig.jpg
            // https://images.techhive.com/images/article/2016/10/20161010204135_1-100687365-carousel.idge.jpg
            //   https://images.techhive.com/images/article/2016/10/20161010204135_1-100687365-orig.jpg
            // https://images.idgesg.net/images/article/2018/02/ryzen_3_2200g_3-100748962-large.jpg
            //   https://images.idgesg.net/images/article/2018/02/ryzen_3_2200g_3-100748962-orig.jpg
            return src.replace(/-[a-z]+(?:\.[^/.]*)?(\.[^/.]*)$/, "-orig$1");
        }

        if (domain_nosub === "rimg.com.tw" ||
            // http://b0.rimg.tw/wishseed/84c6485d_s.jpg
            //   http://b0.rimg.tw/wishseed/84c6485d.jpg
            // http://pcdn1.rimg.tw/photos/2906507_5j6ijbh_l.png?131541
            //   http://pcdn1.rimg.tw/photos/2906507_5j6ijbh_o.png?131541 -- removing _l doesn't work
            domain_nosub === "rimg.tw" ||
            // http://photo.roodo.com/photos/2830061_1frolhm_l.jpg?291733
            //   http://photo.roodo.com/photos/2830061_1frolhm_o.jpg?291733
            domain === "photo.roodo.com" ||
            // https://img.ruten.com.tw/s1/a/b0/15/21308219439125_793.jpg
            domain === "img.ruten.com.tw") {
            // https://a.rimg.com.tw/s1/a/b0/15/21308219439125_793_m.jpg

            if (src.match(/(\/photos\/[0-9]+_[0-9a-z]+_)[a-z](\.[^/.]*)$/)) {
                return src.replace(/(\/photos\/[0-9]+_[0-9a-z]+_)[a-z](\.[^/.]*)$/, "$1o$2");
            }

            return {
                url: src.replace(/_[a-z](\.[^/.]*)$/, "$1"),
                headers: {
                    Referer: "https://goods.ruten.com.tw/item/show"
                }
            };
        }

        if (domain === "buy.line-scdn.net") {
            // https://buy.line-scdn.net/d9ae5f0c/s/wb/images/2AA7830B6AA9A10B8FBA21C36BF8CF28A36BAB1D
            //   https://s.yimg.com/wb/images/2AA7830B6AA9A10B8FBA21C36BF8CF28A36BAB1D
            // https://buy.line-scdn.net/d9ae5f0c/s/ut/api/res/1.2/jGyoWt7od2NeNBE5FWHtLA--~B/dz02MDA7aD02MDA7cT04MTtmaT1maXQ7YXBwaWQ9eXR3bWFsbA--/http://imgcld.zenfs.com:80/ps_image_prod/item/p03761821666-item-0338xf3x0600x0600-m.jpg
            //   https://s.yimg.com/ut/api/res/1.2/jGyoWt7od2NeNBE5FWHtLA--~B/dz02MDA7aD02MDA7cT04MTtmaT1maXQ7YXBwaWQ9eXR3bWFsbA--/http://imgcld.zenfs.com:80/ps_image_prod/item/p03761821666-item-0338xf3x0600x0600-m.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/[a-f0-9]+\/s\//, "https://s.yimg.com/");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nosub === "hc360.cn" && domain.match(/img[0-9]*\.hc360\.cn/)) {
            // https://img006.hc360.cn/m7/M01/9C/9B/wKhQpFczDoOEFjnwAAAAAFJvURI463.jpg..400x400.jpg
            //   https://img006.hc360.cn/m7/M01/9C/9B/wKhQpFczDoOEFjnwAAAAAFJvURI463.jpg
            return src.replace(/(\.[^/.]*)\.[^/]*$/, "$1");
        }

        if (domain_nosub === "ganref.jp" && domain.match(/photo[0-9]*\.ganref\.jp/)) {
            // https://photo1.ganref.jp/photo/0/7033e5f31807519185c42ec12a0e3b87/thumb5.jpg
            //   https://photo1.ganref.jp/photo/0/7033e5f31807519185c42ec12a0e3b87/original.jpg
            return src.replace(/(\/[0-9a-f]+\/)thumb[0-9]*(\.[^/.]*)$/, "$1original$2");
        }

        if (domain_nosub === "st-hatena.com" && domain.match(/cdn(?:-[a-z]+)\.[a-z]\.st-hatena\.com/)) {
            // https://cdn-ak.f.st-hatena.com/images/fotolife/A/Amayadori-June/20180419/20180419183448_120.jpg
            //   https://cdn-ak.f.st-hatena.com/images/fotolife/A/Amayadori-June/20180419/20180419183448.jpg
            return src.replace(/_[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "img.cdn.nimg.jp") {
            // http://news.nicovideo.jp/watch/nw3468901
            // https://img.cdn.nimg.jp/s/niconews/articles/images/3468901/45213edfb355c57cd4794f0ef0c83a3463a6fdb540ccf59db7d2e094c0427a77f183c2c622560c45fa676d4febc525f15ce3aeb95a623b7533a96750725290c6/300x300s_FFFFFFFF?key=293b5fc6c8c97c8a96505ff25eadda2e537c4b415566571114ed309cca61acfb
            //   https://dcdn.cdn.nimg.jp/niconews/articles/images/3468901/45213edfb355c57cd4794f0ef0c83a3463a6fdb540ccf59db7d2e094c0427a77f183c2c622560c45fa676d4febc525f15ce3aeb95a623b7533a96750725290c6
            return src.replace(/:\/\/img\.cdn\.nimg\.jp\/s\/(.*?\/images\/[0-9]+\/[0-9a-f]+)\/.*/,
                               "://dcdn.cdn.nimg.jp/$1");
        }

        if (domain_nosub === "photozou.jp") {
            // http://photozou.jp/photo/show/2422777/173992738?lang=ja
            // http://kura3.photozou.jp/pub/777/2422777/photo/173992771_thumbnail.v1524913392.jpg
            //   http://kura3.photozou.jp/pub/777/2422777/photo/173992771_org.v1524913392.jpg
            // http://kura1.photozou.jp/pub/777/2422777/photo/173992738_624.jpg
            //   http://kura1.photozou.jp/bin/photo/173992738/org.bin?size=1024
            //   http://kura1.photozou.jp/pub/777/2422777/photo/173992738_large.v1525158218.jpg
            //   http://kura1.photozou.jp/pub/777/2422777/photo/173992738_org.v1525158218.jpg
            return src
                .replace(/(\/photo\/[0-9]+\/org\.bin)\?.*$/, "$1")
                .replace(/(\/photo\/[0-9]+)_[a-z0-9]+(\.[^/]*)$/, "$1_org$2");
        }

        if (domain === "desktop.sakura.ne.jp" ||
            // http://kysiamesecat.sakura.ne.jp/sblo_files/new-world-47ft/image/048-a2f72-thumbnail2.jpg
            //   http://kysiamesecat.sakura.ne.jp/sblo_files/new-world-47ft/image/048-a2f72.jpg
            domain === "kysiamesecat.sakura.ne.jp") {
            // http://desktop.sakura.ne.jp/sblo_files/desktop/image/_MG_1072_DxO_raw-thumbnail2.jpg
            //   http://desktop.sakura.ne.jp/sblo_files/desktop/image/_MG_1072_DxO_raw.jpg
            return src.replace(/-thumbnail[0-9]*(\.[^/.]*)$/, "$1");
        }

        if ((domain === "www.ya.sakura.ne.jp" || domain === "mabi4751.orz.hm") &&
            src.indexOf("/~mabi/") >= 0) {
            // http://www.ya.sakura.ne.jp/~mabi/4751/
            //   http://www.ya.sakura.ne.jp/~mabi/etc/20180403/IMG_8319s.jpg
            //     http://www.ya.sakura.ne.jp/~mabi/etc/20180403/IMG_8319.jpg
            // http://mabi4751.orz.hm/~mabi/20110503F/index.html
            //   http://mabi4751.orz.hm/~mabi/20110503F/IMG_9905s.jpg
            //     http://mabi4751.orz.hm/~mabi/20110503F/IMG_9905s.jpg
            // http://mabi4751.orz.hm/~mabi/20100820B/index.html
            //   http://mabi4751.orz.hm/~mabi/20100820B/IMG_0119s.jpg
            //     http://mabi4751.orz.hm/~mabi/20100820B/IMG_0119.jpg
            return src.replace(/s(\.jpg|\.JPG)$/, "$1");
        }

        if (domain === "waganeko.sakura.ne.jp") {
            // http://waganeko.sakura.ne.jp/unko/public/image/ave/201304/.thumbnail/GXHvQJM.jpg.jpg
            //   http://waganeko.sakura.ne.jp/unko/public/image/ave/201304/GXHvQJM.jpg
            return src.replace(/\/\.thumbnail\/([^/]*\.[^/.]*)\.[^/.]*$/, "/$1");
        }

        if (domain_nosub === "storage-yahoo.jp") {
            // https://blogs.yahoo.co.jp/thssythssy/64651630.html
            // https://blog-001.west.edge.storage-yahoo.jp/res/blog-03-7e/thssythssy/folder/1591373/30/64651630/img_0_m?1481865302
            //   https://blog-001.west.edge.storage-yahoo.jp/res/blog-03-7e/thssythssy/folder/1591373/30/64651630/img_0?1481865302
            // https://blog-001.west.edge.storage-yahoo.jp/res/blog-03-7e/thssythssy/folder/1591373/97/64967897/img_0_thumb?1506177062
            //   https://blog-001.west.edge.storage-yahoo.jp/res/blog-03-7e/thssythssy/folder/1591373/97/64967897/img_0?1506177062
            return src.replace(/_(?:m|thumb)(\?.*)?$/, "$1");
        }

        if (domain === "static-mercari-jp-imgtr2.akamaized.net") {
            // https://static-mercari-jp-imgtr2.akamaized.net/thumb/photos/m67374048071_1.jpg?1520960098
            //   https://static-mercari-jp-imgtr2.akamaized.net/photos/m67374048071_1.jpg?1520960098
            // https://static-mercari-jp-imgtr2.akamaized.net/thumb/members/583883227.jpg?1501875459
            //   https://static-mercari-jp-imgtr2.akamaized.net/members/583883227.jpg?1501875459 -- stretched
            // https://static-mercari-jp-imgtr2.akamaized.net/thumb/photos/m86027196730_1.jpg?1528127240
            //   https://static-mercari-jp-imgtr2.akamaized.net/photos/m86027196730_1.jpg?1528127240 -- 2448x3264
            return src.replace(/\/thumb\//, "/");
        }

        if (false && domain.match(/\.fbcdn\.net$/)) {
            // wip
            // https://www.facebook.com/Mahore.official.page/photos/a.1771049596262263.1073742012.148396778527561/1771049639595592/?type=3&theater
            // https://scontent.fcxh3-1.fna.fbcdn.net/v/t1.0-0/c0.0.200.200/p200x200/26804734_1771049639595592_724697207772414518_n.jpg?_nc_cat=0&oh=620d6a106e5646c7829532e0616e2c5f&oe=5B5EE91F
            // https://graph.facebook.com/1771049639595592?fields=images&access_token=
            // https://www.facebook.com/photo/download/?fbid=1771049639595592&ext=1525461615&hash=AeS2Z2X1LdqZYGmJ
            //   https://scontent.fcxh3-1.fna.fbcdn.net/v/t31.0-8/26756562_1771049639595592_724697207772414518_o.jpg?_nc_cat=0&oh=e184f1c97589b647994c3458cb20fb84&oe=5B5DF86F&dl=1
        }

        if (false && domain === "www.the-a.jp") {
            // don't really plan on implementing this one unless a better way is found
            // http://www.the-a.jp/event.cgi?eventnum=071215 -- album
            // http://www.the-a.jp/view/view.php?file=071215001_001 -- image viewer
            // http://www.the-a.jp/thm.cgi?071215001_001 -- 120x160
            // http://www.the-a.jp/thm.php?image=071215001_001 -- 120x160
            // http://www.the-a.jp/photodata/07/071215/thumb/071215001_001.jpg -- 120x160
            // http://www.the-a.jp/imgresize.php?image=071215001_001 -- 240x320
            // http://www.the-a.jp/img.php?image=071215001_001 -- 582x861, badly scaled with badly scaled text
            // http://www.the-a.jp/imgtwit.php?image=071215001_001 -- 800x400, lots of blackspace after
            // to get the original image, stitch these 2 together
            // http://www.the-a.jp/imgdivide.php?image=071215001_001&dx=0 -- 393x836
            // http://www.the-a.jp/imgdivide.php?image=071215001_001&dx=1 -- 320x811
        }

        if (domain === "waichi.sakura.ne.jp") {
            // http://waichi.sakura.ne.jp/prev/chtft68/chtft68_pdx.html
            // http://waichi.sakura.ne.jp/prev/chtft68/momoko.jpg
            //   http://waichi.sakura.ne.jp/prev/chtft68/momoko_L.jpg
            return src.replace(/(\/[^/_.]*)(\.(?:jpg|JPG|jpeg|png|PNG))$/, "$1_L$2");
        }

        if (domain === "news.merumo.ne.jp") {
            // https://news.merumo.ne.jp/imgs/rect78/7372693
            //   https://news.merumo.ne.jp/img/7372693
            return src.replace(/\/imgs\/rect[0-9]*\//, "/img/");
        }

        if (domain_nosub === "shikimori.org" &&
            src.indexOf("/system/") >= 0) {
            // https://shikimori.org/animes/1887-lucky-star/cosplay
            // https://dere.shikimori.org/system/cosplay_images/preview/24174.jpg?1305086273
            //   https://dere.shikimori.org/system/cosplay_images/original/24174.jpg?1305086273
            //   https://nyaa.shikimori.org/system/cosplay_images/original/24174.jpg?1305086273
            // https://dere.shikimori.org/system/animes/preview/36949.jpg?1524536106
            //   https://dere.shikimori.org/system/animes/original/36949.jpg?1524536106
            // https://nyaa.shikimori.org/system/cosplay_images/original/26810.jpg?1306746150
            return src.replace(/\/[a-z]*\/([0-9]+\.[^/.]*)$/, "/original/$1");
        }

        if (domain === "assets.survivalinternational.org") {
            // https://assets.survivalinternational.org/pictures/2015/img-9072_article_column.jpeg
            //   https://assets.survivalinternational.org/pictures/2015/img-9072_screen.jpeg
            //   https://assets.survivalinternational.org/pictures/2015/img-9072_original.jpeg
            // https://assets.survivalinternational.org/pictures/939/col-arh-yc-41_600_landscape.jpg
            //   https://assets.survivalinternational.org/pictures/939/col-arh-yc-41_original.jpg
            return src.replace(/_[0-9a-z_]+(\.[^/.]*)$/, "_original$1");
        }

        if (domain === "alioss.g-cores.com" &&
            src.indexOf("/uploads/image/") >= 0) {
            // https://alioss.g-cores.com/uploads/image/5c072496-cff6-427e-b465-ff189b68729c_watermark.jpg
            //   https://alioss.g-cores.com/uploads/image/5c072496-cff6-427e-b465-ff189b68729c.jpg
            // http://alioss.g-cores.com/uploads/image/07bc730f-0a7e-4af3-bdf9-4b8e45ad0cd4_watermark.jpg
            //   http://alioss.g-cores.com/uploads/image/07bc730f-0a7e-4af3-bdf9-4b8e45ad0cd4.jpg
            // https://alioss.g-cores.com/assets/5th/souvenir/1-5016dae53ea027acdb653e78d25208780cc556bde2ff35007b3d164b9a2b04ac.jpg
            return src.replace(/_watermark(\.[^/.]*)$/, "$1");
        }

        if (domain === "img.nyato.com" ||
            // https://img.ifun01.com/images/2017/09/05/03/4032_hhc1D9_CIyCf7.jpg!r200x0.jpg
            //   https://img.ifun01.com/images/2017/09/05/03/4032_hhc1D9_CIyCf7.jpg
            domain === "img.ifun01.com" ||
            // https://img.itw01.com/images/2018/02/25/05/1120_C0OXdb_4SO7EBF.jpg!r100x0.jpg
            //   https://img.itw01.com/images/2018/02/25/05/1120_C0OXdb_4SO7EBF.jpg
            domain === "img.itw01.com" ||
            // https://img.mttmp.com/images/2018/04/16/20/4147_Olcr3N_dc64in2.jpg!r800x0.jpg
            //   https://img.mttmp.com/images/2018/04/16/20/4147_Olcr3N_dc64in2.jpg
            domain === "img.mttmp.com" ||
            // http://img.maoduoer.com/uploads/images/20170528/162760057.jpg!webp
            //   http://img.maoduoer.com/uploads/images/20170528/162760057.jpg
            domain === "img.maoduoer.com" ||
            // https://img.sycs.net/tupian/cosplay/lyb1mgt3i5v.jpg!800
            //   https://img.sycs.net/tupian/cosplay/lyb1mgt3i5v.jpg
            domain === "img.sycs.net" ||
            // http://img.6jyx.com/2017/0422/20170422114112538.jpg!picS -- 333x500
            //   http://img.6jyx.com/2017/0422/20170422114112538.jpg -- 1280x1920
            domain === "img.6jyx.com" ||
            // https://dn-kdt-img.qbox.me/upload_files/2015/09/21/195e1cdedfeb126e736312bebc5cd30a.jpeg!200x0.jpg
            //   https://dn-kdt-img.qbox.me/upload_files/2015/09/21/195e1cdedfeb126e736312bebc5cd30a.jpeg
            domain === "dn-kdt-img.qbox.me" ||
            // http://bpic.588ku.com/element_pic/00/16/09/0157c77b11d41c5.jpg!/fw/208/quality/90/unsharp/true/compress/true
            //   http://bpic.588ku.com/element_pic/00/16/09/0157c77b11d41c5.jpg
            domain === "bpic.588ku.com" ||
            // http://588ku.qiao88.com/element_origin_min_pic/16/09/01/0857c77a7da303e.jpg!/fw/285/clip/285x500a0a0
            //   http://588ku.qiao88.com/element_origin_min_pic/16/09/01/0857c77a7da303e.jpg
            domain === "588ku.qiao88.com" ||
            // https://img.mgpyh.com/post_image/52fdf552ea637c47518ad8b5d0db379e.jpg!small
            //   https://img.mgpyh.com/post_image/52fdf552ea637c47518ad8b5d0db379e.jpg
            domain === "img.mgpyh.com") {
            // https://img.nyato.com/data/upload/2016/1006/11/57f5cc2d9f2f1.jpg!300x300cut
            //   https://img.nyato.com/data/upload/2016/1006/11/57f5cc2d9f2f1.jpg
            // https://img.nyato.com/data/upload/avatar/22/2d/40/original.jpg!100x100cut
            //   https://img.nyato.com/data/upload/avatar/22/2d/40/original.jpg
            return src.replace(/!.*/, "");
        }

        if (domain === "inews.gtimg.com") {
            // http://inews.gtimg.com/newsapp_bt/0/21184296/1000
            //   https://inews.gtimg.com/newsapp_match/0/21184296/0
            // https://inews.gtimg.com/newsapp_ls/0/3457832104_150120/0
            //   https://inews.gtimg.com/newsapp_match/0/3457832104_150120/0 -- doesn't work
            // http://inews.gtimg.com/newsapp_bt/0/21184291/1000
            //   http://inews.gtimg.com/newsapp_match/0/21184291/0
            // https://inews.gtimg.com/newsapp_bt/0/151988165/640?tp=webp
            //   https://inews.gtimg.com/newsapp_match/0/151988165/0
            return {
                url: src.replace(/\/newsapp_[a-z]+\/([0-9]+\/[0-9]+\/)[0-9]+(?:[?#].*)?$/, "/newsapp_match/$10"),
                headers: {
                    "Origin": "",
                    "Referer": ""
                }
            };
        }

        if ((domain === "acg.ms" ||
             domain === "m.acg.ms") &&
            src.indexOf("/photo/") >= 0) {
            // http://acg.ms/photo/19180_0_620.jpeg
            //   http://acg.ms/photo/19180_0_9999999.jpeg ->
            //     http://acg.ms/photo/19180_0_690.jpeg
            // http://m.acg.ms/photo/19183_0_600.jpeg
            return {
                redirects: true,
                url: src.replace(/(\/[0-9]+)_[0-9]+_[0-9]+(\.[^/.]*)$/, "$1_0_9999999$2")
            };
        }

        if (domain === "sl.news.livedoor.com") {
            // http://sl.news.livedoor.com/ed497b107aabc6a44a13236e45d22ce6456ce615/small_light(dw=120,dh=120,da=s,cw=120,ch=120,q=100,e=imagemagick,sharpen=radius,sigma)/http://image.news.livedoor.com/newsimage/stf/0/8/0812d_1408_a240b678079ee1be40cb46476262012a.jpg
            //   http://image.news.livedoor.com/newsimage/stf/0/8/0812d_1408_a240b678079ee1be40cb46476262012a.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/[a-f0-9]+\/[^/]*\//, "");
        }

        if (domain === "photo.tuchong.com") {
            // https://photo.tuchong.com/1171334/s/8210121.jpg
            //   https://photo.tuchong.com/1171334/f/8210121.jpg
            return src.replace(/\/[a-z]\/([0-9]+\.[^/.]*)/, "/f/$1");
        }

        if ((domain === "arine.akamaized.net" ||
             domain === "media-assets.aumo.jp") &&
            src.indexOf("/uploads/photo/") >= 0) {
            // https://arine.akamaized.net/uploads/photo/snap_photo/data/240902/xlarge_3b631896-390b-49ea-b962-f2b7a8dfa590.jpeg
            //   https://arine.akamaized.net/uploads/photo/snap_photo/data/240902/3b631896-390b-49ea-b962-f2b7a8dfa590.jpeg
            // https://media-assets.aumo.jp/uploads/photo/upload_photo/data/9459/xlarge_a280c9e6-11e7-4778-93c9-3ea4b82aa629.jpeg
            //   https://media-assets.aumo.jp/uploads/photo/upload_photo/data/9459/a280c9e6-11e7-4778-93c9-3ea4b82aa629.jpeg
            return src.replace(/(\/[0-9]+\/)[a-z]+_([-0-9a-z]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "newsimg.glossom.jp") {
            // https://newsimg.glossom.jp/public/img/article/36/86/2833686_580_04.jpg?5ac96eca
            //   https://newsimg.glossom.jp/public/img/article/36/86/2833686_org_04.jpg?5ac96eca
            return src.replace(/(\/[0-9]+_)[0-9]+(_[0-9]+\.[^/.]*)$/, "$1org$2");
        }

        if (domain === "www.vtianxia.cn") {
            // http://www.vtianxia.cn/uploadfile/news/s/2017/1231/1514696987_29121.jpg
            //   http://www.vtianxia.cn/uploadfile/news/big/2017/1231/1514696987_29121.jpg
            return src.replace(/(\/uploadfile\/[a-z]+\/)[a-z]+\//, "$1big/");
        }

        if (domain === "img.over-blog-kiwi.com" ||
            (domain_nosub === "over-blog.com" && domain.indexOf(".idata.over-blog.com") >= 0)) {
            // http://img.over-blog-kiwi.com/100x100-ct/0/93/38/59/20140217/ob_bb3768_cafe.jpg
            //   http://img.over-blog-kiwi.com/0/93/38/59/20140217/ob_bb3768_cafe.jpg
            // https://img.over-blog-kiwi.com/630x400-ct/1/50/73/92/20180426/ob_f976fb_p1270469.JPG
            //   https://img.over-blog-kiwi.com/1/50/73/92/20180426/ob_f976fb_p1270469.JPG
            // https://img.over-blog-kiwi.com/150x150/0/55/07/74/20180504/ob_20914b_2018-05-04-wooz-nao.jpg
            //   https://img.over-blog-kiwi.com/0/55/07/74/20180504/ob_20914b_2018-05-04-wooz-nao.jpg
            // http://a401.idata.over-blog.com/150x185/4/02/25/29/VRAC-3/FERRIE--2-.jpg
            //   http://a401.idata.over-blog.com/4/02/25/29/VRAC-3/FERRIE--2-.jpg
            return src.replace(/(:\/\/[^/]*\/)[0-9]+x[0-9]+(?:-[a-z]+)?\//, "$1");
        }

        if (domain === "resize.over-blog.com") {
            // http://resize.over-blog.com/150x150.jpg?https://hoax-net.be/wp-content/uploads/2015/10/12063832_10207955947996766_7835521811747899900_n.jpg
            //   https://hoax-net.be/wp-content/uploads/2015/10/12063832_10207955947996766_7835521811747899900_n.jpg
            // http://resize.over-blog.com/600x350-ct.jpg?http://s2.e-monsite.com/2010/04/02/02/resize_128_128//Neree-Beauchemin.jpg
            //   http://s2.e-monsite.com/2010/04/02/02/resize_128_128//Neree-Beauchemin.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/[0-9]+x[0-9]+(?:-[a-z]+)?\.[^/.?]*\?/, "");
        }

        if (domain_nosub === "eastday.com" && domain.match(/[0-9]*\.imgmini\.eastday\.com/)) {
            // http://09.imgmini.eastday.com/mobile/20160905/20160905080255_b9afa06a642df686fe424990c933a90a_1_mwpm_03200403.jpeg
            //   http://09.imgmini.eastday.com/mobile/20160905/20160905080255_b9afa06a642df686fe424990c933a90a_1.jpeg
            return src.replace(/(\/[0-9]+_[0-9a-f]+_[0-9]+)_[^/.]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "so-net.ne.jp") {
            // http://harrypotter-fun.c.blog.so-net.ne.jp/_images/blog/_985/harrypotter-fun/m_lunalovegood.jpg
            //   http://harrypotter-fun.c.blog.so-net.ne.jp/_images/blog/_985/harrypotter-fun/lunalovegood.jpg
            // http://news.so-net.ne.jp/photos/30/365455840452641889/S200_365455840452641889_365547478327575649_origin_1.jpg
            //   http://news.so-net.ne.jp/photos/30/365455840452641889/365455840452641889_365547478327575649_origin_1.jpg
            return src.replace(/\/(?:m|S[0-9]+)_([^/]*)$/, "/$1");
        }

        if (amazon_container === "rejob-v2-images-production" ||
            // https://mosaia.s3.amazonaws.com/images/3319178/small.jpg?1510185944
            //   https://mosaia.s3.amazonaws.com/images/3319178/original.jpg?1510185944
            (amazon_container === "mosaia" && src.match(/\/images\/[0-9]+\/[^/]*$/))) {
            // https://s3-ap-northeast-1.amazonaws.com/rejob-v2-images-production/files/client_shop_image/XSaB7Q/s1D8ah/L7RcjU/Um9yL7/bOo/minimum.jpg
            //   https://s3-ap-northeast-1.amazonaws.com/rejob-v2-images-production/files/client_shop_image/XSaB7Q/s1D8ah/L7RcjU/Um9yL7/bOo/detail_top.jpg
            //   https://s3-ap-northeast-1.amazonaws.com/rejob-v2-images-production/files/client_shop_image/XSaB7Q/s1D8ah/L7RcjU/Um9yL7/bOo/original.jpg
            return src.replace(/\/[^/.]*(\.[^/.]*)$/, "/original$1");
        }

        if (domain === "lohas.nicoseiga.jp") {
            // https://lohas.nicoseiga.jp/thumb/6494066i
            //   https://lohas.nicoseiga.jp/thumb/6494066l -- same size
            // https://lohas.nicoseiga.jp/thumb/7639531m
            //   https://lohas.nicoseiga.jp/thumb/7639531i -- doesn't work
            //   https://lohas.nicoseiga.jp/thumb/7639531l -- largest
            // larger images:
            // https://lohas.nicoseiga.jp/material/4e1a77/8032880
            // http://lohas.nicoseiga.jp/priv/5eb1a6e1e94c0e1a55c4b54145af82950dc5145e/1487849470/6505819
            // (l, i), d, m, t, c, u, z, q, s
            return src.replace(/(\/thumb\/[0-9]+)[a-z](\?.*)?$/, "$1l$2");
        }

        if (domain === "files.mastodon.social") {
            // https://files.mastodon.social/media_attachments/files/000/272/420/small/70972b69912d1e4d.png
            //   https://files.mastodon.social/media_attachments/files/000/272/420/original/70972b69912d1e4d.png
            return src.replace(/\/[a-z]+\/([0-9a-f]+\.[^/.]*)$/, "/original/$1");
        }

        if (domain === "appdata.hungryapp.co.kr") {
            // http://appdata.hungryapp.co.kr/data_file/data_img_m/201712/22/W15139228709275643.jpg
            //   http://appdata.hungryapp.co.kr/data_file/data_img/201712/22/W15139228709275643.jpg
            // http://appdata.hungryapp.co.kr/data_file/data_img/201801/25/W1516889805885988.png/hungryapp/resize/500
            //   http://appdata.hungryapp.co.kr/data_file/data_img/201801/25/W1516889805885988.png
            return src
                .replace(/\/data_img_[a-z]\//, "/data_img/")
                .replace(/(\/[0-9]{6}\/[0-9]{2}\/[^/]*\.[^/.]*)\/hungryapp\/.*/, "$1");
        }

        if (domain === "media.funradio.fr") {
            // https://media.funradio.fr/cache/6zVW4QAFrwxZgrBHWQ9VTQ/880v587-0/online/image/2017/1211/7791363662_selena-gomez.jpg -- upscaled?
            //   https://media.funradio.fr/online/image/2017/1211/7791363662_selena-gomez.jpg -- smaller
            return src.replace(/\/cache\/[0-9a-zA-Z]+\/[0-9a-z]+-[0-9]+\//, "/");
        }

        if (domain === "image.afcdn.com" ||
            // http://imworld.aufeminin.com/story/20160114/smokey-eyes-nude-845802_w650.jpg
            //   http://imworld.aufeminin.com/story/20160114/smokey-eyes-nude-845802.jpg
            domain === "imworld.aufeminin.com") {
            // https://image.afcdn.com/story/20170706/selena-gomez-1102651_w767h767c1cx1816cy877.jpg
            //   https://image.afcdn.com/story/20170706/selena-gomez-1102651.jpg
            // https://image.afcdn.com/story/20130911/cara-delevingne-98052_w767h767c1cx345cy200.jpg
            //   https://image.afcdn.com/story/20130911/cara-delevingne-98052.jpg
            // https://image.afcdn.com/album/D20180221/allison-janney-phalbm25328123_w660.jpg
            //   https://image.afcdn.com/album/D20180221/allison-janney-phalbm25328123.jpg
            // https://image.afcdn.com/story/20141004/rihanna-507111_w670.jpg
            //   https://image.afcdn.com/story/20141004/rihanna-507111.jpg
            // https://image.afcdn.com/story/20170706/selena-gomez-1102505_w670.jpg
            //   https://image.afcdn.com/story/20170706/selena-gomez-1102505.jpg -- still works
            // https://image.afcdn.com/story/20170706/selena-gomez-1102441_w670.jpg
            //   https://image.afcdn.com/story/20170706/selena-gomez-1102441.jpg -- still works
            // https://image.afcdn.com/story/20140722/emma-watson-shakes-off-good-girl-image-with-sexy-new-role-in-the-bling-ring-312896_w767h767c1.jpg
            //   https://image.afcdn.com/story/20140722/emma-watson-shakes-off-good-girl-image-with-sexy-new-role-in-the-bling-ring-312896.jpg
            // https://image.afcdn.com/stars/people/1001-1_s96cx1221cy1290cxt530cyt340cxb1961cyb1770.jpg
            //   https://image.afcdn.com/stars/people/1001-1.jpg
            // https://image.afcdn.com/album/D20181012/emma-watson-a-woman-with-a-plan-phalbm25655862_w660.jpg
            //   https://image.afcdn.com/album/D20181012/emma-watson-a-woman-with-a-plan-phalbm25655862.jpg
            // theory: if referer != null (last image), redirects to blank image, no content-length header, can't find differences in headers
            // doesn't seem to be true. trying an image under another browser doesn't work either. could be a cache server problem
            // using referer headers seems to work
            return {
                url: src.replace(/(-(?:[a-z]+)?[0-9]+)_[a-z0-9]+(\.[^/.]*)/, "$1$2"),
                headers: {
                    Origin: "https://www.sofeminine.co.uk/",
                    Referer: "https://www.sofeminine.co.uk/"
                }
            };
        }

        if ((domain_nosub === "greatsong.net" && domain.match(/static[0-9]*\.greatsong\.net/)) ||
            // https://img0.utuku.china.com/130x0/news/20180705/b4db88c1-98c1-4434-b2e7-3620855a7274.jpg
            //   https://img0.utuku.china.com/original/news/20180705/b4db88c1-98c1-4434-b2e7-3620855a7274.jpg
            (domain_nosub === "china.com" && domain.match(/img[0-9]*\.(?:[a-z]+\.)?china\.com/))) {
            // https://static2.greatsong.net/artiste/250x250/selena-gomez-204596.jpg
            //   https://static2.greatsong.net/artiste/original/selena-gomez-204596.jpg
            // https://static2.greatsong.net/artiste/270x164/anthony-hamilton-174297.jpg
            //   https://static2.greatsong.net/artiste/original/anthony-hamilton-174297.jpg
            return src.replace(/\/[0-9]+x[0-9]+\//, "/original/");
        }

        if (domain === "ipravda.sk") {
            // https://ipravda.sk/res/2018/05/03/thumbs/rok-2008-spevacka-adele-na-fotografii-z-new-yorku-stvorec.jpg
            //   https://ipravda.sk/res/2018/05/03/rok-2008-spevacka-adele-na-fotografii-z-new-yorku.jpg
            // https://ipravda.sk/res/2017/06/07/thumbs/selena-gomez_01-nestandard1.jpg
            //   https://ipravda.sk/res/2017/06/07/selena-gomez_01.jpg
            // https://ipravda.sk/res/2015/05/18/thumbs/jennifer-lopez-galeria.jpeg
            //   https://ipravda.sk/res/2015/05/18/jennifer-lopez.jpeg
            // http://ipravda.sk/res/2018/07/17/thumbs/herecka-meryl-streep-na-premiere-filmu-mamma-mia-here-we-go-again-clanokW.jpg
            //   http://ipravda.sk/res/2018/07/17/herecka-meryl-streep-na-premiere-filmu-mamma-mia-here-we-go-again.jpg
            // http://ipravda.sk/res/2008/11/07/thumbs/28933-juraj-jakubisko-clanok.jpg
            //   http://ipravda.sk/res/2008/11/07/28933-juraj-jakubisko.jpg
            // https://ipravda.sk/res/2018/08/13/thumbs/ciznar-nemecko-unos-strednaW.jpg
            //   https://ipravda.sk/res/2018/08/13/ciznar-nemecko-unos.jpg
            // https://ipravda.sk/res/2018/08/03/thumbs/andy-warhol-malaW.jpg
            //   https://ipravda.sk/res/2018/08/03/andy-warhol.jpg
            return src.replace(/\/thumbs\/([^/]*)-(?:stvorec|nestandard[0-9]*|galeria|clanokW?|strednaW?|malaW?)(\.[^/.]*)$/, "/$1$2");
        }

        if (domain === "d919ce141ef35c47fc40-b9166a60eccf0f83d2d9c63fa65b9129.ssl.cf5.rackcdn.com") {
            // https://d919ce141ef35c47fc40-b9166a60eccf0f83d2d9c63fa65b9129.ssl.cf5.rackcdn.com/images/147002.max-620x600.jpg
            //   https://d919ce141ef35c47fc40-b9166a60eccf0f83d2d9c63fa65b9129.ssl.cf5.rackcdn.com/images/147002.original.jpg
            // https://d919ce141ef35c47fc40-b9166a60eccf0f83d2d9c63fa65b9129.ssl.cf5.rackcdn.com/images/76827.2e16d0ba.fill-276x245.jpg
            //   https://d919ce141ef35c47fc40-b9166a60eccf0f83d2d9c63fa65b9129.ssl.cf5.rackcdn.com/images/76827.original.jpg
            // https://d919ce141ef35c47fc40-b9166a60eccf0f83d2d9c63fa65b9129.ssl.cf5.rackcdn.com/images/ADAMMIRAI.2e16d0ba.fill-295x279.jpg
            //   https://d919ce141ef35c47fc40-b9166a60eccf0f83d2d9c63fa65b9129.ssl.cf5.rackcdn.com/images/ADAMMIRAI.original.jpg
            // doesn't work for all:
            // https://d919ce141ef35c47fc40-b9166a60eccf0f83d2d9c63fa65b9129.ssl.cf5.rackcdn.com/images/GettyImages-818219262.2e16d0ba.fill-295x279.jpg
            //   https://d919ce141ef35c47fc40-b9166a60eccf0f83d2d9c63fa65b9129.ssl.cf5.rackcdn.com/images/GettyImages-818219262.original.jpg -- doesn't work
            // but it does work for other GettyImages:
            // https://d919ce141ef35c47fc40-b9166a60eccf0f83d2d9c63fa65b9129.ssl.cf5.rackcdn.com/images/GettyImages-927227080.2e16d0ba.fill-295x279.jpg
            //   https://d919ce141ef35c47fc40-b9166a60eccf0f83d2d9c63fa65b9129.ssl.cf5.rackcdn.com/images/GettyImages-927227080.original.jpg
            return src.replace(/(\/images\/[^/.]+\.)[^/]*(\.[^/.]*)$/, "$1original$2");
        }

        if (domain === "nation.com.pk") {
            // https://nation.com.pk/print_images/small/2018-01-21/rihanna-moving-to-london-1516485654-4082.jpg
            // error when specifying other:
            // Please specify size. Eg: thumbnail, small, medium, large
            return src.replace(/\/print_images\/[a-z]+\//, "/print_images/large/");
        }

        if (domain === "dazedimg.dazedgroup.netdna-cdn.com") {
            // http://dazedimg.dazedgroup.netdna-cdn.com/320/0-0-558-372/azure/dazed-prod/1240/0/1240136.jpg
            //   https://dazedprod.blob.core.windows.net/dazed-prod/1240/0/1240136.jpg
            // http://dazedimg.dazedgroup.netdna-cdn.com/1600/azure/dazed-prod/1220/7/1227289.jpg
            //   https://dazedprod.blob.core.windows.net/dazed-prod/1220/7/1227289.jpg
            return src.replace(/(:\/\/[^/]*\/)[0-9]+\/(?:[0-9]+-[0-9]+-[0-9]+-[0-9]+\/)?/, "$1");
        }

        if (domain === "www.fuse.tv") {
            // https://www.fuse.tv/image/5306185b012d11e57c000012/768/512/photo-of-rihanna-2005.jpg
            //   https://www.fuse.tv/image/5306185b012d11e57c000012/photo-of-rihanna-2005.jpg
            return src.replace(/(\/image\/[0-9a-f]+\/)[0-9]+\/[0-9]+\/([^/]*)$/, "$1$2");
        }

        if (domain === "assets.capitalxtra.com") {
            // https://assets.capitalxtra.com/2018/17/rihanna-1525427948-hero-wide-v4-0.jpg
            //   https://assets.capitalxtra.com/2018/17/rihanna-1525427948.jpg
            return src.replace(/(\/[^/.]*-[0-9]{8,})-[^/.]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "www.ukmix.org") {
            // https://www.ukmix.org/proxy.php?code=3b69a1220d68c617d6dbba93ccf0ace35a34abf823b8a6e17ae123a692765a43&url=aHR0cDovL2NkbmkuY29uZGVuYXN0LmNvLnVrLzQxMHg1NDAva19uL25vdi0yMDA1X2NvdmVyczIwMDVfZ2xfMjJkZWMxMF9iLmpwZw%3D%3D
            //   https://cdni.condenast.co.uk/410x540/k_n/nov-2005_covers2005_gl_22dec10_b.jpg
            return atob(decodeURIComponent(src.replace(/.*\/proxy\.php.*?[?&]url=([^&]*).*/, "$1")));
        }

        if (domain === "www.washingtonpost.com" &&
            src.indexOf("/pbox.php?") >= 0) {
            // https://www.washingtonpost.com/pbox.php?url=http://m.static.newsvine.com/servista/imagesizer?file=meena-hart-duerson--today9358FF7B-91E7-365E-2C23-5DD8416B1703.jpg&width=500&w=1484&op=resize&opt=1&filter=antialias&t=20170517
            //   http://m.static.newsvine.com/servista/imagesizer?file=meena-hart-duerson--today9358FF7B-91E7-365E-2C23-5DD8416B1703.jpg
            newsrc = src.replace(/.*?\/pbox\.php.*?[?&]url=([^&]*).*$/, "$1");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain === "m.static.newsvine.com" &&
            src.indexOf("/servista/imagesizer?") >= 0) {
            // http://m.static.newsvine.com/servista/imagesizer?file=meena-hart-duerson--today9358FF7B-91E7-365E-2C23-5DD8416B1703.jpg&width=400
            //   http://m.static.newsvine.com/servista/imagesizer?file=meena-hart-duerson--today9358FF7B-91E7-365E-2C23-5DD8416B1703.jpg
            return src.replace(/(\/servista\/imagesizer).*?[?&](file=[^&]*).*/, "$1?$2");
        }

        if (domain_nosub === "cosplaywon.com" && domain.match(/theprecious[0-9]*\.cosplaywon\.com/)) {
            // https://theprecious.cosplaywon.com/uploads/post/photo/5198/small_1f3238d6-d48d-42a0-947b-546c14c4771d.jpg
            //   https://theprecious.cosplaywon.com/uploads/post/photo/5198/original_1f3238d6-d48d-42a0-947b-546c14c4771d.jpg -- 3396x5315
            //   https://theprecious.cosplaywon.com/uploads/post/photo/5198/1f3238d6-d48d-42a0-947b-546c14c4771d.jpg          -- 3396x5315
            // https://theprecious2.cosplaywon.com/uploads/post/photo/5051/medium_49ef7a15-37c2-4f6e-a147-4ab6c5bcbfa2.jpg
            //   https://theprecious2.cosplaywon.com/uploads/post/photo/5051/original_49ef7a15-37c2-4f6e-a147-4ab6c5bcbfa2.jpg
            return src.replace(/(\/photo\/[0-9]+\/)[a-z]+_([-0-9a-f]+\.[^/.]*)$/, "$1original_$2");
        }

        if (domain_nowww === "otaku.com") {
            // https://otaku.com/files/images/thumbs/THUMB_206306J2.JPG
            //   https://otaku.com/files/images/fullsize/206306J2.JPG
            // https://otaku.com/files/images/items/206306J.JPG
            //   https://otaku.com/files/images/fullsize/206306J.JPG
            return src.replace(/(\/files\/images\/)[^/]*\/(?:[A-Z]+_)?([^/]*)$/, "$1fullsize/$2");
        }

        if ((domain_nosub === "joyreactor.com" ||
             // http://img0.reactor.cc/pics/post/art-Anime-nil-293006.jpeg
             //   http://img0.reactor.cc/pics/post/full/art-Anime-nil-293006.jpeg
             domain_nosub === "reactor.cc" ||
             domain_nosub === "joyreactor.cc") &&
            domain.match(/^img[0-9]*\./)) {
            // http://img0.joyreactor.com/pics/post/art-shingeki-no-kyojin-anime-anime-art-2196554.jpeg
            //   http://img0.joyreactor.com/pics/post/full/art-shingeki-no-kyojin-anime-anime-art-2196554.jpeg
            newsrc = src.replace(/(\/pics\/post\/)([^/]*)$/, "$1full/$2");
            if (newsrc !== src)
                return newsrc;

            // http://img1.reactor.cc/pics/thumbnail/post-378769.jpg
            //   http://reactor.cc/post/378769
            //   http://img0.reactor.cc/pics/post/art-Anime-nil-293006.jpeg
            //   http://img0.reactor.cc/pics/post/full/art-Anime-nil-293006.jpeg
            // http://img1.reactor.cc/pics/thumbnail/post-3601821.jpg
            //   http://img0.reactor.cc/pics/post/full/meso-meso-AO-Anime-Art-Anime-4634590.png
            var id = src.replace(/.*\/pics\/thumbnail\/post-([0-9]+)\.[^/.]*$/, "$1");
            if (id !== src && options && options.cb && options.do_request) {
                options.do_request({
                    url: src.replace(/:\/\/img[0-9]*\.([^/]*\/).*/, "://$1post/" + id),
                    method: "GET",
                    onload: function(resp) {
                        if (resp.readyState === 4) {
                            var match = resp.responseText.match(/<div class="image">\s*(?:<a[^>]*>)?\s*<img[^>]*src="([^"]*)"/);
                            if (match) {
                                options.cb(match[1]);
                            } else {
                                options.cb(null);
                            }
                        }
                    }
                });

                return {
                    waiting: true
                };
            }
        }

        if (domain_nowww === "coolwallpaperz.info") {
            // http://coolwallpaperz.info/user-content/uploads/wall/thumb/62/dark-anime-art-colorful-girl-free-hd-917493.jpg
            //   http://www.coolwallpaperz.info/user-content/uploads/wall/o/62/dark-anime-art-colorful-girl-free-hd-917493.jpg
            return src.replace(/(\/uploads\/wall\/)thumb(\/[0-9]+\/[^/]*)$/, "$1o$2");
        }

        if (domain_nowww === "besthqwallpapers.com") {
            // https://besthqwallpapers.com/Uploads/29-3-2018/46318/thumb2-vocaloid-kagamine-rin-kagamine-len-anime-characters-art.jpg
            //   https://besthqwallpapers.com/uploads/29-3-2018/46318/vocaloid-kagamine-rin-kagamine-len-anime-characters-art.jpg
            return src.replace(/(\/[0-9]+\/)thumb[0-9]*-([^/]*)$/, "$1$2");
        }

        if (domain === "avatanplus.com") {
            // https://avatanplus.com/files/resources/mid/5aedb0878e6e31633079919f.png -- 700x826
            //   https://avatanplus.com/files/resources/original/5aedb0878e6e31633079919f.png -- 823x972
            // https://avatanplus.com/resize.php?type=resources&mode=mid&file=5aedb0878e6e31633079919f.png
            //   https://avatanplus.com/files/resources/original/5aedb0878e6e31633079919f.png
            if (src.indexOf("/resize.php?") >= 0) {
                var type = url.searchParams.get("type");
                var file = url.searchParams.get("file");
                return "https://avatanplus.com/files/" + type + "/original/" + file;
            }
            return src
                .replace(/(\/files\/[a-z]+)\/[a-z]+\/([0-9a-f]+\.[^/.]*)$/, "$1/original/$2");
        }

        if (domain === "bbd-1tmxd3aba43noa.stackpathdns.com" ||
            // https://kpoimages-1tmxd3aba43noa.stackpathdns.com/data/thumbs/full/478065/225/149/0/0/image-jpg.jpg
            //   https://kpoimages-1tmxd3aba43noa.stackpathdns.com/data/images/full/478065/image-jpg.jpg
            // https://kpoimages-1tmxd3aba43noa.stackpathdns.com/data/images/full/167990/bomber-png.png?w=650
            //   https://kpoimages-1tmxd3aba43noa.stackpathdns.com/data/images/full/167990/bomber-png.png
            domain === "kpoimages-1tmxd3aba43noa.stackpathdns.com" ||
            // http://data.japanese.kpopstarz.com/data/thumbs/full/90028/300/210/47/25/2.jpg
            //   http://data.japanese.kpopstarz.com/data/images/full/90028/2.jpg
            domain === "data.japanese.kpopstarz.com" ||
            // http://image.kpopstarz.com/data/thumbs/full/270672/225/149/50/40/seohyun-thumbs-up-after-tokyo-dome.jpg -- dead
            domain === "image.kpopstarz.com" ||
            // http://images.kpopstarz.com/data/thumbs/full/87676/225/149/50/20/roy-kim-says-he-is-sorry-that-his-song-spring-spring-spring-bom-bom-bom-has-drawn-plagiarism-accusations.jpg
            //   http://images.kpopstarz.com/data/images/full/87676/roy-kim-says-he-is-sorry-that-his-song-spring-spring-spring-bom-bom-bom-has-drawn-plagiarism-accusations.jpg
            domain === "images.kpopstarz.com" ||
            // https://kdrimages-1tmxd3aba43noa.stackpathdns.com/data/thumbs/full/229217/120/100/50/40/mystery-queen.jpg
            //   https://kdrimages-1tmxd3aba43noa.stackpathdns.com/data/images/full/229217/mystery-queen.jpg
            domain === "kdrimages-1tmxd3aba43noa.stackpathdns.com") {
            // https://bbd-1tmxd3aba43noa.stackpathdns.com/data/thumbs/full/595/196/145/0/0/bill-gates-jpg.jpg
            //   https://bbd-1tmxd3aba43noa.stackpathdns.com/data/images/full/595/bill-gates-jpg.jpg

            // filename can be anything
            newsrc = src
                .replace(/\/data\/thumbs\/full\/([0-9]+)\/[0-9]+\/[0-9]+\/[0-9]+\/[0-9]+\/([^/]*)$/,
                         "/data/images/full/$1/$2")
                .replace(/[?#].*$/, "");
            if (newsrc !== src)
                return newsrc;
            //return src.replace(/\/thumbs\/full\/([^/]*)\/[^/]*\/[^/]*\/[^/]*\/[^/]*\/([^/]*)$/, "/thumbs/full/$1/999999/0/0/0/$2");
        }

        if (domain === "studiosol-a.akamaihd.net") {
            // https://studiosol-a.akamaihd.net/letras/215x215/fotos/c/d/e/1/cde1fd38a3142bc266c221f69fb9ee60.jpg
            //   https://studiosol-a.akamaihd.net/uploadfile/letras/fotos/c/d/e/1/cde1fd38a3142bc266c221f69fb9ee60.jpg
            // https://studiosol-a.akamaihd.net/letras/76x76/albuns/d/b/e/b/605161510258737-tb_180.jpg
            //   https://studiosol-a.akamaihd.net/uploadfile/letras/albuns/d/b/e/b/605161510258737-tb_180.jpg
            //   https://studiosol-a.akamaihd.net/uploadfile/letras/albuns/d/b/e/b/605161510258737.jpg
            // https://studiosol-a.akamaihd.net/uploadfile/letras/fotos/5/7/8/a/578ade976c0ac183973f5b628a668eb3-tb_200.jpg
            //   https://studiosol-a.akamaihd.net/uploadfile/letras/fotos/5/7/8/a/578ade976c0ac183973f5b628a668eb3.jpg
            return src
                .replace(/(:\/\/[^/]*\/)([a-z]+)\/[0-9]+x[0-9]+\//, "$1uploadfile/$2/")
                .replace(/-tb_[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (amazon_container === "quietus_production") {
            // http://s3.amazonaws.com/quietus_production/images/articles/24550/TFSMeatspace_1525802422_crop_168x168.jpg
            //   http://s3.amazonaws.com/quietus_production/images/articles/24550/TFSMeatspace_1525802422.jpg
            return src.replace(/_crop_[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "bmi.com" &&
            src.indexOf("/images/") >= 0) {
            // https://www.bmi.com/images/photoblog/2010/cache/bmi_country_106052425ED006_58th_Annual__770_1103_90.JPG
            // https://www.bmi.com/images/photoblog/2010/cache/bmi_country_106052425ED006_58th_Annual__770_1103_90_s.JPG
            //   https://www.bmi.com/images/photoblog/2010/bmi_country_106052425ED006_58th_Annual_.JPG
            return src.replace(/\/cache\/([^/]*)_[0-9]+_[0-9]+_[0-9]+(?:_[a-z]+)?(\.[^/.]*)$/, "/$1$2");
        }

        if (domain === "i.warosu.org") {
            // https://i.warosu.org/data/lit/thumb/0062/33/1425676352426s.jpg
            //   https://i.warosu.org/data/lit/img/0062/33/1425676352426.jpg
            return src.replace(/\/thumb\/([0-9]+\/[0-9]+\/[0-9]+)s?(\.[^/.]*)$/, "/img/$1$2");
        }

        if (domain === "media.rbl.ms") {
            // haven't tested due to redirect
            // https://media.rbl.ms/image?u=%2Ffiles%2F2016%2F03%2F06%2F6359289786772823741235385117_articletaylor6.gif&ho=https%3A%2F%2Faz616578.vo.msecnd.net&s=473&h=bcac1953f8a26948e31526d400fd22ea593e9f404b32236b52589cc0d8dbf28e&size=980x&c=3774816102
            // https://az616578.vo.msecnd.net/files/2016/03/06/6359289786772823741235385117_articletaylor6.gif
            if (src.indexOf("/image?") >= 0) {
                var u = decodeURIComponent(url.searchParams.get("u")).replace(/^([^/])/, "/$1");
                var ho = decodeURIComponent(url.searchParams.get("ho")).replace(/\/$/, "");
                return ho + u;
            }
        }

        if (domain_nowww === "filepicker.io" ||
            // https://d1t35hkz8sx2bl.cloudfront.net/api/file/ucxKmBR4S2DGj5pIuNlw/convert?w=1024&h=1024&fit=max&cache=true
            //   https://d1t35hkz8sx2bl.cloudfront.net/api/file/ucxKmBR4S2DGj5pIuNlw
            domain === "d1t35hkz8sx2bl.cloudfront.net") {
            // https://filepicker.io/api/file/9ej84qIQYKLgNFAbt4bz/convert?align=top&fit=clip&h=500&w=698
            //   https://filepicker.io/api/file/9ej84qIQYKLgNFAbt4bz
            return {
                url: src.replace(/\/convert\?.*/, ""),
                head_wrong_contenttype: true
            };
        }

        if (domain === "cdn.teenidols4you.com" ||
            domain === "www.teenidols4you.com") {
            // http://cdn.teenidols4you.com/thumb/Actors/katyperry/88katy-perry-1379801521.jpg
            //   http://www.teenidols4you.com/thumb/Actors/katyperry/katy-perry-1379801521.jpg
            //   http://www.teenidols4you.com/blink/Actors/katyperry/katy-perry-1379801521.jpg
            return src.replace(/:\/\/[^/]*\/thumb\/(.*?)\/(?:[0-9]+)?([^/]*)$/, "://www.teenidols4you.com/blink/$1/$2");
        }

        if (domain === "cdn.pixabay.com" && false) {
            // https://cdn.pixabay.com/photo/2017/03/10/12/16/airbus-2132610_960_720.jpg
            //   https://pixabay.com/en/photos/download/airbus-2132610.jpg
            // Returns "no hotlinking" error
            newsrc = src.replace(/.*?\/photo\/.*\/([^/]*-[0-9]+)_+[0-9]+[^/]*(\.[^/.]*)$/,
                                 "https://pixabay.com/en/photos/download/$1$2");
            if (newsrc !== src)
                return {
                    url: newsrc,
                    redirects: true,
                    headers: {
                        Cookie: "is_human=1"
                    }
                };
        }

        if (domain_nosub === "meetupstatic.com") {
            // https://secure.meetupstatic.com/photos/member/4/b/1/6/thumb_180259222.jpeg
            // https://secure.meetupstatic.com/photo_api/event/rx308x180/cpt/cr308x180/ql90/sgb54c13bc46/314373292.jpeg
            //   https://secure.meetupstatic.com/photos/event/8/2/0/c/600_314373292.jpeg
            //   https://secure.meetupstatic.com/photos/event/8/2/0/c/highres_314373292.jpeg
            //   https://secure.meetupstatic.com/photos/event/0/0/0/highres_314373292.jpeg
            // http://photos3.meetupstatic.com/photos/event/1/e/1/a/highres_13507706.jpeg -- 3264x2448
            return src
                .replace(/\/photo_api\/([^/]*)\/.*\/([0-9]+\.[^/.]*)$/, "/photos/$1/0/0/0/highres_$2")
                .replace(/\/(?:thumb|[0-9]+)_([0-9]+\.[^/.]*)$/, "/highres_$1");
        }

        if (domain === "d38c5dutwb1t0j.cloudfront.net") {
            // https://d38c5dutwb1t0j.cloudfront.net/Pictures/780xany/7/6/2/130762_shutterstock_174080612.jpg
            //   https://d38c5dutwb1t0j.cloudfront.net/Pictures/9999999xany/7/6/2/130762_shutterstock_174080612.jpg
            return src.replace(/\/Pictures\/[0-9a-z]+x[0-9a-z]+\//, "/Pictures/9999999xany/");
        }

        if (domain === "img.drillspin.com") {
            // http://img.drillspin.com/oi/200/06/DSAX259106.jpg
            //   http://img.drillspin.com/oi/orig/06/DSAX259106.jpg
            // http://img.drillspin.com/ar/144/27/DSAX317727.jpg
            //   http://img.drillspin.com/ar/orig/27/DSAX317727.jpg
            return src.replace(/(:\/\/[^/]*\/[a-z]+\/)[0-9]+\//, "$1orig/");
        }

        if (domain === "pics.drillspin.com") {
            // http://pics.drillspin.com/url/park/db05/bf82/d9aa/9177/dec1/596a/7871/95e3/200.jpg
            //   http://pics.drillspin.com/url/park/db05/bf82/d9aa/9177/dec1/596a/7871/95e3/orig.jpg
            return src.replace(/\/[0-9]+(\.[^/.]*)$/, "/orig$1");
        }

        if (domain === "cdn.britannica.com" ||
            // http://static1.bestie.vn/320x1000/Mlog/ImageContent/201807/3-cap-chi-em-ruot-quyen-luc-nhat-kbiz-dep-xuat-sac-xuat-than-tram-an-44aca2.jpg
            //   http://static1.bestie.vn/Mlog/ImageContent/201807/3-cap-chi-em-ruot-quyen-luc-nhat-kbiz-dep-xuat-sac-xuat-than-tram-an-44aca2.jpg
            (domain_nosub === "bestie.vn" && domain.match(/^static[0-9]*\./)) ||
            // https://cdn.sinemia.com/64x88/artists/1470986296_57ad7838db0e7.jpg
            //   https://cdn.sinemia.com/artists/1470986296_57ad7838db0e7.jpg
            domain === "cdn.sinemia.com") {
            // https://cdn.britannica.com/100x53/50/71350-118-1F17F9C4.jpg
            //   https://cdn.britannica.com/50/71350-118-1F17F9C4.jpg
            return src.replace(/(:\/\/[^/]*\/)[0-9]+x[0-9]+\//, "$1");
        }

        if (domain_nowww === "pets4homes.co.uk") {
            // https://www.pets4homes.co.uk/images/articles/4276/large/why-might-your-cats-whiskers-fall-out-597f347251d52.jpg
            //   https://www.pets4homes.co.uk/images/articles/4276/original/why-might-your-cats-whiskers-fall-out-597f347251d52.jpg
            // https://www.pets4homes.co.uk/images/breeds/15/large/ea8fd9c9deb4550031c94c9bd7c104f5.jpeg
            //   https://www.pets4homes.co.uk/images/breeds/15/original/ea8fd9c9deb4550031c94c9bd7c104f5.jpeg
            return src.replace(/(\/images\/[^/]+\/[0-9]+\/)[a-z]+\/([^/]*)$/, "$1original/$2");
        }

        if (domain === "r.hswstatic.com") {
            // https://r.hswstatic.com/w_256/gif/now-EOAfigPY-tomatoeyes_hansneleman_gettyimagesjpg-1210-680.jpg
            //   https://s.hswstatic.com/gif/now-EOAfigPY-tomatoeyes_hansneleman_gettyimagesjpg-1210-680.jpg
            return src.replace(/:\/\/[^/]*\/[a-z]_[0-9]+\//, "://s.hswstatic.com/");
        }

        if (domain === "www.candb.com") {
            // https://www.candb.com/site/candb/cache/artwork/130/dragon-age_the-queen-of-staves_bioware-main_104x180.jpg
            //   https://www.candb.com/site/candb/images/artwork/dragon-age_the-queen-of-staves_bioware-main.jpg
            // https://www.candb.com/site/candb/cache/artwork/1600/dragon-age_the-queen-of-staves_bioware-main_926x1600_marked.jpg
            //   https://www.candb.com/site/candb/images/artwork/dragon-age_the-queen-of-staves_bioware-main.jpg
            return src.replace(/(\/candb\/)cache\/([^/]*\/)[0-9]+\/([^/]*)_[0-9]+x[0-9]+(?:[^/]*)?(\.[^/.]*)$/, "$1images/$2$3$4");
        }

        if (domain === "www.ottawalife.com") {
            // http://www.ottawalife.com/admin/cms/images/small/olmgamer-dives-back-into-thedas-with-dragonage-inquisition-3-jpg.jpg
            //   http://www.ottawalife.com/admin/cms/images/large/olmgamer-dives-back-into-thedas-with-dragonage-inquisition-3-jpg.jpg
            return src.replace(/\/cms\/images\/[a-z]+\//, "/cms/images/large/");
        }

        if (domain === "assets.rpgsite.net") {
            // https://assets.rpgsite.net/images/images/000/026/311/block/DAI_Jun92014_16.jpg
            //   https://assets.rpgsite.net/images/images/000/026/311/original/DAI_Jun92014_16.jpg
            return src.replace(/(\/images\/[0-9]+\/[0-9]+\/[0-9]+\/)[a-z]+\/([^/]+)$/, "$1original/$2");
        }

        if (domain_nowww === "nusabali.com") {
            // https://www.nusabali.com/article_images/30694/berryhardianto-juara-australia-terbuka-2018-thumb-2018-05-14-153840_0.jpg
            //   https://www.nusabali.com/article_images/30694/berryhardianto-juara-australia-terbuka-2018-2018-05-14-153840_0.jpg
            // https://www.nusabali.com/article_images/30694/berryhardianto-juara-australia-terbuka-2018-800-2018-05-14-153840_0.jpg
            //   https://www.nusabali.com/article_images/30694/berryhardianto-juara-australia-terbuka-2018-2018-05-14-153840_0.jpg
            // doesn't work for all:
            // https://www.nusabali.com/article_images/30669/pgri-bali-soroti-turunnya-nilai-un-800-2018-05-14-115025_0.jpg
            // https://www.nusabali.com/article_images/30669/pgri-bali-soroti-turunnya-nilai-un-thumb-2018-05-14-115025_0.jpg
            return src.replace(/(\/article_images\/[0-9]+\/[^/]*)-(?:thumb|800)(-[0-9]+-[0-9]+-[0-9]+-[0-9]+_[0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "www.wowkeren.com") {
            // https://www.wowkeren.com/display/images/160x117/2018/05/13/00208257.jpg
            //   https://www.wowkeren.com/display/images/photo/2018/05/13/00208257.jpg
            // https://www.wowkeren.com/images/events/thumb/2017/06/20/emma-watson-interview-mei-2017-01.jpg
            //   https://www.wowkeren.com/images/events/ori/2017/06/20/emma-watson-interview-mei-2017-01.jpg
            return src
                .replace(/\/display\/images\/[0-9]+x[0-9]+\//, "/display/images/photo/")
                .replace(/\/images\/events\/[^/]*\//, "/images/events/ori/");
        }

        if (domain === "asset.kompas.com" ||
            // http://asset-a.grid.id/crop/0x0:0x0/700x0/photo/2018/08/07/1840019897.jpg
            //   http://asset-a.grid.id/photo/2018/08/07/1840019897.jpg
            (domain_nosub === "grid.id" && domain.match(/^asset(?:-[a-z]*)?\./))) {
            // https://asset.kompas.com/crop/113x0:787x449/185x124/data/photo/2018/05/14/4120396036.jpg
            //   https://asset.kompas.com/data/photo/2018/05/14/4120396036.jpg
            return src.replace(/\/crop\/[0-9x:]+\/[0-9]+x[0-9]+\//, "/");
        }

        if (domain === "img.4plebs.org") {
            // http://img.4plebs.org/boards/hr/thumb/1526/06/1526064949904s.jpg
            //   http://img.4plebs.org/boards/hr/image/1526/06/1526064949904.jpg
            return src.replace(/\/thumb(\/[0-9]+\/[0-9]+\/[0-9]+)[a-z](\.[^/.]*)$/, "/image$1$2");
        }

        if (domain === "cdn.thinglink.me") {
            // https://cdn.thinglink.me/api/image/777977483742937091/1024/10/scaletowidth
            //   https://cdn.thinglink.me/api/image/777977483742937091
            // https://cdn.thinglink.me/api/image/7DceLftyMsyaZX9oqTXFcE7JbZyn6cssUmHn51dNeQmevWkfEcAcPYixtKrfTusWGcpZMjktM4d2KAD1wDjMx/320/320/scaledown
            //   https://cdn.thinglink.me/api/image/7DceLftyMsyaZX9oqTXFcE7JbZyn6cssUmHn51dNeQmevWkfEcAcPYixtKrfTusWGcpZMjktM4d2KAD1wDjMx
            return src.replace(/(\/api\/image\/[0-9a-zA-Z]+)\/.*$/, "$1");
        }

        if (domain === "images.sk-static.com") {
            // https://images.sk-static.com/images/media/profile_images/artists/8825119/huge_avatar
            //   https://images.sk-static.com/images/media/profile_images/artists/8825119/original
            return src.replace(/(\/[0-9]+\/)[a-z_]+$/, "$1original");
        }

        if (domain === "www.stalkcelebs.com" && src.indexOf("/img-folder/") >= 0) {
            // http://www.stalkcelebs.com/img-folder/2018/04/dove-cameron-in-bikini-top-at-v-house-at-coachella-april-14-2018_t_119071958.jpg
            //   http://www.stalkcelebs.com/img-folder/2018/04/dove-cameron-in-bikini-top-at-v-house-at-coachella-april-14-2018_119071958.jpg
            return src.replace(/_t(_[0-9]+\.[^/.]*)$/, "$1");
        }

        if (domain === "www.picsofcelebrities.com") {
            // https://www.picsofcelebrities.com/media/celebrity/dove-cameron/pictures/medium/dove-cameron-kids.jpg
            //   https://www.picsofcelebrities.com/celebrity/dove-cameron/pictures/large/dove-cameron-kids.jpg
            // https://www.picsofcelebrities.com/media/celebrity/dove-cameron/pictures/medium/dove-cameron-2016.jpg
            //   https://www.picsofcelebrities.com/celebrity/dove-cameron/pictures/large/dove-cameron-2016.jpg
            return src.replace(/\/media(\/.*\/pictures\/)[a-z]+(\/[^/]*)$/, "$1large$2");
        }

        if (domain === "dxglax8otc2dg.cloudfront.net") {
            // https://dxglax8otc2dg.cloudfront.net/media/cache/people/idols/akiyama20090906-thumb.6648e6aae2cc.jpg
            //   https://dxglax8otc2dg.cloudfront.net/media/people/idols/akiyama20090906.jpg
            // https://dxglax8otc2dg.cloudfront.net/media/cache/people/groups/momusu_googleprofile_20150101_thumb.08ba8c8b3ef2.jpg
            //   https://dxglax8otc2dg.cloudfront.net/media/people/groups/momusu_googleprofile_20150101.jpg
            return src.replace(/\/media\/cache\/(.*)[-_]thumb\.[a-f0-9]+(\.[^/.]*)$/, "/media/$1$2");
        }

        if (domain_nosub === "smugmug.com" ||
            domain === "photos.smugmug.com") {
            // thanks to /u/GarlicoinAccount on reddit for the example URLs and regex!
            // https://photos.smugmug.com/Portfolio/i-FsKpjtH/0/bc0067fc/L/Dubai%20at%20Dusk-L.jpg
            //   https://photos.smugmug.com/Portfolio/i-FsKpjtH/0/bc0067fc/O/Dubai%20at%20Dusk-O.jpg
            //   https://photos.smugmug.com/Portfolio/i-FsKpjtH/0/bc0067fc/O/.jpg
            // https://photos.smugmug.com/Galleries/Portfolio/i-97t56hx/0/85d1ded6/S/brentgoesoutside%20-%20Deep%20Cold%20-%2020180116_Deep%20Cold_Madison%20WI-S.jpg
            //   https://photos.smugmug.com/Portfolio/i-97t56hx/0/85d1ded6/O/brentgoesoutside%20-%20Deep%20Cold%20-%2020180116_Deep%20Cold_Madison%20WI-O.jpg
            //   gets redirected to:
            //   https://photos.smugmug.com/Galleries/Portfolio/i-97t56hx/0/85d1ded6/XL/brentgoesoutside%20-%20Deep%20Cold%20-%2020180116_Deep%20Cold_Madison%20WI-XL.jpg
            // https://photos.smugmug.com/Portfolio/i-97t56hx/0/85d1ded6/M/brentgoesoutside%20-%20Deep%20Cold%20-%2020180116_Deep%20Cold_Madison%20WI-M.jpg
            //   https://photos.smugmug.com/Portfolio/i-97t56hx/0/85d1ded6/O/brentgoesoutside%20-%20Deep%20Cold%20-%2020180116_Deep%20Cold_Madison%20WI-O.jpg
            // https://photos.smugmug.com/Outdoors/Los-Padres-National-Forest/i-Pm68s3d/0/f60a0297/X5/MCJ05326-X5.jpg
            //   https://photos.smugmug.com/Outdoors/Los-Padres-National-Forest/i-Pm68s3d/0/f60a0297/O/MCJ05326-O.jpg
            //   gets redirected to:
            //   https://photos.smugmug.com/Outdoors/Los-Padres-National-Forest/i-Pm68s3d/0/f60a0297/5K/MCJ05326-5K.jpg
            // https://photos.smugmug.com/Outdoors/Los-Padres-National-Forest/i-Pm68s3d/0/f60a0297/4K/MCJ05326-4K.jpg
            //   https://photos.smugmug.com/Outdoors/Los-Padres-National-Forest/i-Pm68s3d/0/f60a0297/O/MCJ05326-O.jpg
            // https://photos.smugmug.com/Outdoors/Los-Padres-National-Forest/i-Pm68s3d/0/f60a0297/XL/MCJ05326-XL.jpg
            //   https://photos.smugmug.com/Outdoors/Los-Padres-National-Forest/i-Pm68s3d/0/f60a0297/O/MCJ05326-O.jpg
            // https://photos.smugmug.com/Portfolio/Seattle-Sights/West-Seattle/i-PXJzQVB/1/7e0dd2ae/XL/DSC01014-Edit-1-XL.jpg
            //   https://photos.smugmug.com/Portfolio/Seattle-Sights/West-Seattle/i-PXJzQVB/1/7e0dd2ae/O/DSC01014-Edit-1-O.jpg -- 5168x3448, doesn't get redirected after
            //   https://photos.smugmug.com/Portfolio/Seattle-Sights/West-Seattle/i-PXJzQVB/1/7e0dd2ae/O/DSC01014-Edit-1-XL.jpg -- works too
            // https://photos.smugmug.com/Travel/Jongno-2018/i-647W9cb/0/686f9fdc/S/20180504-DSC_7229-Edit.jpg
            //   https://photos.smugmug.com/Travel/Jongno-2018/i-647W9cb/0/686f9fdc/O/20180504-DSC_7229-Edit.jpg
            // https://photos.smugmug.com/GWDC/2016/i-4WJhmJM/15/1b532670/X3/ATW06318-X3.jpg
            //   https://photos.smugmug.com/GWDC/2016/i-4WJhmJM/15/1b532670/4K/ATW06318-4K.jpg
            // https://keinomiayma.smugmug.com/Autumn-color/i-qx3SKvD/0/f6f93242/600x400/DSC09816-600x400.jpg
            // https://photos.smugmug.com/World-AIDS-Day-Gala-UK/n-3hGNK3/Grassroot-Soccer-World-AIDS-Day-Gala-2017/i-dLbnDsd/0/4f8ff87f/Ti/World%20Aids%20Day%20Gala%20%2023-Ti.jpg
            //   https://photos.smugmug.com/World-AIDS-Day-Gala-UK/n-3hGNK3/Grassroot-Soccer-World-AIDS-Day-Gala-2017/i-dLbnDsd/0/4f8ff87f/X5/World%20Aids%20Day%20Gala%20%2023-X5.jpg
            //return src.replace(/^((?:https?:)\/\/photos\.smugmug\.com\.?\/.+?\/)[A-Z0-9]{1,2}(\/[^\/]+?-)[A-Z0-9]{1,2}\.jpg(?:$|\?|#)/i,'$1O$2O.jpg');
            return {
                //url: src.replace(/(\/i-[A-Za-z0-9]+\/[0-9]\/[a-f0-9]+\/)[A-Z0-9]+(\/[^/.]*-)[A-Z0-9]+(\.[^/.?]*)(?:\?.*)?$/, "$1O$2O$3"),
                url: src.replace(/(\/i-[A-Za-z0-9]+\/[0-9]+\/[a-f0-9]+\/)(?:[A-Z0-9x]+|Ti)(\/[^/]*)(?:\?.*)?$/, "$1O$2"),
                redirects: true
            };
        }

        if (domain_nosub === "lithium.com" && domain.indexOf(".i.lithium.com") >= 0) {
            // https://spotify.i.lithium.com/t5/image/serverpage/image-id/84635i3C36019474421E94/image-size/large?v=1.0&px=999
            //   https://spotify.i.lithium.com/t5/image/serverpage/image-id/84635i3C36019474421E94/image-size/original?v=1.0
            var v = src.replace(/.*[?&](v=[^&]*).*/, "$1");
            if (v === src)
                v = "";
            else
                v = "?" + v;

            return {
                url: src.replace(/\/image-size\/[^/]*(?:\?.*)?$/, "/image-size/original" + v),
                head_wrong_contentlength: true
            };
        }

        if (domain === "www.favepeople.com") {
            // https://www.favepeople.com/photos/h0/35/h035d7s238i5e5o5c97b.jpg
            //   https://www.favepeople.com/photos/h0/35/h035d7s238i5e5o5c97b_b/Dove_Cameron_Red_Carpet_Style_3528.jpg
            // https://www.favepeople.com/photos/66/fe/66fe7i5d284bb46hnc04_s.jpg
            //   https://www.favepeople.com/photos/66/fe/66fe7i5d284bb46hnc04_b.jpg
            // https://www.favepeople.com/photos/a9/21/a921h8naond6e6d46es0/Pom_Klementieff_Red_Carpet_Style_38325.jpg -- 650x1069
            //   https://www.favepeople.com/photos/a9/21/a921h8naond6e6d46es0_b/Pom_Klementieff_Red_Carpet_Style_38325.jpg -- 2443x4020
            return src.replace(/(\/photos\/[0-9a-z]+\/[0-9a-z]+\/[0-9a-z]+)(?:_[a-z]+)?(\/[^/]*)?(\.[^/.]*)$/, "$1_b$2$3");
        }

        if (domain === "img.anews.com") {
            // https://img.anews.com/r/358x188/20161207/59703483.jpg
            //   https://img.anews.com/media/posts/images/20161207/59703483.jpg
            // https://img.anews.com/?url=https://img.anews.com/media/posts/images/20171210/81978684.jpg&w=358&h=188
            newsrc = src.replace(/.*\?url=([^&]*).*?$/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);

            return src.replace(/\/r\/[0-9]+x[0-9]+\//, "/media/posts/images/");
        }

        if (domain === "immagini.quotidiano.net") {
            // https://immagini.quotidiano.net/?url=http://p1014p.quotidiano.net:80/polopoly_fs/1.3245998.1499154460!/httpImage/image.JPG_gen/derivatives/gallery_800/image.JPG&h=495&pos=top&w=626&mode=clip
            //   http://p1014p.quotidiano.net/polopoly_fs/1.3245998.1499154460!/httpImage/image.JPG_gen/derivatives/gallery_800/image.JPG
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/\?url=([^&]*).*?$/, "$1"));
        }

        if (domain_nowww === "realitytvworld.com" ||
            domain === "cdn.realitytvworld.com") {
            // https://cdn.realitytvworld.com/images/heads/gen/embedded/1064843-s.jpg
            //   https://cdn.realitytvworld.com/images/heads/gen/embedded/1064843-l.jpg
            return src.replace(/(\/heads\/gen\/embedded\/[0-9]+)-[a-z](\.[^/.]*)$/, "$1-l$2");
        }

        if (domain === "video.newsserve.net" ||
            domain === "cdn.newsserve.net") {
            // https://video.newsserve.net/300/v/20170223/1487811916-Dove-Cameron-Shay-Mitchell-amp-amp-Ariel-Winter.jpg
            //   https://video.newsserve.net/v/20170223/1487811916-Dove-Cameron-Shay-Mitchell-amp-amp-Ariel-Winter.jpg
            // https://cdn.newsserve.net/700/i/20180821/1840-Asia-Argento-Scandal-Things-We-Still-Need.jpg -- stretched
            //   https://cdn.newsserve.net/i/20180821/1840-Asia-Argento-Scandal-Things-We-Still-Need.jpg
            return src.replace(/(:\/\/[^/]*\/)[0-9]+\//, "$1");
        }

        if (domain === "m.aceshowbiz.com" ||
            domain_nowww === "aceshowbiz.com") {
            // https://m.aceshowbiz.com/images/wennpic/preview/dove-cameron-2017-iheartradio-mmva-arrivals-01.jpg
            //   https://www.aceshowbiz.com/images/wennpic/dove-cameron-2017-iheartradio-mmva-arrivals-01.jpg
            // https://aceshowbiz.com/images/wennpic/preview/barbara-palvin-69th-cannes-film-festival-02.jpg
            //   https://aceshowbiz.com/images/wennpic/barbara-palvin-69th-cannes-film-festival-02.jpg
            //   https://m.aceshowbiz.com/images/wennpic/dove-cameron-2017-iheartradio-mmva-arrivals-01.jpg
            // https://www.aceshowbiz.com/display/images/160x117/2018/05/18/00120311.jpg
            //   https://www.aceshowbiz.com/display/images/photo/2018/05/18/00120311.jpg
            return src
                .replace(/(\/display\/images\/)[0-9]+x[0-9]+\//, "$1/photo/")
                .replace(/(\/images\/[^/]*\/)preview\//, "$1");
        }

        if (domain_nowww === "laughspark.info") {
            // http://www.laughspark.info/thumbfiles/290X169/beautiful-dove-cameron-at-thirst-gala-20-635792432637591680-16984.jpg
            //   http://laughspark.info/uploadfiles/beautiful-dove-cameron-at-thirst-gala-20-635792432637591680-16984.jpg
            return src.replace(/\/thumbfiles\/[0-9]+X[0-9]+\//, "/uploadfiles/");
        }

        if (domain_nosub === "giphy.com" && domain.match(/media[0-9]*.giphy.com/)) {
            // https://media.giphy.com/media/3og0IRYXdt9tTE52nK/giphy.gif
            // https://media.giphy.com/media/3og0IRYXdt9tTE52nK/giphy.mp4
            // https://media1.giphy.com/media/l0Iy0lyLZnfdEBmMg/200w.webp
            // https://media1.giphy.com/media/l0Iy0lyLZnfdEBmMg/200w.gif
            // https://media2.giphy.com/media/ZBg5XWrvDVzNe/200_s.gif
            return src.replace(/\/(?:giphy|[0-9]+[whs_]*)\.(?:gif|webp|mp4)/, "/source.gif");
        }

        if (domain === "pics.dmm.com" ||
            domain === "pics.dmm.co.jp") {
            // http://pics.dmm.com/mono/movie/n_612fxbr80160r/n_612fxbr80160rps.jpg
            //   http://pics.dmm.com/mono/movie/n_612fxbr80160r/n_612fxbr80160rpl.jpg
            // https://pics.dmm.co.jp/livechat/00776976/profile_s.jpg
            return src.replace(/s(\.[^/.]*)$/, "l$1");
        }

        if (domain === "www.showgle.co.kr" && src.indexOf("/uploads/") >= 0) {
            // http://www.showgle.co.kr/uploads/data/team_info_new/photos/201803/7ede4d9a797f3899dcdc547f0fd673b2_m.jpg
            //   http://www.showgle.co.kr/uploads/data/team_info_new/photos/201803/7ede4d9a797f3899dcdc547f0fd673b2.jpg
            return src.replace(/(\/[0-9a-f]+)_[a-z](\.[^/.]*)$/, "$1$2");
        }

        if (domain === "photos.modelmayhem.com") {
            // https://photos.modelmayhem.com/photos/111017/06/4e9c2f9a9c118_m.jpg
            //   https://photos.modelmayhem.com/photos/111017/06/4e9c2f9a9c118.jpg
            // https://photos.modelmayhem.com/potd/entrants/110916/potd-110916-412494-small.jpg
            //   https://photos.modelmayhem.com/potd/entrants/110916/potd-110916-412494-big.jpg
            return src
                .replace(/(\/photos\/[0-9]+\/[0-9a-f]+\/[0-9a-f]+)_[a-z](\.[^/.]*)$/, "$1$2")
                .replace(/(\/potd\/entrants\/[0-9]+\/[^/]*)-[a-z]+(\.[^/.]*)$/, "$1-big$2");
        }

        if (domain === "static.artbible.info") {
            // https://static.artbible.info/medium/lastman_kruisiging.jpg
            //   https://static.artbible.info/large/lastman_kruisiging.jpg
            return src.replace(/(:\/\/[^/]*\/)[a-z]+\//, "$1large/");
        }

        // IIIF (todo: move to bottom, make generic)
        if (domain === "lakeimagesweb.artic.edu" ||
            domain === "gallica.bnf.fr") {
            // first is region:
            // java.lang.IllegalArgumentException: Invalid region
	    //   at edu.illinois.library.cantaloupe.resource.iiif.v2.Region.fromUri(Region.java:56)
	    //   at edu.illinois.library.cantaloupe.resource.iiif.v2.Parameters.(Parameters.java:78)
	    //   at edu.illinois.library.cantaloupe.resource.iiif.v2.ImageResource.doGet(ImageResource.java:62)
            // second is size:
            // java.lang.IllegalArgumentException: Invalid size
	    //   at edu.illinois.library.cantaloupe.resource.iiif.v2.Size.fromUri(Size.java:80)
	    //   at edu.illinois.library.cantaloupe.resource.iiif.v2.Parameters.(Parameters.java:80)
	    //   at edu.illinois.library.cantaloupe.resource.iiif.v2.ImageResource.doGet(ImageResource.java:62)
            // last is rotation:
            // java.lang.IllegalArgumentException: Invalid rotation
	    //   at edu.illinois.library.cantaloupe.resource.iiif.v2.Rotation.fromUri(Rotation.java:29)
	    //   at edu.illinois.library.cantaloupe.resource.iiif.v2.Parameters.(Parameters.java:79)
	    //   at edu.illinois.library.cantaloupe.resource.iiif.v2.ImageResource.doGet(ImageResource.java:62)
	    //   at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)

            // https://lakeimagesweb.artic.edu/iiif/2/08baefe5-1f78-bc4b-db7b-4f53d2edcc29/full/!800,800/0/default.jpg
            //   https://lakeimagesweb.artic.edu/iiif/2/08baefe5-1f78-bc4b-db7b-4f53d2edcc29/full/full/0/default.jpg
            // http://gallica.bnf.fr/iiif/ark:/12148/btv1b6000531z/f1/0,0,1024,1024/256,256/0/native.jpg
            //   http://gallica.bnf.fr/iiif/ark:/12148/btv1b6000531z/f1/full/full/0/native.jpg
            newsrc = src.replace(/(\/iiif\/.*?\/)[^/]+\/[^/]+\/[^/]+\/([^/]+\.[^/.]*)$/, "$1full/full/0/$2");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain === "gallica.bnf.fr") {
            return {
                url: src,
                head_wrong_contenttype: true
            };
        }

        if (domain_nowww === "koodtv.com") {
            // https://koodtv.com/data/apms/video/youtube/thumb-T-18eNTsNk0_180x320.jpg
            //   https://koodtv.com/data/apms/video/youtube/T-18eNTsNk0.jpg
            return src.replace(/\/thumb-([^/.]*)_[0-9]+x[0-9]+(\.[^/.]*)$/, "/$1$2");
        }

        if (domain === "file.bodnara.co.kr") {
            // http://file.bodnara.co.kr/logo/insidelogo.php?image=%2Fhttp%3A%2F%2Ffile.bodnara.co.kr%2Fwebedit%2Fnews%2F2005%2F1150168644-3gate_at_computex2006_1.jpg
            //   http://file.bodnara.co.kr/webedit/news/2005/1150168644-3gate_at_computex2006_1.jpg
            return decodeURIComponent(src.replace(/.*?\/insidelogo\.php.*?[?&]image=([^&]*).*$/, "$1")).replace(/^\/*/, "");
        }

        if (domain === "passport.mobilenations.com") {
            // https://passport.mobilenations.com/avatars/000/000/000/100x100_42.jpg?r=9
            //   https://passport.mobilenations.com/avatars/000/000/000/42.jpg?r=9
            return src.replace(/\/[0-9]+x[0-9]+_([^/]*\.[^/.]*)$/, "/$1");
        }

        // monetate
        if (domain === "www.dollargeneral.com" &&
            src.indexOf("/media/") >= 0) {
            // https://www.dollargeneral.com/media/catalog/product/cache/image/700x700/e9c3970ab036de70892d86c6d221abfe/1/3/13480701.jpg
            //   https://www.dollargeneral.com/media/catalog/product/cache/image/e9c3970ab036de70892d86c6d221abfe/1/3/13480701.jpg
            // https://www.dollargeneral.com/media/catalog/product/cache/thumbnail/90x90/beff4985b56e3afdbeabfc89641a4582/1/3/13480701_6.jpg
            //   https://www.dollargeneral.com/media/catalog/product/cache/image/beff4985b56e3afdbeabfc89641a4582/1/3/13480701_6.jpg
            return src.replace(/\/cache\/(?:image|thumbnail)\/[0-9]+x[0-9]+\//, "/cache/image/");
        }

        if (domain === "www.dollartree.com" &&
            src.indexOf("/assets/") >= 0) {
            // https://www.dollartree.com/assets/product_images_2016/styles/xlarge/214435.jpg
            //   https://www.dollartree.com/assets/product_images_2016/styles/jumbo/214435.jpg
            // https://www.dollartree.com/assets/product_images_2016/styles/jumbo/114193.jpg -- 3000x3000
            return src.replace(/\/styles\/[^/]*\/([^/]*)$/, "/styles/jumbo/$1");
        }

        if (domain === "d2192bm55jmxp1.cloudfront.net") {
            // https://d2192bm55jmxp1.cloudfront.net/resize/s/article/201801/9e7b653cf2fd97604b64198dd954676e52819077d7e80540113ec5508f641629.jpg
            //   https://d2192bm55jmxp1.cloudfront.net/resize/l/article/201801/9e7b653cf2fd97604b64198dd954676e52819077d7e80540113ec5508f641629.jpg
            //   https://d2192bm55jmxp1.cloudfront.net/origin/article/201801/9e7b653cf2fd97604b64198dd954676e52819077d7e80540113ec5508f641629.jpg
            return src.replace(/\/resize\/[a-z]+\//, "/origin/");
        }

        if (domain === "i.marieclaire.com.tw") {
            // https://i.marieclaire.com.tw/assets/mc/201805/800X533/5AF92AC270A191526278850.jpg
            //   https://i.marieclaire.com.tw/assets/mc/201805/5AF92AC270A191526278850.jpeg
            // https://i.marieclaire.com.tw/assets/mc/201805/80X80/5AF92AC7DAA811526278855.jpg
            //   https://i.marieclaire.com.tw/assets/mc/201805/5AF92AC7DAA811526278855.jpeg
            newsrc = src.replace(/\/[0-9]+X[0-9]+\/([0-9A-F]+\.[^/.]*)$/, "/$1");
            if (newsrc !== src) {
                return [newsrc.replace(/\.jpg$/, ".jpeg"), newsrc];
            }
        }

        if (domain === "img.vogue.com.tw" ||
            // https://img.gq.com.tw/_rs/645/userfiles/sm/sm1024_images_A1/26353/2016021660174717.jpg
            //   https://img.gq.com.tw/userfiles/sm/sm1024_images_A1/26353/2016021660174717.jpg
            domain === "img.gq.com.tw") {
            // https://img.vogue.com.tw/_rs/960/userfiles/FCK/2018051404582865.jpg
            //   https://img.vogue.com.tw/userfiles/FCK/2018051404582865.jpg
            return src
                .replace(/\/_rs\/[0-9]+\//, "/")
            // https://img.gq.com.tw/userfiles/sm/sm645450_images_A1/35300/2018022167374993.jpg
            // https://img.gq.com.tw/userfiles/sm/sm1024_images_A1/35300/2018022167374993.jpg
            //   https://img.gq.com.tw/userfiles/images_A1/35300/2018022167374993.jpg
                .replace(/\/userfiles\/sm\/sm[0-9]+_images/, "/userfiles/images");
        }

        if (domain === "niuerdata.donews.com" ||
            // https://niuerdata.g.com.cn/data/shareimg_oss/new_thumb/2018/05/15/thumb_48ac307abe056fa7c49b5e68074e5534.JPEG
            //   https://niuerdata.g.com.cn/data/shareimg_oss/big_media_img/2018/05/15/48ac307abe056fa7c49b5e68074e5534.JPEG
            domain === "niuerdata.g.com.cn") {
            // http://niuerdata.donews.com/data/shareimg_oss/new_thumb/2018/05/21/thumb_692f2b93a7d515a7c853ceb6020763a5.JPEG
            //   http://niuerdata.donews.com/data/shareimg_oss/big_media_img/2018/05/21/692f2b93a7d515a7c853ceb6020763a5.JPEG
            // http://niuerdata.donews.com/data/shareimg_oss/big_media_img/2018/04/16/6251df21989522b68b9cd500ec26894c.JPEG -- 4032x2269
            return src
                .replace(/\/new_thumb\//, "/big_media_img/")
                .replace(/\/thumb_([0-9a-f]+\.[^/.]*)$/, "/$1");
        }

        if (domain === "pictures.icpress.cn") {
            // wip
            // http://pictures.icpress.cn/thumbs/imgs/2018/0511/20180511_83981s.jpg
            //   http://pictures.icpress.cn/thumbs/imgs/2018/0511/20180511_83981.jpg
            return src.replace(/s(\.[^/.]*)$/, "$1");
        }

        if ((domain === "interview365.mk.co.kr" &&
             src.indexOf("/images/") >= 0)) {
            // http://interview365.mk.co.kr/paper/data/news/images/2012/08/2915_S_1343748329.jpg -- 480x324
            //   http://interview365.mk.co.kr/paper/data/news/images/2012/08/2915_L_1343748329.jpg -- same
            // http://interview365.mk.co.kr/paper/data/news/images/2017/09/4272_S_1505186288.jpg -- 99x66
            //   http://interview365.mk.co.kr/paper/data/news/images/2017/09/4272_L_1505186288.jpg -- 2236x1488
            // http://interview365.mk.co.kr/paper/data/news/images/2017/09/4272_S_1506304037.jpg
            //   http://interview365.mk.co.kr/paper/data/news/images/2017/09/4272_L_1506304037.jpg
            // doesn't work for all:
            // http://interview365.mk.co.kr/paper/data/news/images/2017/07/4273_S_1500613825.jpg -- 800x1024
            //   http://interview365.mk.co.kr/paper/data/news/images/2017/07/4273_L_1500613825.jpg -- not found
            return src.replace(/(\/[0-9]+_)[A-Z](_[0-9]+\.[^/.]*)$/, "$1L$2");
        }

        if (domain === "draw.acharts.net") {
            // https://draw.acharts.net/cover/93803-55f057f54dd47-s.jpg
            //   https://draw.acharts.net/cover/93803-55f057f54dd47-l.jpg
            return src.replace(/-[a-z](\.[^/.]*)$/, "-l$1");
        }

        if (domain === "gqhotstuff.gq.com.mx") {
            // http://gqhotstuff.gq.com.mx/api/photos/small/886.jpg
            //   http://gqhotstuff.gq.com.mx/api/photos/medium/886.jpg
            //   http://gqhotstuff.gq.com.mx/api/photos/original/886.jpg
            // http://gqhotstuff.gq.com.mx/api/photos/medium/115.jpg -- upscaled
            //   http://gqhotstuff.gq.com.mx/api/photos/original/115.jpg -- smaller, not upscaled
            // http://gqhotstuff.gq.com.mx/api/photos/medium/100.jpg -- smaller
            //   http://gqhotstuff.gq.com.mx/api/photos/original/100.jpg -- larger, not upscaled
            return src.replace(/\/api\/photos\/[a-z]+\//, "/api/photos/original/");
        }

        if (domain === "images.apester.com") {
            // https://images.apester.com/user-images%2Faa%2Faaecb0949e6508374487f5f8dc120595.jpg/400/undefined/undefined
            //   https://images.apester.com/user-images%2Faa%2Faaecb0949e6508374487f5f8dc120595.jpg
            return src.replace(/(:\/\/[^/]*\/[^/]*\.[^/.]*)\/[/a-z0-9]+$/, "$1");
        }

        if (domain === "twt-thumbs.washtimes.com") {
            // https://twt-thumbs.washtimes.com/media/image/2017/04/25/tv-disney-descendants_77076_c0-218-2002-1385_s885x516.jpg?888310701b41d5af593b29f6b17ebf6bfadcfec1
            //   https://twt-media.washtimes.com/media/image/2017/04/25/tv-disney-descendants_77076.jpg
            // https://twt-thumbs.washtimes.com/media/image/2018/01/30/AP_17060654021879_s4096x2865.jpg?be8aca3bb879af6c6a7bfa91ffb108283c5ad921
            //   https://twt-media.washtimes.com/media/image/2018/01/30/AP_17060654021879.jpg
            // https://twt-thumbs.washtimes.com/media/img/staff/2017/TWT_headshot_s220x278.jpg?7061ac50c834ee0aa00bcb0fbf128328750668c6
            //   https://twt-media.washtimes.com/media/img/staff/2017/TWT_headshot.jpg
            return src.replace(/(:\/\/twt-)thumbs(\.[^/]*\/media\/(?:image|img)\/.*?)_[cs][0-9][-_0-9a-z]+(\.[^/.?]*)(?:\?.*)?$/, "$1media$2$3");
        }

        if (domain === "dynamicmedia.zuza.com") {
            // https://www.therecord.com/whatson-story/7496991-new-on-dvd-for-aug-15-descendants-2-alien-covenant-/
            // https://dynamicmedia.zuza.com/zz/m/original_/8/b/8b4ce612-1bac-40dd-ac6b-e4365811da43/B823485990Z.1_20170810201750_000_G5B1UCEI3.2_Super_Portrait.jpg
            //  https://dynamicmedia.zuza.com/zz/m/original_/8/b/8b4ce612-1bac-40dd-ac6b-e4365811da43/B823485990Z.1_20170810201750_000_G5B1UCEI3.2.jpg
            // https://dynamicmedia.zuza.com/zz/m/cropped_135x90/9/6/963074a2-e60d-43a9-9a9c-d4e5e3fae1aa/B88187086Z.1_20180518174044_000_GA76EN9Q.8-0_150x100.jpg
            //   https://dynamicmedia.zuza.com/zz/m/original_/9/6/963074a2-e60d-43a9-9a9c-d4e5e3fae1aa/B88187086Z.1_20180518174044_000_GA76EN9Q.8-0_150x100.jpg
            //   https://dynamicmedia.zuza.com/zz/m/original_/9/6/963074a2-e60d-43a9-9a9c-d4e5e3fae1aa/B88187086Z.1_20180518174044_000_GA76EN9Q.8-0_Super_Portrait.jpg
            //   https://dynamicmedia.zuza.com/zz/m/original_/9/6/963074a2-e60d-43a9-9a9c-d4e5e3fae1aa/B88187086Z.1_20180518174044_000_GA76EN9Q.8-0.jpg
            //   http://media.zuza.com/9/6/963074a2-e60d-43a9-9a9c-d4e5e3fae1aa/B88187086Z.1_20180518174044_000_GA76EN9Q.8-0_150x100.jpg -- https is not supported
            // https://dynamicmedia.zuza.com/zz/m/cropped_250x165/9/3/9316ab6b-6b66-48cc-aa48-cb5804bba6ce/OOSTERHOFFSAM_300x200.jpg
            //   https://dynamicmedia.zuza.com/zz/m/original_/9/3/9316ab6b-6b66-48cc-aa48-cb5804bba6ce/OOSTERHOFFSAM_300x200.jpg
            return src
                .replace(/\/zz\/m\/[^/]*\//, "/zz/m/original_/")
                .replace(/(\.[0-9]*(?:-[0-9]+)?)_[^-./]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "images.commeaucinema.com") {
            // http://images.commeaucinema.com/galerie/153509_5ddfccd27e59616c161c5742a63bfd42.jpg -- 260x192
            //   http://images.commeaucinema.com/galerie/big/153509_5ddfccd27e59616c161c5742a63bfd42.jpg -- 3152x2336
            return src.replace(/\/galerie\/([^/]*)$/, "/galerie/big/$1");
        }

        if (domain === "static.screenweek.it" ||
            amazon_container === "static.screenweek.it") {
            // https://s3-eu-west-1.amazonaws.com/static.screenweek.it/2016/11/29/Descendants%202%20Sofia%20Carson%20Dove%20Cameron%20foto%20dal%20film%202_mid.jpg?1480423066
            // http://static.screenweek.it/2016/11/29/Descendants%202%20Sofia%20Carson%20Dove%20Cameron%20foto%20dal%20film%202_mid.jpg?1480423066
            //   http://static.screenweek.it/2016/11/29/Descendants%202%20Sofia%20Carson%20Dove%20Cameron%20foto%20dal%20film%202_big.jpg?1480423066
            //   http://static.screenweek.it/2016/11/29/Descendants%202%20Sofia%20Carson%20Dove%20Cameron%20foto%20dal%20film%202.jpg?1480423066
            return src.replace(/_[a-z]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "filmstarjackets.com") {
            // https://filmstarjackets.com/image/cache/data/Nov15/mal-descendants-dove-cameron-leather-jacket-1000x1100.jpg
            //   https://filmstarjackets.com/image/data/Nov15/mal-descendants-dove-cameron-leather-jacket.jpg
            return src.replace(/\/image\/cache\/data\/(.*)-[0-9]+x[0-9]+(\.[^/.]*)$/, "/image/data/$1$2");
        }

        if (domain === "da4pli3l5vc0d.cloudfront.net") {
            // https://da4pli3l5vc0d.cloudfront.net/0f/dd/0fdd8b9ee75364aff60f148056780047a7dc282e/h=310,w=414,crop=top-20/?app=portal&sig=48add57365ba639191586c902db821d28579a8ebe483ba48027c34b5f221fa94
            //   https://da4pli3l5vc0d.cloudfront.net/0f/dd/0fdd8b9ee75364aff60f148056780047a7dc282e
            return src.replace(/(:\/\/[^/]*\/(?:(?:[0-9a-f]{2})\/){2}[0-9a-f]+)\/.*$/, "$1");
        }

        if (domain_nosub === "hollywood.com" && domain.match(/photo\.media[0-9]*\.hollywood\.com/)) {
            // http://photo.media.hollywood.com/prevcln/3/2/3/32368979.jpg
            //   http://photo.media.hollywood.com/full/3/2/3/32368979.jpg
            return src.replace(/(:\/\/[^/]*\/)[^/]*\//, "$1full/");
        }

        // DataLife Engine?
        if (((domain === "www.doodoo.ru" ||
              // http://www.youloveit.ru/uploads/posts/2017-07/thumbs/1499865322_youloveit_ru_nasledniki_2_foto_s_krasnoi_kovrovoi_dorogki02.jpg
              //   http://www.youloveit.ru/uploads/posts/2017-07/1499865322_youloveit_ru_nasledniki_2_foto_s_krasnoi_kovrovoi_dorogki02.jpg
              domain === "www.youloveit.ru" ||
              // http://www.take.az/uploads/posts/2014-04/thumbs/1397909548_alba.jpg
              //   http://www.take.az/uploads/posts/2014-04/1397909548_alba.jpg
              domain_nowww === "take.az" ||
              // http://starmodels.ru/uploads/posts/2014-10/thumbs/1413090916_keira-knightley-glamour-01.jpg
              //   http://starmodels.ru/uploads/posts/2014-10/1413090916_keira-knightley-glamour-01.jpg
              domain_nowww === "starmodels.ru" ||
              // http://nevseoboi.com.ua/uploads/posts/2012-06/thumbs/1339242493-1743970-0127743_www.nevseoboi.com.ua.jpg
              //   http://nevseoboi.com.ua/uploads/posts/2012-06/1339242493-1743970-0127743_www.nevseoboi.com.ua.jpg
              domain_nowww === "nevseoboi.com.ua" ||
              // https://photoofnude.com/uploads/posts/2014-03/thumbs/1394439159_761200l-581x0-selena-gomez-na-denudedstar.com-w-9ae745d9.jpg
              //   https://photoofnude.com/uploads/posts/2014-03/1394439159_761200l-581x0-selena-gomez-na-denudedstar.com-w-9ae745d9.jpg
              domain_nowww === "photoofnude.com" ||
              // http://hronika.info/uploads/posts/2017-05/thumbs/1493885290_uotson3.jpg
              //   http://hronika.info/uploads/posts/2017-05/1493885290_uotson3.jpg
              domain_nowww === "hronika.info" ||
              // http://qadin.net/uploads/posts/2014-06/thumbs/1403965159_52229_117350.jpg
              //   http://qadin.net/uploads/posts/2014-06/1403965159_52229_117350.jpg
              domain_nowww === "qadin.net" ||
              // http://allday2.com/uploads/posts/2016-10/thumbs/1476527388_stellar_collision_by_kuldarleement-d6kvnyd.jpg
              //   http://allday2.com/uploads/posts/2016-10/1476527388_stellar_collision_by_kuldarleement-d6kvnyd.jpg
              domain_nowww === "allday2.com" ||
              // http://tonshuul.mn/uploads/posts/2016-08/thumbs/1472456375_ab3e6c5f33b46a86great.jpg
              //   http://www.tonshuul.mn/uploads/posts/2016-08/1472456375_ab3e6c5f33b46a86great.jpg
              domain_nowww === "tonshuul.mn" ||
              // http://animechan.ru/uploads/posts/2017-02/thumbs/1486670042_8964c2494e73461b4a4302eb_1477163497.jpg
              //   http://animechan.ru/uploads/posts/2017-02/1486670042_8964c2494e73461b4a4302eb_1477163497.jpg
              domain_nowww === "animechan.ru" ||
              // http://www.sexs-foto.com/uploads/posts/2015-12/thumbs/1451558834_golaya-natali-portman_13_sexs-foto.com.jpg
              domain_nowww === "sexs-foto.com" ||
              // http://sexs-foto.info/uploads/posts/2015-12/thumbs/1451558834_golaya-natali-portman_13_.jpg
              //   http://sexs-foto.info/uploads/posts/2015-12/1451558834_golaya-natali-portman_13_.jpg
              // http://sexs-foto.info/uploads/blockpro/200x200/2018-04/200x200_crop_1522920478_golaya-elena-ksenofontova_4_.jpg
              //   http://sexs-foto.info/uploads/posts/2018-04/1522920478_golaya-elena-ksenofontova_4_.jpg
              domain_nowww === "sexs-foto.info" ||
              // http://informaplus.ru/uploads/posts/2014-05/thumbs/zvezdy-na-krasnoy-dorozhke-v-metropoliten-muzee-nyu-yorka_14.jpeg
              //   http://informaplus.ru/uploads/posts/2014-05/zvezdy-na-krasnoy-dorozhke-v-metropoliten-muzee-nyu-yorka_14.jpeg
              domain_nowww === "informaplus.ru" ||
              // http://modnaya.org/uploads/posts/2016-10/thumbs/1475685280_a4.jpg
              //   http://modnaya.org/uploads/posts/2016-10/1475685280_a4.jpg
              domain_nowww === "modnaya.org" ||
              // https://negani.com/uploads/posts/2012-06/thumbs/1340164617_cosplay_girls_27.jpg
              //   https://negani.com/uploads/posts/2012-06/1340164617_cosplay_girls_27.jpg
              domain_nowww === "negani.com" ||
              // http://chukcha.net/uploads/posts/2012-06/thumbs/1340116521_girls_cosplay_01077_019.jpg
              //   http://chukcha.net/uploads/posts/2012-06/1340116521_girls_cosplay_01077_019.jpg
              domain_nowww === "chukcha.net" ||
              // http://opa.kg/uploads/posts/2013-04/thumbs/1365978252_1365942089_Nemnogo_kospleya_8.jpg
              //   http://opa.kg/uploads/posts/2013-04/1365978252_1365942089_Nemnogo_kospleya_8.jpg
              domain_nowww === "opa.kg" ||
              // http://pirojok.net/uploads/posts/2018-03/thumbs/1522295041_metart_tienta_lilit-a_high_0003.jpg
              //   http://pirojok.net/uploads/posts/2018-03/1522295041_metart_tienta_lilit-a_high_0003.jpg
              domain_nowww === "pirojok.net" ||
              // http://femanes.ru/uploads/posts/2018-08/thumbs/1534165217261aaf5fe61d5288d1a35db4b4467f431e5.jpeg
              domain_nowww === "femanes.ru" ||
              // https://vistanews.ru/uploads/posts/2016-11/medium/1479532946_40ba528a22585cfd5bd812f26662f0aeabd7a9df0e4243476apimgpsh_fullsize_distr.jpg
              //   https://vistanews.ru/uploads/posts/2016-11/1479532946_40ba528a22585cfd5bd812f26662f0aeabd7a9df0e4243476apimgpsh_fullsize_distr.jpg
              // https://vistanews.ru/uploads/base/290x290/2b488c806df9f3a869a07dfe5da7c599_local.jpg
              //   https://vistanews.ru/uploads/posts/2018-09/1536835783_46.jpg
              domain_nowww === "vistanews.ru" ||
              // http://www.tour-rest.ru/uploads/posts/2016-07/thumbs/samyy-masshtabnyy-nevulkanicheskiy-opolzen-severnoy-ameriki_1.jpeg
              //   http://www.tour-rest.ru/uploads/posts/2016-07/samyy-masshtabnyy-nevulkanicheskiy-opolzen-severnoy-ameriki_1.jpeg
              domain_nowww === "tour-rest.ru" ||
              // https://bugaga.ru/uploads/posts/2015-08/thumbs/1439815321_kartinki-27.jpg
              //   https://bugaga.ru/uploads/posts/2015-08/1439815321_kartinki-27.jpg
              domain === "bugaga.ru") &&
             src.indexOf("/uploads/") >= 0) ||
            // http://sex18.photos/uploads/posts/2017-11/thumbs/15108915885979.jpg
            src.match(/^[a-z]+:\/\/[^/]*\/uploads\/posts\/[0-9]{4}-[0-9]{2}\/(?:thumbs|medium)\/[0-9]+(?:_[^/]*)?\.[^/.]*$/) ||
            src.match(/^[a-z]+:\/\/[^/]*\/uploads\/[a-z]+\/(?:[0-9]+x[0-9]+\/)?[0-9]{4}-[0-9]{2}\/thumbs\/[0-9]+x[0-9]+_crop_[0-9]+_[^/]*$/)) {
            // http://www.doodoo.ru/uploads/posts/2015-08/thumbs/zverey-foto-40.jpg
            //   http://www.doodoo.ru/uploads/posts/2015-08/zverey-foto-40.jpg
            //return src.replace(/\/thumbs\//, "/");
            return src.replace(/\/uploads\/[a-z]+\/(?:[0-9]+x[0-9]+\/)?([0-9]+-[0-9]+\/)(?:(?:thumbs|medium)\/)?(?:[0-9]+x[0-9]+_crop_)?([^/]*)$/,
                               "/uploads/posts/$1$2");
        }

        // different from above
        if (domain_nowww === "goldwallpapers.com") {
            // https://goldwallpapers.com/uploads/posts/anime-wallpaper-bleach/thumb/anime_wallpaper_bleach_010.jpg
            //   https://goldwallpapers.com/uploads/posts/anime-wallpaper-bleach/anime_wallpaper_bleach_010.jpg
            return src.replace(/(\/uploads\/posts\/[^/]*\/)thumb\/([^/]*)$/, "$1$2");
        }

        if (domain_nowww === "tooob.com" &&
            src.indexOf("/api/") >= 0) {
            // https://tooob.com/api/objs/read/noteid/28530874/__image.scaled_1024
            //   https://tooob.com/api/objs/read/noteid/28530874/
            return src.replace(/(\/[0-9]+\/)__[^/]*$/, "$1");
        }

        if (domain_nosub === "ask.fm" && domain.match(/akphoto[0-9]*\.ask\.fm/)) {
            // https://akphoto1.ask.fm/7d2/b3007/cd69/4a06/af54/e29092f7214e/large/324723.jpg -- upscaled
            // doesn't work:
            // https://akimg0.ask.fm/385/22354/974c/48f4/80af/c420c25977ef/normal/5115678.jpg
            //   transforming to akphoto0, akphoto1, doesn't work, large doesn't work either
            // https://akimg0.ask.fm/246/8095d/06cc/47ff/b7e6/75eee9dc975f/normal/913940.jpg
            // https://akimg0.ask.fm/assets2/151/350/838/784/normal/FB_IMG_1458341455293.jpg
            return src.replace(/\/[a-z]+\/([0-9]+\.[^/.]*)$/, "/original/$1");
        }

        if (domain === "alchetron.com") {
            // https://alchetron.com/cdn/dove-cameron-b073b951-002f-4a02-b6ee-947523dfd11-resize-750.jpeg
            //   https://alchetron.com/cdn/dove-cameron-b073b951-002f-4a02-b6ee-947523dfd11.jpeg
            return src.replace(/-resize-[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "img.ltn.com.tw") {
            // thanks to @rEnr3n on github
            // http://img.ltn.com.tw/Upload/ent/page/800/2018/05/10/2422261_2.jpg -- 800x800
            //   http://img.ltn.com.tw/Upload/ent/page/orig/2018/05/10/2422261_2.jpg -- 2000x2000
            // http://img.ltn.com.tw/Upload/ent/page/400S/2018/05/22/phpsyErCP.jpg -- 400x533
            //   http://img.ltn.com.tw/Upload/ent/page/orig/2018/05/22/phpsyErCP.jpg -- 720x960
            // other:
            // http://img.ltn.com.tw/Upload/Module/2/497/1496422.jpg -- 650x400
            // http://img.ltn.com.tw/Upload/liveNews/BigPic/600_phpbfGlgC.jpg -- 600x402
            // http://img.ltn.com.tw/Upload/liveNews/BigPic/600_phpmMJrzu.jpg -- 2500x1268
            // http://img.ltn.com.tw/2013/new/oct/4/images/bigPic/600_43.jpg -- 1627x1627
            // http://img.ltn.com.tw/Upload/3c/page/2017/12/30/171230-32502-1.jpg -- 3801x2534
            return src.replace(/\/Upload\/ent\/page\/[^/]+\//, "/Upload/ent/page/orig/");
        }

        if (domain_nosub === "lystit.com" && domain.match(/cdn[a-z]?\.lystit\.com/)) {
            // https://cdnc.lystit.com/520/650/n/photos/missguided/549604c4/missguided-designer-mustard-Mustard-Yellow-Satin-Asymmetric-Twist-Front-Maxi-Dress.jpeg
            //   https://cdnc.lystit.com/photos/missguided/549604c4/missguided-designer-mustard-Mustard-Yellow-Satin-Asymmetric-Twist-Front-Maxi-Dress.jpeg
            // https://cdnb.lystit.com/200/250/tr/photos/nordstrom/3c5054da/mulberry-Clay-Small-Zip-Bayswater-Classic-Leather-Tote.jpeg
            //   https://cdnb.lystit.com/photos/nordstrom/3c5054da/mulberry-Clay-Small-Zip-Bayswater-Classic-Leather-Tote.jpeg
            return src.replace(/(:\/\/[^/]*\/)[0-9]+\/[0-9]+\/[0-9a-z]+\/photos\//, "$1photos/");
        }

        if (domain === "www.newshub.co.nz") {
            // http://www.newshub.co.nz/home/entertainment/2018/01/golden-globes-2018-red-carpet-highlights-a-red-carpet-flooded-in-black/_jcr_content/par/image_1284270800.dynimg.1200.q75.jpg/v1515372069805/GettyImages-902328010.jpg
            //   http://www.newshub.co.nz/home/entertainment/2018/01/golden-globes-2018-red-carpet-highlights-a-red-carpet-flooded-in-black/_jcr_content/par/image_1284270800.dynimg.full.q75.jpg/v1515372069805/GettyImages-902328010.jpg
            // https://www.newshub.co.nz/home/world/2017/12/how-one-plastic-bag-can-harm-millions-of-creatures/_jcr_content/par/image.dynimg.1280.q75.jpg/v1512865401357/GettyImages-612269120-plastic-bag-pollution-ocean-environment-1120.jpg
            //   https://www.newshub.co.nz/home/world/2017/12/how-one-plastic-bag-can-harm-millions-of-creatures/_jcr_content/par/image.dynimg.full.q75.jpg/v1512865401357/GettyImages-612269120-plastic-bag-pollution-ocean-environment-1120.jpg
            return {
                url: src.replace(/(\/image(?:[_.][0-9]+)?\.dynimg\.)[^/]*(\.q[0-9]+\.[^/.]*)(\/.*)?$/, "$1full$2$3"),
                can_head: false
            };
        }

        if (amazon_container === "s3.931wolfcountry.com" ||
            // http://assets.instyle.co.uk/instyle/live/styles/article_landscape_600_wide/s3/14/01/schiaparelli-catwalk.jpg
            domain === "assets.instyle.co.uk" ||
            // https://d2nzqyyfd6k6c7.cloudfront.net/styles/nova_hero/s3/article/thumbnail/screen_shot_2017-07-24_at_2.13.11_pm.png?itok=q34nDL0b
            domain === "d2nzqyyfd6k6c7.cloudfront.net" ||
            // https://s3-us-west-1.amazonaws.com/s3.kllcfm.radio.com/styles/delta__775x515/s3/Untitled%2520design%2520%25283%2529_2.png?itok=vj0l-3wC
            //   https://s3-us-west-1.amazonaws.com/s3.kllcfm.radio.com/Untitled%2520design%2520%25283%2529_2.png?itok=vj0l-3wC
            amazon_container === "s3.kllcfm.radio.com" ||
            // https://s3.amazonaws.com/s3.radio.radio.com/styles/delta__775x515/s3/clean%2520bandit%2520demi.png?itok=nvpQgj12
            //   https://s3.amazonaws.com/s3.radio.radio.com/clean%2520bandit%2520demi.png?itok=nvpQgj12
            amazon_container === "s3.radio.radio.com" ||
            // https://qtxasset.com/styles/breakpoint_xl_880px_w/s3fs/2017-01/AtlantisParadiseIsland.jpg?YX9Bi5IShxorNLjzZjM4CVSKS.tq0x6.&itok=JV3OK3EV
            //   https://qtxasset.com/2017-01/AtlantisParadiseIsland.jpg?YX9Bi5IShxorNLjzZjM4CVSKS.tq0x6.&itok=JV3OK3EV
            domain === "qtxasset.com" ||
            // https://wpr-public.s3.amazonaws.com/ttbook/styles/segment_teaser/s3/images/sander-smeekes-18409.jpg?itok=950FHBAv
            amazon_container === "wpr-public" ||
            // https://s3.amazonaws.com/prod-media.gameinformer.com/styles/body_default/s3/legacy-images/imagefeed/Game%20Of%20Thrones%27%20Emilia%20Clarke%20Cast%20In%20Upcoming%20Han%20Solo%20Film/emiliaclarke610starwars.jpg
            //   https://s3.amazonaws.com/prod-media.gameinformer.com/legacy-images/imagefeed/Game%20Of%20Thrones%27%20Emilia%20Clarke%20Cast%20In%20Upcoming%20Han%20Solo%20Film/emiliaclarke610starwars.jpg
            amazon_container === "prod-media.gameinformer.com" ||
            // https://community-content-assets.minecraft.net/upload/styles/small/s3/e7d9b12a6e7f7c7a7a2b4fd7b0fed4b6-NEW%20IMAGE.jpeg
            //   https://community-content-assets.minecraft.net/upload/e7d9b12a6e7f7c7a7a2b4fd7b0fed4b6-NEW%20IMAGE.jpeg
            domain === "community-content-assets.minecraft.net" ||
            // https://cdn-s3.si.com/styles/si_gallery_slide/s3/images/SWIM146_TK3_05712-rawWMFinal1920.jpg?itok=UfWh_d4n
            domain === "cdn-s3.si.com" ||
            // https://kpopimg.s3.amazonaws.com/styles/article_image/s3/eunice-dia.jpg?itok=5JoH8xh6
            //   https://kpopimg.s3.amazonaws.com/eunice-dia.jpg?itok=5JoH8xh6
            amazon_container === "kpopimg") {
            // http://s3.amazonaws.com/s3.931wolfcountry.com/styles/full_content_width__775px_max_/s3/USATSI_10787675.jpg?itok=o8qUHpri
            //   http://s3.amazonaws.com/s3.931wolfcountry.com/USATSI_10787675.jpg?itok=o8qUHpri
            newsrc = src.replace(/\/styles\/[^/]*\/s3(?:fs)?\//, "/");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nosub === "s-nbcnews.com" && domain.match(/media[0-9]*\.s-nbcnews\.com/)) {
            // https://media3.s-nbcnews.com/i/newscms/2017_24/1221281/headshot_nbc_b0b4262799627ca0e2e9fffd7b72458c.jpg -- 2832x4256
            // https://media4.s-nbcnews.com/i/newscms/2017_41/1289217/nialhoran-171016-today-tease_7e3030f1a03215e26135bb6d77ced11c.jpg -- 10721x6031
            // https://media3.s-nbcnews.com/j/newscms/2018_21/1340735/billboard-awards-jenna-dewan-today-180521_64d305c86902f706a7b4dc0667946774.760;1811;7;70;3.jpg -- 760x1811
            //   https://media3.s-nbcnews.com/i/newscms/2018_21/1340735/billboard-awards-jenna-dewan-today-180521_64d305c86902f706a7b4dc0667946774.jpg -- 1049x2500
            // https://media2.s-nbcnews.com/j/newscms/2018_21/1340737/billboard-awards-jlo-today-180521-main-art_aa1d851db712d9a513b768ee4646e442.focal-1000x500.jpg -- 1000x500
            //   https://media2.s-nbcnews.com/i/newscms/2018_21/1340737/billboard-awards-jlo-today-180521-main-art_aa1d851db712d9a513b768ee4646e442.jpg -- 2400x1200
            return src.replace(/(:\/\/[^/]*\/)j(\/.*\/[^/.]*)[^/]*(\.[^/.]*)$/, "$1i$2$3");
        }

        if (domain === "imgcp.aacdn.jp") {
            // https://imgcp.aacdn.jp/img-a/488/auto/global-aaj-front/article/2017/10/59d2800498c16_59d27ee42664e_1369399827.JPG
            //   https://imgcp.aacdn.jp/img-a/auto/auto/global-aaj-front/article/2017/10/59d2800498c16_59d27ee42664e_1369399827.JPG
            // https://imgcp.aacdn.jp/img-a/488/auto/global-aaj-front/article/2017/04/58dfa1fb6bf8b_58df9dd195c06_277476442.JPG
            //   https://imgcp.aacdn.jp/img-a/auto/auto/global-aaj-front/article/2017/04/58dfa1fb6bf8b_58df9dd195c06_277476442.JPG
            // https://imgcp.aacdn.jp/img-a/1720/auto/global-aaj-front/article/2017/02/589a9891100fd_589a94dd4439c_950604468.jpg
            //   https://imgcp.aacdn.jp/img-a/auto/auto/global-aaj-front/article/2017/02/589a9891100fd_589a94dd4439c_950604468.jpg
            return src.replace(/\/img-a\/[0-9a-z]+\/[0-9a-z]+\//, "/img-a/auto/auto/");
        }

        if (domain === "kpopselca.com") {
            // http://kpopselca.com/selca/thumb/49457_i-cant-breathe.jpg
            return src.replace(/\/selca\/thumb\//, "/selca/");
        }

        if (domain === "www.koogle.tv") {
            // http://www.koogle.tv/static/media/uploads/newest-news-2/.thumbnails/052418_blackpink_jennie_01-120x120.jpg
            //   http://www.koogle.tv/static/media/uploads/newest-news-2/052418_blackpink_jennie_01.jpg
            return src.replace(/\/\.thumbnails\/([^/]*)-[0-9]+x[0-9]+(\.[^/.]*)$/, "/$1$2");
        }

        if (domain_nowww === "fanaru.com" ||
            // http://stuffpoint.com/anime-and-manga/image/thumb/404463-anime-and-manga-snow-queen.jpg
            //   http://stuffpoint.com/anime-and-manga/image/404463-anime-and-manga-snow-queen.jpg
            domain_nowww === "stuffpoint.com") {
            // http://fanaru.com/waup/image/thumb/188305-waup-wassup.jpg -- 280x210
            //   http://fanaru.com/waup/image/188305-waup-wassup.jpg -- 3888x2592
            return src.replace(/\/image\/thumb\//, "/image/");
        }

        if (domain === "d9nvuahg4xykp.cloudfront.net" ||
            // https://d1w8cc2yygc27j.cloudfront.net/1150484398913714461/8578329675259839686_thumbnail.jpg
            //   https://d1w8cc2yygc27j.cloudfront.net/1150484398913714461/8578329675259839686.jpg
            domain === "d1w8cc2yygc27j.cloudfront.net") {
            // https://d9nvuahg4xykp.cloudfront.net/-9212700925596145478/-1193646998958160813_thumbnail.jpg
            //   https://d9nvuahg4xykp.cloudfront.net/-9212700925596145478/-1193646998958160813.jpg
            return src.replace(/_thumbnail(\.[^/.]*)$/, "$1");
        }

        if (domain === "i.lihkg.com") {
            // https://i.lihkg.com/540/http://gifyu.com/images/cc018d69be4eb6e68887da85d6dd83b9.jpg
            //   https://gifyu.com/images/cc018d69be4eb6e68887da85d6dd83b9.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/[0-9]+\//, "");
        }

        if (domain === "www.nintendoworldreport.com" &&
            src.indexOf("/media/") >= 0) {
            // http://www.nintendoworldreport.com/media/37218/1/gallery/12.jpg
            //   http://www.nintendoworldreport.com/media/37218/1/12.jpg
            return src.replace(/\/gallery\/([0-9]+\.[^/.]*)$/, "/$1");
        }

        if (domain_nowww === "nintendoeverything.com" &&
            src.indexOf("/gallery/") >= 0) {
            // https://www.nintendoeverything.com/wp-content/gallery/fatal-frame-maiden-of-black-water-8515/thumbs/thumbs_fatal-frame-18.jpg
            //   https://nintendoeverything.com/wp-content/gallery/fatal-frame-maiden-of-black-water-8515/fatal-frame-18.jpg
            return src.replace(/\/thumbs\/thumbs_([^/]*)$/, "/$1");
        }

        if (domain === "images.nintendolife.com") {
            // http://images.nintendolife.com/news/2015/09/first_impressions_taking_a_shot_at_fatal_frame_maiden_of_black_water/attachment/0/900x.jpg
            //   http://images.nintendolife.com/news/2015/09/first_impressions_taking_a_shot_at_fatal_frame_maiden_of_black_water/attachment/0/original.jpg
            return src.replace(/(\/attachment\/[^/]*\/)[^/]+(\.[^/.]*)$/, "$1original$2");
        }

        if (domain === "cdn.igromania.ru") {
            // https://cdn.igromania.ru/mnt/articles/4/b/7/9/4/d/30165/preview/e4c138a20130c713_336x189.jpg
            //   https://cdn.igromania.ru/mnt/articles/4/b/7/9/4/d/30165/preview/e4c138a20130c713_original.jpg
            // https://cdn.igromania.ru/mnt/articles/b/0/8/f/d/3/27221/70b17403b362d9c9_1200xH.jpg
            //   https://cdn.igromania.ru/mnt/articles/b/0/8/f/d/3/27221/70b17403b362d9c9.jpg
            // doesn't work for all:
            // https://cdn.igromania.ru/mnt/articles/b/0/8/f/d/3/27221/html/img/ca7afa51a9675c1d.jpg
            //   https://cdn.igromania.ru/mnt/articles/b/0/8/f/d/3/27221/html/img/ca7afa51a9675c1d_original.jpg -- 404
            // https://www.igromania.ru/mnt/news/9/4/4/8/4/1/74580/html/more/d97ea5df6c0eddf6_original.jpg -- but this works
            return src.replace(/(\/[0-9a-f]+)(?:_[^-_/.]*)?(\.[^/.]*)$/, "$1_original$2");
        }

        if (domain === "i.blogs.es") {
            // https://i.blogs.es/824e4f/bayonetta/150_150.jpg
            //   https://i.blogs.es/824e4f/bayonetta/original.jpg
            return src.replace(/\/[0-9]+_[0-9]+(\.[^/.]*)$/, "/original$1");
        }

        /*if (domain === "popdustroar-img.rbl.ms" ||
            // https://papermag-img.rbl.ms/simage/https%3A%2F%2Fassets.rbl.ms%2F3967597%2F1200x600.jpg/2000%2C2000/3Bthb8U2RPWmDNU8/img.jpg
            //   https://assets.rbl.ms/3967597/1200x600.jpg
            //   https://assets.rbl.ms/3967597/980x.jpg
            // https://assets.rbl.ms/17099886/210x.jpg
            // https://assets.rbl.ms/1361449/origin.jpg
            (domain.indexOf(".rbl.ms") >= 0 && src.indexOf("/simage/") >= 0)) {
            // https://popdustroar-img.rbl.ms/simage/https%3A%2F%2Fassets.rbl.ms%2F6588627%2F980x.jpg/2000%2C2000/FSxn6Qs9PAa0aHKs/img.jpg
            //   https://assets.rbl.ms/6588627/980x.jpg
            return decodeURIComponent(src.replace(/.*?\/simage\/([^/]*)\/.*\/, "$1")); // fix
        }*/

        if (domain_nosub === "rbl.ms") {
            // https://resize.rbl.ms/image?source=https%3A%2F%2Fassets.rbl.ms%2F3689460%2F1216x700.jpg&size=2000%2C2000&c=qkxiCnuqMLv4GT53
            //   https://assets.rbl.ms/3689460/origin.jpg

            newsrc = src.replace(/.*\/image.*?[?&]source=([^&]*).*/, "$1");
            if (newsrc !== src) {
                return decodeURIComponent(newsrc);
            }

            // http://resize.rbl.ms/simage/https%3A%2F%2Fassets.rbl.ms%2F10514873%2F980x.gif/500%2C230/pC%2BRJHWs2YBGt8at/img.gif
            //   https://assets.rbl.ms/10514873/980x.gif
            // https://papermag-img.rbl.ms/simage/https%3A%2F%2Fassets.rbl.ms%2F3967597%2F1200x600.jpg/2000%2C2000/3Bthb8U2RPWmDNU8/img.jpg -- stretched
            //   https://assets.rbl.ms/3967597/1200x600.jpg
            //   https://assets.rbl.ms/3967597/980x.jpg
            // https://popdustroar-img.rbl.ms/simage/https%3A%2F%2Fassets.rbl.ms%2F6588627%2F980x.jpg/2000%2C2000/FSxn6Qs9PAa0aHKs/img.jpg
            //   https://assets.rbl.ms/6588627/980x.jpg
            newsrc = src.replace(/.*?\/simage\/([^/]*)\/.*/, "$1");
            if (newsrc !== src) {
                return decodeURIComponent(newsrc);
            }
        }

        if (domain === "resize-rbl-ms.cdn.ampproject.org") {
            // https://resize-rbl-ms.cdn.ampproject.org/ii/w1000/s/resize.rbl.ms/simage/https%3A%2F%2Fassets.rbl.ms%2F10514873%2F980x.gif/500%2C230/pC%2BRJHWs2YBGt8at/img.gif
            //   http://resize.rbl.ms/simage/https%3A%2F%2Fassets.rbl.ms%2F10514873%2F980x.gif/500%2C230/pC%2BRJHWs2YBGt8at/img.gif
            return src.replace(/^[a-z]+:\/\/[^/]*\/ii\/[wh][0-9]+\/s\//, "http://");
        }

        if (domain === "assets.rbl.ms") {
            // https://odysseyonline-img.rbl.ms/simage/https%3A%2F%2Fassets.rbl.ms%2F10613549%2F980x.jpg/2000%2C2000/CUjBUrbDC4rUON8Q/img.jpg
            //   https://assets.rbl.ms/10613549/origin.jpg
            // https://assets.rbl.ms/17487152/origin.jpg - 3600x2400
            return src.replace(/(:\/\/[^/]*\/[0-9]+\/)[^/.]*(\.[^/.]*)$/, "$1origin$2");
        }

        if (domain === "i.paigeeworld.com") {
            // https://i.paigeeworld.com/user-media/1452729600000/5350f6d7ad9e9cec0bb7e1be_56978883e1cf0a1d06737577_320.jpg -- 320x226
            //   https://i.paigeeworld.com/user-media/1452729600000/5350f6d7ad9e9cec0bb7e1be_56978883e1cf0a1d06737577_rz.jpg -- 5787x4093
            return src.replace(/(\/user-media\/[0-9]+\/[0-9a-f]+_[0-9a-f]+_)[^/.]*(\.[^/.]*)$/, "$1rz$2");
        }

        if (domain === "1d31c772ec21a65b0a71-0707aae3004193da193e1ad4a942592d.ssl.cf2.rackcdn.com") {
            // https://1d31c772ec21a65b0a71-0707aae3004193da193e1ad4a942592d.ssl.cf2.rackcdn.com/24688/fatal_frame_treehouse__default-news-image.png
            //   https://1d31c772ec21a65b0a71-0707aae3004193da193e1ad4a942592d.ssl.cf2.rackcdn.com/24688/fatal_frame_treehouse.png
            // https://1d31c772ec21a65b0a71-0707aae3004193da193e1ad4a942592d.ssl.cf2.rackcdn.com/24680/fatalframelooksbrettygoodguizee32015__medium.png
            //   https://1d31c772ec21a65b0a71-0707aae3004193da193e1ad4a942592d.ssl.cf2.rackcdn.com/24680/fatalframelooksbrettygoodguizee32015.png
            return src.replace(/(:\/\/[^/]*\/[0-9]+\/[^/.]*)__[^_/.]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "i.nextmedia.com.au") {
            // https://i.nextmedia.com.au/Utils/ImageResizer.ashx?n=https%3A%2F%2Fi.nextmedia.com.au%2FFeatures%2Fvampyr3.jpg&w=820&c=0&s=1
            //   https://i.nextmedia.com.au/Features/vampyr3.jpg
            return decodeURIComponent(src.replace(/.*\/Utils\/ImageResizer\.ashx.*?[?&]n=([^&]*).*?$/, "$1"));
        }

        if (domain_nosub === "heritagestatic.com" && domain.match(/dyn[0-9]*\.heritagestatic\.com/)) {
            // https://dyn1.heritagestatic.com/lf?set=path%5B1%2F5%2F3%2F6%2F2%2F15362544%5D%2Csizedata%5B850x600%5D&call=url%5Bfile%3Aproduct.chain%5D
            //   ?set=path[1/5/3/6/2/15362544],sizedata[850x600]&call=url[file:product.chain]
            //
            //   https://dyn1.heritagestatic.com/lf?set=path%5B1%2F5%2F3%2F6%2F2%2F15362544%5D&call=url%5Bfile%3Aproduct.chain%5D
            // https://dyn1.heritagestatic.com/lf?set=path%5B1%2F5%2F3%2F6%2F2%2F15362543%5D&call=url%5Bfile%3Aproduct.chain%5D
            //   ?set=path[1/5/3/6/2/15362543]&call=url[file:product.chain]
            var set = url.searchParams.get("set");
            if (!set)
                return src;

            set = decodeURIComponent(set)
                .replace(/,sizedata\[[^,]*\]/, "")
                .replace(/,$/, "");

            return src.replace(/(.*[?&]set=)[^&]*(.*?)$/, "$1" + encodeURIComponent(set) + "$2");
        }

        if (domain === "natedsanders.com" &&
            src.indexOf("/ItemImages/") >= 0) {
            // https://natedsanders.com/ItemImages/000008/8339a_med.jpeg -- 600x163
            //   https://natedsanders.com/ItemImages/000008/8339a_lg.jpeg -- 4500x1224
            return src.replace(/(\/[0-9a-z]+)_[a-z]+(\.[^/.]*)$/, "$1_lg$2");
        }

        if (domain === "d1x0dndjbjw02n.cloudfront.net" ||
            // https://s3-us-west-2.amazonaws.com/cdn.panda-gossips.com/production/posts/eyecatches/000/001/000/thumb.jpg?1511378312
            //   https://s3-us-west-2.amazonaws.com/cdn.panda-gossips.com/production/posts/eyecatches/000/001/000/original.jpg?1511378312
            amazon_container === "cdn.panda-gossips.com") {
            // https://d1x0dndjbjw02n.cloudfront.net/production/posts/eyecatches/000/001/438/thumb.jpg?1496817733
            //   https://d1x0dndjbjw02n.cloudfront.net/production/posts/eyecatches/000/001/438/original.jpg?1496817733
            return src.replace(/\/thumb(\.[^/.]*)$/, "/original$1");
        }

        if (domain === "summary-sv.fc2.com") {
            // https://summary-sv.fc2.com/api/resize_img.php?src=https%3A%2F%2Fsummary-img-sv.fc2.com%2Fsummaryfc2%2Fimg%2Fsummary%2Fwidget%2F100053655.jpeg&width=300&height=600&upd_date=2017-01-11%2008:28:37 -- upscaled
            //   https://summary-img-sv.fc2.com/summaryfc2/img/summary/widget/100053655.jpeg
            return decodeURIComponent(src.replace(/.*?\/api\/resize_img\.php.*?[?&]src=([^&]*).*?$/, "$1"));
        }

        if (domain === "image.tmdb.org") {
            // https://image.tmdb.org/t/p/w500/76gfJrmdBADyJJXqI0GRgj01yUo.jpg -- 500x750
            //   https://image.tmdb.org/t/p/original/76gfJrmdBADyJJXqI0GRgj01yUo.jpg -- 2000x3000
            // https://image.tmdb.org/t/p/w220_and_h330_bestv2/9AMeuhQn99W6deTt6cVemCy6nKe.jpg -- 220x330
            //   https://image.tmdb.org/t/p/original/9AMeuhQn99W6deTt6cVemCy6nKe.jpg -- 1400x2100
            return src.replace(/\/[wh][0-9]+(?:_and[^/]*)?\/([0-9a-zA-Z]+\.[^/.]*)$/, "/original/$1");
        }

        if (false && (domain_nosub === "nbcuni.com" &&
                      src.indexOf("/prod/image/") >= 0)) {
            // http://tve-static-eonline.nbcuni.com/prod/image/698/238/TotalBellas_S3_Desktop_FeaturedMain_3000x1688_1500x844_1239294019624.jpg -- doesn't exist anymore
            //   http://tve-static-eonline.nbcuni.com/prod/image/698/238/TotalBellas_S3_Desktop_FeaturedMain_3000x1688.jpg
            // http://tve-static-eonline.nbcuni.com/prod/image/775/39/180626_3751765_E__News_7_2_1100x620_1269070915876.jpg -- works, but transformation doesn't
            return src.replace(/_[0-9]+x[0-9]+_[0-9]{8,}(\.[^/.]*)$/, "$1");
        }

        if (domain === "embedly.massrelevance.com") {
            // https://embedly.massrelevance.com/1/image?key=fd577f7497bf11e0b95d4040d3dc5c07&url=https%3A%2F%2Finstagram.com%2Fp%2FBiPaOWNFUvm%2Fmedia%2F%3Fsize%3Dl
            //   https://instagram.com/p/BiPaOWNFUvm/media/?size=l
            return decodeURIComponent(src.replace(/.*\/image.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        if (domain === "media.lolusercontent.com") {
            // https://media.lolusercontent.com/api/embedly/1/image/resize?url=http%3A%2F%2Fddragon.leagueoflegends.com%2Fcdn%2F6.24.1%2Fimg%2Fchampion%2FZiggs.png&key=a45e967db0914c7fb472fd4381e6c85b&width=425
            //   http://ddragon.leagueoflegends.com/cdn/6.24.1/img/champion/Ziggs.png
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/api\/embedly\/1\/image\/resize.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        if (domain === "img.day.az" ||
            // https://img.milli.az/2017/07/01/250x250f/558980_30.jpg
            //   https://img.milli.az/2017/07/01/thumb/558980_30.jpg
            //   https://img.milli.az/2017/07/01/558980_30.jpg
            domain === "img.milli.az") {
            // https://img.day.az/2018/02/10/250x250f/sexiest-women-selena-gomez.jpg
            //   https://img.day.az/2018/02/10/sexiest-women-selena-gomez.jpg
            // https://img.day.az/2018/03/07/thumb/ali_kerimli.jpg
            //   https://img.day.az/2018/03/07/ali_kerimli.jpg
            return src.replace(/\/(?:(?:[0-9]+x[0-9]+[a-z]?)|thumb)(\/[^/]*)$/, "$1");
            //return src.replace(/\/[0-9]+x[0-9]+[a-z]*\/([^/]*)$/, "/$1");
        }

        if (domain_nowww === "publika.az") {
            // https://publika.az/storage/2018/06/22/250x250f/rachel-riley-at-world-aids-day-gala-to-promote-grassroot-soccer-in-london-12-01-2017-6.jpg
            //   https://publika.az/storage/2018/06/22/rachel-riley-at-world-aids-day-gala-to-promote-grassroot-soccer-in-london-12-01-2017-6.jpg
            return src.replace(/(\/storage\/[0-9]{4}\/[0-9]{2}\/[0-9]{2}\/)[0-9]+x[0-9]+[a-z]?\/([^/]*)(?:[?#].*)?$/, "$1$2");
        }

        if (domain === "fotos.caras.uol.com.br") {
            // http://fotos.caras.uol.com.br/media/images/thumb/2017/05/08/img-767195-os-looks-dos-famosos-no-mtv-movie-tv-awards-201720170508101494249579.jpg
            //   http://fotos.caras.uol.com.br/media/images/large/2017/05/08/img-767195-os-looks-dos-famosos-no-mtv-movie-tv-awards-201720170508101494249579.jpg
            //   http://fotos.caras.uol.com.br/media/images/original/2017/05/08/img-767195-os-looks-dos-famosos-no-mtv-movie-tv-awards-201720170508101494249579.jpg
            return src.replace(/\/media\/images\/[^/]*\//, "/media/images/original/");
        }

        if (domain === "www.wmj.ru" ||
            // https://sih.avn.com/300x300/top/filters:extract_focal()/album-images/2018/07/23/15432/5b55fe1652a8f-dsc5716-copy.jpg
            //   https://sih.avn.com/album-images/2018/07/23/15432/5b55fe1652a8f-dsc5716-copy.jpg
            domain === "sih.avn.com" ||
            // https://www.passion.ru/thumb/400x0/filters:quality(75)//imgs/2017/05/13/15/901933/6ed6cad1b0242b0d401881056ab4e55b5b450065.jpg
            //   https://www.passion.ru//imgs/2017/05/13/15/901933/6ed6cad1b0242b0d401881056ab4e55b5b450065.jpg
            domain_nowww === "passion.ru") {
            // https://www.wmj.ru/thumb/399x0/filters:quality(75)//imgs/2017/05/08/08/1061619/2968fac7cdf1514616b70339f0bd0a3b43c64341.jpg
            //   https://www.wmj.ru//imgs/2017/05/08/08/1061619/2968fac7cdf1514616b70339f0bd0a3b43c64341.jpg
            return src.replace(/(:\/\/[^/]*\/)(?:thumb\/)?[0-9]+x[0-9]+\/(?:top\/)?filters:[^/]*\//, "$1");
        }

        if (domain_nosub === "centerblog.net" && domain.indexOf("pic.centerblog.net") >= 0) {
            // http://thebootyhunter.t.h.pic.centerblog.net/de34e5dd.jpg
            //   http://thebootyhunter.t.h.pic.centerblog.net/o/de34e5dd.jpg
            // http://www.centerblog.net/ca/1e5f476d-s.jpg
            //   http://www.centerblog.net/imgs/img/1e5f476d-s.jpg
            //   http://marilynjohn.m.a.pic.centerblog.net/1e5f476d-s.jpg
            //   http://marilynjohn.m.a.pic.centerblog.net/1e5f476d-m.jpg
            // http://marilynjohn.m.a.pic.centerblog.net/tumblr_p1edlhuTny1rxzh05o2_502.jpg
            //   http://marilynjohn.m.a.pic.centerblog.net/o/tumblr_p1edlhuTny1rxzh05o2_502.jpg
            // http://nounousylvie51.n.o.pic.centerblog.net/m/13174182_495970667254617_2594346124069563626_n_1.jpg
            //   http://nounousylvie51.n.o.pic.centerblog.net/o/13174182_495970667254617_2594346124069563626_n_1.jpg
            // http://bionicle.b.i.pic.centerblog.net/55dlahan.jpg
            //   http://bionicle.b.i.pic.centerblog.net/o/55dlahan.jpg -- doesn't work
            return src.replace(/(:\/\/[^/]*\/)(?:[a-z]\/)?([^/]*)$/, "$1o/$2");
        }

        if (domain === "d2n4wb9orp1vta.cloudfront.net") {
            // https://d2n4wb9orp1vta.cloudfront.net/cms/brand/PT/2017-PT/plastic-bag_bpf_2.jpeg;width=560
            //   https://d2n4wb9orp1vta.cloudfront.net/cms/brand/PT/2017-PT/plastic-bag_bpf_2.jpeg
            return src.replace(/;.*/, "");
        }

        if (domain === "gd.image-gmkt.com") {
            // https://gd.image-gmkt.com/li/353/589/801589353.g_400-w_g.jpg
            //   https://gd.image-gmkt.com/li/353/589/801589353.jpg
            return src.replace(/\.[^/.]*(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "toonpool.com") {
            // https://www.toonpool.com/user/589/thumbs/zombie_315250.jpg
            //   https://www.toonpool.com/user/589/files/zombie_3152505.jpg
            //   https://www.toonpool.com/user/589/files/zombie_3152509.jpg
            // https://www.toonpool.com/user/463/files/g7-finanzministertreffen_3153385.jpg
            //   https://www.toonpool.com/user/463/files/g7-finanzministertreffen_3153389.jpg
            // https://es.toonpool.com/user/589/files/smoke_signals_3044635.jpg
            //   https://es.toonpool.com/user/589/files/smoke_signals_3044639.jpg -- no watermark
            // 9 sometimes adds a watermark
            return src
                .replace(/(\/user\/[0-9]+\/)thumbs\/([^/.]+_[0-9]+)(\.[^/.]*)$/, "$1files/$29$3")
                .replace(/(\/user\/[0-9]+\/)files\/([^/.]+_[0-9]+)[0-9](\.[^/.]*)$/, "$1files/$29$3");
        }

        if (domain === "www.cartoonmovement.com") {
            // https://www.cartoonmovement.com/depot/cartoon_thumbnails/2018/06/04/executive_decision__paolo_calleri.jpeg
            //   https://www.cartoonmovement.com/depot/cartoons/2018/06/04/executive_decision__paolo_calleri.jpeg
            return src.replace(/\/cartoon_thumbnails\//, "/cartoons/");
        }

        if (domain_nosub === "sndimg.com") {
            // https://hgtvhome.sndimg.com/content/dam/images/hgtv/fullset/2015/5/11/0/HUHH2015-Curb-Appeal_Dallas-Chateau_4.jpg.rend.hgtvcom.231.231.suffix/1431354155331.jpeg
            //   https://hgtvhome.sndimg.com/content/dam/images/hgtv/fullset/2015/5/11/0/HUHH2015-Curb-Appeal_Dallas-Chateau_4.jpg
            return src.replace(/(\/[^/.]+\.[^/.]+)\.[^/]*(?:\/[^/]*)?$/, "$1");
        }

        if (domain === "st.hzcdn.com") {
            // https://st.hzcdn.com/fimgs/4da1bc970046413d_0612-w74-h74-b0-p0--home-design.jpg
            //   https://st.hzcdn.com/simgs/4da1bc970046413d_4-0612.jpg
            //   https://st.hzcdn.com/simgs/4da1bc970046413d_14-0612/transitional-kitchen.jpg
            // 14, 9, 4, 15, 8, 10, 11, 3, 13, 7, 2, 6, 1, 12, 5, 0
            return src
                .replace(/\/fimgs\/([0-9a-f]+)_([0-9]+)-[^/]*(\.[^/.]*)$/, "/simgs/$1_14-$2$3")
                .replace(/(\/simgs\/[0-9a-f]+)_[0-9]+(-[0-9]+[./])/, "$1_14$2");
        }

        if (domain === "www.axisanimation.com" &&
            src.indexOf("/assets/") >= 0) {
            // http://www.axisanimation.com/site/assets/files/1296/mjs5847.480x270.jpg
            //  http://www.axisanimation.com/site/assets/files/1296/mjs5847.jpg
            return src.replace(/\.[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "media.baselineresearch.com") {
            // https://media.baselineresearch.com/images/198582/198582_small.jpg
            //   https://media.baselineresearch.com/images/198582/198582_full.jpg
            return src.replace(/(\/[0-9]+_)[a-z]+(\.[^/.]*)$/, "$1full$2");
        }

        if (domain_nowww === "mireportz.com" ||
            // https://pakistani.pk/uploads/reviews/photos/thumbnail/200x200c/10/27/d5/Dane20DeHaan201-11-1502137356.jpg
            //   https://pakistani.pk/uploads/reviews/photos/original/10/27/d5/Dane20DeHaan201-11-1502137356.jpg
            domain_nowww === "pakistani.pk") {
            // http://www.mireportz.com/media/reviews/photos/thumbnail/300x300s/62/29/ad/6672-now-she-looks-like-trouble-taylor-swift-ditches-the-girlie-dresses-to-slink-onto-the-acm-red-carpet-in-a-sexy-crop-top-and-slit-skirt-44-1396850272.jpg
            //   http://www.mireportz.com/media/reviews/photos/original/62/29/ad/6672-now-she-looks-like-trouble-taylor-swift-ditches-the-girlie-dresses-to-slink-onto-the-acm-red-carpet-in-a-sexy-crop-top-and-slit-skirt-44-1396850272.jpg
            return src.replace(/\/photos\/thumbnail\/[0-9]+x[0-9]+[a-z]*\//, "/photos/original/");
        }

        if (domain_nosub === "gazeta.pl" && domain.match(/bis?\.gazeta\.pl/)) {
            // http://bi.gazeta.pl/im/ca/69/16/z23502282J,Piekary-Slaskie--pielgrzymka-mezczyzn.jpg
            //   http://bi.gazeta.pl/im/ca/69/16/z23502282V,Piekary-Slaskie--pielgrzymka-mezczyzn.jpg
            //   http://bi.gazeta.pl/im/ca/69/16/z23502282V.jpg
            //   http://bi.gazeta.pl/im/ca/69/16/z23502282O.jpg
            //   http://bi.gazeta.pl/im/ca/69/16/z23502282O,Piekary-Slaskie--pielgrzymka-mezczyzn.jpg
            //   https://bis.gazeta.pl/im/ca/69/16/z23502282O,Piekary-Slaskie--pielgrzymka-mezczyzn.jpg
            // https://bi.gazeta.pl/im/1f/07/16/z23100191AA.jpg
            //   https://bi.gazeta.pl/im/1f/07/16/z23100191O.jpg
            return src.replace(/(\/z[0-9]+)[A-Z]+(,[^/.]*)?(\.[^/.]*)$/, "$1O$2$3");
        }

        if (domain_nosub === "static6.com" && domain.match(/cdn[0-9]*(-[a-z]+)?\.production\.[^./]*\.static6\.com$/)) {
            // https://cdn0-a.production.images.static6.com/ngR8X2ZyTXXuQwpawU-EyycTgbM=/673x379/smart/filters:quality(75):strip_icc():format(jpeg)/liputan6-media-production/medias/1961152/original/071093900_1520215866-20180304-Artis-Ini-Pose-Berbaring-di-Red-Carpet-Oscars-AP-1.jpg
            //   https://cdn0-a.production.liputan6.static6.com/medias/1961152/original/071093900_1520215866-20180304-Artis-Ini-Pose-Berbaring-di-Red-Carpet-Oscars-AP-1.jpg
            return src.replace(/(:\/\/cdn[0-9]*(?:-[a-z]+)?\.production\.)[^./]*(\.static6\.com)\/.*?\/([^/.-]+)-media-production\/(medias\/)/,
                               "$1$3$2/$4");
        }

        if (domain === "lajt.co.uk") {
            // http://lajt.co.uk/media/cache/235x177/uploads/article/2016/02/Pokochaj-koronki-2.jpg
            //   http://lajt.co.uk/media/cache/original/uploads/article/2016/02/Pokochaj-koronki-2.jpg
            return src.replace(/\/media\/cache\/[0-9]+x[0-9]+\//, "/media/cache/original/");
        }

        if (domain === "ellearabia.com" ||
            // http://www.national-geographic.pl/media/cache/default_view/uploads/media/default/0008/46/1fba76fdab7bfa75738a5216b908c39a3e9128d6.jpeg
            //   http://www.national-geographic.pl/uploads/media/default/0008/46/1fba76fdab7bfa75738a5216b908c39a3e9128d6.jpeg
            domain_nowww === "national-geographic.pl" ||
            // https://www.ecranlarge.com/media/cache/160x213/uploads/image/001/031/l1uabslmgse4qwthefxzsm82axp-582.jpg
            //   https://www.ecranlarge.com/uploads/image/001/031/l1uabslmgse4qwthefxzsm82axp-582.jpg
            domain_nowww === "ecranlarge.com" ||
            // https://estaticos.marie-claire.es/media/cache/706x530_thumb/uploads/images/gallery/57d7bfe55cafe82abf1dd4a6/scarlett-johansson.jpg
            //   https://estaticos.marie-claire.es/uploads/images/gallery/57d7bfe55cafe82abf1dd4a6/scarlett-johansson.jpg
            domain === "estaticos.marie-claire.es") {
            // https://ellearabia.com/media/cache/photogallery_entry/uploads/cms/photo-gallery/entries/59b64fb94ef7b.jpg
            //   https://ellearabia.com/uploads/cms/photo-gallery/entries/59b64fb94ef7b.jpg
            return src.replace(/\/+media\/+cache\/+[^/]*\/+/, "/");
        }

        if (domain === "static.t13.cl") {
            // http://static.t13.cl/ee_images/209706/063_488408753_(1)__360x.jpg
            //   http://static.t13.cl/ee_images/209706/063_488408753_(1).jpg
            return src.replace(/__[0-9]+x(?:[0-9]+)?(\.[^/.]*)$/, "$1");
        }

        if (domain === "www.cosmo.com.ua") {
            // https://www.cosmo.com.ua/i/photos_publication/18451/400_535/5p74cZz7.jpg
            //   https://www.cosmo.com.ua/i/photos_publication/18451/5p74cZz7.jpg
            return src.replace(/(\/photos_publication\/[0-9]+\/)[0-9]+_[0-9]+\//, "$1");
        }

        if (domain_nosub === "trrsf.com" && domain.match(/p[0-9]*\.trrsf\.com/)) {
            // https://p2.trrsf.com/image/fget/cf/940/0/images.terra.com/2014/09/17/7-rihanna.jpg
            //   http://images.terra.com/2014/09/17/7-rihanna.jpg
            // https://p2.trrsf.com/image/fget/cf/552/370/217/0/620/300/images.terra.com/2018/06/07/lkjas.png
            //   http://images.terra.com/2018/06/07/lkjas.png
            return src.replace(/^[a-z]+:\/\/[^/]*\/image\/fget\/[^/]*\/(?:(?:[0-9]+\/){4})?[0-9]+\/[0-9]+\//, "http://");
        }

        if (domain === "c.igte.ch" ||
            // https://img.digitalag.ro/?u=http%3A%2F%2Ftvhappy.ro%2Fuploads%2Fmodules%2Fnews%2F0%2F2016%2F8%2F29%2F124107%2F1472486563e2feeed9.jpg&w=527&h=750&c=1
            //   http://tvhappy.ro/uploads/modules/news/0/2016/8/29/124107/1472486563e2feeed9.jpg
            domain === "img.digitalag.ro") {
            // http://c.igte.ch/?u=http:/%2Fwww.trendus.com/Content/Images/PhotoGallery/size1/rihanna-stili-79411-1162016234238.jpg
            //   http://www.trendus.com/Content/Images/PhotoGallery/size1/rihanna-stili-79411-1162016234238.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/.*?[?&]u=([^&]*).*/, "$1"));
        }

        if (domain_nowww === "trendus.com") {
            // http://www.trendus.com/Content/Images/PhotoGallery/size2/rihanna-stili-79411-1162016234238.jpg
            //   http://trendus.com/Content/Images/PhotoGallery/original/rihanna-stili-79411-1162016234238.jpg
            return src.replace(/\/PhotoGallery\/size[0-9]*\//, "/PhotoGallery/original/");
        }

        if (domain === "mediacdn.grabone.co.nz") {
            // http://mediacdn.grabone.co.nz/asset/poDaw53KPl/box=615x0
            //   http://mediacdn.grabone.co.nz/asset/poDaw53KPl
            return src.replace(/(\/asset\/[-_=a-zA-Z0-9]+)\/[a-z]+=.*/, "$1");
        }

        if (domain === "cdn.glamour.es" ||
            // https://cdn.gq.com.mx/uploads/images/thumbs/201543/anna_sizykh__272304971_2954x1969.jpg
            //   https://cdn.gq.com.mx/uploads/images/201543/anna_sizykh__272304971.jpg
            // https://cdn.gq.com.mx/uploads/images/thumbs/mx/gq/2/s/2016/03/la_belleza_de_margot_robbie_956194671_977x1454.jpg
            //   https://cdn.gq.com.mx/uploads/images/mx/gq/2/s/2016/03/la_belleza_de_margot_robbie_956194671.jpg -- doesn't work
            //   https://cdn.gq.com.mx/uploads/images/mx/gq/s/2016/03/la_belleza_de_margot_robbie_956194671.jpg -- works
            domain === "cdn.gq.com.mx" ||
            // http://cdn.revistavanityfair.es/uploads/images/thumbs/201519/todos_los_looks_fabulosamente_indescriptibles_de_rihanna_38784214_93x125.jpg
            //   http://cdn.revistavanityfair.es/uploads/images/201519/todos_los_looks_fabulosamente_indescriptibles_de_rihanna_38784214.jpg
            domain === "cdn.revistavanityfair.es") {
            // http://cdn.glamour.es/uploads/images/thumbs/201419/gala_met_2014_todos_los_vestidos_de_la_alfombra_roja_343183988_667x1000.jpg
            //   http://cdn.glamour.es/uploads/images/201419/gala_met_2014_todos_los_vestidos_de_la_alfombra_roja_343183988.jpg
            // http://cdn.glamour.es/uploads/images/thumbs/201546/el_desfile_de_victorias_secret_la_alfombra_rosa_244031781_335x.jpg
            //   http://cdn.glamour.es/uploads/images/201546/el_desfile_de_victorias_secret_la_alfombra_rosa_244031781.jpg
            //return src.replace(/\/thumbs\/([0-9]+\/[^/.]*)_[0-9]+x[0-9]+(\.[^/.]*)$/, "/$1$2");

            // https://cdn.revistavanityfair.es/uploads/images/thumbs/es/vf/2/s/2018/07/karen_gillan_1730_1199x1800.jpg
            //   http://cdn.revistavanityfair.es/uploads/images/es/vf/s/2018/07/karen_gillan_1730.jpg
            return src.replace(/(\/uploads\/images)\/thumbs(?:(\/[a-z]+\/(?:vf|gq))\/[0-9]+)?(\/.*)_[0-9]+x(?:[0-9]+)?(\.[^/.]*)$/, "$1$2$3$4");
        }

        if (domain_nosub === "woman.ru" && domain.match(/i[0-9]*-cdn\.woman\.ru/)) {
            // http://i41-cdn.woman.ru/images/gallery/0/2/g_02d506839a15d0488cc92c0c4d9f892f_standart_2_1400x1100.jpg?02 -- stretched
            //   http://i41-cdn.woman.ru/images/gallery/0/2/g_02d506839a15d0488cc92c0c4d9f892f_standart.jpg?02
            return src.replace(/_[0-9]+_[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
        }

        // https://ensimages-1tmxd3aba43noa.stackpathdns.com/data/images/full/30601/rihanna.jpg?h=700
        if (domain === "ensimages-1tmxd3aba43noa.stackpathdns.com" ||
            // http://images.enstarz.com/data/images/full/30601/rihanna.jpg?w=580
            // http://images.enstarz.com/data/thumbs/full/30601/810/0/0/0/rihanna.jpg
            //   http://images.enstarz.com/data/images/full/30601/rihanna.jpg
            domain === "images.enstarz.com" ||
            // https://bbd-1tmxd3aba43noa.stackpathdns.com/data/images/full/163561/rihanna-7-jpg.jpg?w=802&l=50&t=40
            domain === "bbd-1tmxd3aba43noa.stackpathdns.com") {
            return src
                .replace(/\/data\/thumbs\/[^/]*\/([0-9]+)\/(?:[0-9]+\/){4}/, "/data/images/full/$1/")
                .replace(/\?.*/, "");
        }

        if (domain === "image.brigitte.de" && false) {
            // https://image.brigitte.de/10933292/large1x1-622-622/585b7cb3885104046176db9052522e3f/GN/rihanna-bild.jpg
            //   https://image.brigitte.de/10933292/uncropped-0-0/c7d9d39acf0a47cc66553fd0536d4b58/rj/rihanna-bild.jpg
            //   https://image.brigitte.de/10933292/uncropped-0-0/585b7cb3885104046176db9052522e3f/GN/rihanna-bild.jpg -- doesn't work
            // https://image.brigitte.de/10384676/uncropped-405-622/b686770df2f13107dd62d767f3a0c25a/El/keira-knightley-gettyimages-462994440-master.jpg
            //return src.replace(/(:\/\/[^/]*\/[0-9]+\/)[^/]*(\/[0-9a-f]+\/)/, "$1uncropped-0-0$2"); // doesn't work
        }

        if (domain_nosub === "20minutos.es" && domain.match(/st-[^/.]*\.20minutos\.es/)) {
            // https://st-listas.20minutos.es/images/2016-07/413299/5021227_249px.jpg?1469993664
            //   https://st-listas.20minutos.es/images/2016-07/413299/5021227_original.jpg?1469993664
            return src.replace(/(\/[0-9]+)_[0-9]+px(\.[^/.]*)$/, "$1_original$2");
        }

        if (domain_nosub === "thehunt.com" && domain.match(/cdn[0-9]*\.thehunt\.com/)) {
            // https://cdn1.thehunt.com/app/public/system/zine_images/4558527/zine_view_thumb/3d07f42e10e4992794c5f8246f8940ab.jpg
            //   https://cdn1.thehunt.com/app/public/system/zine_images/4558527/mobile/3d07f42e10e4992794c5f8246f8940ab.jpg
            //   https://cdn1.thehunt.com/app/public/system/zine_images/4558527/original/3d07f42e10e4992794c5f8246f8940ab.jpg
            // https://cdn1.thehunt.com/app/public/system/note_images/4585319/note_view/46cfbaeb48cf8001a85dec930875d86d.jpg
            //   https://cdn1.thehunt.com/app/public/system/note_images/4585319/original/46cfbaeb48cf8001a85dec930875d86d.jpg
            return src.replace(/(\/[0-9]+\/)[^/]*\/([0-9a-f]+\.[^/.]*)$/, "$1original/$2");
        }

        if (domain_nosub === "devote.se" && domain.match(/static[0-9]*\.devote\.se/)) {
            // http://static4.devote.se/gallery/small/20150708/257a5fd7c37599cc814b4760d98eeb81.jpg
            //   http://static4.devote.se/gallery/big/20150708/257a5fd7c37599cc814b4760d98eeb81.jpg
            return src.replace(/\/gallery\/[^/]+\//, "/gallery/big/");
        }

        if (domain_nowww === "vev.ru" &&
            src.indexOf("/uploads/images/") >= 0) {
            // http://www.vev.ru/uploads/images/00/01/43/2014/04/14/Rihanna-2014-MTV-Movie-Awards.jpg
            //   http://vev.ru/uploads/images/00/01/43/2014/04/14/Rihanna-2014-MTV-Movie-Awards_original.jpg
            return src.replace(/(?:_[a-z]+)?(\.[^/.]*)$/, "_original$1");
        }

        if (domain === "s.glbimg.com") {
            // http://s.glbimg.com/jo/eg/f/288x0/2012/11/14/156353044.jpg
            //   http://s.glbimg.com/jo/eg/f/original/2012/11/14/156353044.jpg
            return src.replace(/\/[0-9]+x[0-9]+\//, "/original/");
        }

        if (domain === "image.xahoi.com.vn" ||
            // https://media.ngoisao.vn/resize_580/news/2017/11/29/tae3-ngoisao.vn-w600-h597.jpg
            //   https://media.ngoisao.vn/news/2017/11/29/tae3-ngoisao.vn-w600-h597.jpg
            domain === "media.ngoisao.vn") {
            // http://image.xahoi.com.vn/resize_580x1100/news/2014/12/15/taylor-swift22.jpg
            //   http://image.xahoi.com.vn/news/2014/12/15/taylor-swift22.jpg
            return src.replace(/(:\/\/[^/]*\/)resize_[0-9]+(?:x[0-9]+)?\//, "$1");
        }

        if (domain_nosub === "intermoda.ru" && domain.match(/s[0-9]*\.intermoda\.ru/)) {
            // http://s1.intermoda.ru/p/max1400/1d/4dda/1e85e085d794e335925b586634813387.jpg
            //   http://s1.intermoda.ru/p/original/1d/4dda/1e85e085d794e335925b586634813387.jpg
            // http://s1.intermoda.ru/p/h450/7c/c593/a145e3941441046673b379884eead1cc.jpg
            //   http://s1.intermoda.ru/p/original/7c/c593/a145e3941441046673b379884eead1cc.jpg
            return src.replace(/\/p\/(?:max|h|w)[0-9]*\//, "/p/original/");
        }

        if (domain === "static.life.ru") {
            // https://static.life.ru/posts/2016/02/347017/5fef920a6117a660ad36961f31cd8e83__980x.jpg
            //   https://static.life.ru/posts/2016/02/347017/5fef920a6117a660ad36961f31cd8e83.jpg
            return src.replace(/__[0-9]+x(?:[0-9]+)?(\.[^/.]*)$/, "$1");
        }

        if (domain === "a.ltrbxd.com") {
            // https://a.ltrbxd.com/resized/sm/upload/l1/y0/02/4c/anohana-1200-1200-675-675-crop-000000.jpg?k=dec61b1bd7
            //   https://a.ltrbxd.com/sm/upload/l1/y0/02/4c/anohana.jpg
            // https://a.ltrbxd.com/resized/film-poster/1/7/9/2/3/0/179230-anohana-the-flower-we-saw-that-day-the-movie-0-230-0-345-crop.jpg?k=00177b15f7
            // https://a.ltrbxd.com/resized/film-poster/2/5/8/3/7/25837-rampage-0-230-0-345-crop.jpg?k=f906f9c4ed
            //   https://a.ltrbxd.com/film-poster/2/5/8/3/7/25837-rampage.jpg?k=f906f9c4ed -- broken
            return src.replace(/\/resized\/(.*)-(?:[0-9]+-){4}crop(?:-[0-9]+)?(\.[^/.]*)$/, "/$1$2");
        }

        if (domain === "images.goodsmile.info") {
            // http://images.goodsmile.info/cgm/images/product/20151117/5347/36478/medium/7c87232c87be286eaa9acf85ad86e2fb.jpg
            //   http://images.goodsmile.info/cgm/images/product/20151117/5347/36478/large/7c87232c87be286eaa9acf85ad86e2fb.jpg
            //   http://images.goodsmile.info/cgm/images/product/20151117/5347/36478/original/7c87232c87be286eaa9acf85ad86e2fb.jpg
            // doesn't work for all:
            // http://images.goodsmile.info/cgm/images/product/20111026/3326/15941/large/c0cb17556e0c49ccc02e5e47cfa642be.jpg
            //   http://images.goodsmile.info/cgm/images/product/20111026/3326/15941/original/c0cb17556e0c49ccc02e5e47cfa642be.jpg
            return src.replace(/\/[a-z]+(\/[0-9a-f]+\.[^/.]*)$/, "/original$1");
        }

        if (domain === "dzt1km7tv28ex.cloudfront.net") {
            // https://dzt1km7tv28ex.cloudfront.net/u/309884825181880320_35s_d.jpg
            //   https://dzt1km7tv28ex.cloudfront.net/u/309884825181880320_35s_o.jpg
            // https://dzt1km7tv28ex.cloudfront.net/u/195776329524707328_35s_d.jpg
            //   https://dzt1km7tv28ex.cloudfront.net/u/195776329524707328_35s_o.jpg
            return src.replace(/_[a-z](\.[^/.]*)$/, "_o$1");
        }

        if (domain_nowww === "ucarecdn.com") {
            // https://ucarecdn.com/ab72986c-0e99-4e1b-bb8e-562afa21df3c/-/stretch/off/-/resize/2000x/-/quality/normal/
            //   https://www.ucarecdn.com/ab72986c-0e99-4e1b-bb8e-562afa21df3c/
            return src.replace(/(:\/\/[^/]*\/[-0-9a-f]+\/).*/, "$1");
        }

        if (domain_nowww === "celebs-place.com") {
            // http://www.celebs-place.com/gallery/selena-gomez/image(468)_s.jpg
            //   http://www.celebs-place.com/gallery/selena-gomez/image(468).jpg
            return src.replace(/(\/gallery\/[^/]*\/[^/]*)_[a-z](\.[^/.]*)$/, "$1$2");
        }

        if (domain === "static.vfiles.com") {
            // https://static.vfiles.com/api/v2/image/media/268246/preview
            return {
                url: src.replace(/(\/image\/media\/[0-9]+\/)[a-z]+(?:\?.*)?$/, "$1original"),
                can_head: false
            };
        }

        if (domain === "img.mediacentrum.sk") {
            // https://img.mediacentrum.sk/gallery/350/1846319.jpg
            //   https://img.mediacentrum.sk/gallery/original/1846319.jpg
            // https://img.mediacentrum.sk/gallery/nwo/maxwidth/233/1846375.jpg
            //   https://img.mediacentrum.sk/gallery/original/1846375.jpg
            // https://img.mediacentrum.sk/images/gallery/640/877491.jpg
            //   https://img.mediacentrum.sk/images/gallery/original/877491.jpg
            //return src.replace(/\/images\/gallery\/[0-9]+\//, "/images/gallery/original/");
            return src.replace(/\/gallery\/(?:.*?\/)?[0-9]+\/([0-9]+\.[^/.]*)$/, "/gallery/original/$1");
        }

        if (domain === "images.says.com") {
            // http://images.says.com/uploads/story_source/source_image/89484/big_thumb_2285.jpeg -- stretched
            //   http://images.says.com/uploads/story_source/source_image/89484/2285.jpeg
            return src.replace(/(\/[0-9]+\/)[a-z_]+_([0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "wir.skyrock.net") {
            // https://wir.skyrock.net/wir/v1/resize/?c=isi&im=%2F7688%2F86157688%2Fpics%2F3171145327_1_9_XywnO238.jpg&w=252
            //   https://i.skyrock.net/7688/86157688/pics/3171145327_1_9_XywnO238.jpg
            return decodeURIComponent(src.replace(/:\/\/[^/]*\/.*[?&]im=([^&]*).*/, "://i.skyrock.net$1"));
        }

        if (domain === "i.skyrock.net") {
            // https://i.skyrock.net/4356/80274356/pics/photo_80274356_avatar_130.jpg
            //   https://i.skyrock.net/4356/80274356/pics/photo_80274356_130.jpg
            // https://i.skyrock.net/7688/86157688/pics/photo_86157688_small_22.jpg
            //   https://i.skyrock.net/7688/86157688/pics/photo_86157688_22.jpg
            // https://i.skyrock.net/5946/11875946/pics/350347040_small.jpg
            //   https://i.skyrock.net/5946/11875946/pics/350347040.jpg
            // https://i.skyrock.net/1868/84821868/pics/3106900297_0_3_V2mZWGaH.jpg
            //   https://i.skyrock.net/1868/84821868/pics/3106900297_1_3_V2mZWGaH.jpg
            return src
                .replace(/(\/pics\/(?:photo_)?[0-9]+)_[a-z]+((?:_[0-9]+)?\.[^/.]*)$/, "$1$2")
                .replace(/(\/pics\/[0-9]+)_[0-9]_([0-9]+_[A-Za-z0-9]+\.[^/.]*)$/, "$1_1_$2");
        }

        if (domain_nosub === "xhcdn.com" &&
            (domain.match(/thumb-p[0-9]*\.xhcdn\.com/) ||
             // https://upt.xhcdn.com/000/105/050/371_450.jpg
             //   https://thumb-p1.xhcdn.com/000/105/050/371_450.jpg
             //   https://thumb-p1.xhcdn.com/000/105/050/371_1000.jpg
             domain === "upt.xhcdn.com" ||
             // https://ept.xhcdn.com/000/160/284/253_450.jpg
            //   https://thumb-p3.xhcdn.com/000/160/284/253_1000.jpg
             domain === "ept.xhcdn.com")) {
            // https://thumb-p2.xhcdn.com/000/185/972/432_450.jpg
            //   https://thumb-p2.xhcdn.com/000/185/972/432_1000.jpg

            return src.replace(/(\/[0-9]+_)[0-9]+(\.[^/.]*)$/, "$11000$2");
        }

        if (domain_nosub === "netease.com" && domain.match(/img[0-9]*\.cache\.netease\.com/)) {
            // http://img4.cache.netease.com/photo/0026/2016-02-06/s_BF64NUDI43AJ0026.jpg
            //   http://img4.cache.netease.com/photo/0026/2016-02-06/t_BF64NUDI43AJ0026.jpg
            //   http://img4.cache.netease.com/photo/0026/2016-02-06/BF64NUDI43AJ0026.jpg
            // http://img2.cache.netease.com/lady/2016/4/16/20160416180754fa41d_550.jpg
            //   http://img2.cache.netease.com/lady/2016/4/16/20160416180754fa41d.jpg
            // http://img5.cache.netease.com/photo/0031/2015-09-08/140x98_B30QHVQI4VJD0031.jpg
            //   http://img5.cache.netease.com/photo/0031/2015-09-08/B30QHVQI4VJD0031.jpg
            return src
                .replace(/\/(?:[a-z]|[0-9]+x[0-9]+)_([^/]*)$/, "/$1")
                .replace(/_[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "img.lengding.cn") {
            // http://img.lengding.cn/article/getImage.php?url=https://mmbiz.qpic.cn/mmbiz_jpg/OBQWTDeVLCNUFv5o4U2RNVrCSTKphdIibJFyFfeyV1gnmtaGazdEibzuO2kicjH5OM3Uadly6ngQKrQxPLPQTwgpQ/640?wx_fmt=jpeg
            //   https://mmbiz.qpic.cn/mmbiz_jpg/OBQWTDeVLCNUFv5o4U2RNVrCSTKphdIibJFyFfeyV1gnmtaGazdEibzuO2kicjH5OM3Uadly6ngQKrQxPLPQTwgpQ/0
            return src.replace(/.*?\/getImage\.php.*?[?&]url=(.*)$/, "$1");
        }

        if (domain === "cdn.sabay.com") {
            // http://cdn.sabay.com/cdn/media.sabay.com/media/Kanha/Fashion/Feshion-4/selena-4_large.jpg
            return src.replace(/:\/\/[^/]+\/cdn\/([a-z]+\.[a-z]+\.[a-z]+\/)/, "://$1");
        }

        if (domain === "media.sabay.com" ||
            // https://static.addiyar.com/storage/attachments/1430/rihanna_892120_large.jpg
            //   https://static.addiyar.com/storage/attachments/1430/rihanna_892120.jpg
            (domain === "static.addiyar.com" && src.indexOf("/storage/attachments/") >= 0) ||
            // https://static2.annahar.com/storage/attachments/397/Rihanna-Dior_sunglasses_959864_940431_large.jpg
            //   https://static2.annahar.com/storage/attachments/397/Rihanna-Dior_sunglasses_959864_940431.jpg
            (domain_nosub === "annahar.com" && domain.match(/^static[0-9]*\.annahar/) && src.indexOf("/storage/attachments/"))) {
            // http://media.sabay.com/media/Kanha/Fashion/Feshion-4/selena-4_large.jpg
            //   http://media.sabay.com/media/Kanha/Fashion/Feshion-4/selena-4.jpg
            return src.replace(/_[a-z]+(\.[^/.]*)$/, "$1");
        }

        // haven't found anything yet
        if (domain === "binaryapi.ap.org") {
            // http://binaryapi.ap.org/2df5c8e3642d4183a08cf802c2dd50b1/preview/AP13344549840.jpg
            // http://binaryapi.ap.org/12df59bdddfa40e1967ba8f9884c8f29/940x.jpg
            //   http://binaryapi.ap.org/12df59bdddfa40e1967ba8f9884c8f29/preview.jpg
            //   http://binaryapi.ap.org/12df59bdddfa40e1967ba8f9884c8f29/460x.jpg
            // any number is accepted, not upscaled
            return {
                url: src,
                can_head: false
            };
        }

        // don't know if nosub is correct or not
        if (domain_nosub === "ekladata.com") {
            // http://ekladata.com/Szr7glS4gLW9Qj87s75kpakvTPY@546x364.jpg
            //   http://ekladata.com/Szr7glS4gLW9Qj87s75kpakvTPY.jpg
            return src.replace(/@[0-9]+x(?:[0-9]+)?(\.[^/.]*)$/, "$1");
        }

        if (domain === "img.geinoueroch.com" ||
            // http://image.hoopchina.com/nba/huabian/milla-jovovich-allen-17-s.jpg
            //   http://image.hoopchina.com/nba/huabian/milla-jovovich-allen-17.jpg
            domain === "image.hoopchina.com" ||
            // http://san.imatin.net/images/barba-s.jpg -- 300x192
            //   http://san.imatin.net/images/barba.jpg -- 2691x1725
            (domain === "san.imatin.net" && src.indexOf("/images/") >= 0) ||
            // https://img.momon-ga.com/imgs/2/f/2f380c51-s.jpg
            domain === "img.momon-ga.com") {
            // http://img.geinoueroch.com/imgs/f/c/fc3b9e51-s.jpg
            //   http://img.geinoueroch.com/imgs/f/c/fc3b9e51.jpg
            return src.replace(/-s(\.[^/.]*)$/, "$1");
        }

        if (domain === "note.taable.com" &&
            src.indexOf("/photo/") >= 0) {
            // http://note.taable.com/photo/scontent.xx.fbcdn.net/v/t31.0-0/p480x480/11182667_10153880871767871_5071962208418710934_o.jpg%3F_nc_cat%3D0%26oh%3D6bb4ad139609d4a1a828aac3d663b3c8%26oe%3D5B8E87B6%26ti%3D1451386800%26_wi%3D200
            //   https://scontent.xx.fbcdn.net/v/t31.0-0/p480x480/11182667_10153880871767871_5071962208418710934_o.jpg?_nc_cat=0&oh=6bb4ad139609d4a1a828aac3d663b3c8&oe=5B8E87B6&ti=1451386800&_wi=200
            return decodeURIComponent(src.replace(/:\/\/[^/]*\/photo\//, "://"));
        }

        if (domain_nosub === "adult-gazou.me" && domain.match(/img-[^.]*\.adult-gazou\.me/)) {
            // http://img-fdc03.adult-gazou.me/adult_b/2515/s/25.jpg
            //   http://img-fdc03.adult-gazou.me/adult_b/2515/l/25.jpg
            return src.replace(/\/[a-z](\/[0-9]*\.[^/.]*)$/, "/l$1");
        }

        if (domain_nosub === "fukugan.com" &&
            src.indexOf("/rssimg/") >= 0) {
            // http://jpn6.fukugan.com/rssimg/thumb_cache/crop_fr0_185x150/http%253A%252F%252Flivedoor.blogimg.jp%252Fseisobitch%252Fimgs%252F8%252Fe%252F8e0df1a7.jpg.%2523FFFFFF.jpg
            //   http://livedoor.blogimg.jp/seisobitch/imgs/8/e/8e0df1a7.jpg
            return decodeURIComponent(decodeURIComponent(src.replace(/.*\/(https?[%:].*)/, "$1"))).replace(/\.#.*/, "");
        }

        if (domain_nosub === "lostbird.vn" && domain.match(/img[0-9]*\.lostbird\.vn/)) {
            // http://img1.lostbird.vn/320x-/2018/02/27/79295/320x480_201312061146592vz0gfz60zu37ihp.jpg
            //   http://img1.lostbird.vn/2018/02/27/79295/320x480_201312061146592vz0gfz60zu37ihp.jpg
            return src.replace(/(:\/\/[^/]*\/)[-0-9]+x[-0-9]+\//, "$1");
        }

        if (domain === "img.biggo.com.tw") {
            // https://img.biggo.com.tw/120,fit,s7JNwTn1ERJnfry1vht0i1DbjsRTt5vOWIvAvWscdSBo/https://tshop.r10s.com/a85/93e/b037/66d8/7062/61bc/20f0/11bee787262c600c7376cd.jpg
            //   https://tshop.r10s.com/a85/93e/b037/66d8/7062/61bc/20f0/11bee787262c600c7376cd.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/[^/]*\//, "");
        }

        if (((domain_nosub === "book.com.tw" && domain.match(/im[0-9]*\.book\.com\.tw/)) ||
             // https://www.books.com.tw/image/getImage?i=https%3A%2F%2Fwww.books.com.tw%2Fimg%2FM01%2F004%2F93%2FM010049307.jpg&width=170&height=240
             //   https://www.books.com.tw/img/M01/004/93/M010049307.jpg
             domain === "www.books.com.tw" ||
             // https://buy.line-scdn.net/2962ea41/im1/image/getImage?i=https://www.books.com.tw/img/M01/004/93/M010049307.jpg&v=57bebab0&w=348&h=348
             //   https://www.books.com.tw/img/M01/004/93/M010049307.jpg
             domain === "buy.line-scdn.net") &&
            src.indexOf("/getImage") >= 0) {
            // http://im2.book.com.tw/image/getImage?i=https://www.books.com.tw/img/M01/004/93/M010049307.jpg&v=56d955b0&w=170&h=170m
            //   https://www.books.com.tw/img/M01/004/93/M010049307.jpg
            return decodeURIComponent(src.replace(/.*\/getImage.*?[?&]i=([^&]*).*?$/, "$1"));
        }

        if (domain === "img.feebee.com.tw") {
            // https://img.feebee.com.tw/ip/80/V-mkCCEt4SsOwU_ATVl53cCQxY5b-fGCIJyxLtJ6L6Y=/https://img.feebee.com.tw/ip/80/x45LJqQkSKXB-QnsHKtYoXDSJ4Y30TxSBJ3D9W8aRwg=/https://s.yimg.com/ut/api/res/1.2/IwnHZ4UimV4jdmDNhzi5jQ--~B/dz02MDA7aD02MDA7cT04MTtmaT1maXQ7YXBwaWQ9eXR3bWFsbA--/https://s.yimg.com/fy/ba06/item/p0303104354614-item-0541xf4x0750x0750-m.jpg
            //   https://s.yimg.com/fy/ba06/item/p0303104354614-item-0541xf4x0750x0750-m.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/ip\/[0-9]+\/[^/]+=\//, "");
        }

        if (domain === "img.fireden.net") {
            // https://img.fireden.net/v/thumb/1470/95/1470959423951s.jpg
            //   https://img.fireden.net/v/image/1470/95/1470959423951.jpg
            return src.replace(/\/thumb(\/.*?)s(\.[^/.]*)$/, "/image$1$2");
        }

        if (domain === "www.consolefun.fr" ||
            // https://nude-gals.com/galleries/karmen%20bella/0001/thumbs/th_karmen-bella-is-a-treat-to-behold-by-digital-desire-01.jpg
            //   https://nude-gals.com/galleries/karmen%20bella/0001/karmen-bella-is-a-treat-to-behold-by-digital-desire-01.jpg
            domain_nowww === "nude-gals.com") {
            // http://www.consolefun.fr/fiche/ps4/thumbs/th_1523541277uwo0iwsr40b1rg0p3fq6.jpg
            //   http://www.consolefun.fr/fiche/ps4/1523541277uwo0iwsr40b1rg0p3fq6.jpg
            return src.replace(/\/thumbs\/th_/, "/");
        }

        if (domain === "ex.f3img.gq") {
            // https://ex.f3img.gq/api/image?url=https%3A%2F%2Fi.kinja-img.com%2Fgawker-media%2Fimage%2Fupload%2Fs--86MJ72ai--%2Fc_scale%2Cfl_progressive%2Cq_80%2Cw_800%2Fuwo0iwsr40b1rg0p3fq6.jpg&w=715
            //   https://i.kinja-img.com/gawker-media/image/upload/uwo0iwsr40b1rg0p3fq6.jpg
            return decodeURIComponent(src.replace(/.*?\/api\/image.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        if (domain === "images.everyeye.it") {
            // https://images.everyeye.it/img-topscheda/yakuza-6-the-song-of-life-v12-24174-1280.jpg
            //   https://images.everyeye.it/img-topscheda/yakuza-6-the-song-of-life-v12-24174.jpg
            return src.replace(/(-v[0-9]+-[0-9]+)-[0-9]+(\.[&/.]*)/, "$1$2");
        }

        if (domain === "www.bobx.com") {
            // http://www.bobx.com/thumbnail/av-idol/tsubomi-tsubomi/tsubomi-tsubomi-preview-04575180.jpg
            //   http://www.bobx.com/av-idol/tsubomi-tsubomi/tsubomi-tsubomi-04575180.jpg
            // http://www.bobx.com/thumbnail/av-idol/tsubomi-tsubomi/tsubomi-tsubomi-04575387.t.jpg
            //   http://www.bobx.com/av-idol/tsubomi-tsubomi/tsubomi-tsubomi-04575387.jpg
            // http://www.bobx.com/av-idol/tsubomi-tsubomi/tsubomi-tsubomi-4236244.html
            // http://www.bobx.com/av-idol/tsubomi-tsubomi/tsubomi-tsubomi--04236244.jpg
            //   http://www.bobx.com/av-idol/tsubomi-tsubomi/tsubomi-tsubomi-04236244.jpg
            newsrc = src
                .replace(/\/thumbnail\/(.*?)(?:-preview)?(-[0-9]+)(?:\.t)?(\.[^/.]*)$/, "/$1$2$3")
                .replace(/--([0-9]+\.[^/.]*)$/, "-$1");
            return {
                url: newsrc,
                headers: {
                    Cookie: null,
                    Referer: newsrc.replace(/\.[^/.]*$/, ".html")
                }
            };
        }

        if ((domain === "www.altcine.com" && src.indexOf("/photo/") >= 0) ||
            // http://gallery-cdn.tiscali.it/repository/1682/312x210/1681221.jpg
            //   http://gallery-cdn.tiscali.it/repository/1682/1681221.jpg
            domain === "gallery-cdn.tiscali.it" ||
            // http://dspdaily.com/data/news/1703/284x189/1994203259_5NO7uXb0_ECBAA1ECB2981.JPG
            //   http://dspdaily.com/data/news/1703/1994203259_5NO7uXb0_ECBAA1ECB2981.JPG
            (domain_nowww === "dspdaily.com" && src.indexOf("/data/") >= 0)) {
            // http://www.altcine.com/personsphoto/photo/205x205/Miljenovic_Dorde%20%20(Wikluh%20Sky).jpg
            //   http://www.altcine.com/personsphoto/photo/Miljenovic_Dorde%20%20(Wikluh%20Sky).jpg
            return src.replace(/\/[0-9]+x[0-9]+\/([^/]*)$/, "/$1");
        }

        if (domain === "www.spacetelescope.org" &&
            src.indexOf("/static/") >= 0) {
            // http://www.spacetelescope.org/static/archives/images/medium/heic1501a.jpg
            //   http://www.spacetelescope.org/static/archives/images/large/heic1501a.jpg -- 6780x7071
            return src.replace(/\/images\/[^/]*\//, "/images/large/");
        }

        if (domain === "static.qobuz.com") {
            // https://static.qobuz.com/images/covers/67/31/8606102083167_600.jpg
            //   https://static.qobuz.com/images/covers/67/31/8606102083167_org.jpg
            return src.replace(/_[0-9]+(\.[^/.]*)$/, "_org$1");
        }

        if (domain_nowww === "sarajevo.travel" &&
            src.indexOf("/assets/photos/") >= 0) {
            // https://sarajevo.travel/assets/photos/events/small/tuborg-open-sara-jo-amp-sky-wikler-1503493807.jpg
            //   https://sarajevo.travel/assets/photos/events/big/tuborg-open-sara-jo-amp-sky-wikler-1503493807.jpg
            //   https://www.sarajevo.travel/assets/photos/events/original/tuborg-open-sara-jo-amp-sky-wikler-1503493807.jpg
            return src.replace(/\/[a-z]+\/([^/]*)$/, "/original/$1");
        }

        if (domain === "avatars.mds.yandex.net") {
            // https://avatars.mds.yandex.net/get-zen_doc/198938/pub_5af84b497425f5fcbcde8785_5af84b6583090599f5aded49/scale_600
            //   https://avatars.mds.yandex.net/get-zen_doc/198938/pub_5af84b497425f5fcbcde8785_5af84b6583090599f5aded49/orig
            // https://avatars.mds.yandex.net/get-pdb/1209663/2630abaf-64c6-43d7-a92b-0bcf49b644b6/s1200?webp=false
            //   https://avatars.mds.yandex.net/get-pdb/1209663/2630abaf-64c6-43d7-a92b-0bcf49b644b6/orig?webp=false
            return src.replace(/\/[a-z_0-9]+([?&].*)?$/, "/orig$1");
        }

        if (domain === "t2online.com") {
            // http://t2online.com/unsafe/s3.ap-south-1.amazonaws.com/cms-abp-prod-media/library/T2_ONLINE/image/2018/5/d67c356e-5ddb-4976-9dcc-877d30a1e4a1.jpg
            //   http://s3.ap-south-1.amazonaws.com/cms-abp-prod-media/library/T2_ONLINE/image/2018/5/d67c356e-5ddb-4976-9dcc-877d30a1e4a1.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/unsafe\//, "http://");
        }

        if (domain_nowww === "filmnegah.com") {
            // http://filmnegah.com/Image/Resize?url=~%2FUploads%2FProduct323%2FDark.Knight.Rises.Poster.26.5.91.filmnegah.jpg&width=256
            //   http://www.filmnegah.com/Uploads/Product323/Dark.Knight.Rises.Poster.26.5.91.filmnegah.jpg
            // http://filmnegah.com/Image/Thumbnail?path=~%2FUploads%2FCelebrity%2FChristopher.Nolan.25.12.91.Filmnegah.jpg&width=64
            return decodeURIComponent(src.replace(/(:\/\/[^/]*)\/Image\/(?:Resize|Thumbnail).*?[?&](?:url|path)=~([^&]*).*?$/, "$1$2"));
        }

        if (domain_nowww === "niagara.sk" &&
            src.indexOf("/images/") >= 0) {
            // https://www.niagara.sk/images/persons/tmb-100-147/christopher-nolan.jpg
            //   https://niagara.sk/images/persons/big/christopher-nolan.jpg
            return src.replace(/\/tmb-[0-9]+(?:-[0-9]+)\//, "/big/");
        }

        if (domain === "www.cdn-cinenode.com") {
            // https://www.cdn-cinenode.com/author_picture/73/christopher-nolan-73464-250-400.jpg
            //   https://www.cdn-cinenode.com/author_picture/73/full/christopher-nolan-73464.jpg
            return src.replace(/(\/[0-9]+\/)([^/]*)-[0-9]+-[0-9]+(\.[^/.]*)$/, "$1full/$2$3");
        }

        if (domain_nosub === "canalblog.com" && domain.match(/\.storage\.canalblog\.com$/)) {
            // http://p0.storage.canalblog.com/07/89/830600/116665408_m.jpg
            //   http://p0.storage.canalblog.com/07/89/830600/116665408.jpg
            //   http://p0.storage.canalblog.com/07/89/830600/116665408_o.jpg
            // http://p1.storage.canalblog.com/15/04/830600/116665417.to_resize_150x3000.png
            //   http://p1.storage.canalblog.com/15/04/830600/116665417_o.png
            return src
                .replace(/\.[^/]*(\.[^/.]*)$/, "$1")
                .replace(/(\/[0-9]+)(?:_[a-z])?(\.[^/.]*)$/, "$1_o$2");
        }

        if (domain_nowww === "film-like.com") {
            // http://film-like.com/images/film/thumb/2008/9908.jpg
            //   http://film-like.com/images/film/full/2008/9908.jpg
            return src.replace(/\/thumb\//, "/full/");
        }

        if (domain === "24smi.org") {
            // https://24smi.org/public/media/105x76/celebrity/2018/02/28/6gehfl9ng7ue-christopher-nolan.jpg
            //   https://24smi.org/public/media/celebrity/2018/02/28/6gehfl9ng7ue-christopher-nolan.jpg
            // https://24smi.org/adwiles2/img/200_150/0/c/0cab42e11498e98f9fb1df71669018a1.jpeg
            //   https://24smi.org/adwiles2/img/999999999_999999999/0/c/0cab42e11498e98f9fb1df71669018a1.jpeg
            return src
                .replace(/\/img\/[0-9]+_[0-9]+\//, "/img/999999999_999999999/")
                .replace(/\/public\/media\/[0-9]+x[0-9]+\//, "/public/media/");
        }

        if (domain === "cdn.metrotvnews.com" ||
            // https://cdn.medcom.id/dynamic/content/2017/04/10/684188/Jw85BLIVDb.jpg?w=720
            domain === "cdn.medcom.id") {
            // http://cdn.metrotvnews.com/dynamic/content/2017/07/20/732264/aSnEGWRr16.jpg?w=200
            //   http://cdn.metrotvnews.com/dynamic/content/2017/07/20/732264/aSnEGWRr16.jpg?w=99999999999
            return src.replace(/\?.*/, "?w=99999999999");
        }

        if (domain === "www.znqnet.com" &&
            src.indexOf("/fileupload/") >= 0) {
            // http://www.znqnet.com/fileupload/thumb/20150909/20150909104806_5775.jpg
            //   http://www.znqnet.com/fileupload/image/20150909/20150909104806_5775.jpg
            return src.replace(/\/fileupload\/thumb\//, "/fileupload/image/");
        }

        if (domain_nosub === "rpp-noticias.io" && domain.match(/[a-z]\.rpp-noticias\.io/)) {
            // http://e.rpp-noticias.io/small/2018/02/12/593459_564005.jpg -- 244x126
            //   http://f.rpp-noticias.io/2018/02/12/593459_564005.jpg -- 5200x2925
            return src.replace(/:\/\/e\.rpp-noticias\.io\/[a-z]+\//, "://f.rpp-noticias.io/");
        }

        if (domain_nosub === "diarioinformacion.com" && domain.match(/fotos[0-9]*\.diarioinformacion\.com/)) {
            // https://fotos01.diarioinformacion.com/2017/12/11/328x206/archivosalida20170719194704.jpg
            //   https://fotos01.diarioinformacion.com/2017/12/11/archivosalida20170719194704.jpg
            return src.replace(/\/[0-9]+x[0-9]+\//, "/");
        }

        if (domain === "imagenes-cdn.diarioinformacion.com" && src.indexOf("/multimedia/fotos/")) {
            // https://imagenes-cdn.diarioinformacion.com/multimedia/fotos/2013/02/20/48588/1361356702610-4_p.jpg
            //   https://imagenes-cdn.diarioinformacion.com/multimedia/fotos/2013/02/20/48588/1361356702610-4.jpg
            return src.replace(/_[a-z](\.[^/.]*)$/, "$1");
        }

        if (domain === "www.digi-film.ro") {
            // http://www.digi-film.ro/onedb/picture(width=200,crop=1)/56824f6695f9cfef07000000
            //   http://www.digi-film.ro/onedb/picture:56824f6695f9cfef07000000
            //   http://www.digi-film.ro/onedb/picture/56824f6695f9cfef07000000 -- redirected to:
            //     http://storage03dgf.rcs-rds.ro/storage/2015/12/29/545191_545191_nolan.jpg
            return src.replace(/\/onedb\/picture\([^/]*\//, "/onedb/picture/");
        }

        if (domain_nosub === "jiemian.com" && domain.match(/img[0-9]*\.jiemian\.com/)) {
            // http://img2.jiemian.com/101/original/20170902/15043383837444100_a580xH.jpg
            //   http://img2.jiemian.com/101/original/20170902/15043383837444100.jpg
            return src.replace(/\/([0-9]+)_[a-zA-Z0-9]+x[a-zA-Z0-9]+(\.[^/.]*)$/, "/$1$2");
        }

        if (domain === "cdn.highdefdigest.com") {
            // https://cdn.highdefdigest.com/uploads/2017/11/20/660/nolan.jpg
            //   https://cdn.highdefdigest.com/uploads/2017/11/20/nolan.jpg
            return src.replace(/(\/uploads\/[0-9]+\/[0-9]+\/[0-9]+\/)[0-9]+\/([^/]*)$/, "$1$2");
        }

        if (domain_nowww === "ojosdecafe.com") {
            // http://ojosdecafe.com/img/upload/thumbs/750x450_christopher-nolan-dunkirk.jpg
            //   http://www.ojosdecafe.com/img/upload/christopher-nolan-dunkirk.jpg
            return src.replace(/\/thumbs\/[0-9]+x[0-9]+_/, "/");
        }

        if (domain === "img.gestion.pe") {
            // https://img.gestion.pe/files/ec_article_multimedia_gallery/uploads/2017/11/08/5a03a7dc67e6a.jpeg -- stretched
            //   https://img.gestion.pe/uploads/2017/11/08/5a03a7dc67e6a.jpeg
            return src.replace(/\/files\/[^/]*\/uploads\//, "/uploads/");
        }

        if (domain === "thumb.guucdn.net") {
            // https://thumb.guucdn.net/400x225/images.guucdn.net/full/2018/05/29/7426c2a3bfc916d4cad3b9e921b604087c246dfa.jpg
            //   https://images.guucdn.net/full/2018/05/29/7426c2a3bfc916d4cad3b9e921b604087c246dfa.jpg
            return src.replace(/:\/\/[^/]*\/[0-9]+x[0-9]+\//, "://");
        }

        if ((domain === "game4v.com" &&
             src.indexOf("/thumb/thumb.php?") >= 0) ||
            // http://static.pinwallpapers.com/thumb.php?src=http://static.pinwallpapers.com/anime/anime-wallpapers/anime-wallpaper-1237412.jpg&w=640&h=360
            //   http://static.pinwallpapers.com/anime/anime-wallpapers/anime-wallpaper-1237412.jpg
            domain === "static.pinwallpapers.com") {
            // http://game4v.com/thumb/thumb.php?w=560&src=http%3A%2F%2Fcdn2.game4v.com%2F2014%2F10%2Fphong-than-di-tuong-2.jpg
            //   http://cdn2.game4v.com/2014/10/phong-than-di-tuong-2.jpg
            return decodeURIComponent(src.replace(/.*?\/thumb\.php.*?[?&]src=([^&]*).*?$/, "$1"));
        }

        if (domain_nowww === "newpal.ps" ||
            // http://pardisgame.net/thumb.php?src=images/uploads/PBC38QTQBL.jpg&w=150&q=90&iar=1
            //   http://pardisgame.net/images/uploads/PBC38QTQBL.jpg
            domain_nowww === "pardisgame.net") {
            // http://newpal.ps/thumb.php?src=uploads//images/c0b239c0c38317c621e9f2e0f45a80ac.jpg&w=500&zc=1
            //   http://newpal.ps/uploads//images/c0b239c0c38317c621e9f2e0f45a80ac.jpg
            newsrc = decodeURIComponent(src.replace(/.*?\/thumb\.php.*?[?&]src=([^&]*).*?$/, "$1"));
            if (newsrc !== src) {
                if (newsrc.match(/^[a-z]+:\/\//))
                    return newsrc;
                else
                    return urljoin(src, "/" + newsrc);
            }
        }

        if (domain === "static.santruyen.com") {
            // http://static.santruyen.com/medias/covers/49/49367_cover.jpg
            //   http://static.santruyen.com/medias/covers/49/49367_large.jpg
            //   http://static.santruyen.com/medias/covers/49/49367.jpg
            // http://static.santruyen.com/medias/covers/75/75215_thumbnail.jpg
            //   http://static.santruyen.com/medias/covers/75/75215.jpg
            return src.replace(/(\/[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (amazon_container === "boligsurf-production" &&
            src.indexOf("/assets/images/") >= 0) {
            // https://s3.eu-central-1.amazonaws.com/boligsurf-production/assets/images/005/979/084/fixed_500_400/e9f400a3478f97092c7456b9836ea888b367c857.jpg
            //   https://s3.eu-central-1.amazonaws.com/boligsurf-production/assets/images/005/979/084/original/e9f400a3478f97092c7456b9836ea888b367c857.jpg
            return src.replace(/\/fixed_[0-9]+_[0-9]+\//, "/original/");
        }

        if (domain === "bt.bmcdn.dk") {
            // https://bt.bmcdn.dk/media/cache/resolve/image_420/image/103/1032257/17913568-.jpg
            //   https://bt.bmcdn.dk/media/cache/resolve/image/image/103/1032257/17913568-.jpg
            // doesn't work:
            // https://bdk.bmcdn.dk/media/cache/resolve/image_910x511/image/97/976522/21478831-isfjeld-grundstdt-lige-uden-f.jpeg
            return src.replace(/\/image_[0-9]+(?:x[0-9]+)?\/image\//, "/image/image/");
        }

        if (domain_nowww === "sonara.net") {
            // http://sonara.net/cro.php?width=108&height=80&cropratio=108:80&image=%2F20180610-1331171884648120.jpg
            //   http://images.sonara.net/20180610-1331171884648120.jpg
            return decodeURIComponent(src.replace(/:\/\/[^/]*\/cro\.php.*?[?&]image=([^&]*).*?$/, "://images.sonara.net$1"));
        }

        if (domain === "d2u7zfhzkfu65k.cloudfront.net" &&
            src.indexOf("/resize/wp-content/") >= 0) {
            // https://d2u7zfhzkfu65k.cloudfront.net/resize/wp-content/uploads/2018/5/8/15/f21a56c81474b277e24bca7575e94dc7.jpg?w=70&q=85
            //   https://d3kszy5ca3yqvh.cloudfront.net/wp-content/uploads/2018/5/8/15/f21a56c81474b277e24bca7575e94dc7.jpg
            return src.replace(/:\/\/[^/]*\/resize\//, "://d3kszy5ca3yqvh.cloudfront.net/");
        }

        if (domain === "imgbp.hotp.jp") {
            // https://imgbp.hotp.jp/CSP/IMG_SRC/60/26/B011156026/B011156026_271-361.jpg
            //   https://imgbp.hotp.jp/CSP/IMG_SRC/60/26/B011156026/B011156026.jpg
            return src.replace(/_[0-9]+-[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (amazon_container === "ro69-bucket") {
            // https://ro69-bucket.s3.amazonaws.com/uploads/text_image/image/298198/200x200/resize_image.jpg
            //   https://ro69-bucket.s3.amazonaws.com/uploads/text_image/image/298198/default/resize_image.jpg
            // https://rockinon.com/images/entry/width:750/137595/1
            //   https://ro69-bucket.s3.amazonaws.com/uploads/text_image/image/206532/width:750/resize_image.gif
            //   https://ro69-bucket.s3.amazonaws.com/uploads/text_image/image/206532/default/resize_image.gif
            return src.replace(/(\/image\/[0-9]+\/)[^/]*\/resize_image/, "$1default/resize_image");
        }

        if (domain === "aimg-pictpix.akamaized.net") {
            // https://aimg-pictpix.akamaized.net/ts600x1/img/pictpix/25/74/04eeb5c81734927eb81cefb1d90e26aa8a340e0b.png
            //   https://aimg-pictpix.akamaized.net/img/pictpix/25/74/04eeb5c81734927eb81cefb1d90e26aa8a340e0b.png
            return src.replace(/(:\/\/[^/]*\/)ts[0-9]+x[0-9]+\/img\//, "$1img/");
        }

        if (amazon_container === "lattepic") {
            // https://lattepic.s3.amazonaws.com/column_bq/pn/fy/5s/n6/km/le/ub/le/tj/5o/wu/hr/u2/5s/xu_medium.png
            //   https://lattepic.s3.amazonaws.com/column_bq/pn/fy/5s/n6/km/le/ub/le/tj/5o/wu/hr/u2/5s/xu_org.png
            // https://lattepic.s3.amazonaws.com/column_pe/qo/iv/g3/lm/e3/6f/e7/q5/lb/b4/jf/rl/xw/ir/fl_square.png
            //   https://lattepic.s3.amazonaws.com/column_pe/qo/iv/g3/lm/e3/6f/e7/q5/lb/b4/jf/rl/xw/ir/fl_org.png
            //
            // https://latte.la/hair/style/10078
            // https://lattepic.s3.amazonaws.com/column_xn/ab/r5/hx/ib/zf/bt/r3/64/73/cn/sy/r2/xz/46/pg_org.png
            //   https://lattepic.s3.amazonaws.com/p_df/v2/3o/6q/kc/4c/ir/cu/4u/ao/un/rj/cy/g3/ev/cr_medium.jpeg?Signature=H6SKvjkyvvSS1bSCJ49ShC4NRG8%3D&Expires=2115594061&AWSAccessKeyId=AKIAIZXE7EOD2KQP55NQ&0
            //   https://lattepic.s3.amazonaws.com/p_df/v2/3o/6q/kc/4c/ir/cu/4u/ao/un/rj/cy/g3/ev/cr_real.jpeg?Signature=MfqquzcPlhIgA%2BM7tkiLegptfHY%3D&Expires=2115594061&AWSAccessKeyId=AKIAIZXE7EOD2KQP55NQ&0
            // doesn't work:
            // https://lattepic.s3.amazonaws.com/p_h3/3n/fe/k2/o5/ts/xf/d4/cc/fz/lb/b3/j6/f7/it/h2_square.jpeg?Signature=YHzaFGZAIkDlez6vmTfRA2KmKjU%3D&Expires=2115594061&AWSAccessKeyId=AKIAIZXE7EOD2KQP55NQ&0 -- signature cannot be removed
            return src.replace(/(\/[a-z]+_)[a-z]+(\.[^/.?]*)$/, "$1org$2");
        }

        if (domain === "coconala.akamaized.net") {
            // https://coconala.akamaized.net/coconala-public-files/service_images/132x132/2da9fdc5-657054.png
            //   https://coconala.akamaized.net/coconala-public-files/service_images/original/2da9fdc5-657054.png -- forces download
            return src.replace(/\/service_images\/[0-9]+x[0-9]+\//, "/service_images/original/");
        }

        if (domain === "dplhqivlpbfks.cloudfront.net") {
            // https://dplhqivlpbfks.cloudfront.net/box_resize/1220x1240/2da9fdc5-657054.png
            //   https://coconala.akamaized.net/coconala-public-files/service_images/original/2da9fdc5-657054.png
            return src.replace(/.*(\/[0-9a-f]+-[0-9]+\.[^/.]*)$/, "https://coconala.akamaized.net/coconala-public-files/service_images/original$1");
        }

        if (domain === "www.ysbnow.com") {
            // http://www.ysbnow.com/dam?media-id=599db1edd74440326c7d50ce&width=800
            //   http://www.ysbnow.com/dam?media-id=599db1edd74440326c7d50ce -- 4608x2592
            return src.replace(/(:\/\/[^/]*\/dam).*?[?&](media-id=[^&]*).*?$/, "$1?$2");
        }

        if (domain === "www.quizz.biz" &&
            src.indexOf("/uploads/") >= 0) {
            // https://www.quizz.biz/uploads/quizz/962477/mini/1_1.jpg?1479738849
            //   https://www.quizz.biz/uploads/quizz/962477/orig/1.jpg?1479738849
            return src.replace(/(\/[0-9]+\/)[a-z]+(\/[0-9]+)(?:_[0-9]+)?(\.[^/.]*)$/,"$1orig$2$3");
        }

        if (domain_nosub === "flipagramcdn.com" && domain.match(/c[0-9]*\.flipagramcdn\.com/)) {
            // https://c1.flipagramcdn.com/d30faeccb979f31d8eea6dd8ad649ddf691b6662_1865984247_1426694464742-small
            //   https://c1.flipagramcdn.com/d30faeccb979f31d8eea6dd8ad649ddf691b6662_1865984247_1426694464742-large?
            //   https://c1.flipagramcdn.com/d30faeccb979f31d8eea6dd8ad649ddf691b6662_1865984247_1426694464742
            return src.replace(/-[a-z]+(?:\?.*)?$/, "");
        }

        if (domain === "images-cdn.9gag.com" ||
            domain === "img-9gag-fun.9cache.com" ||
            // http://d24w6bsrhbeh9d.cloudfront.net/photo/361626_460s.jpg
            //   http://d24w6bsrhbeh9d.cloudfront.net/photo/361626_700b.jpg -- redirects to:
            //   https://img-9gag-fun.9cache.com/photo/361626_700b.jpg
            domain === "d24w6bsrhbeh9d.cloudfront.net" ||
            domain === "miscmedia-9gag-fun.9cache.com") {
            // https://images-cdn.9gag.com/photo/aL2j4BM_460s_v1.jpg
            //   https://images-cdn.9gag.com/photo/aL2j4BM_700b_v1.jpg
            // https://images-cdn.9gag.com/photo/aVXP7Yy_460s.jpg
            //   https://images-cdn.9gag.com/photo/aVXP7Yy_700b.jpg
            // https://images-cdn.9gag.com/photo/a0br3MZ_460s.jpg
            //   https://images-cdn.9gag.com/photo/a0br3MZ_700b.jpg
            // https://img-9gag-fun.9cache.com/photo/a3KW8w7_460swp.webp
            //   https://img-9gag-fun.9cache.com/photo/a3KW8w7_700bwp.webp
            // https://miscmedia-9gag-fun.9cache.com/images/thumbnail-facebook/1482203076.0883_u8yQU9_100x100.jpg
            //   https://miscmedia-9gag-fun.9cache.com/images/thumbnail-facebook/1482203076.0883_u8yQU9_n.jpg
            return src
                .replace(/\/thumbnail-facebook\/([^/]*)_[0-9]+x[0-9]+(\.[^/.]*)$/, "/thumbnail-facebook/$1_n$2")
                .replace(/_460swp(\.[^/.]*)$/, "_700bwp$1")
                .replace(/_460s(_v1)?(\.[^/.]*)$/, "_700b$1$2");
        }

        if (domain_nowww === "samironsheadshots.com" &&
            src.indexOf("/images/") >= 0) {
            // http://samironsheadshots.com/images/pages/small/1510138983.jpg
            //   http://samironsheadshots.com/images/pages/large/1510138983.jpg
            return src.replace(/\/small\/([^/]*)$/, "/large/$1");
        }

        if (domain === "cps-static.rovicorp.com") {
            // https://cps-static.rovicorp.com/2/Open/20th_Century_Fox_39/Program/22067798/_derived_jpg_q90_250x0_m0/walking%20with%20the%20enemy_PA.jpg?partner=allrovi.com
            //   https://cps-static.rovicorp.com/2/Open/20th_Century_Fox_39/Program/22067798/walking%20with%20the%20enemy_PA.jpg?partner=allrovi.com
            return src.replace(/\/_derived_[^/]*(\/[^/]*)$/, "$1");
        }

        if (domain_nosub === "netflixmovies.com" && domain.match(/i[0-9]*\.netflixmovies\.com/)) {
            // https://i1.netflixmovies.com/dibsl9ebc/image/upload/w_1024/mijahb8dbg5qdkxurlwh.jpg
            //   https://i1.netflixmovies.com/dibsl9ebc/image/upload/mijahb8dbg5qdkxurlwh.jpg
            return src.replace(/\/image\/upload\/[wh]_[0-9]+\//, "/image/upload/");
        }

        if (domain === "www.shakespearesglobe.com") {
            // http://www.shakespearesglobe.com/images/8610/normal
            //   http://www.shakespearesglobe.com/images/8610
            return src.replace(/(\/images\/[0-9]+)\/[a-z]+(?:\?.*)?$/, "$1");
        }

        if (domain_nosub === "rsc.org.uk" && domain.match(/cdn[0-9]*\.rsc\.org\.uk/)) {
            // https://cdn2.rsc.org.uk/sitefinity/images/productions/2017-shows/Titus-Andronicus/b7452-titus_review_web-amp-social_images_social-amp-hub.tmb-img-820.jpg?sfvrsn=1
            //   https://cdn2.rsc.org.uk/sitefinity/images/productions/2017-shows/Titus-Andronicus/b7452-titus_review_web-amp-social_images_social-amp-hub.jpg?sfvrsn=1
            return src.replace(/\.tmb-img-[0-9]*\./, ".");
        }

        if (domain === "images.fashionmodeldirectory.com") {
            // http://images.fashionmodeldirectory.com/model/000000592070-hanne_linhares-squaresmall.jpg
            //   http://images.fashionmodeldirectory.com/model/000000592070-hanne_linhares-fullsize.jpg
            return src.replace(/(\/[0-9]+-[^/]*-)[a-z]+(\.[^/.]*)$/, "$1fullsize$2");
        }

        if (domain === "crystal.cafe" ||
            // https://cdn.syn-ch.com/thumb/148/46/03/1484603772-9cd34.png
            //   https://cdn.syn-ch.com/src/148/46/03/1484603772-9cd34.jpg
            domain === "cdn.syn-ch.com" ||
            // http://alphachan.org/eot/thumb/151908726550.jpg
            //   http://alphachan.org/eot/src/151908726550.jpg
            domain_nowww === "alphachan.org" ||
            // http://zonadelta.net/deltachan/thumb/1494318792278.png
            //   http://zonadelta.net/deltachan/src/1494318792278.png
            (domain_nowww === "zonadelta.net" && src.indexOf("/deltachan/") >= 0) ||
            // https://lolcow.farm/ot/thumb/1530053186253.jpg
            //   https://lolcow.farm/ot/thumb/1530053186253.jpg
            domain_nowww === "lolcow.farm") {
            // https://crystal.cafe/hb/thumb/1497657761080.jpeg
            //   https://crystal.cafe/hb/src/1497657761080.jpeg
            return add_extensions(src.replace(/\/thumb\//, "/src/"));
        }

        if ((domain === "www.skinnygossip.com" ||
             // https://www.alternatehistory.com/forum/proxy.php?image=http%3A%2F%2Fipravda.sk%2Fres%2F2008%2F12%2F11%2Fthumbs%2F117664-viktor-dvorcak-nestandard2.jpg&hash=7cb6345bce0733d1c6d28d1a25a7e61f
             //   http://ipravda.sk/res/2008/12/11/thumbs/117664-viktor-dvorcak-nestandard2.jpg
             domain_nowww === "alternatehistory.com" ||
             // https://www.gtplanet.net/forum/proxy.php?image=http%3A%2F%2Fipravda.sk%2Fres%2F2016%2F07%2F06%2Fthumbs%2Frenault-megane-grandtour-2016_08-nestandard2.jpg&hash=66af97d137b15a8c3abbd0b7ea2e3b62
             domain_nowww === "gtplanet.net" ||
             // https://www.arrse.co.uk/community/proxy.php?image=https%3A%2F%2Fencrypted-tbn0.gstatic.com%2Fimages%3Fq%3Dtbn%3AANd9GcQ00K1p5efcjLiUUeCscJEu_w90plhcQSdU6MtDEiOI5QKjcrhC&hash=8b2a01817b67daf880b8f9d53c2d7d61
             //   https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ00K1p5efcjLiUUeCscJEu_w90plhcQSdU6MtDEiOI5QKjcrhC
             domain_nowww === "arrse.co.uk") &&
            src.indexOf("/proxy.php?") >= 0) {
            // https://www.skinnygossip.com/community/proxy.php?image=https%3A%2F%2Fwww.bellazon.com%2Fmain%2Fuploads%2Fmonthly_2017_11%2FGettyImages-876162714.jpg.6f0a67f5cb65d76069675b15e20ec73d.jpg&hash=087ffa4418cc3312b384c32dc19b765a
            //   https://www.bellazon.com/main/uploads/monthly_2017_11/GettyImages-876162714.jpg.6f0a67f5cb65d76069675b15e20ec73d.jpg
            return decodeURIComponent(src.replace(/.*?\/proxy\.php.*?[?&]image=([^&]*).*?$/, "$1"));
        }

        if (domain === "usa-grlk5lagedl.stackpathdns.com") {
            // http://usa-grlk5lagedl.stackpathdns.com/production/usa/images/1514913960191591-Rihanna.tif?w=1920&amp;h=800&amp;fit=crop&amp;crop=faces&amp;fm=pjpg&amp;auto=compress
            return src.replace(/(\/images\/[^/]*)\?.*$/, "$1?fm=pjpg");
        }

        if (domain === "static.sify.com") {
            // http://static.sify.com/cms/image/rh1m7Deiccjhi_thumb.jpg
            //   http://static.sify.com/cms/image/rh1m7Deiccjhi_small.jpg
            //   http://static.sify.com/cms/image/rh1m7Deiccjhi_medium.jpg
            //   http://static.sify.com/cms/image/rh1m7Deiccjhi_big.jpg
            //   http://static.sify.com/cms/image/rh1m7Deiccjhi.jpg
            return src.replace(/(\/cms\/image\/[^/]*)_[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "thumbs.wikifeet.com") {
            // https://thumbs.wikifeet.com/3398643.jpg
            //   https://pics.wikifeet.com/3398643.jpg
            return src.replace(/:\/\/[^/]*\//, "://pics.wikifeet.com/");
        }

        if (domain === "static.spotboye.com") {
            // http://static.spotboye.com/uploads/disha-patani-at-femina-awards_08cb1fd04740a924b584520c6087bc78_small.jpg
            //   http://static.spotboye.com/uploads/disha-patani-at-femina-awards_08cb1fd04740a924b584520c6087bc78_original.jpg
            return src.replace(/(_[0-9a-f]+)(?:_[a-z]+)?(\.[^/.]*)$/, "$1_original$2");
        }

        if (domain === "img.news.goo.ne.jp") {
            // https://img.news.goo.ne.jp/cpimg/wedge.ismedia.jp/mwimgs/c/a/-/img_ca529af8c945704fb5432aceff2d60f2795379.jpg
            //   http://wedge.ismedia.jp/mwimgs/c/a/-/img_ca529af8c945704fb5432aceff2d60f2795379.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/cpimg\/([^/]*\.[^/]*)/, "http://$1");
        }

        if (domain === "preview.redd.it") {
            // https://preview.redd.it/7nte0k30d7p11.jpg?width=640&crop=smart&s=3045865f8ce23192e486c9f35de800bd6e2a685b
            //   https://i.redd.it/7nte0k30d7p11.jpg
            return src.replace(/:\/\/preview\.redd\.it\/([^/.]*\.[^/.?]*)\?.*$/, "://i.redd.it/$1");
        }

        if ((domain_nosub === "redditmedia.com" ||
             domain_nosub === "redd.it") &&
            host_domain_nosub === "reddit.com" &&
            options.element && options.do_request && options.cb) {
            newsrc = (function() {
                function checkimage(url) {
                    url = urljoin(options.host_url, url, true);
                    if (url.match(/^(?:[a-z]+)?:\/\/[^/]*\.redditmedia\.com\//) ||
                        url.match(/^(?:[a-z]+)?:\/\/[^/]*\.redd\.it\//))
                        return url;

                    if (bigimage_recursive(url, {
                        fill_object: false,
                        iterations: 3,
                        use_cache: false,
                        null_if_no_change: true,
                        do_request: function(){},
                        cb: function(){}
                    }) !== null) {
                        return url;
                    }
                }

                function request(url) {
                    var id;

                    if (url.match(/^t3_/))
                        id = url;
                    else {
                        id = url.replace(/.*\/comments\/([^/]*)\/[^/]*(?:\/(?:\?.*)?)?$/, "$1");
                        if (id === url) {
                            return;
                        }

                        id = "t3_" + id;
                    }

                    options.do_request({
                        method: "GET",
                        url: "https://www.reddit.com/api/info.json?id=" + id,
                        onload: function(result) {
                            try {
                                var json = JSON_parse(result.responseText);
                                var item = json.data.children[0].data;
                                var image = item.url;

                                if (!checkimage(image)) {
                                    if (item.preview.images[0].variants.gif)
                                        image = item.preview.images[0].variants.gif.source.url;
                                    else
                                        image = item.preview.images[0].source.url;
                                }

                                return options.cb(image);
                            } catch (e) {
                                console_log(id);
                                console_log(result);
                                console_error(e);
                            }

                            options.cb(null);
                        }
                    });

                    return {
                        waiting: true
                    };
                }

                if (options.element.parentElement && options.element.parentElement.parentElement) {
                    // classic reddit
                    var doubleparent = options.element.parentElement.parentElement;
                    newsrc = doubleparent.getAttribute("data-url");

                    if (newsrc) {
                        if (checkimage(newsrc))
                            return newsrc;
                        else {
                            var id = doubleparent.getAttribute("data-fullname");
                            if (id) {
                                newsrc = request(id);
                                if (newsrc)
                                    return newsrc;
                            }
                        }
                    }

                    if (doubleparent.parentElement) {
                        if (doubleparent.parentElement.tagName === "A" && options.do_request && options.cb) {
                            // card
                            newsrc = request(doubleparent.parentElement.href);
                            if (newsrc)
                                return newsrc;
                        }

                        if (options.element.parentElement.tagName === "A" &&
                            // new classic with external url
                            (options.element.parentElement.getAttribute("target") === "_blank" ||
                             // new user page
                             options.element.parentElement.classList.contains("PostThumbnail"))) {

                            newsrc = options.element.parentElement.href;
                            if (checkimage(newsrc))
                                return newsrc;
                        }

                        // new classic
                        var current = options.element;
                        var found = false;
                        while (current = current.parentElement) {
                            // new classic
                            if (current.classList.contains("scrollerItem") ||
                                // new user page
                                current.classList.contains("Post__top")) {
                                found = true;
                                break;
                            }
                        }

                        if (found) {
                            var elements = current.getElementsByTagName("a");
                            for (var i = 0; i < elements.length; i++) {
                                var element = elements[i];
                                // new classic
                                if (element.getAttribute("data-click-id") === "body" ||
                                    // new user page
                                    element.classList.contains("Post__absoluteLink")) {
                                    newsrc = request(element.href);
                                    if (newsrc)
                                        return newsrc;
                                    else
                                        return;
                                }
                            }
                        }
                    }
                }
            })();
            if (newsrc !== undefined)
                return newsrc;
        }

        if ((domain_nosub === "gstatic.com" ||
             domain === "") &&
            host_domain_nosub.match(/^google\./) && options.element) {
            newsrc = (function() {
                // image search
                var current = options.element;
                while (current = current.parentElement) {
                    if (current.tagName !== "A")
                        continue;

                    if (!current.href.match(/\/imgres\?/))
                        continue;

                    return decodeURIComponent(current.href.replace(/.*?\/imgres.*?[?&]imgurl=([^&]*).*?$/, "$1"));
                }

                // small previews
                current = options.element;
                while (current = current.parentElement) {
                    if (current.tagName !== "A")
                        continue;

                    if (!current.href.match(/\/search\?/))
                        continue;

                    // related images
                    var parent = current.parentElement;
                    if (parent.tagName !== "DIV")
                        continue;

                    var notranslate = parent.getElementsByClassName("notranslate");
                    if (!notranslate.length) {
                        // all search results
                        parent = parent.parentElement;
                        if (!parent || parent.tagName !== "DIV")
                            break;

                        notranslate = parent.getElementsByClassName("notranslate");
                        if (!notranslate.length)
                            continue;
                    }

                    for (var i = 0; i < notranslate.length; i++) {
                        var el = notranslate[i];
                        if (!el.innerHTML.match(/^ *{/))
                            continue;

                        var json = JSON_parse(el.innerHTML);
                        // properties:
                        // oh = original height
                        // ow = original width
                        // ou = original url (of image)
                        // pt = original url minus protocol
                        // rh = host url hostname
                        // ru = host url
                        // th = thumbnail height
                        // tw = thumbnail width
                        // tu = thumbnail url

                        if (json.ou.match(/^[a-z]+:/))
                            return json.ou;

                        break;
                    }
                }
            })();
            if (newsrc !== undefined)
                return newsrc;
        }

        if (domain === "thumbnail.named.com") {
            // http://thumbnail.named.com/normal/croptop/206x150/file/photo/977034
            //   http://data.named.com/data/file/photo/977034 -- forces download
            return src.replace(/:\/\/[^/]*\/.*?(\/file\/photo\/[0-9]+)/, "://data.named.com/data$1");
        }

        if (domain_nosub === "bing.com" &&
            host_domain_nosub === "bing.com" && options.element) {
            var current = options.element;
            while (current = current.parentElement) {
                if (current.tagName !== "A")
                    continue;

                console_log(current.href);
                if (!current.href.match(/\/images\/search\?.*mediaurl=/))
                    continue;

                return decodeURIComponent(current.href.replace(/.*?\/search.*?[?&]mediaurl=([^&]*).*?$/, "$1"));
            }
        }

        if (domain_nosub === "deviantart.net" &&
            (domain.match(/^pre[0-9]*\.deviantart\.net/) ||
             domain.match(/^img[0-9]*\.deviantart\.net/)) &&
            src.match(/\/[a-z0-9]\/[0-9]+\/[0-9a-z]+\/[0-9a-z]+\/[0-9a-z]+\/[^/]*-[0-9a-z]+\.[^/.]*$/) &&
            options && options.do_request && options.cb) {
            // https://github.com/DeviantArt/DeviantArt-API/issues/100#issuecomment-219092634
            //   ids are base36 encoded
            // https://aikiyun.deviantart.com/art/BRS-Strength-619670254
            // https://img00.deviantart.net/f4a7/i/2016/187/9/8/_brs__strength_by_aikiyun-da8xomm.jpg
            //   https://orig00.deviantart.net/af7a/f/2016/187/6/d/_brs__strength_by_aikiyun-da8xomm.jpg
            //
            // https://pre00.deviantart.net/cc1d/th/pre/i/2015/027/3/7/_brs__nana_gray_by_aikiyun-d8flbyx.png
            //   https://orig00.deviantart.net/5455/f/2015/027/f/c/_brs__nana_gray_by_aikiyun-d8flbyx.png
            //
            // https://darkblueandy.deviantart.com/art/Black-Rock-Shooter-10th-Anniversary-Tribute-749686444 -- no download
            //   https://pre00.deviantart.net/8fe7/th/pre/i/2018/164/6/3/black_rock_shooter_10th_anniversary_tribute_by_darkblueandy-dcecdrg.jpg
            //
            // older links don't work:
            //
            // https://daniwae.deviantart.com/art/Vocaloid-Black-Rock-Shooter-126624173
            //   https://pre00.deviantart.net/1fa8/th/pre/f/2009/171/d/3/vocaloid__black_rock_shooter_by_danny07312017.png
            //   https://orig00.deviantart.net/1d55/f/2009/171/d/3/vocaloid__black_rock_shooter_by_danny07312017.png
            // parseInt("da8xomm", 36) = 28917840622
            //   28917840622 - 619670254 = 28298170368

            var newsrc = (function() {
                var id = src.replace(/.*-([0-9a-z]+)\.[^/.]*$/, "$1");
                //id = parseInt(id, 36) - 28298170368;

                options.do_request({
                    method: "GET",
                    url: "http://fav.me/" + id,
                    onload: function(result) {
                        if (result.status !== 200) {
                            console_log(result);
                            options.cb(null);
                            return;
                        }

                        var obj = {
                            url: null,
                            extra: {
                                page: result.finalUrl
                            }
                        };

                        if (true) {
                            try {
                                var hrefre = /<div *class="dev-view-deviation">\s*?<img[^>]*?src=["'](https?:\/\/images-wixmp[^>'"]*?)["']/;
                                var match = result.responseText.match(hrefre);
                                if (match) {
                                    obj.url = match[1];
                                    options.cb(obj);
                                    return;
                                }
                            } catch (e) {
                                console_error(e);
                            }
                        }
                        return;

                        try {
                            var hrefre = /href=["'](https?:\/\/www\.deviantart\.com\/download\/[0-9]+\/[^/>'"]*?)["']/;
                            var match = result.responseText.match(hrefre);
                            if (!match) {
                                console_error("No public download for " + src);
                                options.cb(obj);
                                return;
                            }

                            var href = match[1].replace("&amp;", "&");

                            options.do_request({
                                method: "HEAD",
                                url: href,
                                onload: function(result) {
                                    if (result.status !== 200) {
                                        console_log(result);
                                        options.cb(obj);
                                        return;
                                    }

                                    var finalurl = result.finalUrl;
                                    if (finalurl.match(/^[a-z]+:\/\/(?:www\.)?deviantart\.com\/users\/outgoing\?/)) {
                                        finalurl = finalurl.replace(/^[a-z]+:\/\/(?:www\.)?deviantart\.com\/users\/outgoing\?/, "");
                                    }
                                    obj.url = finalurl;
                                    options.cb(obj);
                                }
                            });
                        } catch (e) {
                            console_error(e);
                            options.cb(obj);
                        }
                    }
                });
            })();

            return {
                "waiting": true
            };
        }

        if (domain_nowww === "af-hobby.com" ||
            // http://sky-seller.com/image/cache/data/Game_Jackets/Assassins_Creed_Syndicate_Jack_Ripper_Black_Game_Coat-800x800.jpg
            //   http://sky-seller.com/image/data/Game_Jackets/Assassins_Creed_Syndicate_Jack_Ripper_Black_Game_Coat.jpg
            domain === "sky-seller.com") {
            // https://www.af-hobby.com/image/cache/catalog/Figure/Prize%20Figure/Fate/Taito/Jack%20The%20Ripper/s-l1600%20(1)-228x228.jpg
            //   https://www.af-hobby.com/image/catalog/Figure/Prize%20Figure/Fate/Taito/Jack%20The%20Ripper/s-l1600%20(1).jpg
            return src.replace(/\/image\/cache\/(.*)-[0-9]+x[0-9]+(\.[^/.]*)$/, "/image/$1$2");
        }

        if (domain === "www.huangdi5000.com") {
            // http://www.huangdi5000.com/p.php?p=http://mmbiz.qpic.cn/mmbiz/vbBlf7WMGAVedhZJHo9ooicWiaOY5RDdAbjYxWicFsdl8NATTCBQ11fdibPmE4Y5BicbpXg9r0g2FF0PZnB0OnZm4IA/0?wx_fmt=jpeg
            //   http://mmbiz.qpic.cn/mmbiz/vbBlf7WMGAVedhZJHo9ooicWiaOY5RDdAbjYxWicFsdl8NATTCBQ11fdibPmE4Y5BicbpXg9r0g2FF0PZnB0OnZm4IA/0
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/p\.php.*?[?&]p=(.*)$/, "$1"));
        }

        if (domain === "www.popcornfor2.com" &&
            src.indexOf("/upload/") >= 0) {
            // http://www.popcornfor2.com/upload/101/news-thumb-100097.jpg
            //   http://www.popcornfor2.com/upload/101/news-full-100097.jpg
            return src.replace(/\/news-[a-z]+-([0-9]+\.[^/.]*)$/, "/news-full-$1");
        }

        if (domain === "img.daily.co.kr") {
            // http://img.daily.co.kr/@files/www.daily.co.kr/content_watermark/life/2016/20160718/e0c39c44f765af2a2adf6dc0ce825309.jpg
            //   http://img.daily.co.kr/@files/www.daily.co.kr/content/life/2016/20160718/e0c39c44f765af2a2adf6dc0ce825309.jpg
            return src.replace("/content_watermark/", "/content/");
        }

        if (domain === "file.gamedonga.co.kr") {
            // http://file.gamedonga.co.kr/files/2016/05/13/t/sosi1.jpg
            //   http://file.gamedonga.co.kr/files/2016/05/13/sosi1.jpg
            return src.replace(/(\/files\/[0-9]+\/[0-9]+\/[0-9]+\/)[a-z]\/([^/]*)$/, "$1$2");
        }

        if (domain === "cloud.tcusercontent.net") {
            // https://cloud.tcusercontent.net/ticket-10462437-ad37350ebc-258.png
            //   https://cloud.tcusercontent.net/ticket-10462437-ad37350ebc.png
            return src.replace(/(-[0-9]+-[0-9a-f]+)-[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "image.entertainment-topics.jp" ||
            // https://image.code-file.jp/item/image/normal/3793054.jpg?time=1486525693
            //   https://image.code-file.jp/item/image/original/3793054.jpg?time=1486525693
            domain === "image.code-file.jp" ||
            // https://image.make-book.jp/item/image/normal/2618489.jpg?time=1494472954
            //   https://image.make-book.jp/item/image/original/2618489.jpg?time=1494472954
            domain === "image.make-book.jp") {
            // http://image.entertainment-topics.jp/item/image/normal/4084176.jpg?time=1508824130
            //   http://image.entertainment-topics.jp/item/image/original/4084176.jpg?time=1508824130
            // http://image.entertainment-topics.jp/article/normal/137930.jpg?time=1529115899
            //   http://image.entertainment-topics.jp/article/original/137930.jpg?time=1529115899
            return src.replace(/(:\/\/[^/]*\/)(item\/image\/|article\/)[a-z]+(\/[^/]*)$/, "$1$2original$3");
        }

        if ((domain_nosub === "styapokupayu.ru" &&
             src.indexOf("/images/") >= 0) ||
            (domain_nosub === "yapokupayu.ru" &&
             src.indexOf("/system/images/") >= 0)) {
            // http://st4.styapokupayu.ru/images/blog_post_images/000/137/597_large.jpg
            //   http://st4.styapokupayu.ru/images/blog_post_images/000/137/597_original.jpg
            // http://st10.styapokupayu.ru/images/product/026/756/403_medium.jpg
            //   http://st10.styapokupayu.ru/images/product/026/756/403_original.jpg
            // http://www.yapokupayu.ru/system/images/avatars/000/038/880_large.jpg?1486491028
            //   http://www.yapokupayu.ru/system/images/avatars/000/038/880_original.jpg?1486491028
            return src.replace(/(\/[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1_original$2");
        }

        if (domain_nowww === "thai.ac") {
            // https://thai.ac/news/tn/?fn=https://obs.line-scdn.net/0m01a167cc1b700d30606e7a412827332a6c6f64602f417c46137b3d397c2b3f316a333c6573303c0c342b623b3b/w580
            //   https://obs.line-scdn.net/0m01a167cc1b700d30606e7a412827332a6c6f64602f417c46137b3d397c2b3f316a333c6573303c0c342b623b3b/w580
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/news\/tn\/.*?[?&]fn=([^&]*).*?/, "$1"));
        }

        if (domain_nosub === "styleshare.kr" &&
            domain.match(/usercontents(?:-[a-z])?\.styleshare\.kr/)) {
            // https://usercontents-c.styleshare.kr/images/14247471/640x640
            //   https://usercontents-c.styleshare.kr/images/14247471/original
            // https://usercontents-c.styleshare.kr/images/14890803/460x-
            //   https://usercontents-c.styleshare.kr/images/14890803/original
            return src.replace(/(\/images\/[0-9]+\/)[-0-9]+x[-0-9]+(?:\?.*)?$/, "$1original");
        }

        if (domain === "images.vingle.net") {
            // https://images.vingle.net/upload/t_us_l/vrcdqlkhhzniaubre2pr.jpg
            //   https://images.vingle.net/upload/vrcdqlkhhzniaubre2pr.jpg
            return src.replace(/(:\/\/[^/]*\/upload\/)t_[^/]*\/([^/]*)$/, "$1$2");
        }

        if (domain === "www.anewsa.com") {
            // http://www.anewsa.com/news_images/2016/07/14/mark/20160714163711-1.jpg
            //   http://www.anewsa.com/news_images/2016/07/14/original/20160714163711-1.jpg
            return src.replace(/(_images\/[0-9]+\/[0-9]+\/[0-9]+\/)mark(\/[^/]*)$/, "$1original$2");
        }

        if (domain === "img.newspim.com") {
            // http://img.newspim.com/news/2018/06/12/1806121533058220_tc.jpg
            //   http://img.newspim.com/news/2018/06/12/1806121533058220.jpg
            return src.replace(/(\/[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "www.insectidentification.org") {
            // https://www.insectidentification.org/imgs/insects/thumbnails/eastern-hercules-beetle_19.jpg
            //   https://www.insectidentification.org/imgs/insects/eastern-hercules-beetle_19.jpg
            return src.replace(/(\/imgs\/[a-z]+\/)thumbnails\//, "$1")
        }

        if (domain_nowww === "a-z-animals.com") {
            // https://a-z-animals.com/media/animals/images/100x100/japanese_macaque6.jpg
            //   https://www.a-z-animals.com/media/animals/images/original/japanese_macaque6.jpg
            return src.replace(/\/images\/[0-9]+x[0-9]+\//, "/images/original/");
        }

        if (domain_nosub === "nicematin.com" &&
            domain.match(/cdn\.static[0-9]*\.nicematin\.com/)) {
            // https://cdn.static01.nicematin.com/media/npo/mobile_1440w/2017/04/a1-8874302.jpg
            //   https://cdn.static01.nicematin.com/media/npo/original/2017/04/a1-8874302.jpg
            // https://cdn.static03.nicematin.com/media/npo/square/2018/06/rca12q100_fv_lunallena.jpg
            //   https://cdn.static03.nicematin.com/media/npo/original/2018/06/rca12q100_fv_lunallena.jpg
            //return src.replace(/\/mobile_[0-9]+[whx](?:[0-9]+)?\//, "/original/");
            return src.replace(/(:\/\/[^/]*\/media\/[^/]*\/)[^/]*(\/[0-9]+\/[0-9]+\/[^/]*)$/, "$1original$2");
        }

        if (((domain_nosub === "fbcdn.net" && domain.match(/^instagram\./)) ||
             domain_nosub === "cdninstagram.com") &&
            host_domain_nosub === "instagram.com" && options.element &&
            options.do_request && options.cb) {
            newsrc = (function() {
                var query_ig = function(url, cb) {
                    options.do_request({
                        method: "GET",
                        url: url,
                        onload: function(result) {
                            if (result.readyState !== 4)
                                return;

                            try {
                                var text = result.responseText;

                                var regex1 = /window\._sharedData = *(.*?);?<\/script>/;
                                var regex2 = /window\._sharedData *= *(.*?}) *;[\s]*window\.__initialDataLoaded/;

                                var match = text.match(regex1);
                                if (!match) {
                                    match = text.match(regex2);
                                }

                                cb(JSON_parse(match[1]));
                            } catch (e) {
                                console_log(result);
                                console_error(e);
                                cb(null);
                            }
                        }
                    });
                };

                var uid_from_sharedData = function(json) {
                    if (json.id)
                        return json.id;
                    else {
                        return json.entry_data.ProfilePage[0].graphql.user.id;
                    }
                };

                var username_to_uid = function(username, cb) {
                    if (username.match(/^http/)) {
                        username = username.replace(/^[a-z]+:\/\/[^/]*\/([^/]*)(?:\/.*)?$/, "$1");
                    }

                    query_ig("https://www.instagram.com/" + username + "/", function(json) {
                        try {
                            cb(uid_from_sharedData(json));
                        } catch (e) {
                            console_error(e);
                            cb(null);
                        }
                    });
                };

                var uid_to_profile = function(uid, cb) {
                    var url = "https://i.instagram.com/api/v1/users/" + uid + "/info/";
                    options.do_request({
                        method: "GET",
                        url: url,
                        onload: function(result) {
                            if (result.readyState !== 4)
                                return;

                            try {
                                cb(JSON_parse(result.responseText).user);
                            } catch (e) {
                                console_log(result);
                                console_error(e);
                                cb(null);
                            }
                        }
                    });
                };

                var profile_to_url = function(profile) {
                    return profile.hd_profile_pic_url_info.url;
                };

                var request_profile = function(username) {
                    username_to_uid(username, function(uid) {
                        if (!uid) {
                            options.cb(null);
                            return;
                        }

                        uid_to_profile(uid, function(profile) {
                            if (!profile) {
                                options.cb(null);
                                return;
                            }

                            options.cb(profile_to_url(profile));
                        });
                    });

                    return {
                        waiting: true
                    };
                };

                var request_post_inner = function(post_url, image_url, cb) {
                    query_ig(post_url, function(json) {
                        if (!json) {
                            cb(null);
                            return;
                        }

                        try {
                            var media = json.entry_data.PostPage[0].graphql.shortcode_media;

                            var images = [];
                            var parse_image = function(node) {
                                var image = node.display_src;
                                if (!image)
                                    image = node.display_url;

                                if (image && images.indexOf(image) < 0) {
                                    images.push(image);
                                }
                            }

                            parse_image(media);

                            if (media.edge_sidecar_to_children) {
                                var edges = media.edge_sidecar_to_children.edges;
                                for (var i = 0; i < edges.length; i++) {
                                    var edge = edges[i];
                                    if (edge.node)
                                        edge = edge.node;

                                    parse_image(edge);
                                }
                            }

                            var image_id = image_url.replace(/.*\/([^/.]*)\.[^/.]*$/, "$1");
                            for (var i = 0; i < images.length; i++) {
                                if (images[i].indexOf(image_id) > 0) {
                                    cb(images[i]);
                                    return;
                                }
                            }

                            cb(null);
                        } catch (e) {
                            console_error(e);
                            cb(null);
                        }
                    });

                    return {
                        waiting: true
                    };
                };

                var request_post = function(post_url, image_url) {
                    return request_post_inner(post_url, image_url, options.cb);
                };

                // check for links first
                var current = options.element;
                while (current = current.parentElement) {
                    if (current.tagName !== "A")
                        continue;

                    if (current.href.match(/:\/\/[^/]*\/p\//)) {
                        // post
                        newsrc = request_post(current.href, options.element.src);
                        if (newsrc)
                            return newsrc;
                    } else if (current.href.match(/:\/\/[^/]*\/[^/]*(?:\/(?:\?.*)?)?$/)) {
                        // user
                        newsrc = request_profile(current.href);
                        if (newsrc)
                            return newsrc;
                    }
                }

                var current = options.element;
                while (current = current.parentElement) {
                    // profile image
                    if (current.tagName === "HEADER") {
                        var sharedData = null;

                        var scripts = document.getElementsByTagName("script");
                        for (var i = 0; i < scripts.length; i++) {
                            if (scripts[i].innerText.match(/^ *window\._sharedData/)) {
                                sharedData = scripts[i].innerText.replace(/^ *window\._sharedData *= *({.*}) *;.*?/, "$1");
                            }
                        }

                        if (!sharedData) {
                            console_error("Shared data not found");
                            continue;
                        } else {
                            sharedData = JSON.parse(sharedData);
                        }

                        uid_to_profile(uid_from_sharedData(sharedData), function(profile) {
                            if (!profile) {
                                options.cb(null);
                                return;
                            }

                            options.cb(profile_to_url(profile));
                        });

                        return {
                            waiting: true
                        };
                    }

                    // popup
                    if (current.tagName === "DIV" && current.getAttribute("role") === "dialog") {
                        newsrc = request_post(document.location.href, options.element.src);
                        if (newsrc)
                            return newsrc;
                    }
                }
            })();
            if (newsrc !== undefined)
                return newsrc;
        }

        if (domain_nosub === "instagram.com" &&
            !(domain_nowww === "instagram.com" &&
              (src.match(/:\/\/[^/]*\/p\/[^/]*/) ||
               src.match(/:\/\/[^/]*\/[-a-zA-Z0-9_.]+(?:\?.*)?$/)))) {
            return {
                url: src,
                headers: {
                    "Referer": "https://www.instagram.com"
                }
            };
        }

        if (domain === "cdns.klimg.com" ||
            domain === "cdn.klimg.com") {
            // https://cdns.klimg.com/resized/300x150/p/photonews/foto-pesona-cantik-krystal-kenakan-suit-0ef272.jpg
            //   https://cdns.klimg.com/kapanlagi.com/p/photonews/foto-pesona-cantik-krystal-kenakan-suit-0ef272.jpg
            // https://cdns.klimg.com/kapanlagi.com/p/headline/476x238/usai-avicii-meninggal-komunitas-dance-m-1ec3b8.jpg
            // https://cdns.klimg.com/resized/476x/p/camila-cabello-camilacabello-com.jpg
            //   https://cdns.klimg.com/kapanlagi.com/p/camila-cabello-camilacabello-com.jpg
            // http://cdn.klimg.com/kapanlagi.com/g/t/i/tiffany_dan_kris_wu_di_red_carpet_2018_amas_para_alumni_sm_ent/t/tiffany-20181010-001-rita.jpg
            //   http://cdn.klimg.com/kapanlagi.com/g/t/i/tiffany_dan_kris_wu_di_red_carpet_2018_amas_para_alumni_sm_ent/tiffany-20181010-001-rita.jpg
            return src
                .replace(/\/resized\/[0-9]+x(?:[0-9]+)?\//, "/kapanlagi.com/")
                .replace(/(\/g\/.\/.\/[^/]*\/)t\/([^/]*)$/, "$1$2")
                .replace(/\/[0-9]+x[0-9]+(\/[^/]*$)/, "$1");
        }

        if (domain_nosub === "nintendo-europe.com" &&
            domain.match(/^cdn[0-9]*\./)) {
            // https://cdn02.nintendo-europe.com/media/images/10_share_images/portals_3/H2x1_SuperMario_Hub_image1600w.jpg
            //   https://cdn02.nintendo-europe.com/media/images/10_share_images/portals_3/H2x1_SuperMario_Hub.jpg
            return src.replace(/_image[0-9]*[wh](\.[^/.]*)$/, "$1");
        }

        if ((domain_nowww === "gonintendo.com" && src.indexOf("/file_uploads/uploads/") >= 0) ||
            // https://gozzip.id/system/App/BlogBody/photos/000/203/493/medium/24f76634ce96b927cfdcdd6dce44e5ef.jpg
            //   https://gozzip.id/system/App/BlogBody/photos/000/203/493/original/24f76634ce96b927cfdcdd6dce44e5ef.jpg
            (domain === "gozzip.id" && src.indexOf("/BlogBody/photos/") >= 0)) {
            // https://gonintendo.com/system/file_uploads/uploads/000/011/876/medium/New-Super-Mario-Bros-U_2012_06-05-12_012.jpg
            //   https://gonintendo.com/system/file_uploads/uploads/000/011/876/original/New-Super-Mario-Bros-U_2012_06-05-12_012.jpg
            return src.replace(/(\/[0-9]+\/[0-9]+\/[0-9]+)\/[a-z]+\/([^/]*)$/, "$1/original/$2");
        }

        if (domain_nosub === "15min.lt" &&
            domain.match(/s[0-9]*\.15min\.lt/) &&
            src.indexOf("/images/") >= 0) {
            // https://s1.15min.lt/images/photos/2017/05/19/big/olivia-rodrigo-591e9d3a8f81d.jpg
            //   https://s1.15min.lt/images/photos/2017/05/19/original/olivia-rodrigo-591e9d3a8f81d.jpg
            return src.replace(/\/[a-z]+(\/[^/]*)$/, "/original$1");
        }

        if (domain_nosub === "bdbphotos.com" &&
            domain.match(/^img[0-9]*\.bdbphotos\.com/) && false) {
            // doesn't work
            return {
                url: src.replace(/\/images\/[a-z]+\//, "/images/orig/"),
                headers: {
                    Referer: "https://www.famousfix.com/"
                }
            };
        }

        if (domain_nosub === "lazygirls.info" &&
            domain.match(/^img[0-9]*\.lazygirls\.info/)) {
            // http://img004.lazygirls.info/people/jenna_ortega/jenna_ortega_jenna_ortega_at_gifted_premiere_in_los_anegeles_442017_wXtzOMIf.thumb.jpg
            //   http://img004.lazygirls.info/people/jenna_ortega/jenna_ortega_jenna_ortega_at_gifted_premiere_in_los_anegeles_442017_wXtzOMIf.sized.jpg
            //   http://lzimages.lazygirls.info/jenna_ortega_jenna_ortega_at_gifted_premiere_in_los_anegeles_442017_wXtzOMIf
            //return src.replace(/\.thumb\.jpg$/, ".sized.jpg");
            return src.replace(/:\/\/.*\/([^/.]*)\.[^/]*$/, "://lzimages.lazygirls.info/$1");
        }

        if (domain === "lzimages.lazygirls.info") {
            // http://lzimages.lazygirls.info/rachel_riley_charity_ice_bucket_challenge_19th_august_2014_9Dyh9BAS.thumb
            //   http://lzimages.lazygirls.info/rachel_riley_charity_ice_bucket_challenge_19th_august_2014_9Dyh9BAS -- 2266x3933
            // http://lzimages.lazygirls.info/jenna_ortega_jenna_ortega_at_gifted_premiere_in_los_anegeles_442017_wXtzOMIf.sized
            //   http://lzimages.lazygirls.info/jenna_ortega_jenna_ortega_at_gifted_premiere_in_los_anegeles_442017_wXtzOMIf
            return src.replace(/\.(?:thumb|sized)$/, "");
        }

        if (domain === "image.way2enjoy.com") {
            // https://image.way2enjoy.com/misc/lazyg/kristin_kreuk/people/kristin_kreuk_cw_network_2013_upfront_in_new_york_16may2013_sud8I4qq.sized.jpg
            //   http://lzimages.lazygirls.info/kristin_kreuk_cw_network_2013_upfront_in_new_york_16may2013_sud8I4qq
            return src.replace(/^[a-z]+:\/\/[^/]*\/misc\/lazyg\/.*?\/([^/]*)\.[^/.]*\.[^/.]*$/,
                               "http://lzimages.lazygirls.info/$1");
        }

        if (domain === "www.mobtada.com") {
            // https://www.mobtada.com/resize?src=uploads/images/2017/06/447549.jpg&w=190&h=110&zc=1&q=65
            //   https://www.mobtada.com/uploads/images/2017/06/447549.jpg
            return src.replace(/(:\/\/[^/]*\/)resize.*?[?&]src=([^&]*).*?$/, "$1$2");
        }

        if (domain_nowww === "art-dept.com") {
            // http://www.art-dept.com/media/images/useruploaded/cache/168193_2.jpg
            //   http://www.art-dept.com/media/images/useruploaded/168193.jpg
            // http://art-dept.com/media/images/useruploaded/cache/KC_004_3_3.jpg
            //   http://art-dept.com/media/images/useruploaded/KC_004_3.jpg
            return src.replace(/\/cache\/([^/]*)_[0-9]+(\.[^/.]*)$/, "/$1$2");
        }

        if (domain === "static.stylosophy.it") {
            // https://static.stylosophy.it/r/50x0/www.stylosophy.it/img/Trucco-rosso-occhi-verdi.jpg
            //   https://static.stylosophy.it/r/999999999999x0/www.stylosophy.it/img/Trucco-rosso-occhi-verdi.jpg
            // https://static.stylosophy.it/845X0/www/stylosophy/it/img/Keira-Knightley-in-Mary-Kontratzou.jpg
            //   https://static.stylosophy.it/999999999999x0/www/stylosophy/it/img/Keira-Knightley-in-Mary-Kontratzou.jpg -- doesn't work
            newsrc = src.replace(/(:\/\/[^/]*\/)(r\/)[0-9]+[xX][0-9]+\//, "$1$2999999999999x0/");
            if (newsrc !== src)
                return newsrc;
        }

        if (amazon_container === "nikeinc" &&
            src.indexOf("/assets/") >= 0) {
            // https://s3.amazonaws.com/nikeinc/assets/7284/Sp12_WT_HopeSolo_NikePro_01_hd_1600.jpg?1328664887 -- 1600x900
            //   https://s3.amazonaws.com/nikeinc/assets/7284/Sp12_WT_HopeSolo_NikePro_01_original.jpg?1328664887 -- 8226x10980
            return src.replace(/_hd_[0-9]+(\.[^/.]*)$/, "_original$1");
        }

        if (domain_nowww === "mitazamagica.com" &&
            src.indexOf("/Shops/") >= 0) {
            // https://mitazamagica.com/WebRoot/Store8/Shops/6fe0d17f-85dc-4216-b8f7-030dc2226c0a/56FB/F6F1/63AF/4EB2/7C87/0A48/3523/638D/Tmg-097_ml.jpg
            return src.replace(/_[a-z]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "imgbase.info" &&
            src.indexOf("/images/safe-wallpapers/") >= 0) {
            // https://www.wallpapervortex.com/wallpaper-7420_black_rock_shooter.html
            //   https://www.imgbase.info/images/safe-wallpapers/anime/black_rock_shooter/aa_7420_black_rock_shooter.jpg
            //   https://www.imgbase.info/images/safe-wallpapers/anime/black_rock_shooter/7420_black_rock_shooter.jpg
            newsrc = src.replace(/\/[a-z]+_([0-9]+[^/]*)$/, "/$1");
            return {
                url: newsrc,
                headers: {
                    Referer: "https://www.wallpapervortex.com/wallpaper-" + src.replace(/\/[a-z]+_([0-9]+[^/]*)\.[^/.]*$/, "$1") + ".html"
                }
            };
        }

        if (domain_nowww === "paperlief.com" ||
            // http://celebritywc.com/images100_/jennifer-lawrence-11.jpg
            //   http://celebritywc.com/images/jennifer-lawrence-11.jpg
            domain_nowww === "celebritywc.com" ||
            // http://eskipaper.com/images250_/anime-wallpaper-65.jpg
            //   http://eskipaper.com/images/anime-wallpaper-65.jpg
            domain_nowww === "eskipaper.com") {
            // http://paperlief.com/images450_300/insane-black-rock-shooter-huke-wallpaper-4.jpg
            //   http://www.paperlief.com/images/insane-black-rock-shooter-huke-wallpaper-4.jpg
            // http://paperlief.com/images450_300/insane-black-rock-shooter-wallpaper-1.jpg
            //   http://paperlief.com/images/insane-black-rock-shooter-wallpaper-1.jpg
            return src.replace(/\/images[0-9]+_([0-9]+)?\//, "/images/");
        }

        if (domain_nosub === "anidb.net" &&
            domain.match(/img[0-9]*(?:-[a-z]+)?\.anidb\.net/)) {
            // https://img7-us.anidb.net/pics/anime/thumbs/50x65/74335.jpg-thumb.jpg
            //   https://img7-us.anidb.net/pics/anime/74335.jpg
            return src.replace(/\/thumbs\/[0-9]+x[0-9]+(\/[0-9]+\.[^/.-]*)-thumb\.[^/.]*$/, "$1");
        }

        if (domain === "web-ace.jp") {
            // https://web-ace.jp/rp/1/182_182/img/youngace/contents/39/bungou_small.jpg
            //   https://web-ace.jp/img/youngace/contents/39/bungou_small.jpg
            return src.replace(/\/rp\/[0-9_]+\/[0-9]+_[0-9]+\/img\//, "/img/");
        }

        if (domain === "staticdelivery.nexusmods.com") {
            // https://staticdelivery.nexusmods.com/mods/1151/images/thumbnails/32634/32634-1529809154-43464164.jpeg
            //   https://staticdelivery.nexusmods.com/mods/1151/images/32634/32634-1529809154-43464164.jpeg
            return src.replace(/\/images\/thumbnails\//, "/images/");
        }

        if (domain === "forums.nexusmods.com") {
            // https://forums.nexusmods.com/uploads/profile/photo-thumb-375497.jpg?r_=1509119036
            //   https://forums.nexusmods.com/uploads/profile/photo-375497.jpg?r_=1509119036
            return src.replace(/\/uploads\/profile\/photo-thumb-([0-9]+)/, "/uploads/profile/photo-$1");
        }

        if (domain === "kb4images.com" &&
            src.indexOf("/images/") >= 0) {
            // http://kb4images.com/images/cute-anime-girl-wallpaper/36611827-cute-anime-girl-wallpaper-small.jpg
            //   http://kb4images.com/images/cute-anime-girl-wallpaper/36611827-cute-anime-girl-wallpaper.jpg
            return src.replace(/-small(\.[^/.]*)$/, "$1");
        }

        if (domain === "pics.me.me") {
            // https://pics.me.me/thumb_anime-real-so-cute-anime-say-i-love-you-6285223.png
            //   https://pics.me.me/anime-real-so-cute-anime-say-i-love-you-6285223.png
            return src.replace(/\/thumb_([^/]*-[0-9]+\.[^/.]*)$/, "/$1");
        }

        if (domain === "image.winudf.com") {
            // https://image.winudf.com/v2/image/Y29tLnNnbS5jdXRlYW5pbWVnaXJsd2FsbHBhcGVyX3NjcmVlbnNob3RzXzNfYzA1NDUxZDk/screen-3.jpg?h=355&fakeurl=1&type=.jpg
            //   https://image.winudf.com/v2/image/Y29tLnNnbS5jdXRlYW5pbWVnaXJsd2FsbHBhcGVyX3NjcmVlbnNob3RzXzNfYzA1NDUxZDk/screen-3.jpg?fakeurl=1&type=.jpg
            return src
                .replace(/\?[wh]=[0-9]+&/, "?")
                .replace(/&[wh]=[0-9]+/, "");
        }

        if (domain === "i.supload.com") {
            // https://i.supload.com/300x0/Skiej6q8x.png
            //   https://i.supload.com/Skiej6q8x.png
            return src.replace(/\/[0-9]+x[0-9]+\//, "/");
        }

        if (domain_nosub === "yaplakal.com" &&
            domain.match(/s[0-9]*\.yaplakal\.com/)) {
            // http://s00.yaplakal.com/pics/pics_preview/6/5/7/11722756.jpg
            //   http://s00.yaplakal.com/pics/pics_original/6/5/7/11722756.jpg
            // https://s00.yaplakal.com/pics/pics_preview/7/8/7/8817787.jpg
            //   https://s00.yaplakal.com/pics/pics_original/7/8/7/8817787.jpg
            return src.replace(/\/pics\/pics_[a-z]+\//, "/pics/pics_original/");
        }

        if (domain === "static.comicvine.com") {
            // https://static.comicvine.com/uploads/square_small/6/67663/6449136-800.jpg
            //   https://static.comicvine.com/uploads/original/6/67663/6449136-800.jpg
            return src.replace(/\/uploads\/[^/]*\//, "/uploads/original/");
        }

        if (domain === "preview.ibb.co" && false) {
            // https://preview.ibb.co/gfffEy/russia_players_celebrate_following_their_sides_victory_in_a_penalty_picture_id988998656_story_large_9c8c1668_4d53_4b55_ac5c_f7bd71b7f407.jpg
            //   https://image.ibb.co/gfffEy/russia_players_celebrate_following_their_sides_victory_in_a_penalty_picture_id988998656_story_large_9c8c1668_4d53_4b55_ac5c_f7bd71b7f407.jpg -- doesn't work
            // https://preview.ibb.co/gfffEy/russia_players_celebrate_following_their_sides_victory_in_a_penalty_picture.jpg
            //   https://image.ibb.co/gfffEy/russia_players_celebrate_following_their_sides_victory_in_a_penalty_picture.jpg -- doesn't work
            //return src.replace(/:\/\/[^/]*\/([0-9a-zA-Z]+\/[^/]*_id[0-9]{5,}[_.])/, "://image.ibb.co/$1");
        }

        if (domain === "image.ibb.co" ||
            domain === "preview.ibb.co") {
            // https://image.ibb.co/gfffEy/russia_players_celebrate_following_their_sides_victory_in_a_penalty_picture_id988998656_story_large_9c8c1668_4d53_4b55_ac5c_f7bd71b7f407.jpg
            //   https://image.ibb.co/gfffEy/russia_players_celebrate_following_their_sides_victory_in_a_penalty_picture_id988998656.jpg
            // https://preview.ibb.co/gfffEy/russia_players_celebrate_following_their_sides_victory_in_a_penalty_picture_id988998656_story_large_9c8c1668_4d53_4b55_ac5c_f7bd71b7f407.jpg
            //   https://preview.ibb.co/gfffEy/russia_players_celebrate_following_their_sides_victory_in_a_penalty_picture_id988998656.jpg
            // https://preview.ibb.co/jYsMbo/Screenshot_2018_07_12_15_56_41.png
            return src.replace(/(_id[0-9]{5,})_[0-9a-z_]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "cdn.imagepush.to") {
            // https://cdn.imagepush.to/in/625x2090/i/110/1106/11060/77.jpg
            //   https://cdn.imagepush.to/i/110/1106/11060/77.jpg
            return src.replace(/(:\/\/[^/]*\/)(?:in|out)\/[0-9]+x[0-9]+\//, "$1");
        }

        if (domain_nosub === "luscious.net" &&
            domain.match(/cdn[a-z]*\.luscious\.net/)) {
            // https://cdnio.luscious.net/Piclocked/316083/29737493_385675231951060_2443315356056420352_n_01CHCAG9S2B6ZYCNE0STTDBZP3.100x100.jpg
            //   https://cdnio.luscious.net/Piclocked/316083/29737493_385675231951060_2443315356056420352_n_01CHCAG9S2B6ZYCNE0STTDBZP3.jpg
            // https://cdna.luscious.net/avatars/unknown474/resized/380/21856557ca4272c7bdaaff9be64cd0bc.jpg
            //   https://cdna.luscious.net/avatars/unknown474/21856557ca4272c7bdaaff9be64cd0bc.jpg
            newsrc = src
                .replace(/\.[0-9]+x[0-9]+(\.[^/]*)$/, "$1")
                .replace(/\/resized\/[0-9]+\//, "/");
            if (newsrc !== src) {
                return [newsrc, newsrc.replace(/\.jpg$/, ".png")];
            }
        }

        if (domain === "d2pqhom6oey9wx.cloudfront.net") {
            // https://d2pqhom6oey9wx.cloudfront.net/img_resize/5997041145b3926972f0d8.jpg
            //   https://d2pqhom6oey9wx.cloudfront.net/img_original/5997041145b3926972f0d8.jpg
            return src.replace(/\/img_resize\//, "/img_original/");
        }

        if (domain === "i.gyazo.com") {
            // https://i.gyazo.com/thumb/1000/32311a3c69f875d5dc87f81624416d8a-png.jpg
            //   https://i.gyazo.com/32311a3c69f875d5dc87f81624416d8a.png
            return src.replace(/\/thumb\/[0-9]+\/([0-9a-f]+)-([a-z]+)\.[^/.]*$/, "/$1.$2");
        }

        if (domain === "cdn.theatlantic.com" &&
            src.match(/\/assets\/media\/(?:[^/]*\/)?img\//)) {
            // https://cdn.theatlantic.com/assets/media/img/photo/2018/06/photos-of-the-week-3/w06_AP18176413538038/main_600.jpg
            //   https://cdn.theatlantic.com/assets/media/img/photo/2018/06/photos-of-the-week-3/w06_AP18176413538038/original.jpg
            // https://cdn.theatlantic.com/assets/media/img/2018/06/WEL_Langewiesche_RaidOpener/640x360.jpg?mod=1530451892
            //   https://cdn.theatlantic.com/assets/media/img/2018/06/05/WEL_Langewiesche_RaidOpener/1920.jpg?1528207593
            //   https://cdn.theatlantic.com/assets/media/img/2018/06/WEL_Langewiesche_RaidOpener/original.jpg?mod=1530451892
            // https://cdn.theatlantic.com/assets/media/img/posts/2018/06/WEL_Langewiesche_RaidPilot/fe02c4147.jpg
            //   https://cdn.theatlantic.com/assets/media/img/posts/2018/06/WEL_Langewiesche_RaidPilot/original.jpg
            // https://cdn.theatlantic.com/assets/media/video/img/2018/06/homeSchool_03_03/hero_wide_640.jpg?1529695674
            //   https://cdn.theatlantic.com/assets/media/video/img/2018/06/homeSchool_03_03/original.jpg?1529695674
            //return src.replace(/\/(?:main_[0-9]+|[0-9]+(?:x[0-9]+)?)(\.[^/.]*)$/, "/original$1");
            return src.replace(/\/[^/.]*(\.[^/.]*)$/, "/original$1");
        }

        if (domain === "media.tag24.de") {
            // https://media.tag24.de/3/6/2/62e521e741273fa4f117.jpg
            //   https://media.tag24.de/0/6/2/62e521e741273fa4f117.jpg
            return src.replace(/(:\/\/[^/]*\/)[0-9]+\//, "$10/");
        }

        if (domain_nosub === "gelbooru.com" &&
            domain.match(/simg[0-9]*\.gelbooru\.com/)) {
            // https://simg3.gelbooru.com/thumbnails/ce/b8/thumbnail_ceb852df49b45c7c595eea61951b9ffb.jpg
            //   https://simg3.gelbooru.com/images/ce/b8/ceb852df49b45c7c595eea61951b9ffb.jpg
            return src.replace(/\/thumbnails\/([0-9a-f]+\/[0-9a-f]+\/)thumbnail_/, "/images/$1");
        }

        if ((domain_nosub === "e621.net" &&
             domain.match(/static[0-9]*\.e621\.net/)) ||
            // http://behoimi.org/data/preview/ee/b0/eeb0a41dc90c7861d5ca0fb200e06847.jpg
            //   http://behoimi.org/data/ee/b0/eeb0a41dc90c7861d5ca0fb200e06847.jpg
            domain_nowww === "behoimi.org") {
            // https://static1.e621.net/data/preview/5b/77/5b775b9fbcff339ce15fef7b85b1f9b9.jpg
            //   https://static1.e621.net/data/5b/77/5b775b9fbcff339ce15fef7b85b1f9b9.png
            // https://static1.e621.net/data/sample/de/b8/deb8350027c2edb949486319c1f78256.jpg
            //   https://static1.e621.net/data/de/b8/deb8350027c2edb949486319c1f78256.png
            newsrc = src.replace(/(:\/\/[^/]*\/)data\/(?:preview|sample)\//, "$1data/");
            if (newsrc !== src) {
                if (newsrc.match(/\.jpg[^/]*$/)) {
                    return [newsrc, newsrc.replace(/\.jpg(\?.*)?$/, ".png$1")];
                } else {
                    return [newsrc, newsrc.replace(/\.png(\?.*)?$/, ".jpg$1")];
                }
            }
        }

        if (amazon_container &&
            amazon_container.match(/^customink-iotw/)) {
            // https://s3.amazonaws.com/customink-iotw-east-prod/images/87525/large/3FFB96AD-5057-48B2-B198-59C9FEE377D1.jpeg?1529842961
            //   https://s3.amazonaws.com/customink-iotw-east-prod/images/87525/original/3FFB96AD-5057-48B2-B198-59C9FEE377D1.jpeg?1529842961
            return src.replace(/(\/images\/[0-9]+\/)[^/]*\//, "$1original/");
        }

        if (domain === "www.mypokecard.com") {
            // http://www.mypokecard.com/my/galery/thumbs/tRLELnxn16sc.jpg?1530649984
            //   http://www.mypokecard.com/my/galery/tRLELnxn16sc.jpg?1530649984
            return src.replace(/\/galery\/thumbs\//, "/galery/");
        }

        if (domain === "media.women.com" &&
            src.indexOf("/images/images/") >= 0) {
            // https://media.women.com/images/images/000/144/217/large/kirsty-tg-146655-unsplash.jpg?1530552637
            //   https://media.women.com/images/images/000/144/217/original/kirsty-tg-146655-unsplash.jpg?1530552637
            return src.replace(/\/[a-z]+\/([^/]*)$/, "/original/$1");
        }

        if (domain_nowww === "alternathistory.com") {
            // http://www.alternathistory.com/files/resize/users/user675/Rolls-Royce_Crecy-01-680x299.jpg
            //   http://www.alternathistory.com/files/users/user675/Rolls-Royce_Crecy-01.jpg
            return src.replace(/\/files\/resize(\/.*\/[^/]*)-[0-9]+x[0-9]+(\.[^/.]*)$/, "/files$1$2");
        }

        if (domain_nowww === "mtvwe.com") {
            // http://mtvwe.com/vpic.php?w=280&h=&f=/upload/news/2018/07/03/thumbweb12345678910.jpg
            //   http://www.mtvwe.com/upload/news/2018/07/03/thumbweb12345678910.jpg
            return src
                .replace(/\/vpic\.php.*?[?&]f=([^&]*).*?$/, "/$1")
                .replace(/(:\/\/[^/]*\/)\/*/, "$1");
        }

        if (domain === "yahoo.tw.weibo.com") {
            // https://yahoo.tw.weibo.com/thumbnail/93f8d29dly1fly3yibxtzj20f00exwg2.jpg
            //   https://yahoo.tw.weibo.com/bmiddle/93f8d29dly1fly3yibxtzj20f00exwg2.jpg
            //   https://yahoo.tw.weibo.com/large/93f8d29dly1fly3yibxtzj20f00exwg2.jpg
            return src.replace(/(:\/\/[^/]+\/)[a-z]+\//, "$1large/");
        }

        if (domain === "mobile.pic.people.com.cn") {
            // http://mobile.pic.people.com.cn/thumbs/320/426/data/cms/NMediaFile/2018/0619/WIRELESS201806190920000136814656512.jpg
            //   http://mobile.pic.people.com.cn/data/cms/NMediaFile/2018/0619/WIRELESS201806190920000136814656512.jpg
            return src.replace(/\/thumbs\/[0-9]+\/[0-9]+\//, "/");
        }

        if (domain === "images.asianstar.cz") {
            // http://images.asianstar.cz/upload/profily/1caed/slider_a0b347b222dee02660c4b8c47d817632.jpg - 640x400
            //  http://images.asianstar.cz/upload/profily/1caed/a0b347b222dee02660c4b8c47d817632.jpg -- 1570x1038
            // http://images.asianstar.cz/upload/gallery/2/35292/c_22ad86dbfd13cc6f3574790c8c1e99fe.jpg -- 280x280
            //   http://images.asianstar.cz/upload/gallery/2/35292/r_22ad86dbfd13cc6f3574790c8c1e99fe.jpg -- 480x600
            //   http://images.asianstar.cz/upload/gallery/2/35292/22ad86dbfd13cc6f3574790c8c1e99fe.jpg -- 635x794
            // http://images.asianstar.cz/upload/users/crop_e2478_3384.jpeg -- 397x397
            //   http://images.asianstar.cz/upload/users/e2478_3384.jpeg -- 636x641
            // http://images.asianstar.cz/upload/profily/8ce81/thumbnail_c9f4ea39e4ab3ba551618c7d02c2f912.jpg -- 400x400
            //   http://images.asianstar.cz/upload/profily/8ce81/slider_c9f4ea39e4ab3ba551618c7d02c2f912.jpg -- 640x400
            //   http://images.asianstar.cz/upload/profily/8ce81/c9f4ea39e4ab3ba551618c7d02c2f912.jpg 1920x1080
            // http://images.asianstar.cz/upload/clanky/f01ef/thumbnail_b450207590d5ace4ecae92eec7b5b0ae.jpg -- 240x150
            //   http://images.asianstar.cz/upload/clanky/f01ef/b450207590d5ace4ecae92eec7b5b0ae.jpg -- 960x960
            return src.replace(/\/[a-z]+_([^/]*)$/, "/$1");
        }

        if (domain === "picservice.qimai.cn") {
            // https://picservice.qimai.cn/get/http://mmbiz.qpic.cn/mmbiz_jpg/Kia46cB1ib34XkXOEYXhQQ4Gc0me6t7ViaM9ZLLZwpia1CO6VdOQA92PPZzjwHaPET679QlLMmp0NHCA20eccraIlA/640?wx_fmt=jpeg
            //   http://mmbiz.qpic.cn/mmbiz_jpg/Kia46cB1ib34XkXOEYXhQQ4Gc0me6t7ViaM9ZLLZwpia1CO6VdOQA92PPZzjwHaPET679QlLMmp0NHCA20eccraIlA/640?wx_fmt=jpeg
            return src.replace(/^[a-z]+:\/\/[^/]*\/get\//, "");
        }

        if (domain_nowww === "wxzixun.com") {
            // https://wxzixun.com/p/https://mmbiz.qpic.cn/mmbiz_jpg/A1IN49X2ibV8Znz9icmdicib1EjRJblrAiaNT2EWLcNXZRIhsQ6uqsFYFrGCbEM6OQFKqfIYmEj8k1C8cYIXe06ic18g/640?wx_fmt=jpeg
            //   https://mmbiz.qpic.cn/mmbiz_jpg/A1IN49X2ibV8Znz9icmdicib1EjRJblrAiaNT2EWLcNXZRIhsQ6uqsFYFrGCbEM6OQFKqfIYmEj8k1C8cYIXe06ic18g/640?wx_fmt=jpeg
            return src.replace(/^[a-z]+:\/\/[^/]*\/p\//, "");
        }

        if (domain === "mediaday.co.kr") {
            // http://mediaday.co.kr/uploads/cache/editor/2018/06/thumb-6b0c51b23bb282ff8113e620c06e6d40_1529461823064781800_600x0.jpg
            //   http://mediaday.co.kr/uploads/editor/2018/06/6b0c51b23bb282ff8113e620c06e6d40_1529461823064781800.jpg
            // http://mediaday.co.kr/uploads/cache/post/2018/07/thumb-357f8c7e9621a870cfc1c1daaf96b5dc_1530693023034070800_214x180.jpg
            //   http://mediaday.co.kr/uploads/post/2018/07/357f8c7e9621a870cfc1c1daaf96b5dc_1530693023034070800.jpg
            return src.replace(/\/uploads\/cache\/(.*)\/thumb-([0-9a-f]+_[0-9]+)_[0-9]+x[0-9]+(\.[^/.]*)$/,
                               "/uploads/$1/$2$3");
        }

        if (domain === "up.kpop.re") {
            // https://up.kpop.re/thumb/79/79cf99bde9d9902162c07af516f7e855872ac5.jpg
            //   https://up.kpop.re/src/79/79cf99bde9d9902162c07af516f7e855872ac5.jpg
            // https://up.kpop.re/src/19/7240a6e374ba73121b94b1f3e5dcb43fae3efb.jpg/int-136946.jpg
            //   https://up.kpop.re/src/19/7240a6e374ba73121b94b1f3e5dcb43fae3efb.jpg
            return src.replace(/(:\/\/[^/]*\/)[a-z]+(\/[0-9a-f]{2}\/[0-9a-f]+\.[^/.]*)(?:\/[^/]*)?$/, "$1src$2");
        }

        if (domain === "st.kp.yandex.net" &&
            src.indexOf("/images/") >= 0) {
            // https://st.kp.yandex.net/images/kadr/sm_2599504.jpg
            //   https://st.kp.yandex.net/images/kadr/2599504.jpg
            // https://st.kp.yandex.net/images/kadr/sm_226485_03072005195621_HALLEBERRY12.jpg
            //   https://st.kp.yandex.net/images/kadr/226485_03072005195621_HALLEBERRY12.jpg
            return src.replace(/\/[a-z]+_([0-9]+(?:_[^/]*)?\.[^/.]*)$/, "/$1");
        }

        if (domain_nowww === "startfilm.ru" && src.indexOf("/images/") >= 0) {
            // https://www.startfilm.ru/images/base/person/07_08_16/sm_96797_73399_naomie_harris_.jpg
            //   https://www.startfilm.ru/images/base/person/07_08_16/96797_73399_naomie_harris_.jpg
            return src.replace(/\/sm_([0-9]+_[^/]*)$/, "/$1");
        }

        if (domain_nowww === "publicfeet.com") {
            // http://publicfeet.com/public/media/front/post/img/t1414285.jpg
            //   http://publicfeet.com/public/media/front/post/img/1414285.jpg
            return src.replace(/\/img\/t([0-9]+\.[^/.]*)$/, "/img/$1");
        }

        if (domain_nowww === "twatis.com") {
            // http://twatis.com/data/07012018/324422718/thumb.jpeg
            //   http://twatis.com/data/07012018/324422718/photo.jpeg
            return src.replace(/\/thumb(\.[^/.]*)$/, "/photo$1");
        }

        if (domain === "images.starlets.photos") {
            // http://images.starlets.photos/rachel-riley/17027-large.jpg
            //   http://images.starlets.photos/rachel-riley/17027-original.jpg
            return src.replace(/(\/[0-9]+-)[a-z]+(\.[^/.]*)$/, "$1original$2");
        }

        if (domain === "s.smutty.com") {
            // https://s.smutty.com/media_smutty_2/d/i/r/t/m/dirtyukguy-8qxdg-6b9be5.jpg
            //   https://s.smutty.com/media_smutty_2/d/i/r/t/p/dirtyukguy-8qxdg-6b9be5.jpg
            return src.replace(/\/m\/([^/]*)$/, "/p/$1");
        }

        if (domain === "welovesexyfeet.com" ||
            // http://podolatria.net/cdn/upload/record/nlmrmlolnmmt/kristin-kreuk-feet-t270x337.jpg
            //   http://podolatria.net/cdn/upload/record/nlmrmlolnmmt/kristin-kreuk-feet.jpg
            domain_nowww === "podolatria.net" ||
            // http://img.ibxk.com.br/2018/07/16/16162511563028-t474x237.jpg
            //   http://img.ibxk.com.br/2018/07/16/16162511563028.jpg
            domain === "img.ibxk.com.br") {
            // http://welovesexyfeet.com/cdn/upload/record/nlmtlomqmplo/rachel-riley-feet-t270x450.jpg
            //   http://welovesexyfeet.com/cdn/upload/record/nlmtlomqmplo/rachel-riley-feet.jpg
            return src.replace(/-t[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "tfk.thefreekick.com" ||
            // https://discourse-cdn-sjc1.com/helloforos/uploads/default/optimized/4X/5/7/a/57aa3f914365bb39e7db1e85a15f1e4a61e62edc_1_666x1000.jpg
            //   https://discourse-cdn-sjc1.com/helloforos/uploads/default/original/4X/5/7/a/57aa3f914365bb39e7db1e85a15f1e4a61e62edc.jpg
            domain_nowww === "discourse-cdn-sjc1.com" ||
            // http://swagup.co.kr/uploads/default/optimized/2X/7/729996eeedbcc6eb835c108234590b94f3298f4a_1_375x500.jpg
            //   http://www.swagup.co.kr/uploads/default/original/2X/7/729996eeedbcc6eb835c108234590b94f3298f4a.jpg
            domain_nowww === "swagup.co.kr" ||
            // https://forum.combustionpunks.co.uk/uploads/default/optimized/2X/5/5d734122d237c0ac1a7961f8d536db660c891c77_1_690x413.jpg
            //   https://forum.combustionpunks.co.uk/uploads/default/original/2X/5/5d734122d237c0ac1a7961f8d536db660c891c77.jpg
            domain === "forum.combustionpunks.co.uk") {
            // https://tfk.thefreekick.com/uploads/default/optimized/2X/9/9c9755f8dcbd5d1427c7e9f4ac86eee3383b7366_1_333x500.jpeg
            //   https://tfk.thefreekick.com/uploads/default/original/2X/9/9c9755f8dcbd5d1427c7e9f4ac86eee3383b7366.jpeg
            return src.replace(/(\/uploads\/[a-z]+\/)optimized(\/.*\/[0-9a-f]+)_[0-9]+_[0-9]+x[0-9]+(\.[^/.]*)$/,
                               "$1original$2$3");
        }

        if (domain_nowww === "hotflick.net" ||
            amazon_container === "hotflicknet") {
            // http://hotflick.net/u/n/Y2CdwHWG5q/tn/5hPrKMLsdZpFjpT.jpg
            //   http://hotflicknet.s3.amazonaws.com/u/n/Y2CdwHWG5q/5hPrKMLsdZpFjpT.jpg
            // http://www.hotflick.net/u/n/2746164/tn/180_r/victoria-justice-jon-mckee-photoshoot.jpg
            //   http://www.hotflick.net/u/n/2746164/victoria-justice-jon-mckee-photoshoot.jpg
            // https://hotflicknet.s3.amazonaws.com/u/n/5058631/tn/natalie-portman-marie-claire-magazine-france-december-2016-2.jpg
            //   https://hotflicknet.s3.amazonaws.com/u/n/5058631/natalie-portman-marie-claire-magazine-france-december-2016-2.jpg
            // https://s3.amazonaws.com/hotflicknet/u/n/5058631/tn/natalie-portman-marie-claire-magazine-france-december-2016-2.jpg
            //   https://hotflicknet.s3.amazonaws.com/u/n/5058631/natalie-portman-marie-claire-magazine-france-december-2016-2.jpg
            return src
                .replace(/(:\/\/[^/]*\/.*\/[0-9]+\/)tn\/[0-9]+_[a-z]+\/([^/]*)$/, "$1$2")
                .replace(/:\/\/(?:[^/.]*-)?s3\.amazonaws\.com\/hotflicknet\/(.*\/)tn\/([^/]*)$/, "://hotflicknet.s3.amazonaws.com/$1$2")
                .replace(/:\/\/[^/]*\/(.*\/)tn\/([^/]*)$/, "://hotflicknet.s3.amazonaws.com/$1$2");
        }

        if (domain === "www.seniorclassaward.com" ||
            // http://www.zocalo.com.mx/images/sized/images/uploads/articles/emmawat-621x354.jpg
            //   http://www.zocalo.com.mx/images/uploads/articles/emmawat.jpg
            domain_nowww === "zocalo.com.mx") {
            // http://www.seniorclassaward.com/images/sized/images/athletes/Rachel_Riley_headshot-150x220.jpg
            //   http://www.seniorclassaward.com/images/athletes/Rachel_Riley_headshot.jpg
            return src.replace(/\/images\/sized(\/images\/.*)-[0-9]+x[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "hypnohub.net") {
            // http://hypnohub.net//data/preview/ce4154eb5de93edeae9389e5e1c5a31e.jpg
            //   http://hypnohub.net//data/sample/ce4154eb5de93edeae9389e5e1c5a31e.jpg
            //   http://hypnohub.net//data/image/ce4154eb5de93edeae9389e5e1c5a31e.jpg
            newsrc = src.replace(/\/data\/(?:preview|sample)\/([0-9a-f]+\.[^/.]*)$/, "/data/image/$1");
            if (newsrc !== src) {
                if (newsrc.match(/\.jpg[^/]*$/)) {
                    return [newsrc, newsrc.replace(/\.jpg(\?.*)?$/, ".png$1")];
                } else {
                    return [newsrc, newsrc.replace(/\.png(\?.*)?$/, ".jpg$1")];
                }
            }
        }

        if (domain === "www.hentairing.com") {
            // http://www.hentairing.com/thumb/1/width-248/ada-wong-tomoki-resident-evil.jpg
            //   http://www.hentairing.com/thumb/1/ada-wong-tomoki-resident-evil.jpg?width=150
            //   http://www.hentairing.com/thumb/1/ada-wong-tomoki-resident-evil.jpg
            return src
                .replace(/\/(?:width|height)-[0-9]+\/([^/]*)$/, "/$1")
                .replace(/\?.*/, "");
        }

        if (domain_nosub === "enterdesk.com" &&
            domain.match(/^up\./)) {
            // https://up.sc.enterdesk.com/edpic_360_360/f2/d9/dd/f2d9dd6f218ddcd958e3726305285b1e.jpg -- 450x300
            //   https://up.sc.enterdesk.com/edpic_source/f2/d9/dd/f2d9dd6f218ddcd958e3726305285b1e.jpg -- 5472x3648
            return src.replace(/\/edpic_[0-9]+(?:_[0-9]+)?\//, "/edpic_source/");
        }

        if (domain_nosub === "gtimg.com" &&
            domain.match(/img[0-9]*\.gtimg\.com/)) {
            // http://img1.gtimg.com/18/1852/185277/18527786_640x640_281.jpg
            //   http://img1.gtimg.com/18/1852/185277/18527786.jpg
            return src.replace(/_[0-9]+x[0-9]+_[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "zol-img.com.cn") {
            // https://desk-fd.zol-img.com.cn/t_s960x600c5/g1/M08/06/01/Cg-4jlSTiHOIQBPhAATA0Y9zzg8AAPFzAOGmKkABMDp424.jpg
            //   https://desk-fd.zol-img.com.cn/g1/M08/06/01/Cg-4jlSTiHOIQBPhAATA0Y9zzg8AAPFzAOGmKkABMDp424.jpg
            // https://sjbz-fd.zol-img.com.cn/t_s320x510c/g5/M00/0A/07/ChMkJljBGoeIcgh9AADu6XCSFkUAAamGgBbQ1kAAO8B221.jpg
            //   https://sjbz-fd.zol-img.com.cn/g5/M00/0A/07/ChMkJljBGoeIcgh9AADu6XCSFkUAAamGgBbQ1kAAO8B221.jpg
            // http://2c.zol-img.com.cn/article/13_310x310/70/li6mTksSxuQ.jpg
            //   http://2c.zol-img.com.cn/article/13/70/li6mTksSxuQ.jpg
            return src
                .replace(/(:\/\/[^/]*\/)t_[0-9a-z]+\//, "$1")
                .replace(/(\/article\/[0-9]+)_[0-9]+x[0-9]+\//, "$1/");;
        }

        if (domain === "img.faxing11.com") {
            // http://img.faxing11.com/img/p3.pstatp.com/large/pgc-image/1525594197806a4d5686dc4.jpg
            //   http://p3.pstatp.com/large/pgc-image/1525594197806a4d5686dc4.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/img\//, "http://");
        }

        if (domain === "static.congnghe.vn") {
            // http://static.congnghe.vn/tinmoi/store/techmag/thumb/30092017/218/top-10-nu-minh-tinh-trung-quoc-hut-khach-cho-thuong-hieu-dai-dien-2094125.jpg.600.0.jpg
            //   http://static.congnghe.vn/tinmoi/srv_thumb.ashx?source=218&w=600&h=0&f=store\techmag\thumb\30092017\218\2094125.jpg&title=top-10-nu-minh-tinh-trung-quoc-hut-khach-cho-thuong-hieu-dai-dien
            //   http://static.congnghe.vn/tinmoi/store/techmag/thumb/30092017/218/2094125.jpg
            // http://static.congnghe.vn/tinmoi/srv_thumb.ashx?source=202&w=110&h=96&f=store\techmag\thumb\05072018\202\2132322.jpg&title=nguoi-la-ma-co-dai-da-khien-can-benh-kinh-khung-nay-hoanh-hanh-va-lay-lan-xuyen-luc-dia
            //   http://static.congnghe.vn/tinmoi/store/techmag/thumb/05072018/202/2132322.jpg
            return src
                .replace(/\/srv_thumb\.ashx.*?[?&]f=([^&]*).*/, "/$1")
                .replace(/\\/g, "/")
                .replace(/\/[^/]*-([0-9]+\.[^/.]*)\.[0-9]+\.[0-9]+\.[^/.]*$/, "/$1");
        }

        if (domain === "images.foody.vn") {
            // https://images.foody.vn/res/g24/238192/prof/s640x400/foody-mobile-tan-bot-2-jpg-850-636003866052957560.jpg
            //   https://images.foody.vn/res/g24/238192/prof/s/foody-mobile-tan-bot-2-jpg-850-636003866052957560.jpg
            return src.replace(/\/s[0-9]+x[0-9]+\/([^/]*)$/, "/s/$1");
        }

        if (domain === "programma.sorrisi.com") {
            // https://programma.sorrisi.com/guidatv/uploads/media/cache/epg_program_large/uploads/epg/images/programseries/0/0/originale/272826.jpg
            //   https://programma.sorrisi.com/guidatv/uploads/epg/images/programseries/0/0/originale/272826.jpg
            return src.replace(/\/uploads\/media\/cache\/.*?\/uploads\//, "/uploads/");
        }

        if (domain === "www.vidofa.com" &&
            src.indexOf("/module/thumb/sr.php") >= 0) {
            // http://www.vidofa.com/module/thumb/sr.php?src=http://dl64.vidofa.com/srv//files/thumbs/2018/06/30//1530342529fd517-30.jpg
            //   http://dl64.vidofa.com/srv//files/thumbs/2018/06/30//1530342529fd517-30.jpg
            return decodeURIComponent(src.replace(/.*?\/module\/thumb\/sr\.php.*?[?&]src=([^&]*)$/, "$1"));
        }

        if (domain === "free4kwallpapers.com") {
            // https://free4kwallpapers.com/uploads/originals/2015/08/12/black-rock-shooter-anime-wallpaper-2560x1600-640.jpg
            //   https://free4kwallpapers.com/no-watermarks/originals/2015/08/12/black-rock-shooter-anime-wallpaper-2560x1600-640.jpg
            // https://free4kwallpapers.com/uploads/wallpaper/15/08/12/black-rock-shooter-anime-wallpaper-2560x1600-640-1024x768-wallpaper.jpg
            //   https://free4kwallpapers.com/no-watermarks/originals/2015/08/12/black-rock-shooter-anime-wallpaper-2560x1600-640.jpg
            return src
                .replace(/\/uploads\/wallpaper\/([0-9]{2}\/.*)-[0-9]+x[0-9]+-wallpaper(\.[^/.]*)$/, "/uploads/originals/20$1$2")
                .replace(/\/uploads\/originals\//, "/no-watermarks/originals/");
        }

        if (domain_nosub === "webnode.com.br") {
            // https://predadoresblack.webnode.com.br/_files/system_preview_detail_200000000-c9bd6ca3b5-public/thumbbig-124889.jpg
            //   https://predadoresblack.webnode.com.br/_files/200000000-c9bd6ca3b5-public/thumbbig-124889.jpg
            return src.replace(/(:\/\/[^/]*\/_files\/)[^/]*_([0-9]+-[0-9a-f]+(?:-[a-z]+)?\/[^/]*)$/, "$1$2");
        }

        if (amazon_container === "cdn.roosterteeth.com") {
            // https://s3.amazonaws.com/cdn.roosterteeth.com/uploads/images/3bc8b57e-f691-4657-8a82-2339f07ce0e4/sm/Titch110151cb4503ddb1f.jpg
            //   https://s3.amazonaws.com/cdn.roosterteeth.com/uploads/images/3bc8b57e-f691-4657-8a82-2339f07ce0e4/original/Titch110151cb4503ddb1f.jpg
            return src.replace(/(\/images\/[-0-9a-f]+\/)[a-z]+(\/[^/]*)$/, "$1original$2");
        }

        if (domain === "www.wallpaperk.com") {
            // http://www.wallpaperk.com/wallpapers/resoluciones/16/anime-impresionantes-chicas_1024x600_4719.jpg
            //   http://www.wallpaperk.com/wallpapers/anime-impresionantes-chicas-4719.jpg
            return src.replace(/\/resoluciones\/[0-9]+\/([^/]*)_[0-9]+x[0-9]+_([0-9]+\.[^/.]*)$/, "/$1-$2");
        }

        if (domain === "pic.58pic.com" ||
            // http://ku.90sjimg.com/back_pic/03/62/07/2457a98b1f1e8c9.jpg!/fw/226/quality/90/unsharp/true/compress/true/canvas/226x105a0a0/cvscolor/FFFFFFFF
            //   http://ku.90sjimg.com/back_pic/03/62/07/2457a98b1f1e8c9.jpg
            domain_nosub === "90sjimg.com" ||
            domain === "pic.qiantucdn.com") {
            // http://pic.58pic.com/58pic/17/35/09/58r58PICV96_1024.jpg!/fw/1024/watermark/url/L2ltYWdlcy93YXRlcm1hcmsveGlhb3R1LnBuZw==/align/center
            //   http://pic.58pic.com/58pic/17/35/09/58r58PICV96_1024.jpg
            // http://pic.qiantucdn.com/58pic/17/35/09/58r58PICV96_1024.jpg!/fw/1024/watermark/url/L2ltYWdlcy93YXRlcm1hcmsveGlhb3R1LnBuZw==/align/center
            //   http://pic.qiantucdn.com/58pic/17/35/09/58r58PICV96_1024.jpg
            return src.replace(/!.*/, "");
        }

        if (domain === "img.wallpapersafari.com") {
            // https://img.wallpapersafari.com/desktop/1536/864/85/66/Na4mby.jpg
            //   https://img.wallpapersafari.com/85/66/Na4mby.jpg
            // https://img.wallpapersafari.com/img720/12/74/SW1XU0.jpg
            //   https://img.wallpapersafari.com/12/74/SW1XU0.jpg
            return src
                .replace(/\/img[0-9]+\//, "/")
                .replace(/\/desktop\/[0-9]+\/[0-9]+\//, "/");
        }

        if (domain_nosub === "fjcdn.com" &&
            domain.match(/static[0-9]*\.fjcdn\.com/)) {
            // https://static.fjcdn.com/pictures/Anime+and+related+wallpaper+dump+please+help+me+expand+my_937a43_5302360.jpg
            //   https://static.fjcdn.com/large/pictures/93/7a/937a43_5302360.jpg
            // https://static1.fjcdn.com/thumbnails/comments/Blank+_8610876e6fec56649d73447e057639e3.jpg
            //   https://static1.fjcdn.com/comments/Blank+_8610876e6fec56649d73447e057639e3.jpg
            return src
                .replace(/\/thumbnails\/comments\//, "/comments/")
                .replace(/\/pictures\/[^/]*_([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]+_[0-9]+\.[^/.]*)$/, "/large/pictures/$1/$2/$1$2$3");
        }

        if (googlestorage_container === "kendam-148811.appspot.com") {
            // https://storage.googleapis.com/kendam-148811.appspot.com/photo.kendam.com/thumb300/tn300_b903d3471725aeea6387c699c7e06888_3189.jpg
            //   https://storage.googleapis.com/kendam-148811.appspot.com/photo.kendam.com/temp/b903d3471725aeea6387c699c7e06888_3189.jpg
            return src.replace(/\/thumb[0-9]+\/tn[0-9]+_/, "/temp/");
        }

        if (domain === "image-cdn.hypb.st") {
            // https://image-cdn.hypb.st/https%3A%2F%2Fhypebeast.com%2Fimage%2F2018%2F07%2Fkaws-companion-sculpture-gwanggyo-ipark-0.jpg?q=90&w=1400&cbr=1&fit=max
            //   https://hypebeast.com/image/2018/07/kaws-companion-sculpture-gwanggyo-ipark-0.jpg?q=90
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/([^&]*).*/, "$1"))
        }

        if (domain_nowww == "productionparadise.com") {
            // https://productionparadise.com/newsletters/1128/photos/71900/minisite/delaria.jpg
            //   https://productionparadise.com/newsletters/1128/photos/71900/original/delaria.jpg
            return src.replace(/(\/photos\/[0-9]+\/)[a-z]+(\/[^/]*)$/, "$1original$2");
        }

        if (domain_nosub === "cargocollective.com" &&
            domain.match(/payload[0-9]*\.cargocollective\.com/)) {
            // https://payload554.cargocollective.com/1/12/394613/13388711/20171210_PolkaDotStory_1_1000.jpg
            //   https://payload554.cargocollective.com/1/12/394613/13388711/20171210_PolkaDotStory_1.jpg
            // https://payload560.cargocollective.com/1/12/394613/13503032/WTL-Web-01_1000.jpg
            //   https://payload560.cargocollective.com/1/12/394613/13503032/WTL-Web-01.jpg
            return src.replace(/_[0-9]{3,4}(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "imagebam.com" &&
            (domain.match(/^thumbs[0-9]*\.imagebam\.com/) ||
             domain.match(/^thumbnails[0-9]*\.imagebam\.com/)) &&
            options && options.cb && options.do_request) {
            // http://www.imagebam.com/image/b08214643524333
            //   http://thumbs2.imagebam.com/b5/84/c2/b08214643524333.jpg
            //   http://images2.imagebam.com/c9/b4/96/b08214643524333.jpg
            // http://www.imagebam.com/image/172f56480587760
            //   http://thumbnails115.imagebam.com/48059/172f56480587760.jpg
            //   http://images3.imagebam.com/5f/1e/36/172f56480587760.jpg
            var id = src.replace(/.*\/([0-9a-f]+)\.[^/.]*$/, "$1");
            if (id !== src) {
                options.do_request({
                    url: "http://www.imagebam.com/image/" + id,
                    method: "GET",
                    onload: function(resp) {
                        if (resp.readyState === 4) {
                            var match = resp.responseText.match(/<meta *property="og:image" *content="([^"]*)"/);
                            if (match) {
                                options.cb(match[1]);
                            } else {
                                options.cb(null);
                            }
                        }
                    }
                });
                return {
                    waiting: true
                };
            }
        }

        if (domain_nosub === "imagevenue.com" &&
            domain.match(/^img[0-9]+\.imagevenue\.com/) &&
            src.match(/\/th_([^/]*)$/) &&
            options && options.cb && options.do_request) {
            // http://img2250.imagevenue.com/img.php?image=613512642_0_00_0_0sexyhot0___0_123_257lo.jpg
            // http://img250.imagevenue.com/loc257/th_613512642_0_00_0_0sexyhot0___0_123_257lo.jpg
            //   http://img2250.imagevenue.com/aAfkjfp01fo1i-3407/loc257/613512642_0_00_0_0sexyhot0___0_123_257lo.jpg
            var id = src.replace(/.*\/th_([^/]*)$/, "$1");
            if (id !== src) {
                var requrl = src.replace(/(:\/\/[^/]*\/).*/, "$1img.php?image=" + id);
                options.do_request({
                    url: requrl,
                    method: "GET",
                    onload: function(resp) {
                        if (resp.readyState === 4) {
                            var match = resp.responseText.match(/<img *id="thepic"[^>]* (?:src|SRC)="([^"]*)"/);
                            if (match) {
                                options.cb(urljoin(requrl, match[1], true));
                            } else {
                                options.cb(null);
                            }
                        }
                    }
                });
                return {
                    waiting: true
                };
            }
        }

        if (domain === "static.cinemagia.ro") {
            // https://static.cinemagia.ro/img/resize/db/actor/33/04/29/andrea-duro-731111l-thumbnail_gallery.jpg
            //   https://static.cinemagia.ro/img/db/actor/33/04/29/andrea-duro-731111l.jpg
            // https://static.cinemagia.ro/img/resize/db/actor/33/04/29/andrea-duro-195331l-poza.jpg
            //   https://static.cinemagia.ro/img/db/actor/33/04/29/andrea-duro-195331l.jpg
            // https://static.cinemagia.ro/img/resize/db/movie/00/15/42/the-time-machine-755487l-576x0-w-c5c527bb.jpg
            //   https://static.cinemagia.ro/img/db/movie/00/15/42/the-time-machine-755487l.jpg
            //return src.replace(/\/img\/resize\/db\/(.*-[0-9]{4,}[a-z])-[a-z_]+(\.[^/.]*)$/, "/img/db/$1$2");
            //return src.replace(/\/img\/resize\/db\/(.*-[0-9]+[a-z]*)-[0-9]+x[0-9]+-[a-z]+-[0-9a-f]+(\.[^/.]*)$/, "/img/db/$1$2");
            return src.replace(/\/img\/resize\/db\/(.*\/[^/]*?-[0-9]+[a-z])-[^/.]*?(\.[^/.]*)$/, "/img/db/$1$2");
        }

        if (domain === "static.kinokopilka.pro") {
            // https://static.kinokopilka.pro/system/images/photos/images/000/046/133/46133_thumb.jpg
            //   https://static.kinokopilka.pro/system/images/photos/images/000/046/133/46133_original.jpg
            // https://static.kinokopilka.pro/system/images/people/images/000/061/034/1336571110/61034_large.jpg
            //   https://static.kinokopilka.pro/system/images/people/images/000/061/034/1336571110/61034_original.jpg
            return src.replace(/(\/[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1_original$2");
        }

        if (domain === "d1uzk9o9cg136f.cloudfront.net") {
            // https://d1uzk9o9cg136f.cloudfront.net/f/16783100/rc/2018/07/06/3ab2cab8878441a5553e43f1ef631bf7f6e97f80_normal.jpg
            //   https://d1uzk9o9cg136f.cloudfront.net/f/16783100/rc/2018/07/06/3ab2cab8878441a5553e43f1ef631bf7f6e97f80.jpg
            //   https://d1uzk9o9cg136f.cloudfront.net/f/16783100/rc/2018/07/06/3ab2cab8878441a5553e43f1ef631bf7f6e97f80_xlarge.jpg -- stretched?
            // https://d1uzk9o9cg136f.cloudfront.net/f/portal/16777363/rc/2018/06/28/ef28b10ad2fae52fea839fdd88bc72c7405f02b4_large.jpg
            //   https://d1uzk9o9cg136f.cloudfront.net/f/portal/16777363/rc/2018/06/28/ef28b10ad2fae52fea839fdd88bc72c7405f02b4.jpg
            // https://d1uzk9o9cg136f.cloudfront.net/f/16783100/rc/2018/07/02/31f0bf6f6992ade98ad3388c3e652a24d96f5990_small.jpg
            //   https://d1uzk9o9cg136f.cloudfront.net/f/16783100/rc/2018/07/02/31f0bf6f6992ade98ad3388c3e652a24d96f5990.jpg
            return src.replace(/(\/[a-f0-9]+)_[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "static.azteca.com") {
            // http://static.azteca.com/crop/crop.php?coordinates=50,50&width=750&height=450&img=http://static.azteca.com/imagenes/2017/45/fotoespecial-2174571.jpg
            //   http://static.azteca.com/imagenes/2017/45/fotoespecial-2174571.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/crop\/crop\.php.*?[?&]img=([^&]*).*?$/, "$1"));
        }

        if (domain === "www.tasoeur.biz") {
            // http://www.tasoeur.biz/images/2018/01/06/thumbs/CC-2.thumb.jpg
            //   http://www.tasoeur.biz/images/2018/01/06/CC-2.jpg
            return src.replace(/\/thumbs\/([^/]*)\.thumb(\.[^/.]*)$/, "/$1$2");
        }

        if (domain === "imageproxy.ifcdn.com") {
            // https://imageproxy.ifcdn.com/crop:x-20,resize:320x,crop:x800,quality:90x75/images/e9b3c27e6252634d8d55b3936b6d8d1104ffc4fddae247e4bd6188de8f61ef92_1.jpg
            //   https://imageproxy.ifcdn.com/crop:x,resize:x,crop:x,quality:x/images/e9b3c27e6252634d8d55b3936b6d8d1104ffc4fddae247e4bd6188de8f61ef92_1.jpg
            //   https://img.ifcdn.com/images/e9b3c27e6252634d8d55b3936b6d8d1104ffc4fddae247e4bd6188de8f61ef92_1.jpg
            return src.replace(/:\/\/[^/]*\/[^/]*(\/images\/[^/]*)$/, "://img.ifcdn.com$1");
        }

        if (domain === "resource.mingweekly.com") {
            // http://resource.mingweekly.com/userfiles/sm/sm640480_images_A1/13366/2018012359061705.jpg -- 320x480
            //   http://resource.mingweekly.com/userfiles/images_A1/13366/2018012359061705.jpg -- 5792x8688
            // http://resource.mingweekly.com/userfiles/sm/sm1200_images_A1/13150/2018010361134885.jpg
            //   http://resource.mingweekly.com/userfiles/images_A1/13150/2018010361134885.jpg
            return src.replace(/\/userfiles\/sm\/sm[0-9]+_images/, "/userfiles/images");
        }

        if (domain_nosub === "allegroimg.com") {
            // https://5.allegroimg.com/s512/03a7a6/3432952a4812a32a7eacaf3611e5
            //   https://5.allegroimg.com/original/03a7a6/3432952a4812a32a7eacaf3611e5
            return src.replace(/(:\/\/[^/]*\/)s[0-9]+\//, "$1original/");
        }

        if (domain === "mmc.tirto.id") {
            // https://mmc.tirto.id/image/otf/600x315/2018/01/13/camila-cabello--youtube.jpg
            //   https://mmc.tirto.id/image/2018/01/13/camila-cabello--youtube.jpg
            return src.replace(/\/image\/otf\/[0-9]+x[0-9]+\//, "/image/");
        }

        if (domain === "ia.tmgrup.com.tr") {
            // http://ia.tmgrup.com.tr/ec4621/0/0/0/0/960/504?u=http://i.tmgrup.com.tr/es/2018/03/08/turkiyede-en-cok-hangi-kadin-sarkicilar-dinleniyor-1520499517892.jpg&mw=600
            //   http://i.tmgrup.com.tr/es/2018/03/08/turkiyede-en-cok-hangi-kadin-sarkicilar-dinleniyor-1520499517892.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/[^/]*\/(?:[0-9]+\/){5}[0-9]+\/?.*?[?&]u=([^&]*).*?$/, "$1"));
        }

        if (domain === "img.erogazou.co") {
            // http://img.erogazou.co/thumb/06ac5470158bdeca9cb58abf386cb8c54fa6ac2e.2.jpg
            //   http://img.erogazou.co/photo/06ac5470158bdeca9cb58abf386cb8c54fa6ac2e.2.jpg
            return src.replace(/\/thumb\//, "/photo/");
        }

        if (domain === "tracks.content.hardstyle.com") {
            // https://tracks.content.hardstyle.com/products/0/275/356/thumbs/500x500/zatox-and-brennan-heart-back-in-the-days.jpg
            //   https://tracks.content.hardstyle.com/products/0/275/356/original/zatox-and-brennan-heart-back-in-the-days.jpg
            return src.replace(/\/thumbs\/[0-9]+x[0-9]+\//, "/original/");
        }

        if (domain_nosub === "thedjlist.com" &&
            domain.match(/i[0-9]*\.thedjlist\.com/)) {
            // http://i9.thedjlist.com/djs/photos/328097/large.jpg
            //   http://i9.thedjlist.com/djs/photos/328097/original.jpg
            return src.replace(/(\/photos\/[0-9]+\/)[a-z]+(\.[^/.]*)$/, "$1original$2");
        }

        if (domain === "artist-assets.hubbardradio.com") {
            // https://artist-assets.hubbardradio.com/clean-bandit-1_v1000.jpg
            //   https://artist-assets.hubbardradio.com/clean-bandit-1.jpg
            return src.replace(/_v[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "cdn.ebaumsworld.com" ||
            domain === "images.ebaumsworld.com") {
            // http://cdn.ebaumsworld.com/thumbs/picture/718392/84995481.jpg
            //   http://cdn.ebaumsworld.com/mediaFiles/picture/718392/84995481.jpg
            // http://images.ebaumsworld.com/thumbs/picture/718392/84995481.jpg
            //   http://images.ebaumsworld.com/mediaFiles/picture/718392/84995481.jpg
            // http://cdn.ebaumsworld.com/thumbs/gallery/730195/84747317.jpg
            //   http://cdn.ebaumsworld.com/mediaFiles/picture/730195/84747317.jpg -- doesn't work
            //   http://cdn.ebaumsworld.com/mediaFiles/picture/730195/84747318.jpg
            return src.replace(/\/thumbs\/(?:picture|gallery)\//, "/mediaFiles/picture/");
        }

        if (domain_nosub === "kapook.com") {
            // https://my.kapook.com/rf/145/109/img-rambobar/img_rambobar_1_1530873150.jpg
            //   https://my.kapook.com/o/img-rambobar/img_rambobar_1_1530873150.jpg
            // https://simg.kapook.com/rf/145/145/photo/238/kapook_world-237259.jpg
            //   https://simg.kapook.com/o/photo/238/kapook_world-237259.jpg
            return src.replace(/\/rf\/[0-9]+\/[0-9]+\//, "/o/");
        }

        if (domain_nosub === "amcn.in" &&
            domain.match(/^cdn[0-9]*\.amcn\.in/)) {
            // https://cdn4.amcn.in/a/tomislav.alle.bg/assets/6802a60d74b9-w800-c999999999-v1c51e564c5/bearcms/files/image/x6af845t2fa1r6ptu1i.jpg
            //   https://tomislav.alle.bg/assets/5c0a53cb790c-w255-c999999999-v7fbf8ac942/bearcms/files/image/v9s2dd4t2fa18k2d8lv.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/a\/([^/.]*\.[^/]*\/)/, "http://$1");
        }

        if (domain_nosub === "litlepups.net" &&
            domain.match(/^cdn[0-9]*\.litlepups\.net/)) {
            // http://cdn1.litlepups.net/resize/2018/04/27/small-toco-toucan-ramphastos-toco-pgcps-mess-reform.jpg
            //   http://cdn.litlepups.net/2018/04/27/toco-toucan-ramphastos-toco-pgcps-mess-reform.jpg
            return src.replace(/:\/\/[^/]*\/resize\/(.*)\/[a-z]+-([^/]*)$/, "://cdn.litlepups.net/$1/$2");
        }

        if (domain_nowww === "wede-mail.com" ||
            // http://www.warnerchappell.com/slir/w450/app/webroot/assets/3045.jpg
            //   http://www.warnerchappell.com/slir/orig/app/webroot/assets/3045.jpg
            //   http://www.warnerchappell.com/app/webroot/assets/3045.jpg
            // http://www.warnerchappell.com/slir/w125-h109-c1:1/app/webroot/assets/3045.jpg
            //   http://www.warnerchappell.com/app/webroot/assets/3045.jpg
            domain_nowww === "warnerchappell.com") {
            // http://wede-mail.com/slir/w584/wp-content/uploads/2014/11/df2be7aa-8eaa-47be-a1e4-f536300f4319.jpg
            //   http://www.wede-mail.com/slir/orig/wp-content/uploads/2014/11/df2be7aa-8eaa-47be-a1e4-f536300f4319.jpg
            //   http://www.wede-mail.com/wp-content/uploads/2014/11/df2be7aa-8eaa-47be-a1e4-f536300f4319.jpg
            //return src.replace(/\/slir\/[wh][0-9]*\//, "/slir/orig/");
            return src.replace(/\/slir\/(?:[whc][0-9:]+(?:-[^/]*)|orig)\//, "/");
        }

        if (domain_nowww === "photorator.com" ||
            // https://pornopics.co/photos/thumbs/mckayla-maroney-turns-today-1476244.jpg
            //   https://pornopics.co/photos/small/mckayla-maroney-turns-today-1476244.jpg
            //   https://pornopics.co/photos/images/mckayla-maroney-turns-today-1476244.jpg
            domain_nowww === "pornopics.co") {
            // https://photorator.com/photos/thumbs/a-cozy-toucan--69045.jpg
            //   https://www.photorator.com/photos/images/a-cozy-toucan--69045.jpg
            return src.replace(/\/photos\/(?:thumbs|small)\//, "/photos/images/");
        }

        if (domain_nosub === "cdn-expressen.se") {
            // https://c.cdn-expressen.se/images/4b/d3/4bd315bf3bb14ac48b8f73c7fbb812f1/16x9/1000@60.jpg
            //   https://c.cdn-expressen.se/images/4b/d3/4bd315bf3bb14ac48b8f73c7fbb812f1/16x9/original.jpg
            //   https://c.cdn-expressen.se/images/4b/d3/4bd315bf3bb14ac48b8f73c7fbb812f1/original.jpg -- doesn't work
            //   https://c.cdn-expressen.se/images/4b/d3/4bd315bf3bb14ac48b8f73c7fbb812f1/annan/original.jpg
            // https://y.cdn-expressen.se/images/d9/7a/d97a1ccee600422ea37a35eb58e74763/original.jpg
            //   https://c.cdn-expressen.se/images/d9/7a/d97a1ccee600422ea37a35eb58e74763/original.jpg -- same
            // https://x.cdn-expressen.se/images/6e/d2/6ed2fd7499174eff97992c4032b77721/16x9/original.jpg
            //   https://x.cdn-expressen.se/images/6e/d2/6ed2fd7499174eff97992c4032b77721/annan/original.jpg
            return src
                .replace(/\/[0-9]+(?:@[0-9]+)?(\.[^/.]*)$/, "/original$1")
                .replace(/(\/[0-9a-f]+\/)[0-9]+x[0-9]+(\/[^/]*)$/, "$1annan$2");
        }

        if (domain === "images.csmonitor.com") {
            // https://images.csmonitor.com/csm/2018/06/0629-RedHen.jpg?alias=standard_75x50
            //   https://images.csmonitor.com/csm/2018/06/0629-RedHen.jpg?alias=original
            return src.replace(/(?:\?.*)?$/, "?alias=original");
        }

        if (domain === "www.incimages.com" ||
            // https://firenewsfeed.com/image/728x410/aHR0cHM6Ly9pbWFnZXMuYXhpb3MuY29tL2NJQm1aS2xyZ0hiRFhpZDNsQklEdkcyUXdZOD0vMHgwOjE5MjB4MTA4MC8xOTIweDEwODAvMjAxOC8wNy8xNS8xNTMxNjg4MTkyMjg3LmpwZw==
            //   https://firenewsfeed.com/image/aHR0cHM6Ly9pbWFnZXMuYXhpb3MuY29tL2NJQm1aS2xyZ0hiRFhpZDNsQklEdkcyUXdZOD0vMHgwOjE5MjB4MTA4MC8xOTIweDEwODAvMjAxOC8wNy8xNS8xNTMxNjg4MTkyMjg3LmpwZw==
            domain_nowww === "firenewsfeed.com") {
            // https://www.incimages.com/uploaded_files/image/300x200/getty_930534182_200014312000928078_362581.jpg
            //   https://www.incimages.com/uploaded_files/image/getty_930534182_200014312000928078_362581.jpg
            return src.replace(/\/image\/[0-9]+x[0-9]+\//, "/image/");
        }

        if (domain === "cached.imagescaler.hbpl.co.uk") {
            // https://cached.imagescaler.hbpl.co.uk/resize/scaleWidth/743/cached.offlinehbpl.hbpl.co.uk/news/OMC/marie-claire---640-20140814021457224.jpg
            //   http://cached.offlinehbpl.hbpl.co.uk/news/OMC/marie-claire---640-20140814021457224.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/resize\/[^/]*\/[0-9]+\/([^/]*\.[^/]*\/)/, "http://$1");
        }

        if (domain === "i.tuenlinea.com") {
            // http://i.tuenlinea.com/dam/moda/17/03/12/orange_carpet_de_los_kids_choice_awards_2017_10.jpg.imgw.1280.1280.jpeg
            //   http://i.tuenlinea.com/dam/moda/17/03/12/orange_carpet_de_los_kids_choice_awards_2017_10.jpg.imgo.jpg
            return src.replace(/(\/[^/]*(\.[^/.]*))\.img[wh]\.[0-9]+\.[0-9]+\.[^/.]*$/, "$1.imgo$2");
        }

        if (domain === "cdn-photos.extratv.com") {
            // http://cdn-photos.extratv.com/gallery-images/2018/05/GettyImages-960168704_thumb.jpg
            //   http://cdn-photos.extratv.com/gallery-images/2018/05/GettyImages-960168704_full.jpg
            return src.replace(/_thumb(\.[^/.]*)$/, "_full$1");
        }

        if (domain === "media.extratv.com") {
            // https://media.extratv.com/2016/02/29/2016-02-gettyimages-513022330-100x100-3.jpg
            //   https://media.extratv.com/2016/02/29/2016-02-gettyimages-513022330-1000w-3.jpg
            //   https://media.extratv.com/2016/02/29/2016-02-gettyimages-513022330.jpg
            // https://media.extratv.com/2017/01/09/sophie-turner-getty-510x600.jpg
            //   https://media.extratv.com/2017/01/09/sophie-turner-getty.jpg
            return src.replace(/-(?:[0-9]+x[0-9]+|[0-9]+[wh])(?:-[0-9]+)?(\.[^/.]*)$/, "$1");
        }

        if (domain === "i.wpimg.pl") {
            // https://i.wpimg.pl/623x882/e5.pudelek.pl.sds.o2.pl/1d3e78c442bd58b4f81c5344b6b39c86f81702b0.jpg
            //   http://e5.pudelek.pl.sds.o2.pl/1d3e78c442bd58b4f81c5344b6b39c86f81702b0.jpg
            // https://i.wpimg.pl/O/352x600/i.wp.pl/a/f/film/033/87/07/0320787.jpg
            //   http://i.wp.pl/a/f/film/033/87/07/0320787.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/(?:[A-Z]\/)?[0-9]+x[0-9]+\//, "http://");
        }

        if (domain === "static.keptelenseg.hu") {
            // https://static.keptelenseg.hu/thumbs/thumb/p/16fe9d08d860f9ce6b525da7554ea66e.jpg
            //   https://static.keptelenseg.hu/p/16fe9d08d860f9ce6b525da7554ea66e.jpg
            return src.replace(/\/thumbs\/thumb\/p\//, "/p/");
        }

        if (domain_nosub === "wdfiles.com") {
            // http://daeren.wdfiles.com/local--resized-images/brendolyn/bren6.jpg/medium.jpg
            //   http://daeren.wdfiles.com/local--files/brendolyn/bren6.jpg
            return src.replace(/\/local--resized-images\/(.*\.[^/.]*)\/[a-z]+\.[^/.]*$/, "/local--files/$1");
        }

        if (domain_nowww === "astrofactor.com") {
            // https://astrofactor.com/imgs/celeb/120/9791-0.jpg
            //   https://astrofactor.com/imgs/celeb/full/9791-0.jpg
            return src.replace(/(\/imgs\/[^/]*\/)[0-9]+(\/[^/]*)$/, "$1full$2");
        }

        if (domain === "makeup.nuovogennarino.org") {
            // http://makeup.nuovogennarino.org/static/250/img/ksassets.timeincuk.net/wp/uploads/sites/46/2016/08/Emma-Watson-THUMB.jpg
            //   https://ksassets.timeincuk.net/wp/uploads/sites/46/2016/08/Emma-Watson-THUMB.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/static\/[0-9]+\/img\/([^/.]+\.[^/]+)/, "http://$1");
        }

        if (domain === "img.newsdog.today" ||
            amazon_container === "img.newsdog.today") {
            // http://img.newsdog.today/thumb_abb85c7b6d6e536b0cd70bc5a2d6227b
            //   http://img.newsdog.today/origin_abb85c7b6d6e536b0cd70bc5a2d6227b
            // https://s3.ap-south-1.amazonaws.com/img.newsdog.today/thumb_preview_3ddcb3d8e1cd57ce6b14ac92fd6cb866
            //   https://s3.ap-south-1.amazonaws.com/img.newsdog.today/origin_3ddcb3d8e1cd57ce6b14ac92fd6cb866
            return src.replace(/(img\.newsdog\.today\/)[a-z_]+_([a-f0-9]+)$/, "$1origin_$2");
        }

        if (domain === "d1qikntta4cp8k.cloudfront.net") {
            // https://d1qikntta4cp8k.cloudfront.net/?q=85&w=772&url=http://ksassets.timeincuk.net/wp/uploads/sites/46/2016/08/Emma-Watson-THUMB.jpg
            //   https://ksassets.timeincuk.net/wp/uploads/sites/46/2016/08/Emma-Watson-THUMB.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/.*?[?&]url=([^&]*)$/, "$1"));
        }

        if (domain_nosub === "img.com.ua") {
            // http://v.img.com.ua/b/1100x999999/f/ec/257f1798ba3954d99cb502145ec15ecf.jpg -- stretched
            //   http://v.img.com.ua/b/orig/f/ec/257f1798ba3954d99cb502145ec15ecf.jpg
            // http://bm.img.com.ua/berlin/storage/afisha/600x500/c/32/e2bca5867c6ef06310bf4d8210bda32c.jpg
            //   http://bm.img.com.ua/berlin/storage/afisha/orig/c/32/e2bca5867c6ef06310bf4d8210bda32c.jpg
            //return src.replace(/(:\/\/[^/]*\/[a-z]\/)[0-9]+x[0-9]+\//, "$1orig/");
            newsrc = src.replace(/\/[0-9]+x[0-9]+(\/[0-9a-f]\/[0-9a-f]{2}\/[0-9a-f]+\.[^/.]*)$/, "/orig$1");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain === "rs.img.com.ua") {
            // http://rs.img.com.ua/crop?v2=1&w=600&h=0&url=%2F%2Fv.img.com.ua%2Fb%2Forig%2F4%2Fdf%2F326931add26ff5064449f5b923643df4.jpg
            //   http://v.img.com.ua/b/orig/4/df/326931add26ff5064449f5b923643df4.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/crop.*?[?&]url=([^&]*).*?$/, "$1");
            if (newsrc !== src) {
                return urljoin(src, decodeURIComponent(newsrc));
            }
        }

        if (domain === "img-hw.xvideos.com") {
            // https://img-hw.xvideos.com/videos/profiles/galleries/c5/94/00/mbrisebois1963/gal1148191/pic_3_thumbl.jpg
            //   https://img-hw.xvideos.com/videos/profiles/galleries/c5/94/00/mbrisebois1963/gal1148191/pic_3_big.jpg
            return src.replace(/(\/pic_[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1_big$2");
        }

        if (domain === "camo.derpicdn.net") {
            // https://camo.derpicdn.net/08a79af4e43715ab9e20f943e912ded3c911b6e3?url=http%3A%2F%2Fi43.tinypic.com%2F2eusocg.png
            //   http://i43.tinypic.com/2eusocg.png
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/[0-9a-f]+\?url=([^&]*).*?$/, "$1"));
        }

        if (domain === "live.store.cmcm.com") {
            // http://live.store.cmcm.com/small/liveme/poster/a34c5fefc0d9ba2cae7dd989a1bfdefc_icon.jpeg
            //   http://live.store.cmcm.com/liveme/poster/a34c5fefc0d9ba2cae7dd989a1bfdefc_icon.jpeg
            return src.replace(/(:\/\/[^/]*\/)[a-z]+\/(liveme\/)/, "$1$2");
        }

        if (domain === "media.timeout.com") {
            // https://media.timeout.com/images/103349268/640/480/image.jpg
            //   https://media.timeout.com/images/103349268/image.jpg
            return src.replace(/(\/images\/[0-9]+\/)[0-9]+\/[0-9]+\/([^/]*)$/, "$1$2");
        }

        if (domain_nowww === "tokkoro.com") {
            // http://www.tokkoro.com/thumbs/2613254-emilia-clarke-computer-desktop-backgrounds.jpg
            //   http://tokkoro.com/picsup/2613254-emilia-clarke-computer-desktop-backgrounds.jpg
            return src.replace(/\/thumbs\//, "/picsup/");
        }

        if (domain === "picstatio.com") {
            // https://picstatio.com/thumb/kmuj1w/beautiful-actress-model-Margot-Robbie.jpg
            //   https://picstatio.com/large/kmuj1w/beautiful-actress-model-Margot-Robbie.jpg
            //   https://picstatio.com/u/kmuj1w/beautiful-actress-model-Margot-Robbie.jpg
            return src.replace(/(:\/\/[^/]*\/)(?:thumb|large)\//, "$1u/");
        }

        if (domain === "www.wallpapermaiden.com") {
            // http://www.wallpapermaiden.com/image/2017/06/17/model-brown-eyes-short-hair-earring-face-portrait-girls-16379-resized.jpg
            //   http://www.wallpapermaiden.com/image/2017/06/17/model-brown-eyes-short-hair-earring-face-portrait-girls-16379.jpg
            // http://www.wallpapermaiden.com/wallpaper/542/download/1700x1020/ciri-cosplay-the-witcher-3.jpg -- 1700x1020
            //   http://www.wallpapermaiden.com/wallpaper/542/ciri-cosplay-the-witcher-3
            //   http://www.wallpapermaiden.com/image/2016/06/08/ciri-cosplay-the-witcher-3-girls-542.jpg -- 2048x1283
            newsrc = src.replace(/(\/image\/[0-9]+\/[0-9]+\/[0-9]+\/[^/]*)-resized(\.[^/.]*)$/, "$1$2");
            if (newsrc !== src)
                return newsrc;

            var id = src.replace(/(\/wallpaper\/[0-9]+\/)download\/[0-9]+x[0-9]+\/([^/]*)\.[^/.]*(?:[?#].*)?$/,
                                 "$1$2");
            if (id !== src &&
                options && options.cb && options.do_request) {
                options.do_request({
                    url: id,
                    method: "GET",
                    onload: function(resp) {
                        if (resp.readyState === 4) {
                            var match = resp.responseText.match(/<meta *property="og:image" *content="([^"]*)"/);
                            if (match) {
                                options.cb(match[1]);
                            } else {
                                options.cb(null);
                            }
                        }
                    }
                });
            }
        }

        if (domain === "2ch.hk" ||
            // http://www.shisharc.com/vg/arch/2017-11-11/thumb/24469242/15101342791610s.jpg
            //   https://www.shisharc.com/vg/arch/2017-11-11/src/24469242/15101342791610.jpg -- doesn't work, but it's what's linked
            // https://www.shisharc.com/rf/thumb/3190059/15376372180120s.jpg
            //   https://www.shisharc.com/rf/src/3190059/15376372180120.png
            domain_nowww == "shisharc.com") {
            // https://2ch.hk/mov/arch/2018-01-11/thumb/1715093/15144001211300s.jpg
            //   https://2ch.hk/mov/arch/2018-01-11/src/1715093/15144001211300.jpg
            return add_extensions(src.replace(/\/thumb\/([0-9]+\/[0-9]+)s(\.[^/.]*)$/, "/src/$1$2"));
        }

        if (domain === "s.heavenlynudes.net" ||
            // http://s.nufap.com/194/953/194953594a03e39d850/thumbs/3222369594a03e3a023b.jpg
            domain === "s.nufap.com" ||
            // http://s.papajizz.com/227/096/22709658c972619c356/thumbs/353469058c972619efaa.jpg
            domain === "s.papajizz.com") {
            // http://s.heavenlynudes.net/085/279/085279556b1e0a7f645/thumbs/1620146556b1e0aa118c.jpg
            //   http://s.heavenlynudes.net/085/279/085279556b1e0a7f645/1620146556b1e0aa118c.jpg
            return src.replace(/\/thumbs\/([0-9a-f]+\.[^/.]*)$/, "/$1");
        }

        if (domain_nosub === "bbend.net" &&
            domain.match(/cdn[0-9]*\.bbend\.net/)) {
            // https://cdn6.bbend.net/media/com_news/galleries/2014/09/08/57412/photos/thumb/rihanna-5_0.jpg
            //   https://cdn6.bbend.net/media/com_news/galleries/2014/09/08/57412/photos/full/rihanna-5_0.jpg
            return src.replace(/\/photos\/thumb\/([^/]*)$/, "/photos/full/$1");
        }

        if (domain === "static.fustany.com") {
            // https://static.fustany.com/images/en/photo/large_thumb_Fustany-Celebrity_Style-Celebrities_on_the_Front_Row_at_New_York_Fashion_Week_Spring_2015-Rihanna-Altuzarra.jpg
            //   https://static.fustany.com/images/en/photo/small_Fustany-Celebrity_Style-Celebrities_on_the_Front_Row_at_New_York_Fashion_Week_Spring_2015-Rihanna-Altuzarra.jpg
            //   https://static.fustany.com/images/en/photo/large_Fustany-Celebrity_Style-Celebrities_on_the_Front_Row_at_New_York_Fashion_Week_Spring_2015-Rihanna-Altuzarra.jpg
            //   https://static.fustany.com/images/en/photo/Fustany-Celebrity_Style-Celebrities_on_the_Front_Row_at_New_York_Fashion_Week_Spring_2015-Rihanna-Altuzarra.jpg -- 2001x3000
            return {
                url: src.replace(/\/photo\/[a-z]+_([^/]*)$/, "/photo/$1"),
                headers: {
                    Referer: "http://fustany.com/en/fashion/celebrity-style/front-row-celebrities-at-new-york-fashion-week-spring-2015"
                }
            };
        }

        if (domain_nosub === "protv.md" &&
            domain.match(/^assets[0-9]*\.protv/)) {
            // http://assets.protv.md/articles/files/thumbs/650x/1424531.jpg
            //   http://retete.perfecte.md/assets/articles/images/original/1424531.jpg
            // http://assets1.protv.md/articles/files/thumbs/700x/3424711.jpg
            //   http://retete.perfecte.md/assets/articles/images/original/3424711.jpg
            return src.replace(/:\/\/[^/]*\/articles\/files\/thumbs\/[0-9]+x(?:[0-9]+)?(\/[0-9]+\.[^/.]*)$/,
                               "://retete.perfecte.md/assets/articles/images/original$1");
        }

        if (domain_nowww === "bgol.us" ||
            // https://defenceforumindia.com/forum/proxy.php?image=https%3A%2F%2Fwww.army.mil%2Fe2%2Fc%2Fimages%2F2017%2F03%2F31%2F472049%2Fsize0.jpg&hash=699d728bd8d19598da9dbd722e7f1a6f
            //   https://www.army.mil/e2/c/images/2017/03/31/472049/size0.jpg
            domain_nowww === "defenceforumindia.com") {
            // https://www.bgol.us/forum/proxy.php?image=http%3A%2F%2Fmedia.philstar.com%2Fimages%2Fthe-philippine-star%2Fsports%2F20150414%2Fpacquiao-rousey-2.jpg&hash=846f88cc38c91693da5f567184ee6d2f
            //   http://media.philstar.com/images/the-philippine-star/sports/20150414/pacquiao-rousey-2.jpg
            return decodeURIComponent(src.replace(/.*?\/forum\/proxy\.php.*?[?&]image=([^&]*).*?$/, "$1"));
        }

        if (domain === "resources.tidal.com") {
            // https://resources.tidal.com/images/30503edc/04d2/46d9/88dd/f3274fce9324/320x320.jpg
            //   https://resources.tidal.com/images/30503edc/04d2/46d9/88dd/f3274fce9324/origin.jpg
            return src.replace(/\/[0-9]+x[0-9]+(\.[^/.]*)$/, "/origin$1");
        }

        if (domain === "i.kfs.io") {
            // https://i.kfs.io/album/global/9442692,0v1/fit/500x500.jpg
            //   https://i.kfs.io/album/global/9442692,0v1/original.jpg
            return src.replace(/\/fit\/[0-9]+x[0-9]+(\.[^/.]*)$/, "/original$1");
        }

        if (domain_nosub === "fuskator.com") {
            // https://fuskator.com/small/iA3vsUWvpqT/thumb-1.jpg
            //   https://i9.fuskator.com/large/iA3vsUWvpqT/image-1.jpg
            return {
                url: src
                //.replace(/\/thumb-([0-9]*\.[^/.]*)$/, "/image-$1")
                    .replace(/(:\/\/[^/]*\/)small\//, "$1large/"),
                //.replace(/:\/\/fuskator\.com\//, "://i9.fuskator.com/");
                can_head: false
            };
        }

        if (domain === "ssref.net") {
            // http://ssref.net/scripts/image_resize.cgi?min=200&url=https://d3k2oh6evki4b7.cloudfront.net/req/201806211/images/headshots/e/e083ea50_davis.jpg
            //   https://d3k2oh6evki4b7.cloudfront.net/req/201806211/images/headshots/e/e083ea50_davis.jpg
            return decodeURIComponent(src.replace(/.*?\/image_resize\.cgi.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        if (domain_nosub === "m1905.cn" &&
            domain.match(/image[0-9]*\.m1905\.cn/)) {
            // http://image14.m1905.cn/uploadfile/2016/0802/thumb_0_647_500_20160802095117440123_watermark.jpg
            //   http://image14.m1905.cn/uploadfile/2016/0802/20160802095117440123.jpg
            return src.replace(/\/(?:thumb_[0-9]+_[0-9]+_[0-9]+_)?([0-9]+)(?:_watermark)?(\.[^/.]*)$/, "/$1$2");
        }

        if (domain_nosub === "intermedia.ge"/* &&
            domain.match(/server[0-9]*\.intermedia\.ge/)*/) {
            // http://server4.intermedia.ge/article_images/small/201401/2014012814022421579.jpg
            //   http://server4.intermedia.ge/article_images/large/201401/2014012814022421579.jpg
            // http://server1.intermedia.ge/pictures/small/180/180494.jpg?/prezidentis-sasaxle.jpg
            //   http://server1.intermedia.ge/pictures/original/180/180494.jpg?/prezidentis-sasaxle.jpg -- has watermark
            // http://server1.intermedia.ge/pictures/original/187/187829.jpg?/qarTuli-silamaze.jpg -- no watermark
            // http://intermedia.ge/uploads/article_images2/small/13689792768013.jpg
            //   http://intermedia.ge/uploads/article_images2/large/13689792768013.jpg
            return src
                .replace(/(\/article_images[0-9]*\/)[a-z]+\//, "$1large/")
                .replace(/\/pictures\/[a-z]+\//, "/pictures/original/");
        }

        if (domain === "www.sqshi.com") {
            // http://www.sqshi.com/img.php?imgurl=http://mmbiz.qpic.cn/mmbiz/tjGXef7Wic6vJYcWwicP133lkTsaxoxFEzZX9MYBhUc3puACLiaWesCjqYXjvyt3cYKV0EeQgvEjYQgaGdRAe4FSw/0?wx_fmt=jpeg
            //   http://mmbiz.qpic.cn/mmbiz/tjGXef7Wic6vJYcWwicP133lkTsaxoxFEzZX9MYBhUc3puACLiaWesCjqYXjvyt3cYKV0EeQgvEjYQgaGdRAe4FSw/0?wx_fmt=jpeg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/img\.php.*?[?&]imgurl=([^&]*).*?$/, "$1"));
        }

        if (domain === "i.annihil.us") {
            // http://i.annihil.us/u/prod/marvel/i/mg/5/b0/4f872edbcddde/detail.jpg -- 550x853
            //   http://i.annihil.us/u/prod/marvel/i/mg/5/b0/4f872edbcddde/clean.jpg -- 1816x2816
            return src.replace(/(\/[0-9a-f]+\/)detail(\.[^/.]*)$/, "$1clean$2");
        }

        if (domain === "pimg.mycdn.me" ||
            // https://s4.sywcdn.net/getImage?url=https%3A%2F%2Fimages.homedepot-static.com%2FproductImages%2Ff4e34aad-9d82-46c9-a38f-a1175e50de09%2Fsvn%2Fiq-america-door-chimes-kits-245821-64_1000.jpg&t=Product&w=1500&h=1500&qlt=100&mrg=1&str=1&s=7a5e0893f3afb59a6c1764ea32ecda8f
            //   https://images.homedepot-static.com/productImages/f4e34aad-9d82-46c9-a38f-a1175e50de09/svn/iq-america-door-chimes-kits-245821-64_1000.jpg
            (domain_nosub === "sywcdn.net" && domain.match(/^s[0-9]*\./))) {
            // https://pimg.mycdn.me/getImage?url=http%3A%2F%2Fcdn.ok-magazine.ru%2Fcdn%2Ffarfuture%2FTNYbFLIgxMSinQm9JCDwPwuBARaukO40WV04KXprx8A%2Fmtime%3A1474324275%2Fsites%2Fdefault%2Ffiles%2Fstyles%2F620_620_2014%2Fpublic%2Flll_d34_05759_r.jpg%3Fitok%3DwFNbCbKo&type=WIDE_FEED_PANORAMA&signatureToken=2DySh4jD-d-_4Gmusanj_Q
            //   http://cdn.ok-magazine.ru/cdn/farfuture/TNYbFLIgxMSinQm9JCDwPwuBARaukO40WV04KXprx8A/mtime:1474324275/sites/default/files/styles/620_620_2014/public/lll_d34_05759_r.jpg?itok=wFNbCbKo
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/getImage.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        if (domain === "www.dissidia-france.com") {
            // http://www.dissidia-france.com/news/18-04-18/small/artwork.jpg
            //   http://www.dissidia-france.com/news/18-04-18/big/artwork.jpg
            return src.replace(/\/small\/([^/]*)$/, "/big/$1");
        }

        if (domain === "cdn.asiatatler.com" ||
            // http://indonesiatatler.com/images/i/gallery1-20170507132916-DakotaFanningJimmyChoo5_resized_600x900.jpg
            //   http://indonesiatatler.com/images/i/gallery1-20170507132916-DakotaFanningJimmyChoo5.jpg
            domain_nowww === "indonesiatatler.com") {
            // https://cdn.asiatatler.com/asiatatler/hk/i/2018/06/01110551-JessicaAlba-HEROshot-1920x1200_cropped_1584x780.jpg
            //   https://cdn.asiatatler.com/asiatatler/hk/i/2018/06/01110551-JessicaAlba-HEROshot-1920x1200.jpg
            // https://cdn.asiatatler.com/asiatatler/hk/i/2018/07/17163159-EmmaWatson_resized_1333x2000.jpg
            //   https://cdn.asiatatler.com/asiatatler/hk/i/2018/07/17163159-EmmaWatson.jpg
            return src.replace(/_(?:cropped|resized)_[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "stylowi.pl" &&
            domain.match(/^img[0-9]*\.stylowi\.pl/)) {
            // http://img1.stylowi.pl//images/items/s/201605/stylowi_pl_fotografia_jessica-alba_44333333.jpg -- 210x294
            //   http://img1.stylowi.pl//images/items/m/201605/stylowi_pl_fotografia_jessica-alba_44333333.jpg -- 440x642
            //   http://img1.stylowi.pl//images/items/l/201605/stylowi_pl_fotografia_jessica-alba_44333333.jpg -- 740x1062
            //   http://img1.stylowi.pl//images/items/o/201605/stylowi_pl_fotografia_jessica-alba_44333333.jpg -- 870x1244
            return src.replace(/\/images\/items\/[a-z]\//, "/images/items/o/");
        }

        if (domain === "files.dals.media") {
            // https://files.dals.media/mediafiles/image/2018/05/07/10-NbyVVd__prev__.jpg
            //   https://files.dals.media/mediafiles/image/2018/05/07/10-NbyVVd__original__.jpg
            return src.replace(/__[a-z]+__(\.[^/.]*)$/, "__original__$1");
        }

        if (domain === "media.linkonlineworld.com") {
            // http://media.linkonlineworld.com/img/large/2018/4/28/2018_4_28_14_10_17_815.jpg
            //   http://media.linkonlineworld.com/img/original/2018/4/28/2018_4_28_14_10_17_815.jpg
            return src.replace(/\/img\/large\//, "/img/original/");
        }

        if (amazon_container === "marieclairebucket") {
            // https://marieclairebucket.s3.amazonaws.com/release/0usr_636376812121056000460x547.jpg
            //   https://marieclairebucket.s3.amazonaws.com/release/0usr_636376812121056000.jpg
            //   https://s3.amazonaws.com/marieclairebucket/release/0usr_636376812121056000.jpg
            // https://marieclairebucket.s3.amazonaws.com/release/0usr_636376812130728000286x334.jpg
            //   https://marieclairebucket.s3.amazonaws.com/release/0usr_636376812130728000286x334.jpg
            return src.replace(/000[0-9]+?x[0-9]+(\.[^/.]*)$/, "000$1");
        }

        if (domain_nosub === "nh.ee") {
            // http://g3.nh.ee/images/pix/376x250/bJ9--ccu2TI/foto-scanpix-75111475.jpg
            //   http://g3.nh.ee/images/pix/bJ9--ccu2TI/foto-scanpix-75111475.jpg
            // http://g2.nh.ee/images/pix/376x250/Oi8Ia67GlU8/reserved-81831817.jpg
            //   http://g2.nh.ee/images/pix/Oi8Ia67GlU8/reserved-81831817.jpg
            return src.replace(/\/images\/pix\/[0-9]+x[0-9]+\//, "/images/pix/");
        }

        if (domain === "read.html5.qq.com" ||
            // https://cdn.read.html5.qq.com/image?src=circle&q=5&r=0&imgflag=7&cdn_cache=24&imageUrl=http%3A%2F%2Fp%2Eqpic%2Ecn%2Fmttcircle%2F3059959958%2F11105527854m656647i1009437104_201803w01_7da7ec0a99792967531853d3e42132f8%2Ejp%2F0
            //   http://p.qpic.cn/mttcircle/3059959958/11105527854m656647i1009437104_201803w01_7da7ec0a99792967531853d3e42132f8.jp/0
            domain === "cdn.read.html5.qq.com") {
            // http://read.html5.qq.com/image?src=forum&q=5&r=0&imgflag=7&imageUrl=https://mmbiz.qpic.cn/mmbiz/HiaNy8LPboMzo9U0Dg38XibJQia6sicM2D26icquxZic0eRPVRNLGDSMYu2tgnZ6RjqOaZEJ3608def8gpZEicX2WAM2Q/0
            //   https://mmbiz.qpic.cn/mmbiz/HiaNy8LPboMzo9U0Dg38XibJQia6sicM2D26icquxZic0eRPVRNLGDSMYu2tgnZ6RjqOaZEJ3608def8gpZEicX2WAM2Q/0
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/image.*?[?&]imageUrl=([^&]*).*?$/, "$1"));
        }

        if (domain === "img.chuansong.me" ||
            // http://img.weiduba.net/mmbiz_png/3WKoAveGcfiaeOJ4S2270mgicByQTWNK6mHbOXIDInFbic6WolbkXtOta2r1waAToJlhCTI2sLU0iap77iabCvNJ0qg/640?wx_fmt=png
            domain === "img.weiduba.net" ||
            // http://img1.jinciwei.cn/mmbiz_jpg/Mczq9OQm09bQqk9NXJIeWJJ0wfOHfsicHrdmLbdIdEW0qnZJKOXCFGGdENWwdXiceE0vJlcJQoonnDzhib0y9y59g/640?wx_fmt=jpeg&wx_lazy=1
            //   http://mmbiz.qpic.cn/mmbiz_jpg/Mczq9OQm09bQqk9NXJIeWJJ0wfOHfsicHrdmLbdIdEW0qnZJKOXCFGGdENWwdXiceE0vJlcJQoonnDzhib0y9y59g/640?wx_fmt=jpeg&wx_lazy=1
            (domain_nosub === "jinciwei.cn" && domain.match(/img[0-9]*\./))) {
            // http://img.chuansong.me/mmbiz/6sMn1CfyttCg3RjpIOT9Io9a0zaYCC7ZwuEmjTDj71TeOGfyWXsyCC96mQib9Hr7CCtw6J39BcMdz0eiauOVfjlw/0?wx_fmt=jpeg
            //   http://mmbiz.qpic.cn/mmbiz/6sMn1CfyttCg3RjpIOT9Io9a0zaYCC7ZwuEmjTDj71TeOGfyWXsyCC96mQib9Hr7CCtw6J39BcMdz0eiauOVfjlw/0?wx_fmt=jpeg
            return src.replace(/:\/\/[^/]*\/(mmbiz(?:_[a-z]+)?)\//, "://mmbiz.qpic.cn/$1/");
        }

        if (domain === "cdn.iguang.co") {
            // https://cdn.iguang.co/22c037fc/mmbiz_jpg/m472J5FqZ3jdicDcgFIwdru4GkTR8iaTeAlJv5C2Swmtb7NeOkEiaBvDvBO82VJaXrSpeDRCBKqicJbmibUxZicZUp2A/0?wx_fmt=jpeg
            //   https://mmbiz.qpic.cn/mmbiz_jpg/m472J5FqZ3jdicDcgFIwdru4GkTR8iaTeAlJv5C2Swmtb7NeOkEiaBvDvBO82VJaXrSpeDRCBKqicJbmibUxZicZUp2A/0?wx_fmt=jpeg
            return src.replace(/:\/\/[^/]*\/[0-9a-f]+\/(mmbiz(?:_[a-z]+)?)\//, "://mmbiz.qpic.cn/$1/");
        }

        if (domain === "pic.kuaizhan.com") {
            // http://pic.kuaizhan.com/g2/M01/2A/74/CgpQVFXS1uWAaQTSAAGAmL2_SsY8922594/imageView/v1/thumbnail/640x0
            //   http://pic.kuaizhan.com/g2/M01/2A/74/CgpQVFXS1uWAaQTSAAGAmL2_SsY8922594
            return src.replace(/\/imageView\/v[0-9]*\/.*/, "");
        }

        if ((domain_nosub === "popcornnews.ru" && domain.match(/v[0-9]*\.popcornnews\.ru/)) ||
            // https://static.kinoafisha.info/k/news/580/upload/news_images/0/2/6/8329620/e4d9a81021ca2590a28746e13f900da1.jpeg
            //   https://static.kinoafisha.info/upload/news_images/0/2/6/8329620/e4d9a81021ca2590a28746e13f900da1.jpeg
            // https://static.kinoafisha.info/k/fests/600/upload/fests/4/5/0/54/c0c0606483cd423c088ba8b8da169d68.jpeg
            //   https://static.kinoafisha.info/upload/fests/4/5/0/54/c0c0606483cd423c088ba8b8da169d68.jpeg
            domain === "static.kinoafisha.info") {
            // http://v1.popcornnews.ru/k/news/500x700/upload/news_images/9/3/3/146339/f05d636fe83741bcbd1f870f019c8e26.jpg
            //   http://v1.popcornnews.ru/upload/news_images/9/3/3/146339/f05d636fe83741bcbd1f870f019c8e26.jpg -- no watermark
            return src.replace(/(:\/\/[^/]*\/)[a-z]+\/[a-z]+\/[0-9]+(?:x[0-9]+)?\/upload\//, "$1upload/");
        }

        if (domain_nowww === "amorq.com" ||
            // http://prikolno.cc/uploads/tumb/img/201609/4eec60a6f7b93d8ec969fe7708b209d6_tumb_660.jpg -- stretched
            //   http://prikolno.cc/uploads/img/201609/4eec60a6f7b93d8ec969fe7708b209d6.jpg
            domain_nowww === "prikolno.cc" ||
            // http://obaldenno.com/uploads/tumb/title/201706/all-inclusive-buffet-breakfast_tumb_340.jpg
            //   http://obaldenno.com/uploads/title/201706/all-inclusive-buffet-breakfast.jpg
            // http://obaldenno.com/uploads/tumb/img/201703/dehjjzi-ridli-foto-daisy-ridley-photo-4_1490809870_tumb_660.jpg
            //   http://obaldenno.com/uploads/img/201703/dehjjzi-ridli-foto-daisy-ridley-photo-4_1490809870.jpg
            domain_nowww === "obaldenno.com") {
            // http://amorq.com/uploads/tumb/img/201802/9cgewbn_tumb_660.jpg
            //   http://amorq.com/uploads/img/201802/9cgewbn.jpg
            return src.replace(/\/uploads\/tumb(\/[a-z]+\/[0-9]+\/[^/.]+)_tumb_[0-9]+(\.[^/.]*)$/, "/uploads$1$2");
        }

        if (domain_nosub === "pinme.ru" &&
            domain.match(/^cdn/)) {
            // https://cdn-nus-1.pinme.ru/tumb/600/photo/af/70/af708c3de5366834ec0f44dac99d4150.jpg
            //   https://cdn-nus-1.pinme.ru/photo/af/70/af708c3de5366834ec0f44dac99d4150.jpg
            // https://cdn-nus-1.pinme.ru/tumb/600//photo/02/a0/02a0a85155afa459cc04b295ea487d9c.jpg
            //   https://cdn-nus-1.pinme.ru/photo/02/a0/02a0a85155afa459cc04b295ea487d9c.jpg
            return src.replace(/\/+tumb\/+[0-9]+\/+photo\//, "/photo/");
        }

        if (domain_nosub === "postila.ru" &&
            domain.match(/^img[0-9]*\.postila\.ru/)) {
            // https://img11.postila.ru/resize?w=660&src=%2Fdata%2F88%2F12%2F77%2F41%2F8812774170b8f5379e1d15f676b1937c89c1ff8c8662136e557a7bc1145609f4.jpg
            //   https://img11.postila.ru/data/88/12/77/41/8812774170b8f5379e1d15f676b1937c89c1ff8c8662136e557a7bc1145609f4.jpg
            return urljoin(src, decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/resize.*?[?&]src=([^&]*).*?$/, "$1")), true);
        }

        if (domain_nowww === "enolivier.com" ||
            // http://www.fotoventasdigital.com/img/jessica-alba-company/_thumb/chic-parisdiaper-jessica-honest-company-sued-again-in-false-advertising-plus-jessica-alba-at-a-launch-event-then-honest-springtime_jessica-alba-company_250x250.jpg
            //   http://www.fotoventasdigital.com/img/jessica-alba-company/_fullsize/chic-parisdiaper-jessica-honest-company-sued-again-in-false-advertising-plus-jessica-alba-at-a-launch-event-then-honest-springtime_jessica-alba-company.jpg
            domain_nowww === "fotoventasdigital.com") {
            // http://enolivier.com/img/jessica-alba-company/_thumb/excellent-false-advertising-for-parisdiaper-jessica-honest-company-sued-again-together-with-jessica-alba-at-a-launch-event-also-honest-springtime_jessica-alba-company_250x250.jpg
            //   http://enolivier.com/img/jessica-alba-company/_fullsize/excellent-false-advertising-for-parisdiaper-jessica-honest-company-sued-again-together-with-jessica-alba-at-a-launch-event-also-honest-springtime_jessica-alba-company.jpg
            return src.replace(/\/_thumb\/([^/]*)_[0-9]+x[0-9]+(\.[^/.]*)$/, "/_fullsize/$1$2");
        }

        if (domain === "ss.metronews.ru") {
            // https://ss.metronews.ru/userfiles/materials/116/1160022/858x540.jpg
            //   https://ss.metronews.ru/userfiles/materials/116/1160022/origin.jpg
            return src.replace(/(\/userfiles\/materials\/[0-9]+\/[0-9]+\/)[0-9]+x[0-9]+(\.[^/.]*)$/, "$1origin$2");
        }

        if (domain_nosub === "mtvnimages.com") {
            // http://vh1.mtvnimages.com/uri/mgid:file:http:shared:vh1.com/news/uploads/sites/2/2018/03/GettyImages-873076880-1522090083.jpg
            //   http://vh1.com/news/uploads/sites/2/2018/03/GettyImages-873076880-1522090083.jpg
            //   http://www.vh1.com/news/uploads/sites/2/2018/03/GettyImages-873076880-1522090083.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/uri\/mgid:file:(https?):shared:([^/:]*\/)/, "$1://$2");
        }

        if (domain_nowww === "vh1.com") {
            // http://www.vh1.com/news/uploads/sites/2/2018/03/GettyImages-873076880-1522090083.jpg
            return {
                url: src,
                can_head: false
            };
        }

        if (domain === "user-uploads.aznude.com") {
            // https://user-uploads.aznude.com/data/thumbs/victoriajustice/OZUWG5DPOJUWCLLKOVZXI2LDMUWXGZLYPEWTCNZNOBUG65DPOMWWO2LGOM======/TheFappeningBlog.com-Victoria-Justice-Sexy-13.jpg
            //   https://user-uploads.aznude.com/data/azncdn/victoriajustice/OZUWG5DPOJUWCLLKOVZXI2LDMUWXGZLYPEWTCNZNOBUG65DPOMWWO2LGOM======/TheFappeningBlog.com-Victoria-Justice-Sexy-13.jpg
            return src.replace(/(:\/\/[^/]*\/data\/)thumbs\//, "$1azncdn/");
        }

        if (domain_nowww === "bstars.eu") {
            // https://www.bstars.eu/media/djcatalog2/images/item/11/victoria-justice.2_f.jpg
            //   https://www.bstars.eu/media/djcatalog2/images/item/11/victoria-justice.2.jpg
            return src.replace(/(\/media\/djcatalog2\/.*\.[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "media.toofab.com" ||
            // https://toofab.akamaized.net/2017/03/16/2016-08-gettyimages-591898736-1000w.jpg
            //   https://toofab.akamaized.net/2017/03/16/2016-08-gettyimages-591898736.jpg
            domain === "toofab.akamaized.net") { // doesn't work for all urls
            // works:
            // https://media.toofab.com/2017/12/13/gettyimages-891360920-master-1000w.jpg
            // https://media.toofab.com/2017/12/13/gettyimages-891258416-master-1000w.jpg
            // doesn't work:
            // https://media.toofab.com/2017/10/31/screen-shot-2017-10-31-at-3-57-1000w.jpg (300x250 works)
            src = src.replace(/-[0-9]+w\.([^/.]*)/, ".$1");

            // works:
            // https://media.toofab.com/2018/01/02/stars-who-refuse-to-take-selfies-with-fans-split-480x360.jpg (1000w works too)
            // doesn't work: (access denied)
            // https://media.toofab.com/2018/01/02/0102-justin-timberlake-main-300x250.jpg
            // https://media.toofab.com/2018/01/02/0102-justin-timberlake-main-810x610.jpg
            // https://media.toofab.com/2017/10/23/gettyimages-844434368-810x610.jpg
            // https://media.toofab.com/2018/01/02/traveling-pants-everett-300x400.jpg
            // https://media.toofab.com/2017/11/01/timberlake-teaser-480x360.jpg
            // https://media.toofab.com/2017/12/22/1222-tom-katie-lala-main-300x250.jpg
            src = src.replace(/-[0-9]+x[0-9]+\.([^/.]*)/, ".$1");

            return src;
        }

        if (domain === "thumb.tvpalace.org") {
            // http://thumb.tvpalace.org/actor/victoria-justice/w75_6C.jpg
            //   http://thumb.tvpalace.org/actor/victoria-justice/6C.jpg
            return src.replace(/\/[wh][0-9]+_([^/]*\.[^/.]*)$/, "/$1");
        }

        if (domain_nowww === "mafab.hu") {
            // https://mafab.hu/static/thumb/w150/profiles/2014p/293/05/277358_18.jpg
            //   https://mafab.hu/static/profiles/2014p/293/05/277358_18.jpg
            return src.replace(/\/static\/thumb\/[wh][0-9]+\//, "/static/");
        }

        if (domain === "film.kinootziv.com" ||
            // http://static2.moviesfan.org/source/files/artists_photos_thumbs/dani/215480-danielle-panabaker509381.jpg
            //   http://static2.moviesfan.org/source/files/artists_photos/dani/215480-danielle-panabaker509381.jpg
            (domain_nosub === "moviesfan.org" && domain.match(/^static/)) ||
            // http://kinokach.com/source/files/artists_photos_thumbs/vict/victoriajustice297913.jpg
            //   http://www.kinokach.com/source/files/artists_photos/vict/victoriajustice297913.jpg
            domain_nowww === "kinokach.com") {
            // http://film.kinootziv.com/source/files/films_images_thumbs/vikt/viktoriya44022.jpg
            //   http://film.kinootziv.com/source/files/films_images/vikt/viktoriya44022.jpg
            return src.replace(/(:\/\/[^/]*\/source\/files\/[^/]*)_thumbs\//, "$1/");
        }

        if (amazon_container === "harmony-assets-live") {
            // http://harmony-assets-live.s3.amazonaws.com/image_source/7d/5f/7d5fc9007db632d8ce71fe01f00429732b3dad80.jpg
            return {
                src: url,
                can_head: false
            };
        }

        if (domain === "cdn.kme.si") {
            // https://cdn.kme.si/public/images-cache/750xX/2015/08/21/64f048b69f69d7ff3a1508a5b6b15d85/55d7408f5f4ec/64f048b69f69d7ff3a1508a5b6b15d85.jpeg
            //   https://cdn.kme.si/public/images/2015/08/21/64f048b69f69d7ff3a1508a5b6b15d85.jpeg
            return src.replace(/\/public\/images-cache\/[0-9X]+x[0-9X]+\/([0-9]+\/[0-9]+\/[0-9]+\/)[0-9a-f]+\/[0-9a-f]+\/([0-9a-f]+\.[^/.]*)$/,
                               "/public/images/$1$2");
        }

        if (domain_nosub === "slidely.com" &&
            domain.match(/cdn\.slidely\.com$/)) {
            // https://ak02-cdn.slidely.com/img-proxy/images.coveralia.com/autores/fotos/victoria-justice26398.jpg
            //   http://images.coveralia.com/autores/fotos/victoria-justice26398.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/img-proxy\//, "http://");
        }

        if (domain_nosub === "hochu.ua") {
            // https://img2.hochu.ua//thumbnails/articles/cropm_568x568/67199_191683.jpg
            //   https://img2.hochu.ua//images/articles/67199_191683.jpg
            //   https://www.hochu.ua/images/articles/67199_191683.jpg
            return src.replace(/\/thumbnails\/articles\/crop[a-z]*_[0-9]+x[0-9]+\//, "/images/articles/");
        }

        if (domain === "media.professionali.ru") {
            // https://media.professionali.ru/processor/topics/size1/2016/06/02/001.jpg
            //   https://media.professionali.ru/processor/topics/original/2016/06/02/001.jpg
            return src.replace(/(\/processor\/[a-z]+\/)[^/]*\//, "$1original/");
        }

        if (domain_nowww === "stars-naked.ru") {
            // http://www.stars-naked.ru/pictures/Panabaker_Danielle/prev/s_od15tI-fmsc.jpg
            //   http://stars-naked.ru/pictures/Panabaker_Danielle/big/big_od15tI-fmsc.jpg
            //   http://stars-naked.ru/pictures/Panabaker_Danielle/od15tI-fmsc.jpg
            // http://www.stars-naked.ru/pictures/Panabaker_Danielle/prev/med_GvWz23ts7OA.jpg
            //   http://www.stars-naked.ru/pictures/Panabaker_Danielle/GvWz23ts7OA.jpg
            return src.replace(/(:\/\/[^/]*\/pictures\/[^/]*\/)[^/]*\/[a-z]+_([^/]*)$/, "$1$2");
        }

        if (domain_nowww === "avsforum.com" ||
            // http://www.sitcomsonline.com/photopost/data/3696/thumbs/Peyton_List_in_Bunk_d_2015_.jpg
            //   http://www.sitcomsonline.com/photopost/data/3696/Peyton_List_in_Bunk_d_2015_.jpg
            domain_nowww === "sitcomsonline.com") {
            // https://www.avsforum.com/photopost/data/2148226/thumbs/1/11/11ec6f6e_Danielle-Panabaker-Blue.jpeg
            //   https://www.avsforum.com/photopost/data/2148226/1/11/11ec6f6e_Danielle-Panabaker-Blue.jpeg
            return src.replace(/(\/photopost\/data\/[0-9]+\/)thumbs\//, "$1");
        }

        if (domain_nowww === "pgmscreen.fr") {
            // http://www.pgmscreen.fr/protect.php?src=http://www.pgmscreen.fr/galerie/medium/med-WycxRxXQ2G-02-08-2016.jpg
            //   http://www.pgmscreen.fr/galerie/medium/med-WycxRxXQ2G-02-08-2016.jpg
            // http://www.pgmscreen.fr/watermark.php?src=http://www.pgmscreen.fr/galerie/grande/max-WycxRxXQ2G-02-08-2016.jpg
            //   http://www.pgmscreen.fr/galerie/grande/max-WycxRxXQ2G-02-08-2016.jpg
            newsrc = decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/(?:protect|watermark)\.php.*?[?&]src=([^&]*).*?$/, "$1"));
            if (newsrc !== src)
                return newsrc;
            return src.replace(/\/galerie\/[a-z]+\/[a-z]+-/, "/galerie/grande/max-");
        }

        if (domain === "celeb.gate.cc") {
            // http://celeb.gate.cc/media/cache/headshot/upload/d/a/danielle-panabaker-leather-874342.jpeg
            //   http://celeb.gate.cc/media/cache/original/upload/d/a/danielle-panabaker-leather-874342.jpeg
            return src.replace(/(:\/\/[^/]*\/media\/cache\/)[a-z]+\/upload\//, "$1original/upload/");
        }

        if (domain_nowww === "modagid.ru") {
            // http://modagid.ru/files/photos/imgs/356/356155/large_danielle-panabaker-at-2017-entertainment-weekly-pre-emmy-party-in-west-hollywood-09-15-2017_1.jpg?1505575192
            //   http://modagid.ru/files/photos/imgs/356/356155/original_danielle-panabaker-at-2017-entertainment-weekly-pre-emmy-party-in-west-hollywood-09-15-2017_1.jpg?1505575192
            return src.replace(/(\/files\/photos\/imgs\/[0-9]+\/[0-9]+\/)[a-z]+_/, "$1original_");
        }

        if (domain_nowww === "zdf.de" &&
            src.indexOf("/assets/") >= 0) {
            // https://www.zdf.de/assets/teletext-dpa-image-der-eisberg-vor-der-groenlaendischen-kueste-am-dorf-innaarsuit-100~2400x1350?cb=1531503697356
            //   https://www.zdf.de/assets/teletext-dpa-image-der-eisberg-vor-der-groenlaendischen-kueste-am-dorf-innaarsuit-100~original?cb=1531503697356
            return src.replace(/~[0-9]+x[0-9]+([?#].*)?$/, "~original$1");
        }

        if (domain_nowww === "arcinfo.ch" ||
            // https://www.lacote.ch/media/image/71/normal_16_9/348625165-1.jpg
            //   https://www.lacote.ch/media/image/71/348625165-1.jpg
            domain_nowww === "lacote.ch") {
            // https://www.arcinfo.ch/media/image/71/small_16_9/348625165-1.jpg
            //   https://www.arcinfo.ch/media/image/71/348625165-1.jpg
            return src.replace(/(\/media\/image\/[0-9]*\/)[^/]*\/([0-9]+-[0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "gulf365.co" ||
            // https://www.alsharqtimes.com/temp/resized/medium_2018-07-14-12a167f5c5.jpg -- stretched
            //   https://www.alsharqtimes.com/content/uploads/2018/07/14/12a167f5c5.jpg
            domain_nowww === "alsharqtimes.com") {
            // http://www.gulf365.co/temp/thumb/320x190_uploads,2018,07,15,bdc0651fec.jpg
            //   http://www.gulf365.co/content/uploads/2018/07/15/bdc0651fec.jpg
            // http://www.gulf365.co/temp/resized/medium_2017-08-19-bbb37bcbc2.jpg
            //   http://www.gulf365.co/content/uploads/2017/08/19/bbb37bcbc2.jpg
            return src
                .replace(/(:\/\/[^/]*\/)temp\/(?:thumb|resized)\/[^-/_.]+_uploads,([0-9]+),([0-9]+),([0-9]+),([0-9a-f]+\.[^/.]*)$/,
                         "$1content/uploads/$2/$3/$4/$5")
                .replace(/(:\/\/[^/]*\/)temp\/(?:thumb|resized)\/[a-z]+_([0-9]+)-([0-9]+)-([0-9]+)-([0-9a-f]+\.[^/.]*)$/,
                         "$1content/uploads/$2/$3/$4/$5")
        }

        if (domain_nowww === "aljazeera.com") {
            // https://www.aljazeera.com/mritems/imagecache/mbdresplarge/mritems/Images/2018/7/15/6e6bcf4305f34f38831be340b4912535_18.jpg
            //   https://www.aljazeera.com/mritems/Images/2018/7/15/6e6bcf4305f34f38831be340b4912535_18.jpg
            return src.replace(/\/mritems\/imagecache\/[^/]*\/mritems\//, "/mritems/");
        }

        if (domain === "media.publika.md") {
            // https://media.publika.md/md/image/201807/w400/aisberg-groelanda_99594600.jpg
            //   https://media.publika.md/md/image/201807/full/aisberg-groelanda_99594600.jpg
            return src.replace(/\/[wh][0-9]+\/([^/]+_[0-9]+\.[^/.]*)$/, "/full/$1");
        }

        if (domain === "www1.wdr.de") {
            // https://www1.wdr.de/kinder/radio/kiraka/nachrichten/klicker/eisberg-bedroht-dorf-in-groenland100~_v-gseaclassicxl.jpg
            //   https://www1.wdr.de/kinder/radio/kiraka/nachrichten/klicker/eisberg-bedroht-dorf-in-groenland100~_v-original.jpg
            return src.replace(/~_v-[a-z0-9]+(\.[^/.]*)$/, "~_v-original$1");
        }

        if (domain_nowww === "xrimaonline.gr") {
            // https://www.xrimaonline.gr/photos/c_450px_255px/articles/201807/groilandia_pagobouno.jpg
            //   https://www.xrimaonline.gr/photos/w_999999999999px/articles/201807/groilandia_pagobouno.jpg
            // uses gdthumb to resize:
            // https://github.com/mewebstudio/Phpthumb/blob/master/src/Mews/Phpthumb/lib/GdThumb.inc.php
            return src.replace(/\/photos\/[a-z]_[0-9]+px[^/]*\/articles\//, "/photos/w_999999999999px/articles/");
        }

        if (domain_nosub === "avisen.dk" &&
            domain.match(/^media[0-9]*\.avisen\.dk/)) {
            // https://media2.avisen.dk/GetImage.ashx?imageid=10902044&sizeid=37
            //   https://media2.avisen.dk/GetImage.ashx?imageid=10902044&sizeid=255
            // https://media2.avisen.dk/GetImage.ashx?imageid=9837228&sizeid=255 -- 4928x3280
            // 255, {52,27}, 30, 36, 49, 25, 26, {4, 33, 34, 32, 28, 10}, {51, 37}, 31, 23, 8, 14, 29, 50, 16, 46, 44, {45, 41}, 3, {20, 15}, 19, 47, 7, 18, {5, 40, 35, 2}, 39, 43, 22, 11, {24, 9, 42, 38}, 13, 21, 17, 6, {48, 0}
            return src.replace(/([?&]sizeid=)[0-9]+/, "$1255");
        }

        if (domain_nowww === "elimparcial.es" &&
            src.indexOf("/fotos/") >= 0) {
            // https://www.elimparcial.es/fotos/1/53175_636670785479221072w_thumb_570.jpg
            //   https://www.elimparcial.es/fotos/1/53175_636670785479221072w.jpg
            return src.replace(/_thumb_[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nosub === "agora.md" &&
            domain.match(/^st[0-9]*\.agora\.md/)) {
            // http://st2.agora.md/news/medium/video--un-sat-din-groenlanda--amenintat-de-un-ghetar-urias--ce-risca-localnicii-47637.jpg
            //   http://st2.agora.md/news/big/video--un-sat-din-groenlanda--amenintat-de-un-ghetar-urias--ce-risca-localnicii-47637.jpg
            return src.replace(/(:\/\/[^/]*\/news\/)[a-z]+\//, "$1big/");
        }

        if (domain_nowww === "demokrathaber.org") {
            // https://www.demokrathaber.org/images/resize/100/600x315/haberler/2018/07/gronland_da_bir_koy_devasa_buzdaginin_tehdidi_altinda_h104638_1e4e3.jpg
            //   https://demokrathaber.org/images/haberler/2018/07/gronland_da_bir_koy_devasa_buzdaginin_tehdidi_altinda_h104638_1e4e3.jpg
            return src.replace(/\/images\/resize\/[0-9]+\/[0-9]+x[0-9]+\//, "/images/");
        }

        if (domain === "imgl.krone.at") {
            // https://imgl.krone.at/scaled/1739548/v435e9c/630x356
            //   https://imgl.krone.at/scaled/1739548/v435e9c/full
            return src.replace(/(\/scaled\/[0-9]+\/[0-9a-z]+\/)[0-9]+x[0-9]+([?#].*)?$/, "$1full$2");
        }

        if (domain_nowww === "elfinanciero.com.mx" &&
            src.indexOf("/uploads/") >= 0) {
            // http://www.elfinanciero.com.mx/uploads/2018/07/13/a4666cd9e11531496851_standard_desktop_medium.jpeg
            //   http://www.elfinanciero.com.mx/uploads/2018/07/13/a4666cd9e11531496851.jpeg
            return src.replace(/(\/[0-9a-f]+)_[a-z_]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "redcdn.pl" &&
            domain.indexOf("dcs.redcdn.pl") >= 0) {
            // https://r-scale-00.dcs.redcdn.pl/scale/o2/tvn/web-content/m/p5/i/4496bf24afe7fab6f046bf4923da8de6/5ee170e0-0086-4902-bd53-3ecc7126f4de.jpg?type=1&srcmode=3&srcx=0/1&srcy=0/1&srcw=640&srch=360&dstw=640&dsth=360&quality=80
            //   https://r-scale-00.dcs.redcdn.pl/dcs//o2/tvn/web-content/m/p5/i/4496bf24afe7fab6f046bf4923da8de6/5ee170e0-0086-4902-bd53-3ecc7126f4de.jpg
            // https://n-4-1.dcs.redcdn.pl/dcs/o2/tvn/web-content/m/p1/f/97d0145823aeb8ed80617be62e08bdcc/3d46f316-f013-4b95-9e6e-83a493d21906.jpg -- 7874x5512
            return src.replace(/(:\/\/[^/]*\/)scale(\/.*?)(?:[?#].*)?$/, "$1dcs/$2");
        }

        if (domain === "media.nu.nl") {
            // https://media.nu.nl/m/xc3x2ajaw2pt_wd640.jpeg
            //   https://media.nu.nl/m/xc3x2ajaw2pt.jpeg
            // https://media.nu.nl/m/xc3x2ajaw2pt_wd1280.jpg/groenland-vreest-tsunami-afgebroken-ijsberg-bij-kustplaats.jpg
            //   https://media.nu.nl/m/xc3x2ajaw2pt.jpg
            return src.replace(/(:\/\/[^/]*\/[a-z]\/[0-9a-z]+)_[0-9a-z]+(\.[^/.]*)(?:\/[^/]*\.[^/.]*)?$/, "$1$2");
        }

        if (domain === "cloudia.hnonline.sk") {
            // https://cloudia.hnonline.sk/r740x415n/f46d9eecfa7bc72be2d58a1db131b148.jpg?default=article
            //   https://cloudia.hnonline.sk/f46d9eecfa7bc72be2d58a1db131b148.jpg
            return src.replace(/(:\/\/[^/]*\/)[a-z]?[0-9]+x[0-9]+[a-z]?\/([0-9a-f]+\.[^/.]*?)(?:\?.*)?$/, "$1$2");
        }

        if (googlestorage_container === "nana10img") {
            // https://storage.googleapis.com/nana10img/crop/_w-743_h-418_c-1/images/news/2018-07-13T115944Z_222051012_RC17A823B160_RTRMADP_3_GREENLAND-ICEBERG.JPG
            //   https://storage.googleapis.com/nana10img/images/news/2018-07-13T115944Z_222051012_RC17A823B160_RTRMADP_3_GREENLAND-ICEBERG.JPG
            return src.replace(/\/crop\/(?:_[a-z]-[0-9]+){1,}\/images\//, "/images/");
        }

        if ((domain_nowww === "webnews.bg" ||
             // https://static.dir.bg/uploads/images/2018/08/07/1484000/768x.jpg?_=1533643044
             //   https://static.dir.bg/uploads/images/2018/08/07/1484000/orig.jpg?_=1533643044
             domain === "static.dir.bg") &&
            src.indexOf("/uploads/images/") >= 0) {
            // https://www.webnews.bg/uploads/images/70/8070/368070/768x432.jpg
            //   https://www.webnews.bg/uploads/images/70/8070/368070/orig.jpg
            return src.replace(/\/[0-9]+x(?:[0-9]+)?(\.[^/.]*)$/, "/orig$1");
        }

        if (domain === "static.ffx.io") {
            // technically this looks like cloudinary, but possibly a variant?
            // https://static.ffx.io/images/$zoom_0.841%2C$multiply_0.7252124645892352%2C$ratio_1.776846%2C$width_1059%2C$x_0%2C$y_0/t_crop_custom/t_sharpen%2Cq_auto%2Cf_auto/edf6feebc2488f212b2ac65be557a89edda359e6
            //   https://static.ffx.io/images/edf6feebc2488f212b2ac65be557a89edda359e6
            return src.replace(/\/images\/\$[^/]*\/.*\/([0-9a-f]+)([?#].*)?$/, "/images/$1$2");
        }

        if (domain === "images.stv.tv") {
            // https://images.stv.tv/articles/w768/598476-the-iceberg-is-said-to-be-grounded-on-the-sea-floor.jpg -- stretched?
            //    https://images.stv.tv/articles/master/598476-the-iceberg-is-said-to-be-grounded-on-the-sea-floor.jpg
            // https://images.stv.tv/articles/w1280xh720xmFit/598472-four-mile-long-iceberg-breaks-off-from-greenland-glacier.jpg -- stretched
            //    https://images.stv.tv/articles/master/598472-four-mile-long-iceberg-breaks-off-from-greenland-glacier.jpg
            return src.replace(/\/articles\/[wh][0-9]+(?:xh[0-9]+)?(?:xm[^/]*)?\/([^/]*)$/, "/articles/master/$1");
        }

        if (domain === "cdn.cretalive.gr") {
            // https://cdn.cretalive.gr/_largeImage/groilandia-pagobouno.jpg?mtime=20180713135637 -- stretched?
            //   https://cdn.cretalive.gr/groilandia-pagobouno.jpg?mtime=20180713135637
            return src.replace(/(:\/\/[^/]*\/)_[a-z]+Image\//, "$1");
        }

        if ((domain_nosub === "ellingtoncms.com" &&
             domain.match(/\.media\.clients\.ellingtoncms\.com$/)) ||
            // https://media.spokesman.com/photos/2018/07/13/Greenland_Iceberg.JPG_MYCrmE3_t1200.jpg?298603a24e8d51915fce203907ff2746e482a5a6
            //   https://media.spokesman.com/photos/2018/07/13/Greenland_Iceberg.JPG_MYCrmE3.jpg?298603a24e8d51915fce203907ff2746e482a5a6
            domain === "media.spokesman.com") {
            // https://kpbs.media.clients.ellingtoncms.com/assets/img/2018/07/14/gettyimages-997468440_wide-a78798da0e97d7deb7aa537c32ca8d2ee11d840d_t800.jpg?90232451fbcadccc64a17de7521d859a8f88077d
            //   https://kpbs.media.clients.ellingtoncms.com/assets/img/2018/07/14/gettyimages-997468440_wide-a78798da0e97d7deb7aa537c32ca8d2ee11d840d.jpg?90232451fbcadccc64a17de7521d859a8f88077d
            // http://thetribune.media.clients.ellingtoncms.com/img/photos/2016/07/07/Moodys_t670.jpg?b3f6a5d7692ccc373d56e40cf708e3fa67d9af9d
            //   http://thetribune.media.clients.ellingtoncms.com/img/photos/2016/07/07/Moodys.jpg?b3f6a5d7692ccc373d56e40cf708e3fa67d9af9d
            // http://epmgaa.media.clients.ellingtoncms.com/img/photos/2016/12/08/Grace_t750x550.jpeg?d885fc46c41745b3b5de550c70336c1b382931d2
            //   http://epmgaa.media.clients.ellingtoncms.com/img/photos/2016/12/08/Grace.jpeg?d885fc46c41745b3b5de550c70336c1b382931d2
            return src.replace(/_t[0-9]*(?:x[0-9]+)?(\.[^/.]*)$/, "$1");
        }

        if (domain === "ajo.prod.reuters.tv") {
            // https://ajo.prod.reuters.tv/api/v2/img/5b4a4a4ae4b01cce9ac71a1c-1531595338794?location=LANDSCAPE&width=800&height=450
            //   https://ajo.prod.reuters.tv/api/v2/img/5b4a4a4ae4b01cce9ac71a1c-1531595338794?location=LANDSCAPE
            return src.replace(/(\/img\/[0-9a-f]+-[0-9]+).*?[?&](location=[^&]*).*?$/, "$1?$2");
        }

        if (domain_nowww === "nos.nl") {
            // https://nos.nl/data/image/2018/07/13/486455/xxl.jpg
            //   https://nos.nl/data/image/2018/07/13/486455/original.jpg
            return src.replace(/(\/data\/image\/[0-9]+\/[0-9]+\/[0-9]+\/[0-9]+\/)[a-z]+(\.[^/.]*)$/, "$1original$2");
        }

        if (domain_nowww === "braunschweiger-zeitung.de" ||
            // https://img.derwesten.de/img/panorama/crop214844835/8353229184-w960-cv16_9/doc70zrsr66hr6mvzbm8l1-MASTER.jpg
            //   https://img.derwesten.de/bin/src-214844835.jpg
            domain === "img.derwesten.de" ||
            // https://www.thueringen24.de/img/welt/crop214844835/5233837185-w960-cv16_9-q85/doc70zrsr66hr6mvzbm8l1-MASTER.jpg
            //   https://www.thueringen24.de/bin/src-214844835.jpg
            domain_nowww === "thueringen24.de" ||
            // https://www.helmstedter-nachrichten.de/img/panorama/crop214844835/2972606866-w820-cv16_9-q85/doc70zrsr66hr6mvzbm8l1-MASTER.jpg
            //   https://www.helmstedter-nachrichten.de/bin/src-214844835.jpg
            domain_nowww === "helmstedter-nachrichten.de") {
            // https://www.braunschweiger-zeitung.de/img/panorama/crop214844835/9502969114-w820-cv16_9-q70/doc70zrsr66hr6mvzbm8l1-MASTER.jpg
            //   https://www.braunschweiger-zeitung.de/bin/src-214844835.jpg
            return src.replace(/\/img\/(?:panorama|welt)\/crop([0-9]+)\/.*(\.[^/.]*)$/, "/bin/src-$1$2");
        }

        if (domain === "iprx.ten.com.au") {
            // https://iprx.ten.com.au/ImageHandler.ashx?f=jpg&u=https%3A%2F%2Fimages.tenplay.com.au%2F~%2Fmedia%2FGreenland900W.jpg
            //   https://images.tenplay.com.au/~/media/Greenland900W.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/ImageHandler\.ashx.*?[?&]u=([^&]*).*?$/, "$1"));
        }

        if (domain === "images.sudouest.fr") {
            // https://images.sudouest.fr/2018/07/13/5b48afab66a4bd5f4db04b7a/widescreen/1000x500/une-evacuation-a-ete-faite-au-cas-ou-le-bloc-venait-a-rompre.jpg?v1
            //   https://images.sudouest.fr/2018/07/13/5b48afab66a4bd5f4db04b7a/une-evacuation-a-ete-faite-au-cas-ou-le-bloc-venait-a-rompre.jpg?v1
            return src.replace(/(\/[0-9a-f]+\/)[a-z]+\/[0-9]+x[0-9]+\/([^/]*)$/, "$1$2");
        }

        if (domain === "gdb.rferl.org" ||
            // https://gdb.voanews.com/FFF71CAB-7CA6-4876-831A-B7E44ED40BF4_w1200_r1_s.jpg
            //   https://gdb.voanews.com/FFF71CAB-7CA6-4876-831A-B7E44ED40BF4.jpg
            domain === "gdb.voanews.com" ||
            // https://gdb.radiosawa.us/1C56840D-938D-4931-9C15-1BF8EE7E42A6_cx0_cy10_cw0_w1080_h608.jpg
            //   https://gdb.radiosawa.us/1C56840D-938D-4931-9C15-1BF8EE7E42A6.jpg
            domain === "gdb.radiosawa.us") {
            // https://gdb.rferl.org/A8AAF0A8-851A-4A70-8803-05E5409C6A19_w1200_r1_s.jpg
            //   https://gdb.rferl.org/A8AAF0A8-851A-4A70-8803-05E5409C6A19.jpg
            return src.replace(/(:\/\/[^/]*\/[-0-9A-F]+)(?:_c?[a-z][0-9]*){1,}(\.[^/.]*)$/, "$1$2");
            // return src.replace(/_[^/.]*(\.[^/.]*)$/, "$1");
        }

        if (domain === "img.nzz.ch") {
            // https://img.nzz.ch/C=W3500,H1969,X0,Y0/S=W1200/O=75/https://nzz-img.s3.amazonaws.com/2018/7/13/39384ab7-1119-4465-a5c2-12987ed85ec1.jpeg
            //   https://nzz-img.s3.amazonaws.com/2018/7/13/39384ab7-1119-4465-a5c2-12987ed85ec1.jpeg
            return src.replace(/^[a-z]+:\/\/[^/]*\/(?:[A-Z]=[^/]+\/){1,}(https?:\/\/)/, "$1");
        }

        if (domain === "images-cdn.impresa.pt") {
            // http://images-cdn.impresa.pt/sicnot/2018-07-14-DOC.20180713.24512537.06885114.jpg-1/16x9/mw-1240
            //   http://images-cdn.impresa.pt/sicnot/2018-07-14-DOC.20180713.24512537.06885114.jpg-1/original
            // https://images-cdn.impresa.pt/famashow/2018-03-05-GettyImages-927262244.jpg/original/mw-1240 -- 1240x1860
            //   https://images-cdn.impresa.pt/famashow/2018-03-05-GettyImages-927262244.jpg/original -- 2048x3071
            // http://images-cdn.impresa.pt/caras/2018-02-06-2-Margot-Robbie.jpg?mw=200
            //   http://images-cdn.impresa.pt/caras/2018-02-06-2-Margot-Robbie.jpg/original
            return src
                .replace(/\/(?:[0-9]+x[0-9]+|original)\/m[wh]-[0-9]+(?:\?.*)?$/, "/original")
                .replace(/\?.*/, "");
            //return src.replace(/(:\/\/[^/]*\/[^/]*\/[^/]*\.[^/.]*)\/[^/]*(?:\/[^/]*)?$/, "$1/original");
        }

        if (domain === "awsimages.detik.net.id") {
            // https://awsimages.detik.net.id/visual/2018/02/21/29c13f53-a628-460a-bdf6-da19a9d8c514.jpeg?w=420&q=90 -- 420x639
            //   https://awsimages.detik.net.id/visual/2018/02/21/29c13f53-a628-460a-bdf6-da19a9d8c514.jpeg?a=1 -- 1973x3000
            return src.replace(/\?.*/, "?a=1");
        }

        if (domain_nowww === "sexhd.pics" ||
            // https://sexphotos.pw/image/celebmatrix/rihanna/bbwhoneygallery-celebrities-jimslip/hd-rihanna-4.jpg
            //   https://sexphotos.pw/xxx/celebmatrix/rihanna/bbwhoneygallery-celebrities-jimslip/rihanna-4.jpg
            domain_nowww === "sexphotos.pw" ||
            // https://yespornpics.com/thumb/celebmatrix/rihanna/my-favorite-celebs-mobi-sex/hd-rihanna-10.jpg
            //   https://vip.yespornpics.com/media/celebmatrix/rihanna/my-favorite-celebs-mobi-sex/rihanna-10.jpg
            domain_nosub === "yespornpics.com" ||
            // https://babe.today/pics/amourangels/nelly/land-skinny-babes-desnudas/nelly-11.jpg
            //   https://babe.today/pics/amourangels/nelly/land-skinny-babes-desnudas/nelly-11.jpg
            domain_nowww === "babe.today" ||
            // https://xxxporn.pics/thumb/digitaldesire/bree-daniels/gorgeous-softcore-hotel/hd-bree-daniels-15.jpg
            //   https://xxxporn.pics/media/digitaldesire/bree-daniels/gorgeous-softcore-hotel/bree-daniels-15.jpg
            domain_nowww === "xxxporn.pics" ||
            // https://pics.jjgirls.com/thumbs/celebsonly/rihanna/april-celebrities-sweety/hd-rihanna-5.jpg
            //   https://pics.jjgirls.com/pictures/celebsonly/rihanna/april-celebrities-sweety/rihanna-5.jpg
            domain_nosub === "jjgirls.com") {
            // https://sexhd.pics/photo/celebsonly/rihanna/monday-celebrities-trainer/hd-rihanna-5.jpg
            //   https://sexhd.pics/gallery/celebsonly/rihanna/monday-celebrities-trainer/rihanna-5.jpg
            newsrc = src
                .replace(/(:\/\/[^/]*\/)photo(\/.*\/)hd-([^/]*)$/, "$1gallery$2$3")
                .replace(/(:\/\/[^/]*\/)image(\/.*\/)hd-([^/]*)$/, "$1xxx$2$3")
                .replace(/(:\/\/[^/]*\/)thumbs(\/.*\/)hd-([^/]*)$/, "$1pictures$2$3")
                .replace(/(:\/\/[^/]*\/)thumb(\/.*\/)hd-([^/]*)$/, "$1media$2$3")
                .replace(/(:\/\/[^/]*\/)pic(\/.*\/)hd-([^/]*)$/, "$1pics$2$3");

            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nowww === "javhd.pics") {
            // https://javhd.pics/media/caribbeancom/nao-kojima/031811-647/hd-nao-kojima-2.jpg
            //   https://javhd.pics/media/caribbeancom/nao-kojima/031811-647/uhd-nao-kojima-2.jpg
            //   https://javhd.pics/photos/caribbeancom/nao-kojima/031811-647/nao-kojima-2.jpg
            return src.replace(/(:\/\/[^/]*\/)media(\/.*\/)(?:u?hd|pin)-([^/]*)$/, "$1photos$2$3");
        }

        if (domain_nowww === "javpics.com") {
            // https://javpics.com/xxx/japanese/nao-shiraishi/1/pin-nao-shiraishi-1.jpg
            //   https://javpics.com/images/japanese/nao-shiraishi/1/nao-shiraishi-1.jpg
            return src.replace(/(:\/\/[^/]*\/)xxx(\/.*\/)(?:u?hd|pin)-([^/]*)$/, "$1images$2$3");
        }

        if (domain_nowww === "purejapanese.com" ||
            // http://www.jjgirls.com/uncensored/caribbeancompr/nao-kojima/042514_828/cute-nao-kojima-4.jpg
            //   http://www.jjgirls.com/uncensored/caribbeancompr/nao-kojima/042514_828/nao-kojima-4.jpg
            domain_nowww === "jjgirls.com" ||
            // http://www.javtube.com/tokyopic/caribbeancom/nao-kojima/062511-734/cute-nao-kojima-2.jpg
            //   http://www.javtube.com/tokyopic/caribbeancom/nao-kojima/062511-734/nao-kojima-2.jpg
            domain_nowww === "javtube.com") {
            // http://www.purejapanese.com/pic/nao-kojima/13/cute-nao-kojima-1.jpg
            //   http://www.purejapanese.com/pic/nao-kojima/13/nao-kojima-1.jpg
            return src.replace(/(:\/\/[^/]*\/)(pic|tokyopic|uncensored)(\/.*\/)cute-([^/]*)$/, "$1$2$3$4");
        }

        if (domain_nowww === "javbtc.com") {
            // https://javbtc.com/media/caribbeancom/nao-kojima/031811-647/hd-nao-kojima-1.jpg
            //   https://javbtc.com/photos/caribbeancom/nao-kojima/031811-647/nao-kojima-1.jpg
            return src.replace(/(:\/\/[^/]*\/)media(\/.*\/)hd-([^/]*)$/, "$1photos$2$3");
        }

        if (domain_nowww === "tubetubetube.com") {
            // https://www.tubetubetube.com/media/handjobjapan/mizuho-shiina/075_shiina_mizuho/uhd-mizuho-shiina-1.jpg
            //   https://www.tubetubetube.com/pics/handjobjapan/mizuho-shiina/075_shiina_mizuho/mizuho-shiina-1.jpg
            return src.replace(/(:\/\/[^/]*\/)media(\/.*\/)(?:u?hd|pin)-([^/]*)$/, "$1pics$2$3");
        }

        if (domain_nowww === "nuceleb.ru") {
            // https://www.nuceleb.ru/assets/images/resources/183/144x180/rihanna-golaya-162.jpg
            //   https://www.nuceleb.ru/assets/images/resources/183/rihanna-golaya-162.jpg
            return src.replace(/(\/assets\/images\/resources\/[0-9]+\/)[0-9]+x[0-9]+\/([^/]*)$/, "$1$2");
        }

        if (domain_nosub === "imgserve.net") {
            // http://s12.imgserve.net/images/small/2015/03/26/551470ce6adbe.jpg
            //   http://s12.imgserve.net/images/big/2015/03/26/551470ce6adbe.jpg
            return {
                url: src.replace(/(:\/\/[^/]*\/)images\/[a-z]+\//, "$1images/big/"),
                headers: {
                    Referer: src
                }
            };
        }

        if (domain === "image.celebrityrave.com") {
            // http://image.celebrityrave.com/20160815075823/0000/0000/0145/9045/ea0cea8ab4c76e34a438d3b710dc67ba-m2.jpg
            //   http://image.celebrityrave.com/20160815075823/0000/0000/0145/9045/ea0cea8ab4c76e34a438d3b710dc67ba.jpg
            return src.replace(/(\/[0-9a-f]*)-[0-9a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "zceleb.com" ||
            // https://cdn.faponix.com/contents/albums/main/300x500/83000/83852/1313934.jpg
            //   https://cdn.faponix.com/contents/albums/sources/83000/83852/1313934.jpg
            domain === "cdn.faponix.com" ||
            // https://i5.fapality.com/contents/albums/main/240x999/1000/1682/64817.jpg
            //   https://i5.fapality.com/contents/albums/sources/1000/1682/64817.jpg
            (domain_nosub === "fapality.com" && domain.match(/^i[0-9]*\.fapality\.com/)) ||
            // https://cdn.pornstill.com/contents/albums/main/300x500/82000/82628/1298509.jpg
            //   https://cdn.pornstill.com/contents/albums/sources/82000/82628/1298509.jpg
            domain === "cdn.pornstill.com") {
            // https://www.zceleb.com/contents/albums/main/235x350/0/73/4807.jpg
            //   https://zceleb.com/contents/albums/main/5000x5000/0/73/4807.jpg
            //   https://www.zceleb.com/contents/albums/sources/0/73/4807.jpg
            return src.replace(/\/albums\/main\/[0-9]+x[0-9]+\//, "/albums/sources/");
        }

        if (domain_nowww === "celebcafe.net") {
            // http://www.celebcafe.net/blog/thumbs/aSelena%20Gomez%20%20At%20swimming%20pool%20in%20Miami%20-%20Oct%2028%2C%202013%20%2844%29.jpg
            //   http://www.celebcafe.net/blog/pics/aSelena%20Gomez%20%20At%20swimming%20pool%20in%20Miami%20-%20Oct%2028%2C%202013%20%2844%29.jpg
            return src.replace(/\/blog\/thumbs\//, "/blog/pics/");
        }

        if (domain === "image.jeuxvideo.com") {
            // http://image.jeuxvideo.com/medias-md/153181/1531806400-2401-card.jpg
            //   http://image.jeuxvideo.com/medias/153181/1531806400-2401-card.jpg
            return {
                url: src.replace(/(:\/\/[^/]*\/medias)-[a-z]+(\/[0-9]+\/)/, "$1$2"),
                can_head: false
            };
        }

        if (domain === "images.pushsquare.com") {
            // http://images.pushsquare.com/screenshots/77413/900x.jpg -- 900x506
            //   http://images.pushsquare.com/screenshots/77413/large.jpg --1920x1080 (with watermark)
            //   http://images.pushsquare.com/screenshots/77413/original.jpg -- 1920x1080 (without watermark)
            // http://images.pushsquare.com/games/ps4/hitman_episode_3_-_marrakesh/cover_medium.jpg -- 576x766 (stretched)
            //   http://images.pushsquare.com/games/ps4/hitman_episode_3_-_marrakesh/cover.jpg -- 576x766 (stretched)
            //   http://images.pushsquare.com/games/ps4/hitman_episode_3_-_marrakesh/cover_original.jpg -- 255x300
            // http://images.pushsquare.com/news/2018/07/guide_the_best_ps4_rpgs/75x75.jpg
            //   http://images.pushsquare.com/news/2018/07/guide_the_best_ps4_rpgs/original.jpg
            return src
                .replace(/(\/screenshots\/[0-9]+\/)(?:[0-9]+x(?:[0-9]+)?|[a-z]+)(\.[^/.]*)$/, "$1original$2")
                .replace(/(\/news\/[0-9]+\/[0-9]+\/[^/]+\/)(?:[0-9]+x(?:[0-9]+)?|[a-z]+)(\.[^/.]*)$/, "$1original$2")
                .replace(/(\/games\/.*\/cover)(?:_[a-z]+)?(\.[^/.]*)$/, "$1_original$2");
        }

        if (domain_nowww === "pcgames.de") {
            // http://www.pcgames.de/screenshots/110x83/2016/10/Hitman-4--pc-games_b2teaser_43.jpg
            //   http://www.pcgames.de/screenshots/original/2016/10/Hitman-4--pc-games_b2teaser_43.jpg
            return src.replace(/\/screenshots\/[0-9]+x[0-9]+\//, "/screenshots/original/");
        }

        if (domain_nowww === "collinsdictionary.com") {
            // https://www.collinsdictionary.com/images/thumb/iceberg_346820033_250.jpg?version=3.1.158
            //   https://www.collinsdictionary.com/images/full/iceberg_346820033.jpg?version=3.1.158
            return src.replace(/\/images\/thumb\/([^/]*)_[0-9]+(\.[^/.]*)(\?.*)?$/, "/images/full/$1$2$3");
        }

        if (domain_nowww === "abc.net.au") {
            // http://www.abc.net.au/archives/80days/pluck-cache/images/49866abe-f614-4ba4-a585-489637e3f829.Small.jpg
            //   http://www.abc.net.au/archives/80days/pluck-cache/images/49866abe-f614-4ba4-a585-489637e3f829.Full.jpg
            // http://www.abc.net.au/cm/rimage/9931726-16x9-thumbnail.jpg -- 160x90
            //   http://www.abc.net.au/cm/rimage/9931726-16x9-small.jpg -- 220x124
            //   http://www.abc.net.au/cm/rimage/9931726-16x9-large.jpg -- 1600x900
            return src
                .replace(/(\/pluck-cache\/images\/[-0-9a-f]+\.)[A-Z][a-z]+(\.[^/.]*)$/, "$1Full$2")
                .replace(/(\/cm\/rimage\/[0-9]+-[0-9]+x[0-9]+-)[a-z]+(\.[^/.]*)$/, "$1large$2");
        }

        if (domain_nowww === "1x.com") {
            // https://1x.com/images/user/e9fd987c2a0231b4ff115afb9728c38e-sq.jpg
            //   https://1x.com/images/user/e9fd987c2a0231b4ff115afb9728c38e-ld.jpg
            //   https://1x.com/images/user/e9fd987c2a0231b4ff115afb9728c38e-sd.jpg
            //   https://1x.com/images/user/e9fd987c2a0231b4ff115afb9728c38e-sd2.jpg
            //   https://1x.com/images/user/e9fd987c2a0231b4ff115afb9728c38e-hd2.jpg
            //   https://1x.com/images/user/e9fd987c2a0231b4ff115afb9728c38e-hd4.jpg -- same size, slightly larger file
            // https://1x.com/img/?id=e9fd987c2a0231b4ff115afb9728c38e&q=sd
            //   https://1x.com/images/user/e9fd987c2a0231b4ff115afb9728c38e-hd4.jpg
            return src
                .replace(/(:\/\/[^/]*\/)img\/[^/]*?[?&]id=([0-9a-f]+).*$/, "$1images/user/$2-hd4.jpg")
                .replace(/(\/images\/user\/[0-9a-f]+)-[a-z]+(?:[0-9]+)?(\.[^/.]*)$/, "$1-hd4$2");
        }

        if (domain === "fotografroku.ifotovideo.cz") {
            // http://fotografroku.ifotovideo.cz/image.php?id=423026&size=2
            return src.replace(/(:\/\/[^/]*\/image\.php).*?[?&]id=([0-9]+).*?$/, "$1?id=$2&size=2");
        }

        if (domain === "img.kutikomiya.jp") {
            // https://img.kutikomiya.jp/thumbnail/sakura-sena/W85xH85/sakura-sena441.jpg
            //   https://img.kutikomiya.jp/album/sakura-sena/sakura-sena441.jpg
            // https://img.kutikomiya.jp/thumbnail/sakura-sena/W180/sakura-sena441.jpg
            //   https://img.kutikomiya.jp/album/sakura-sena/sakura-sena441.jpg
            return src.replace(/\/thumbnail(\/[^/]*\/)W[0-9]+(?:xH[0-9]+)?\//, "/album$1");
        }

        if (domain === "attach.setn.com") {
            // https://attach.setn.com/newsimages/2018/07/19/1452129-XXL.jpg -- 510x287
            //   https://attach.setn.com/newsimages/2018/07/19/1452129.jpg -- 1920x1080
            return src.replace(/(\/newsimages\/[0-9]+\/[0-9]+\/[0-9]+\/[0-9]+)-[A-Z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "heyzo.com") {
            // http://www.heyzo.com:81/contents/3000/0410/gallery/thumbnail_001.jpg
            //   http://www.heyzo.com:81/contents/3000/0410/gallery/001.jpg
            return src.replace(/\/gallery\/thumbnail_([0-9]+\.[^/.]*)$/, "/gallery/$1");
        }

        if (domain === "img.picabcd.com") {
            // http://img.picabcd.com/thumbnail/images/jlksxklxkk/9133178/caribpr-062714_885-002.jpg
            //   http://img.picabcd.com/images/jlksxklxkk/9133178/caribpr-062714_885-002.jpg
            return src.replace(/\/thumbnail\/images\//, "/images/");
        }

        if (domain === "mozishop.cdn.shoprenter.hu") {
            // https://mozishop.cdn.shoprenter.hu/custom/mozishop/image/cache/w400h600q80np1/Cikkek/Mozi%20M%C3%A1nia/Bossz%C3%BA%C3%A1ll%C3%B3k%204%20forgat%C3%A1si%20fot%C3%B3k/bosszuallok_vegtelen_haboru_plakat_comin_con_2018-mozishop.JPG?v=null.1527958420
            //   https://mozishop.cdn.shoprenter.hu/custom/mozishop/image/data/Cikkek/Mozi%20M%C3%A1nia/Bossz%C3%BA%C3%A1ll%C3%B3k%204%20forgat%C3%A1si%20fot%C3%B3k/bosszuallok_vegtelen_haboru_plakat_comin_con_2018-mozishop.JPG?v=null.1527958420
            return src.replace(/\/mozishop\/image\/cache\/(?:[a-z]{1,}[0-9]+){1,}\//, "/mozishop/image/data/");
        }

        if (domain === "terrigen-cdn-dev.marvel.com") {
            // https://terrigen-cdn-dev.marvel.com/content/qa/1x/291f80-LEGION_S1_Poster_REVISED.jpeg -- 1800x2700
            //   https://terrigen-cdn-dev.marvel.com/content/qa/2x/291f80-LEGION_S1_Poster_REVISED.jpeg -- 3600x5400 (not stretched)
            // https://terrigen-cdn-dev.marvel.com/content/prod/1x/291f80-LEGION_S1_Poster_REVISED.jpeg -- 1800x2700
            //   https://terrigen-cdn-dev.marvel.com/content/prod/2x/291f80-LEGION_S1_Poster_REVISED.jpeg -- doesn't work
            // https://terrigen-cdn-dev.marvel.com/content/prod/1x/cbl-08564_r2.jpg -- 2784x1856
            //   https://terrigen-cdn-dev.marvel.com/content/prod/2x/cbl-08564_r2.jpg -- 404
            return src.replace(/(\/content\/[a-z]+\/)1x\//, "$12x/");
        }

        if (domain_nowww === "czmodels.cz" ||
            // http://www.phmodels.cz/image/itemid-59296/h-400/59296.jpg
            //   http://www.phmodels.cz/image/itemid-59296/q-100/59296.jpg
            domain_nowww === "phmodels.cz") {
            // http://www.czmodels.cz/image/itemid-174708/h-130/q-80/174708.jpg
            //   http://www.czmodels.cz/image/itemid-174708/q-100174708.jpg
            //   http://www.czmodels.cz/image/itemid-174708/q-100/174708.jpg
            // .png also works, but is much larger
            // without q-100, it defaults to q-0 or something
            return src.replace(/(\/image\/itemid-([0-9]+)\/).*/, "$1q-100/$2.jpg");
        }

        if (domain_nosub === "amazonaws.com" &&
            domain.match(/^[a-z0-9]+\.execute-api\./)) {
            // https://siirsn90c7.execute-api.eu-central-1.amazonaws.com/image/fit-in/620x700/pudra/3603/mila-kunis.jpg
            //   https://siirsn90c7.execute-api.eu-central-1.amazonaws.com/image/pudra/3603/mila-kunis.jpg
            // http://cdn.pudra.com/9634/fitb620x700/margotrobbie.jpg
            return src.replace(/(:\/\/[^/]*\/image\/)fit-in\/[0-9]+x[0-9]+\//, "$1");
        }

        if (domain === "cdn.pudra.com") {
            // http://cdn.pudra.com/9634/fitb620x700/margotrobbie.jpg
            //   http://cdn.pudra.com/9634/margotrobbie.jpg -- redirects to:
            //   https://siirsn90c7.execute-api.eu-central-1.amazonaws.com/image/pudra/9634/margotrobbie.jpg
            return src.replace(/(:\/\/[^/]*\/[0-9]+\/)fit[a-z]?[0-9]+x[0-9]+\//, "$1");
        }

        if (domain === "arhiva.dalje.com") {
            // http://arhiva.dalje.com/slike/slike_3/r4/g2010/m12/y3252347100705424_1.jpg -- 132x124
            //   http://arhiva.dalje.com/slike/slike_3/r1/g2010/m12/y3252347100705424_1.jpg -- 3234x3060
            return src.replace(/(\/slike_[0-9]*\/)r[0-9]*(\/g[0-9]+\/)/, "$1r1$2");
        }

        if (domain === "media.super.cz") {
            // https://media.super.cz/images/gallery/0000000008211249/vcD3G5I_vuMisULzel6ZJA/57a06ea89d4df922981a0300-188614?size=539
            //   https://media.super.cz/images/gallery/0000000008211249/vcD3G5I_vuMisULzel6ZJA/57a06ea89d4df922981a0300-188614?size=9999999999999
            return src.replace(/(\/[0-9a-f]+-[0-9]+)(?:\?.*)$/, "$1?size=9999999999999");
        }

        if (domain_nowww === "d1g.com") {
            // http://www.d1g.com/photos/00/32/3363200_normal.jpg -- 540x303
            //   http://www.d1g.com/photos/00/32/3363200_max.jpg -- 3264x1832
            return src.replace(/(\/photos\/[0-9]+\/[0-9]+\/[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1_max$2");
        }

        if (domain_nowww === "e-shuushuu.net") {
            // http://e-shuushuu.net/images/thumbs/2010-07-17-303994.jpeg
            //   http://e-shuushuu.net/images/2010-07-17-303994.jpeg
            // http://e-shuushuu.net/images/thumbs/2018-07-22-967950.jpeg
            //   http://e-shuushuu.net/images/2018-07-22-967950.png
            return add_extensions_jpeg(src.replace(/(:\/\/[^/]*\/images\/)thumbs\//, "$1"));
        }

        if (domain_nowww === "konachan.net" && false) {
            // https://konachan.net/data/preview/e1/29/e12943f0e1591d2d0b0a29581d92c81b.jpg
            //   https://konachan.net/jpeg/e12943f0e1591d2d0b0a29581d92c81b.jpg
            // https://konachan.net/data/preview/98/6d/986d22d11cb6963ab1fc0dbcda942ea7.jpg
            //   https://konachan.net/image/986d22d11cb6963ab1fc0dbcda942ea7.jpg
            var regex = /\/data\/preview\/[0-9a-f]{2}\/[0-9a-f]{2}\/([0-9a-f]+\.[^/.]*)$/;
            return [src.replace(regex, "/jpeg/$1"),
                    src.replace(regex, "/image/$1")];
        }

        if (domain_nowww === "konachan.com" ||
            domain_nowww === "konachan.net") {
            // https://konachan.com/data/preview/33/fe/33fe5a47e2274171d02f7bb8347b9ab9.jpg
            //   https://konachan.com/sample/33fe5a47e2274171d02f7bb8347b9ab9.jpg
            //   https://konachan.com/image/33fe5a47e2274171d02f7bb8347b9ab9.png
            //   https://konachan.com/sample/33fe5a47e2274171d02f7bb8347b9ab9/Konachan.com%20-%20129575%20sample.jpg?0.7594912488960968
            //   https://konachan.com/image/33fe5a47e2274171d02f7bb8347b9ab9/Konachan.com%20-%20129575%20sample.png?0.7594912488960968
            // https://konachan.net/data/preview/e1/29/e12943f0e1591d2d0b0a29581d92c81b.jpg
            //   https://konachan.net/jpeg/e12943f0e1591d2d0b0a29581d92c81b.jpg
            //   https://konachan.net/image/e12943f0e1591d2d0b0a29581d92c81b.png
            // https://konachan.net/data/preview/98/6d/986d22d11cb6963ab1fc0dbcda942ea7.jpg
            //   https://konachan.net/image/986d22d11cb6963ab1fc0dbcda942ea7.jpg
            //   https://konachan.net/image/986d22d11cb6963ab1fc0dbcda942ea7.jpg
            return add_extensions(src.replace(/(?:\/data\/preview\/[0-9a-f]+\/[0-9a-f]+\/|\/sample\/)([0-9a-f]+)(\/[^/]*)?(\.[^/.?]*)(?:[?#]*)?$/, "/image/$1$2$3"));
        }

        if (domain === "cdn.anime-pictures.net" ||
            // http://ip1.anime-pictures.net/jvwall_images/c40/c40921ef095eaadb0bb668a193b1da3b_bp.jpg
            //   http://ip1.anime-pictures.net/jvwall_images/c40/c40921ef095eaadb0bb668a193b1da3b.jpg
            domain_nosub === "anime-pictures.net") {
            // https://cdn.anime-pictures.net/jvwall_images/5c1/5c1600107b0c809aa60ba085003cbb03_sp.png -- 111x150
            //   https://cdn.anime-pictures.net/jvwall_images/5c1/5c1600107b0c809aa60ba085003cbb03_bp.png.webp -- 447x600
            //   https://cdn.anime-pictures.net/jvwall_images/5c1/5c1600107b0c809aa60ba085003cbb03.png -- 750x1006
            // https://cdn.anime-pictures.net/jvwall_images/297/297017a879930cb80b97d33f4a19e38f_sp.jpg.webp
            //   https://cdn.anime-pictures.net/jvwall_images/297/297017a879930cb80b97d33f4a19e38f.jpg -- 2419x3047
            return src.replace(/(\/[0-9a-f]+)_[a-z]+(\.[^/.]*)(?:\.webp)?(\?.*)?$/, "$1$2$3");
        }

        if (domain === "images.treccani.it") {
            // http://images.treccani.it/enc/media/share/images/lm/system/galleries/IX_Appendice/ix_appendice_c_fig73.jpg
            //   http://images.treccani.it/enc/media/share/images/orig/system/galleries/IX_Appendice/ix_appendice_c_fig73.jpg
            return src.replace(/\/enc\/media\/share\/images\/[a-z]+\/system\//, "/enc/media/share/images/orig/system/");
        }

        if (domain === "image-store.slidesharecdn.com") {
            // http://image-store.slidesharecdn.com/7e34b936-0bf8-11e4-94b5-22000aa7091d-large.jpeg
            //   http://image-store.slidesharecdn.com/7e34b936-0bf8-11e4-94b5-22000aa7091d-original.jpeg
            return src.replace(/(:\/\/[^/]*\/[-0-9a-f]+)-large(\.[^/.]*)$/, "$1-original$2");
        }

        if (domain_nosub === "stgy.ovh" &&
            domain.match(/citynews-riminitoday\.stgy\.ovh/)) {
            // http://2.citynews-riminitoday.stgy.ovh/~media/horizontal-low/18483820294027/riccione-controlli-polizia-notte-005-2.jpg
            //   http://2.citynews-riminitoday.stgy.ovh/~media/original-hi/18483820294027/riccione-controlli-polizia-notte-005-2.jpg -- 1000x666 (watermarked, stretched)
            //   http://2.citynews-riminitoday.stgy.ovh/~media/18483820294027/riccione-controlli-polizia-notte-005-2.jpg -- 667x444
            // http://2.citynews-riminitoday.stgy.ovh/~media/original-hi/40457162851293/enea-basianini-2016-2.jpg -- 1000x666
            //   http://2.citynews-riminitoday.stgy.ovh/~media/40457162851293/enea-basianini-2016-2.jpg -- 2500x1667
            return src.replace(/\/~media\/[-a-z]+(\/[0-9]+\/)/, "/~media/$1");
        }

        if (domain === "media.raccweb.com") {
            // https://media.raccweb.com/__sized__/products/productimage-picture-jennette-mccurdy-signed-autograph-8x10-photo-sexy-sam-8977-thumbnail-1000x1000-100.jpg
            //   https://media.raccweb.com/products/productimage-picture-jennette-mccurdy-signed-autograph-8x10-photo-sexy-sam-8977.jpg
            return src.replace(/(:\/\/[^/]*\/)__sized__\/(.*)-thumbnail-[0-9]+x[0-9]+-[0-9]+(\.[^/.]*)$/, "$1$2$3");
        }

        if (domain_nowww === "mormonnewsroom.org") {
            // https://www.mormonnewsroom.org/media/800x800/first-presidency-2018-horizontal.jpg
            //   https://www.mormonnewsroom.org/media/original/first-presidency-2018-horizontal.jpg
            return src.replace(/\/media\/[0-9]+x[0-9]+\//, "/media/original/");
        }

        if (domain === "contents.mediadecathlon.com") {
            // https://contents.mediadecathlon.com/p596601/2000x2000/sq/3mm_thermo_fishing_waders_caperlan_8304142_596601.jpg?k=e5a9a9425cad7905f6351a10b5f4edcf
            //   https://contents.mediadecathlon.com/p596601/3mm_thermo_fishing_waders_caperlan_8304142_596601.jpg?k=e5a9a9425cad7905f6351a10b5f4edcf
            return src.replace(/(\/p[0-9]+\/)(?:[0-9]+x[0-9]+\/)?(?:[a-z]+\/)?([^/]*)$/, "$1$2");
        }

        if (domain_nowww === "overcast.fm") {
            // https://overcast.fm/art?s=9553420abe5c2fde9aa4baa732eb6640f635d57513b48b226a994149d2edf13d&w=840&u=http%3A%2F%2Fclovermedia.s3-us-west-2.amazonaws.com%2Fstore%2F1c%2F1c7b341e-3114-4031-940f-9858ef85928c%2Fthumbnails%2Fmobile%2F7be30075-53e3-4ffe-9539-5de773f033ee.jpg
            //   http://clovermedia.s3-us-west-2.amazonaws.com/store/1c/1c7b341e-3114-4031-940f-9858ef85928c/thumbnails/mobile/7be30075-53e3-4ffe-9539-5de773f033ee.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/art.*?[?&]u=([^&]*).*?$/, "$1"));
        }

        if (domain === "spottappeu01prd.blob.core.windows.net") {
            // https://api-cdn.spott.tv/rest/v004/image/images/a5921178-58de-4b98-8dc5-ba1317880f65?width=414&height=414
            // https://spottappeu01prd.blob.core.windows.net/appiness-spott-prd-img/2e/11/9b/07/c2ef81af78d2e7e48a19065f82507277ee1b1dc3bd5dec99a04777c2fb4ea311/600_600.jpg -- 399x600
            //   https://spottappeu01prd.blob.core.windows.net/appiness-spott-prd-img/2e/11/9b/07/c2ef81af78d2e7e48a19065f82507277ee1b1dc3bd5dec99a04777c2fb4ea311/0.jpg -- 615x923
            return src.replace(/(\/[0-9a-f]+\/)[0-9]+(?:_[0-9]+)(\.[^/.]*)$/, "$10$2");
        }

        if (domain === "medias.spotern.com") {
            // https://medias.spotern.com/spots/w640/100898.jpg
            //   https://medias.spotern.com/spots/original/100898.jpg
            return src.replace(/\/[wh][0-9]+\/([0-9]+\.[^/.]*)$/, "/original/$1");
        }

        if (domain_nosub === "ounousa.com") {
            // http://static.ounousa.com/Content/ResizedImages/169/140/outside/150609123209282.jpg
            //   http://static.ounousa.com/content/uploads/Article/150609123209282.jpg
            // http://kms.ounousa.com/Content/ResizedImages/548/10000/inside/150321091301862.jpg
            //   http://kms.ounousa.com/content/uploads/Article/150321091301862.jpg
            return src.replace(/\/Content\/ResizedImages\/[0-9]+\/[0-9]+\/[a-z]+(\/[0-9]+\.[^/.]*)$/, "/content/uploads/Article$1");
        }

        if (domain_nowww === "divahair.ro") {
            // https://www.divahair.ro/images/speciale/articole/articole_imagini/andreea_baluteanu_107/2016.04.06/650x488/iiunie%202012%20la%20film%20festival%20valentino%20elle%20com_325_488.jpg
            //   https://www.divahair.ro/images/speciale/articole/articole_imagini/andreea_baluteanu_107/2016.04.06/iiunie%202012%20la%20film%20festival%20valentino%20elle%20com.jpg
            return src.replace(/(\/articole_imagini\/[^/]*\/[0-9]+\.[0-9]+\.[0-9]+\/)[0-9]+x[0-9]+\/([^/]*)_[0-9]+_[0-9]+(\.[^/.]*)$/, "$1$2$3");
        }

        if (domain_nowww === "wall.hr") {
            // https://wall.hr/cdn/uploads/850x/2015/02/ce1208af/keira-knightley.jpg
            //   https://wall.hr/cdn/uploads/2015/02/ce1208af/keira-knightley.jpg
            return src.replace(/\/cdn\/uploads\/[0-9]+x\//, "/cdn/uploads/");
        }

        if (domain_nosub === "tialoto.bg") {
            // http://m.tialoto.bg/media/tialoto/files/galleries/540x720scale/a888eccd8535a6bf86cf6729b96eeab2.jpg
            //   http://m.tialoto.bg/media/tialoto/files/galleries/orig/a888eccd8535a6bf86cf6729b96eeab2.jpg
            // http://m.tialoto.bg/media/tialoto/files/articles/451x572/b2a8a0221b893eff06d7411b5f0a742d.jpg -- 451x572
            //   http://m.tialoto.bg/media/tialoto/files/articles/orig/b2a8a0221b893eff06d7411b5f0a742d.jpg -- 4848x3232
            return src.replace(/(\/media\/tialoto\/files\/[a-z]+\/)[0-9]+x[0-9]+(?:[a-z]+)?(\/[0-9a-f]+\.[^/.]*)$/, "$1orig$2");
        }

        if (domain === "bizweb.dktcdn.net") {
            // https://bizweb.dktcdn.net/thumb/grande/100/177/764/products/alicia-vikander-6.jpg?v=1502942542610
            //   https://bizweb.dktcdn.net/100/177/764/products/alicia-vikander-6.jpg?v=1502942542610
            return src.replace(/(:\/\/[^/]*\/)thumb\/[a-z]+\//, "$1");
        }

        if (domain_nowww === "socialbliss.com") {
            // http://www.socialbliss.com/img/280x0/assets/user_images/52774b76abbc1.jpg
            //   http://www.socialbliss.com/assets/user_images/52774b76abbc1.jpg
            return src.replace(/\/img\/[0-9]+x[0-9]+\/assets\//, "/assets/");
        }

        if (domain_nowww === "forumfr.com") {
            // https://www.forumfr.com/applications/core/interface/imageproxy/ximageproxy.php,qimg=,hnsa39.casimages.com,_img,_2018,_02,_07,_180207013159588388.jpg,akey=96fb4ae9f8f30c138ce4b5acf9d67ba5dc66f73ed534691d8e88ff8224bc2f16.pagespeed.ic.ukhs3d8eIr.jpg
            //   https://nsa39.casimages.com/img/2018/02/07/180207013159588388.jpg
            return "http://" + src.replace(/.*\/applications\/core\/interface\/imageproxy\/ximageproxy\.php.*?,qimg=,h(.*?)(?:,[^_].*)?$/, "$1").replace(/,_/g, "/");
        }

        if (domain_nowww === "pinkomatic.com") {
            // https://pinkomatic.com/images/0516/small/tTsOyy3Y16J7.jpg
            //   https://pinkomatic.com/images/0516/full/tTsOyy3Y16J7.jpg
            return src.replace(/(\/images\/[0-9]+\/)[a-z]+\//, "$1full/");
        }

        if (domain_nowww === "khmeread.com") {
            // http://khmeread.com/images/111492/medium/Salomon.jpg?1533719848
            //   http://khmeread.com/images/111492/original/Salomon.jpg?1533719848
            return src.replace(/(\/images\/[0-9]+\/)[a-z]+\//, "$1original/");
        }

        if (domain === "cfshopeetw-a.akamaihd.net" ||
            // https://cf.shopee.tw/file/a190639cd8c7a04fcfc2e399d3f8b0f8_tn
            domain === "cf.shopee.tw" ||
            // https://cf.shopee.vn/file/b7d2cb844c1b46470dda210b7a777709_tn
            //   https://cf.shopee.tw/file/a190639cd8c7a04fcfc2e399d3f8b0f8
            domain === "cf.shopee.vn") {
            // https://cfshopeetw-a.akamaihd.net/file/914c8b8afa8600aede6f41dec60224be_tn
            //   https://cfshopeetw-a.akamaihd.net/file/914c8b8afa8600aede6f41dec60224be
            return src.replace(/(\/file\/[0-9a-f]+)_tn(?:\?.*)?$/, "$1");
        }

        if (domain_nowww === "theredlist.com") {
            // https://theredlist.com/media/.cache/database/muses/icon/cinematic_women/2000/keira-knightley/1468679918-039-keira-knightley-theredlist.jpg
            //   https://theredlist.com/media/database/muses/icon/cinematic_women/2000/keira-knightley/039-keira-knightley-theredlist.jpg
            return src.replace(/\/media\/\.cache\/database\/(.*\/)[0-9]+-([^/]*)$/, "/media/database/$1$2");
        }

        if ((domain_nosub === "hentai-cosplay.com" ||
             domain_nosub === "hentai-image.com" ||
             domain_nosub === "porn-image-xxx.com" ||
             domain_nosub === "porn-movie-xxx.com") &&
            domain.match(/^static[0-9]*\./)) {
            // https://static.hentai-cosplay.com/upload/20170918/67/68234/p=160x200/1.jpg -- 160x106
            //   https://static.hentai-cosplay.com/upload/20170918/67/68234/p=160x200/1.jpg -- 5472x3648
            newsrc = src
                .replace(/^[a-z]+:\/\/[^/]*\/upload\/cache\/thumbnail\/create\.php.*?[?&]image=([^&]*).*?$/, "$1");
            if (newsrc !== src) {
                return newsrc;
            }

            return src.replace(/(\/+[0-9]+\/+)(?:[a-z]+=[^/]*\/+){1,}([0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "d1in1v57myx5v.cloudfront.net") {
            // https://d1in1v57myx5v.cloudfront.net/pics/Thumbnails/561000004541403.JPEG.webp
            //   https://d1in1v57myx5v.cloudfront.net/pics/Images/561000004541403.JPEG.webp
            return src.replace(/\/pics\/Thumbnails\//, "/pics/Images/");
        }

        if (domain_nowww === "artistic-nude-images.com") {
            // http://www.artistic-nude-images.com/modules/mg3/albums/2012/10-Octobre/thumbnail/tn-NU_artistique_feminin_067.jpg
            //   http://www.artistic-nude-images.com/modules/mg3/albums/2012/10-Octobre/NU_artistique_feminin_067.jpg
            return src.replace(/\/thumbnail\/tn-([^/]*)$/, "/$1");
        }

        if (domain_nowww === "babefilter.net") {
            // http://babefilter.net/i/5b4d/5b4d69cc62878_tn.jpg
            //   http://babefilter.net/i/5b4d/5b4d69cc62878.jpg
            return {
                url: src.replace(/(\/i\/[0-9a-f]+\/[0-9a-f]+)_tn(\.[^/.]*)$/, "$1$2"),
                headers: {
                    Referer: src
                }
            };
        }

        if ((domain_nosub === "dagospia.com" && src.indexOf("/img/") >= 0) ||
            // http://www.sutki.net/img/g/146/33/1_tn.jpg
            //   http://www.sutki.net/img/g/146/33/1.jpg
            (domain_nowww === "sutki.net" && src.indexOf("/img/") >= 0) ||
            // http://screensonic.net/images/169df776e1ec1f491ff3d92a1_tn.jpg
            //   http://screensonic.net/images/169df776e1ec1f491ff3d92a1.jpg
            (domain_nowww === "screensonic.net" && src.indexOf("/images/") >= 0)) {
            // http://cdn-static.dagospia.com/img/foto/04-2018/netanyahu-1007071_tn.jpg
            //   http://cdn-static.dagospia.com/img/foto/04-2018/netanyahu-1007071.jpg
            // http://www.dagospia.com/img/foto/03-2016/amelia-windsor-6-771156_tn.jpg
            //   http://www.dagospia.com/img/foto/03-2016/amelia-windsor-6-771156.jpg
            return src.replace(/_tn(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "redcarpetnudes.com") {
            // https://www.redcarpetnudes.com/xhc/1460358606-selena-gomez-pictures-celebrity-teen-hot-tits-sexy/selena-gomez-pictures-celebrity-teen-hot-tits-sexy-11-tn.jpg
            //   https://www.redcarpetnudes.com/xhc/1460358606-selena-gomez-pictures-celebrity-teen-hot-tits-sexy/selena-gomez-pictures-celebrity-teen-hot-tits-sexy-11.jpg
            return src.replace(/-tn(\.[^/.]*)$/, "$1");
        }

        if (domain === "pat.primecdn.net") {
            // https://pat.primecdn.net/pics/hugethumbs/b9/b9be5e48.jpg
            //   https://pat.primecdn.net/pics/original/b9/b9be5e48.jpg
            return src.replace(/\/pics\/[a-z]+(\/[0-9a-f]+\/[0-9a-f]+\.[^/.]*)$/, "/pics/original$1");
        }

        if (domain_nosub === "imagearn.com") {
            // http://thumbs.imagearn.com/18112009/2112534.jpg
            //   http://thumbs.imagearn.com/imags/18112009/2112534.jpg
            return src.replace(/(:\/\/[^/]*\/)([0-9]+\/[0-9]+\.[^/.]*)$/, "$1imags/$2");
        }

        if (domain === "img.static-smb.be") {
            // https://img.static-smb.be/a/view/q75/w/h450/742525/natalie-portman.jpg
            //   https://img.static-smb.be/a/view/q100/w/h/742525/natalie-portman.jpg
            return src.replace(/\/view\/q[0-9]*\/w[0-9]*\/h[0-9]*\//, "/view/q100/w/h/");
        }

        if (domain_nosub === "buro247.mn" ||
            // https://www.buro247.sg/thumb/500x200/local/images/buro/cannes%20film%20festival%20best%20dressed%20red%20carpet%20celebrity%20buro247%20portrait-1.jpg
            //   https://www.buro247.sg/local/images/buro/cannes%20film%20festival%20best%20dressed%20red%20carpet%20celebrity%20buro247%20portrait-1.jpg
            domain_nosub === "buro247.sg" ||
            // https://www.buro247.kz/thumb/125x185/galleries/2018/01/Vuitton%20m%20RF18%201109.jpg
            //   https://www.buro247.kz/local/images/buro/galleries/2018/01/Vuitton%20m%20RF18%201109.jpg
            domain_nosub === "buro247.kz" ||
            // http://www.buro247.mx/thumb/625x960_0/galleries/2018/01/gucci.jpg
            //   http://www.buro247.mx/local/images/buro/galleries/2018/01/gucci.jpg
            domain_nosub === "buro247.mx" ||
            // http://www.buro247.com.au/thumb/640x960_0/thumb/512x760_8/512-GettyImages-151262923.jpg
            //   http://www.buro247.com.au/thumb/512x760_8/512-GettyImages-151262923.jpg
            domain_nosub === "buro247.com.au" ||
            // https://www.buro247.ru/thumb/1000x700/local/images/buro/galleries/2018/01/Vuitton-m-RF18-0784.jpg
            //   https://www.buro247.ru/local/images/buro/galleries/2018/01/Vuitton-m-RF18-0784.jpg
            domain_nosub === "buro247.ru") {
            // http://www.m.buro247.mn/thumb/600x960_0/images/b5355e20ca4e6c7938b8fb3d009bf304--brown-hair-facial-hair.jpg
            //   http://www.m.buro247.mn/images/b5355e20ca4e6c7938b8fb3d009bf304--brown-hair-facial-hair.jpg
            // http://www.buro247.mn/thumb/1000x700/local/images/buro/galleries/2018/01/_VUI0653.jpg
            //   http://www.buro247.mn/local/images/buro/galleries/2018/01/_VUI0653.jpg
            //return src.replace(/\/thumb\/[0-9]+x[0-9]+\/local\/images\//, "/local/images/");
            return src
                .replace(/(\/thumb\/[^/]*\/)galleries\//, "$1local/images/buro/galleries/")
                .replace(/\/thumb\/[0-9]+x[0-9]+(?:_0)?((?:\/local)?\/(?:images|thumb)\/)/, "$1");
        }

        if (domain === "images.vogue.it") {
            // https://images.vogue.it/gallery/38166/Big/10c148fb-73cb-49d7-b2fe-4a30926462bd.jpg
            //   https://images.vogue.it/gallery/38166/Original/10c148fb-73cb-49d7-b2fe-4a30926462bd.jpg
            return src.replace(/(\/gallery\/[0-9]+\/)[A-Za-z]+(\/[-0-9a-f]+\.[^/.]*)$/, "$1Original$2");
        }

        if (domain === "blogs.glamour.de") {
            // https://blogs.glamour.de/danijelapilic/thumbs/teaserimage_large/2011/08/122140252.jpg
            //   https://blogs.glamour.de/danijelapilic/files/2011/08/122140252.jpg
            return src.replace(/\/thumbs\/[^/]*\//, "/files/");
        }

        if (domain === "img.beatles.ru") {
            // http://img.beatles.ru/f/2874/2874233.jpg
            //   http://img.beatles.ru/f/2874b/2874233.jpg
            return src.replace(/(\/[0-9]+)(\/[0-9]+\.[^/.]*)$/, "$1b$2");
        }

        if (domain_nowww === "boutique.az") {
            // http://boutique.az/images/94034_m.jpg
            //   http://boutique.az/images/94034.jpg
            return src.replace(/(\/images\/[0-9]+)_[a-z](\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "izum.ua") {
            // http://izum.ua/Data/GImg/12369/miss-dior-natali-portman-v-novojj-reklamnojj-kampa_209006_sml.jpg
            //   http://izum.ua/Data/GImg/12369/miss-dior-natali-portman-v-novojj-reklamnojj-kampa_209006.jpg
            return src.replace(/(_[0-9]+)_sml[0-9]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "senatus.net" &&
            domain.match(/^cache[0-9]*\./)) {
            // https://cache2.senatus.net/files/albums/resized/senatus_SNsZUm.jpg
            //   https://cache2.senatus.net/files/albums/resized2x/senatus_SNsZUm.jpg
            //   https://cache2.senatus.net/files/albums/senatus_SNsZUm.jpg
            return src.replace(/\/files\/albums\/resized(?:[0-9]+x)?\//, "/files/albums/");
        }

        if (domain_nowww === "max-pix.com" ||
            // http://moregirls.org/data/thumbnails/22/moregirlsAsians%20(212).jpg
            //   http://moregirls.org/data/media/22/moregirlsAsians%20(212).jpg
            domain_nosub === "moregirls.org") {
            // http://max-pix.com/data/thumbnails/4767/Portman_13-1.jpg
            //   http://max-pix.com/data/media/4767/Portman_13-1.jpg
            return src.replace(/\/data\/thumbnails(\/[0-9]+\/)/, "/data/media$1");
        }

        if (domain_nowww === "tapeteos.pl") {
            // https://www.tapeteos.pl/data/thumbnails/1214/becky_g_-_rebbeca_marie_gomez_039.jpg
            //   https://www.tapeteos.pl/data/media/1214/becky_g_-_rebbeca_marie_gomez_039.jpg
            //   https://www.tapeteos.pl/data/media/1214/big/becky_g_-_rebbeca_marie_gomez_039.jpg
            // https://www.tapeteos.pl/data/media/1214/big/becky_g_-_rebbeca_marie_gomez_039__resized_1600x900.jpg
            //   https://www.tapeteos.pl/data/media/1214/big/becky_g_-_rebbeca_marie_gomez_039.jpg
            return src
                .replace(/\/data\/thumbnails(\/[0-9]+\/)/, "/data/media$1big/")
                .replace(/(\/data\/media\/[0-9]+\/)([^/]*)$/, "$1big/$2")
                .replace(/__resized_[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "media.8ch.net") {
            // https://media.8ch.net/file_store/thumb/b024015a42f19d474d282a532ef8b99fdfad69cad68c0e95efc68e071c8afa4c.jpg
            //   https://media.8ch.net/file_store/b024015a42f19d474d282a532ef8b99fdfad69cad68c0e95efc68e071c8afa4c.jpg
            return src.replace(/\/file_store\/thumb\//, "/file_store/");
        }

        if (domain_nowww === "elles-se-mettent-nues-pour-nous.fr") {
            // https://elles-se-mettent-nues-pour-nous.fr/photos/affiche/thumb/closer-1.jpg
            //   https://elles-se-mettent-nues-pour-nous.fr/photos/affiche/closer-1.jpg
            return src.replace(/(\/photos\/[^/]+\/)thumb\//, "$1");
        }

        if (domain === "media.fashionnetwork.com") {
            // http://media.fashionnetwork.com/m/2884/966d/1620/d702/c1de/b152/ad09/33fa/3832/bc32/487x272.72/bc32.jpg
            //   http://media.fashionnetwork.com/m/2884/966d/1620/d702/c1de/b152/ad09/33fa/3832/bc32/bc32.jpg
            return src.replace(/(\/[a-f0-9]+\/)[0-9]+x[0-9]+\.[0-9]+\/([a-f0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "media.filmz.ru") {
            // http://media.filmz.ru/photos/small/filmz.ru_s_148528.jpg
            //   http://media.filmz.ru/photos/full/filmz.ru_f_148528.jpg
            // http://media.filmz.ru/photos/medium/m_148528.jpg
            //   http://media.filmz.ru/photos/full/f_148528.jpg
            return src.replace(/\/photos\/[a-z]+\/([^/_]*_)?[a-z](_[0-9]+\.[^/.]*)$/, "/photos/full/$1f$2");
        }

        if (domain_nowww === "kinofilms.ua") {
            // http://www.kinofilms.ua/images/photos/w200/446671.jpg -- 200x133
            //   http://www.kinofilms.ua/images/photos/hd/446671.jpg -- 4928x3280
            return src.replace(/\/images\/photos\/[a-z0-9]+\/([0-9]+\.[^/.]*)$/, "/images/photos/hd/$1");
        }

        if (domain_nowww === "grandmagazine.gr") {
            // http://www.grandmagazine.gr/cache/uploaded_images/articles/1441/75_46_phoca_thumb_l_beautiful-creatures-12.jpg
            //   http://www.grandmagazine.gr/uploaded_images/articles/1441/phoca_thumb_l_beautiful-creatures-12.jpg
            return src.replace(/\/cache\/uploaded_images\/(.*)\/[0-9]+_[0-9]+_([^/]*)$/, "/uploaded_images/$1/$2");
        }

        if (domain === "a69.g.akamai.net") {
            // http://a69.g.akamai.net/n/69/10688/v1/img5.allocine.fr/acmedia/medias/nmedia/18/96/63/32/20480140.jpg
            //   http://img5.allocine.fr/acmedia/medias/nmedia/18/96/63/32/20480140.jpg
            return add_http(src.replace(/^[a-z]+:\/\/[^/]*\/[a-z]+\/[0-9]+\/[0-9]+\/v[0-9]+\//, ""));
        }

        if (domain === "cdn-media.rtl.fr") {
            // https://cdn-media.rtl.fr/cache/mRLUC6KYEOEJJKk1mtII6A/720v1080-2/online/image/2015/1014/7780099593_jeremyironssublimescreaturessnd.jpg
            //   https://cdn-media.rtl.fr/online/image/2015/1014/7780099593_jeremyironssublimescreaturessnd.jpg
            // https://cdn-media.rtl.fr/cache/jHJjYDpcT3hXj3zdd_W9Aw/880v587-0/online/image/2016/0226/7782069121_les-audiences-des-sites-de-la-galaxie-rtlnet-sont-en-hausse.png
            //   https://cdn-media.rtl.fr/online/image/2016/0226/7782069121_les-audiences-des-sites-de-la-galaxie-rtlnet-sont-en-hausse.png
            return src.replace(/\/cache\/[-a-zA-Z0-9_]+\/[0-9]+v[0-9]+(?:-[0-9]+)?\/online\//, "/online/");
        }

        if (domain === "bcdn.newshunt.com" ||
            // http://assets-news-bcdn.dailyhunt.in/cmd/resize/400x400_60/fetchdata13/images/84/8f/55/848f55be707b5d4cc1e5177728105a36.jpg
            //   http://assets-news-bcdn.dailyhunt.in/rx/fetchdata13/images/84/8f/55/848f55be707b5d4cc1e5177728105a36.jpg
            (domain_nosub === "dailyhunt.in" && domain.indexOf("bcdn.") >= 0)) {
            // http://bcdn.newshunt.com/cmd/resize/400x400_60/fetchdata13/images/dc/b1/27/dcb1279a206713ea6342291e9f268f42.jpg
            //   http://bcdn.newshunt.com/rx/fetchdata13/images/dc/b1/27/dcb1279a206713ea6342291e9f268f42.jpg
            return src.replace(/\/cmd\/[a-z]+\/[^/]*\/(fetchdata[0-9]*\/images\/)/, "/rx/$1");
        }

        if (domain === "media.search.lt") {
            // http://media.search.lt/GetFile.php?OID=263904&filetype=1 -- 64x43
            //   http://media.search.lt/GetFile.php?OID=263904&filetype=4 -- 2736x1824
            return src.replace(/\/GetFile\.php.*?[?&](OID=[0-9]+).*?$/, "/GetFile.php?$1&filetype=4");
        }

        if (domain_nowww === "wallofcelebrities.com") {
            // https://www.wallofcelebrities.com/celebrity/samantha-mumba/pictures/psmall/samantha-mumba_669439.jpg
            //   https://www.wallofcelebrities.com/celebrity/samantha-mumba/pictures/original/samantha-mumba_669439.jpg
            return {
                url: src.replace(/\/pictures\/[a-z]+\/([^/]*_[0-9]+\.[^/.]*)$/, "/pictures/original/$1"),
                headers: {
                    Referer: "https://www.wallofcelebrities.com/"
                }
            };
        }

        if (domain_nosub === "lmstube.com") {
            // http://pt.lmstube.com/wallpaper/stars/Samantha-Mumba/200x150/Samantha-Mumba-1.JPG
            //   http://pt.lmstube.com/wallpaper/stars/Samantha-Mumba/Samantha-Mumba-1.JPG
            // http://us.lmstube.com/wallpaper/stars/Samantha-Mumba/1280x1024/Samantha-Mumba-1.JPG
            //   http://us.lmstube.com/wallpaper/stars/Samantha-Mumba/Samantha-Mumba-1.JPG
            return src.replace(/\/[0-9]+x[0-9]+\/([^/]*)$/, "/$1");
        }

        if (domain === "assets.mubi.com") {
            // https://assets.mubi.com/images/cast_member/45165/image-w240.jpg?1387570366
            //   https://assets.mubi.com/images/cast_member/45165/image-original.jpg?1387570366
            return src.replace(/\/image-[a-z0-9]+(\.[^/.]*)$/, "/image-original$1");
        }

        if (domain_nowww === "fundir.org") {
            // https://fundir.org/th/7vgrj_iy=t!dkk=dwzam5vpu/najpiekniejsze_aktorki.jpg
            //   https://fundir.org/img/7vgrj_iy=t!dkk=dwzam5vpu/najpiekniejsze_aktorki.jpg
            return src.replace(/(:\/\/[^/]*\/)th\//, "$1img/");
        }

        if (domain_nowww === "spletnik.ru") {
            // http://www.spletnik.ru/thumb/300x200/img/2018/07/elizaveta/20180730-beauty-an.jpg
            //   http://www.spletnik.ru/img/2018/07/elizaveta/20180730-beauty-an.jpg
            // http://www.spletnik.ru/thumb/135x200_5/img/gallery/comthumb/989/2902-margo-01.jpg
            //   http://www.spletnik.ru/img/gallery/comthumb/989/2902-margo-01.jpg
            return src.replace(/\/thumb\/[0-9]+x[0-9]+(?:_[0-9]+)?\/img\//, "/img/");
        }

        if (domain === "r.mtdata.ru") {
            // https://r.mtdata.ru/c50x50/u2/photoE179/20222887187-0/original.jpg#20222887187
            //   https://mtdata.ru/u2/photoE179/20222887187-0/original.jpg#20222887187
            // https://r.mtdata.ru/r480x-/u23/photo7A49/20855335731-0/original.jpeg#20855335731
            //   https://mtdata.ru/u23/photo7A49/20855335731-0/original.jpeg#20855335731
            return src.replace(/:\/\/[^/]*\/[a-z][-0-9]+x[-0-9]+\//, "://mtdata.ru/");
        }

        if (domain_nowww === "mtdata.ru" &&
            src.match(/:\/\/[^/]*\/u[0-9]+\/photo/)) {
            // http://mtdata.ru/u23/photoEE41/20442231528-0/big.jpeg -- 480x677
            //   http://mtdata.ru/u23/photoEE41/20442231528-0/huge.jpeg -- 725x1024
            //   http://mtdata.ru/u23/photoEE41/20442231528-0/original.jpeg -- 907x1280
            return src.replace(/\/(?:huge|big)(\.[^/.]*)$/, "/original$1");
        }

        if (domain === "img.uduba.com") {
            // http://img.uduba.com/mtdata.ru/u3/photo96CC/20986372912-0/original_783x0.jpg -- 783x1135 (stretched?)
            //   http://mtdata.ru/u3/photo96CC/20986372912-0/original.jpg -- 745x1080
            newsrc = src.replace(/:\/\/[^/]*\/mtdata\.ru\//, "://mtdata.ru/");
            if (newsrc !== src) {
                return newsrc.replace(/\/[a-z]+_[0-9]+x[0-9]+(\.[^/.]*)$/, "/original$1");
            }
        }

        if (domain_nowww === "russianpulse.ru") {
            // https://russianpulse.ru/img/http://mtdata.ru/u15/photo882D/20980066834-0/original.jpg
            //   http://mtdata.ru/u15/photo882D/20980066834-0/original.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/img\/([a-z]+:\/\/.*)$/, "$1");
        }

        if (domain === "img.noobzone.ru") {
            // https://img.noobzone.ru/getimg.php?url=http%3A%2F%2Fmtdata.ru%2Fu2%2Fphoto7447%2F20649820661-0%2Foriginal.jpg
            //   http://mtdata.ru/u2/photo7447/20649820661-0/original.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/getimg\.php.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        if (domain === "media.aintitcool.com") {
            // https://media.aintitcool.com/media/uploads/2016/quint/ffsplit1_large.jpg
            //   https://media.aintitcool.com/media/uploads/2016/quint/ffsplit1.jpg
            // http://media.aintitcool.com/media/uploads/2013/papa_vinyard/hobbitsdwarvesohmy_big.jpg
            //   http://media.aintitcool.com/media/uploads/2013/papa_vinyard/hobbitsdwarvesohmy.jpg
            // https://media.aintitcool.com/media/uploads/2016/herc/civil_huge.jpg
            //   https://media.aintitcool.com/media/uploads/2016/herc/civil.jpg
            return src.replace(/_(?:large|big|huge)(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww == "lichnosti.net") {
            // http://lichnosti.net/rs/thumbs/599/set_8_51e52868d9343_jpg_0_250_250.png
            //   http://lichnosti.net/photos/599/sets/8_51e52868d9343.jpg
            return src.replace(/\/rs\/thumbs\/([0-9]+)\/set_([^/]*)_([a-z]+)_[0-9]+_[0-9]+_[0-9]+\.[^/.]*$/,
                               "/photos/$1/sets/$2.$3");
        }

        if (domain_nosub === "zmones.lt" &&
            domain.match(/^s[0-9]*\.zmones\.lt/)) {
            // https://s1.zmones.lt/images/photos/2013/05/17/big/kristin-kreuk-4-5195f12f24f9f.jpg
            //   https://s1.zmones.lt/images/photos/2013/05/17/original/kristin-kreuk-4-5195f12f24f9f.jpg
            return src.replace(/(\/images\/photos\/[0-9]+\/[0-9]+\/[0-9]+\/)[a-z]+(\/[^/]*\.[^/.]*)$/, "$1original$2");
        }

        if (domain_nosub === "hsmedia.ru") {
            // http://n1s2.hsmedia.ru/b2/68/53/b268534296034073da54fe199e02fa60/440x660_1_6456fe81c89f61ae8f59b1e4c2c2b338@440x660_0xc0a839a2_10376472071471436248.jpeg
            //   http://n1s2.hsmedia.ru/b2/68/53/b268534296034073da54fe199e02fa60/440x660_0xc0a839a2_10376472071471436248.jpeg
            // http://n1s1.hsmedia.ru/3a/18/5b/3a185b9d81db36aaa6665378971dc501/235x142_21_727a7fd3ae01a11bedf6072aa3db308a@1732x1046_0x0a330ca2_9361423281533279737.jpeg
            //   http://n1s1.hsmedia.ru/3a/18/5b/3a185b9d81db36aaa6665378971dc501/1732x1046_0x0a330ca2_9361423281533279737.jpeg
            return src.replace(/(:\/\/[^/]*\/[0-9a-f]{2}\/[0-9a-f]{2}\/[0-9a-f]{2}\/[0-9a-f]+\/)[0-9]+x[0-9]+_[^/]*@([0-9]+x[0-9]+_[^/]*)$/, "$1$2");
        }

        if (domain_nowww === "starbeat.ru" &&
            src.indexOf("/gallery/") >= 0) {
            // http://starbeat.ru/gallery/kristin-kreuk/kristin-kreuk-cw-network-2013-upfront-in-nyc/small/kristin-kreuk---cw-network-2013-upfront-in-nyc--10_Starbeat.ru.jpg
            //   http://starbeat.ru/gallery/kristin-kreuk/kristin-kreuk-cw-network-2013-upfront-in-nyc/kristin-kreuk---cw-network-2013-upfront-in-nyc--10_Starbeat.ru.jpg
            return src.replace(/\/(?:small|medium)\/([^/]*)$/, "/$1");
        }

        if ((domain === "image.kilimall.com" ||
             // https://d2lpfujvrf17tu.cloudfront.net/uganda/shop/store/goods/788/2017/11/788_05649359385016211_240.jpg
             domain === "d2lpfujvrf17tu.cloudfront.net") &&
            src.indexOf("/shop/store/") >= 0) {
            // https://image.kilimall.com/uganda/shop/store/goods/788/2017/11/788_05649359385016211_240.jpg
            //   https://image.kilimall.com/uganda/shop/store/goods/788/2017/11/788_05649359385016211.jpg
            // https://image.kilimall.com/uganda/shop/store/goods/1008/2018/06/1008_05821550736572452_240.jpg
            //   https://image.kilimall.com/uganda/shop/store/goods/1008/2018/06/1008_05821550736572452.jpg -- 403
            return src.replace(/(\/[0-9]+_[0-9]+)_[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "zevenmart.com") {
            // https://zevenmart.com/images/stories/virtuemart/category/resized/hombre_0x660.jpg
            //   https://zevenmart.com/images/stories/virtuemart/category/hombre.jpg
            return src.replace(/\/resized\/([^/]*)_[0-9]+x[0-9]+(\.[^/.]*)$/, "/$1$2");
        }

        if (domain_nowww === "superherotv.net" ||
            // http://starsplanet.ru/photo/images_small/selena_gomez_photo_2010/selena_gomes_photo_2010_starsplanet.ru_034.jpg
            //   http://starsplanet.ru/photo/images_large/selena_gomez_photo_2010/selena_gomes_photo_2010_starsplanet.ru_034.jpg
            domain_nowww === "starsplanet.ru") {
            // http://www.superherotv.net/photo/images_small/lyndsy_fonseca/superherotv.net_lyndsy_fonseca_035.jpg -- 150x200
            //   http://www.superherotv.net/photo/images_large/lyndsy_fonseca/superherotv.net_lyndsy_fonseca_035.jpg -- 2809x3750
            return src.replace(/\/photo\/images_small\//, "/photo/images_large/");
        }

        if (domain_nowww === "xxx-photo.com") {
            // https://www.xxx-photo.com/m/photo/t/1704/06/608511/610496-daisy-ridley-wearing-a-green-dress_t.jpg
            //   https://www.xxx-photo.com/m/photo/i/1704/06/608511/610496-daisy-ridley-wearing-a-green-dress.jpg
            return src.replace(/\/photo\/t\/(.*)_t(\.[^/.]*)$/, "/photo/i/$1$2");
        }

        if (domain_nowww === "div.bg") {
            // http://div.bg/pictures/1638721_886_.jpg
            //   http://div.bg/pictures/1638721.jpg
            return src.replace(/(\/pictures\/[0-9]+)_[0-9]+_(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "cdn.hqsluts.com" ||
            // https://www.hqbabes.com/t/3p159968
            //   https://www.hqbabes.com/t/3c159968
            domain_nowww === "hqbabes.com" ||
            // https://c.xme.net/3p159968
            //   https://c.xme.net/3c159968
            domain === "c.xme.net") {
            // http://cdn.hqsluts.com/0p313268
            //   http://cdn.hqsluts.com/0c313268
            return src.replace(/(:\/\/[^/]*\/(?:t\/)?[0-9]+)[a-z]([0-9]+(?:\.[^/.]*)?)$/, "$1c$2");
        }

        if (domain_nowww === "sensualgirls.org" &&
            src.indexOf("/media/pictures/") >= 0) {
            // https://www.sensualgirls.org/media/pictures/2016-12-05-young-beauty/01_thumb.jpg
            //   https://www.sensualgirls.org/media/pictures/2016-12-05-young-beauty/01.jpg
            return {
                url: src.replace(/(\/[^/.]*)_thumb(\.[^/.]*)$/, "$1$2"),
                headers: {
                    Origin: "https://www.sensualgirls.org/",
                    Referer: "https://www.sensualgirls.org/"
                }
            };
        }

        if ((domain_nosub === "mainbabes.com" && domain.match(/^content[0-9]*\./)) ||
            // https://content4.livejasminbabes.net/zishy.com/0070/tn_01.jpg
            (domain_nosub === "livejasminbabes.net" && domain.match(/^content[0-9]*\./)) ||
            // https://content8.babesandgirls.com/met-art/1073/tn_01.jpg
            (domain_nosub === "babesandgirls.com" && domain.match(/^content[0-9]*\./)) ||
            // https://content6.exgirlfriendmarket.com/digitaldesire.com/1157/tn_02.jpg
            // https://contenta.exgirlfriendmarket.com/digitaldesire.com/1157/tn_01.jpg
            (domain_nosub === "exgirlfriendmarket.com" && domain.match(/^content[0-9a-z]*\./)) ||
            // http://pornodontstop.com/gallery/fucasvz/7980/tn_002.jpg
            domain_nosub === "pornodontstop.com") {
            // https://content8.mainbabes.com/amourangels.com/1122/tn_00.jpg
            //   https://content8.mainbabes.com/amourangels.com/1122/00.jpg
            newsrc = src.replace(/\/tn_([0-9]+\.[^/.]*)$/, "/$1");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain_nosub === "livejasminbabes.net" && domain.match(/^content[0-9]*\./)) {
            // https://content6.livejasminbabes.net/upload/main/tn/8/3603785.jpg
            //   https://content6.livejasminbabes.net/upload/main/8/3603785.jpg
            return src.replace(/\/upload\/main\/tn\//, "/upload/main/");
        }

        if (domain_nowww === "captaingoodlink.com" &&
            src.indexOf("/celebrities/") >= 0) {
            // http://captaingoodlink.com/celebrities/emma_watson/tn_emma_watson_0062.jpg
            //   http://captaingoodlink.com/celebrities/emma_watson/emma_watson_0062.jpg
            return src.replace(/\/tn_([^/]*\.[^/.]*)$/, "/$1");
        }

        if (domain_nosub === "pornodontstop.com" ||
            // http://hosted.amourangels.com/sexyteenicecream/4064/th_99485.jpg
            //   http://hosted.amourangels.com/sexyteenicecream/4064/99485.jpg
            domain === "hosted.amourangels.com" ||
            // http://hornyteen.pro/g/3423bd/th_01.jpg
            //   http://hornyteen.pro/g/3423bd/01.jpg
            domain_nowww === "hornyteen.pro" ||
            // http://teengalleries.mobi/g/d55bf2/th_02.jpg
            //   http://teengalleries.mobi/g/d55bf2/02.jpg
            domain_nowww === "teengalleries.mobi") {
            // http://pornodontstop.com/gallery/aangels/nelly-juicy-nude-body/th_002.jpg
            //   http://pornodontstop.com/gallery/aangels/nelly-juicy-nude-body/002.jpg
            return src.replace(/\/th_([0-9]+\.[^/.]*)$/, "/$1");
        }

        if (domain === "i.girlstop.info") {
            // http://i.girlstop.info/cat/posts/58bfcf7f0e7eb9.60090633/thumbs/450px_1.jpg
            //   http://i.girlstop.info/cat/posts/58bfcf7f0e7eb9.60090633/1.jpg
            return src.replace(/\/thumbs\/[0-9]+px_([^/]*)$/, "/$1");
        }

        if (domain === "img.freeones.com") {
            // https://img.freeones.com/images/freeones/pinned_pictures/pin/0429/55117.gif
            //   https://img.freeones.com/images/freeones/pinned_pictures/original/0429/55117.gif
            return src.replace(/\/pinned_pictures\/pin\//, "/pinned_pictures/original/");
        }

        if (domain_nowww === "starspics.ru" ||
            // http://otherstars.ru/thumbs/2018-07/04/i4t4of06zdfa1un0t7vqsukf2.jpg
            //   http://otherstars.ru/img/2018-07/04/i4t4of06zdfa1un0t7vqsukf2.jpg
            domain_nowww === "otherstars.ru") {
            // http://starspics.ru/thumbs/2016-10/11/g4hd7ipoglpzy5tcitoip2fze.jpg
            //   http://starspics.ru/img/2016-10/11/g4hd7ipoglpzy5tcitoip2fze.jpg
            return src.replace(/(:\/\/[^/]*\/)thumbs\//, "$1img/");
        }

        if (domain === "images.apina.biz") {
            // https://images.apina.biz/thumbs/t_166714.jpg
            //   https://images.apina.biz/medium/m_166714.jpg
            //   https://images.apina.biz/full/166714.jpg
            return src.replace(/(:\/\/[^/]*\/)[a-z]+\/[a-z]+_([0-9]+\.[^/.]*)$/, "$1full/$2");
        }

        if (domain_nowww === "pluska.sk") {
            // https://www.pluska.sk/thumb/images/emma/krasna/emma-watson-zmenila-imidz-neuverite-co-spravila-so-svojimi-vlasmi/profimedia-0304405320.jpg?w=220&h=220&ip=6
            //   https://www.pluska.sk/images/emma/krasna/emma-watson-zmenila-imidz-neuverite-co-spravila-so-svojimi-vlasmi/profimedia-0304405320.jpg?w=220&h=220&ip=6
            return src.replace(/\/thumb\/images\//, "/images/");
        }

        if (domain_nowww === "mad-movies.com") {
            // https://www.mad-movies.com/98-132-0-images/MM_PersonsPhotos/2DN3Hi8AxyiUClzCun7ANG3YBhS.jpg
            //   https://www.mad-movies.com/images/MM_PersonsPhotos/2DN3Hi8AxyiUClzCun7ANG3YBhS.jpg
            return src.replace(/(:\/\/[^/]*\/)[0-9]+-[0-9]+-[0-9]+-images\//, "$1images/");
        }

        if (domain === "assets.mycast.io") {
            // https://assets.mycast.io/actors/6730_tiny.jpg?1518685234
            //   https://assets.mycast.io/actors/6730_original.jpg?1518685234
            return src.replace(/(\/[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1_original$2");
        }

        if (domain === "cdn.cinemur.fr") {
            // https://cdn.cinemur.fr/persons/cache/225x225_109475.jpg
            //   https://cdn.cinemur.fr/persons/original/109475.jpg
            // http://cdn.cinemur.fr/movies/blur/234885.jpg
            //   http://cdn.cinemur.fr/movies/original/234885.jpg
            return src.replace(/(?:\/cache\/[0-9]+x[0-9]+_|\/blur\/)([0-9]+\.[^/.]*)$/, "/original/$1");
        }

        if (domain_nowww === "farfarawaysite.com") {
            // http://www.farfarawaysite.com/temple/m-m/maisiesell/shoots1/hires/t/19.jpg
            //   http://www.farfarawaysite.com/temple/m-m/maisiesell/shoots1/hires/19.jpg
            return src.replace(/\/hires\/t\//, "/hires/");
        }

        if (domain === "movieplayer.net-cdn.it" ||
            // https://multiplayer.net-cdn.it/thumbs/images/2017/11/15/the-game-awards-2017-trailer-logo_jpg_1400x0_q85.jpg
            //   https://multiplayer.net-cdn.it/images/2017/11/15/the-game-awards-2017-trailer-logo.jpg
            // https://multiplayer.net-cdn.it/thumbs/images/2017/03/11/legow1_jpg_800x0_crop_upscale_q85.jpg
            //   https://multiplayer.net-cdn.it/images/2017/03/11/legow1.jpg
            domain === "multiplayer.net-cdn.it") {
            // https://movieplayer.net-cdn.it/t/images/2016/06/24/maisierichardsonse_3142640b_jpg_363x200_crop_q85.jpg
            //   https://movieplayer.net-cdn.it/images/2016/06/24/maisierichardsonse_3142640b.jpg
            return src.replace(/\/(?:t|thumbs)\/images\/(.*?)_([a-z]+)_(?:[0-9]+x[0-9]+_)?(?:crop_)?(?:upscale_)?(?:q[0-9]+)?(\.[^/.]*)$/, "/images/$1.$2");
        }

        if (domain === "u.livelib.ru") {
            // https://u.livelib.ru/album/1000007170/m/lggajq57/dbstatic.no-m.jpg
            //   https://u.livelib.ru/album/1000007170/o/lggajq57/o-o.jpeg
            return src
                .replace(/\/[a-z](\/[a-z0-9]+\/)[^/]*(\.[^/.]*)$/, "/o$1o-o$2")
                .replace(/\.jpg(\?.*)?$/, ".jpeg$1");
        }

        if (domain_nowww === "dbstatic.no") {
            // https://www.dbstatic.no/68267011.jpg?imageId=68267011&x=0&y=0&cropw=100&croph=100&width=1024&height=1539
            //   https://www.dbstatic.no/68267011.jpg -- 100x150
            //   https://www.dbstatic.no/68267011.jpg?width=-1&height=-1 -- 1664x2500
            return src.replace(/(:\/\/[^/]*\/[0-9]+\.[^/.]*?)(?:\?.*)?$/, "$1?width=-1&height=-1");
        }

        if (domain_nosub === "celebsnetworth.org") {
            // https://movies.celebsnetworth.org/main/thumbs/3918035_Zendaya.jpg
            //   https://movies.celebsnetworth.org/main/images/3918035_Zendaya.jpg
            return src.replace(/(:\/\/[^/]*\/main\/)thumbs\//, "$1images/");
        }

        if (domain_nowww === "multimedios.com") {
            // http://www.multimedios.com/files/og_thumbnail/uploads/2017/09/04/59ad996ab60d9.jpeg
            //   http://www.multimedios.com/uploads/2017/09/04/59ad996ab60d9.jpeg
            return src.replace(/(:\/\/[^/]*\/)files\/[^/]*\/uploads\//, "$1uploads/");
        }

        if (domain === "file.hstatic.net") {
            // https://file.hstatic.net/1000162927/file/zendaya-feet-2287006_grande.jpg
            //   https://file.hstatic.net/1000162927/file/zendaya-feet-2287006.jpg
            return src.replace(/(\/file\/[^/]*-[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "sm.askmen.com") {
            // https://sm.askmen.com/t/askmen_pt/photo/default/zendaya-mj_y5jx.640.jpg
            //   https://sm.askmen.com/askmen_pt/photo/default/zendaya-mj_y5jx.jpg
            return src.replace(/(:\/\/[^/]*\/)t\/(.*\/[^/]*)\.[0-9]+(\.[^/.]*)$/, "$1$2$3");
        }

        if (domain_nowww === "elsiglodetorreon.com.mx") {
            // https://www.elsiglodetorreon.com.mx/m/ni/2018/08/1086642.300.jpg
            //   https://media22.elsiglodetorreon.com.mx/i/2018/08/1086642.jpeg
            // https://www.elsiglo.mx/m/ng/2017/05/27273259.800.jpg
            return src
                .replace(/:\/\/[^/]*\/m\/ni\/(.*\/[0-9]+)\.[0-9]+(\.[^/.]*)$/,
                         "://media22.elsiglodetorreon.com.mx/i/$1$2")
                .replace(/\.jpg(\?.*)?$/, ".jpeg$1");
        }

        if (domain_nowww === "elsiglo.mx") {
            // https://www.elsiglo.mx/m/g/2017/05/27273259_m.jpeg
            //   https://www.elsiglo.mx/m/g/2017/05/27273259.jpeg
            // https://www.elsiglo.mx/m/ng/2017/05/27273259.800.jpg
            //   https://www.elsiglo.mx/m/g/2017/05/27273259.jpeg
            return src
                .replace(/(:\/\/[^/]*\/m\/)n([a-z]\/.*\/[0-9]+)\.[0-9]+(\.[^/.]*)$/,
                         "$1$2$3")
                .replace(/(\/[0-9]+)_[a-z](\.[^/.]*)$/, "$1$2")
                .replace(/\.jpg(\?.*)?$/, ".jpeg$1");
        }

        if (domain === "img.richestcelebrities.org" ||
            // https://celebritypictures.wiki/thumbs/2851530/2851530_1.jpeg
            //   https://celebritypictures.wiki/images/2851530/2851530_1.jpeg
            domain_nowww === "celebritypictures.wiki" ||
            // http://thefappeningpics.com/thumbs/Bella-Thorne-Sexy-1-1.jpg
            //   http://thefappeningpics.com/images/Bella-Thorne-Sexy-1-1.jpg
            domain_nowww === "thefappeningpics.com") {
            // http://img.richestcelebrities.org/thumbs/5154_lucy-liu/5154_lucy-liu_1.jpeg
            //   http://img.richestcelebrities.org/images/5154_lucy-liu/5154_lucy-liu_1.jpeg
            return src.replace(/(:\/\/[^/]*\/)thumbs\//, "$1images/");
        }

        if (domain_nowww === "fashionscene.nl") {
            // https://www.fashionscene.nl/ckfinder/userfiles/images/Fashionscene/Beelden%202014/juni/Tess%20Duinker(1)_thumb_743x743.jpg
            //   https://www.fashionscene.nl/ckfinder/userfiles/images/Fashionscene/Beelden%202014/juni/Tess%20Duinker(1).jpg
            return src.replace(/_thumb_[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "monitor.bg") {
            // https://www.monitor.bg/web/files/articles/94270/gallery/thumb_480x0_rihanna.jpg
            //   https://www.monitor.bg/web/files/articles/94270/gallery/rihanna.jpg
            return src.replace(/\/gallery\/thumb_[0-9]+x[0-9]+_([^/]*)$/, "/gallery/$1");
        }

        if (domain_nowww === "textilwirtschaft.de" ||
            // https://www.fashionmagazine.it/gallery/media/4383/166583-detailp.jpeg
            //   https://www.fashionmagazine.it/gallery/media/4383/166583.jpeg
            domain_nowww === "fashionmagazine.it") {
            // https://www.textilwirtschaft.de/gallery/media/9940/182251-detailp.jpeg
            //   https://www.textilwirtschaft.de/gallery/media/9940/182251.jpeg
            return src.replace(/(\/gallery\/media\/[0-9]+\/[0-9]+)-[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "horizont.net" && src.indexOf("/media/") >= 0) {
            // https://www.horizont.net/news/media/9/--85650-detail.jpeg
            //   https://www.horizont.net/news/media/9/--85650.jpeg
            // https://www.horizont.net/news/media/9/Peter-Krause-Foto-Triplesense-88166-detail.jpeg
            //   https://www.horizont.net/news/media/9/Peter-Krause-Foto-Triplesense-88166.jpeg
            return src.replace(/(-[0-9]+)-[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "twproxy.stiletto.fr") {
            // http://twproxy.stiletto.fr/2h319489/w600/www.stiletto.fr/uploads/pictures/2016/05/rihanna_red001.jpg
            //   http://www.stiletto.fr/uploads/pictures/2016/05/rihanna_red001.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/[0-9a-z]+\/[wh][0-9]+\//, "http://");
        }

        if (domain_nowww === "we123.com") {
            // http://www.we123.com/img/p.php?p=http://mmbiz.qpic.cn/mmbiz_jpg/mic8pHL2lAewRjSSd4ZLYyNDXHVsgicPb1NGiap4iaBPmZgdxTn02bS0skuDDoIiaRJcNzfUj67gaKMqpvsVVdB6yJw/0?wx_fmt=jpeg -- text/html
            //   http://mmbiz.qpic.cn/mmbiz_jpg/mic8pHL2lAewRjSSd4ZLYyNDXHVsgicPb1NGiap4iaBPmZgdxTn02bS0skuDDoIiaRJcNzfUj67gaKMqpvsVVdB6yJw/0?wx_fmt=jpeg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/img\/p\.php.*?[?&]p=([^&]*).*?$/, "$1"));
        }

        if (domain_nosub === "vagalume.com" &&
            domain.match(/^s[0-9]*\.vagalume/)) {
            // https://s2.vagalume.com/rihanna/images/112365w260.jpg
            //   https://s2.vagalume.com/rihanna/images/112365.jpg
            return src.replace(/(\/images\/[0-9]+)[wh][0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "storage.gra1.cloud.ovh.net" &&
            src.match(/\/Futurenet[^/]*Images\//)) {
            // https://storage.gra1.cloud.ovh.net/v1/AUTH_b28011873a5246aa8e71be0a276335cc/Futurenet%20Images/2d10134db57f7b765011bbf4b3014a3b56fedadd8f75c5e308bdc8ff6c0c6e9f1737426abafe9fceedbb1a66e0126acc464ec8c731c18ccc81851b5804e9c208/8fb6fffcf916c06919436c6395413119328e6cce21e1947aef33498a1be545cc47efaf0010ebbecacabfc992af77044b682703261564da50d15dcca5ee6ab6f1/ce10e6bd025ad8fbe55adb7cafe41dcfaa0b2815b7637689dae71dada276e6919feea97a7291a5dab16e69c6d1cea6b6f0d90d766696086ef185a79cb56ecad8/c57528adb699c3718764a51d6fe8f19d93f175ef299ac2508b12781b169c3aa6e5a1d9561771f63e2debb0a12c4c7769642d3113b61ad072b6db1bde9542e93a_640x480
            //   https://storage.gra1.cloud.ovh.net/v1/AUTH_b28011873a5246aa8e71be0a276335cc/Futurenet%20Images/2d10134db57f7b765011bbf4b3014a3b56fedadd8f75c5e308bdc8ff6c0c6e9f1737426abafe9fceedbb1a66e0126acc464ec8c731c18ccc81851b5804e9c208/8fb6fffcf916c06919436c6395413119328e6cce21e1947aef33498a1be545cc47efaf0010ebbecacabfc992af77044b682703261564da50d15dcca5ee6ab6f1/ce10e6bd025ad8fbe55adb7cafe41dcfaa0b2815b7637689dae71dada276e6919feea97a7291a5dab16e69c6d1cea6b6f0d90d766696086ef185a79cb56ecad8/c57528adb699c3718764a51d6fe8f19d93f175ef299ac2508b12781b169c3aa6e5a1d9561771f63e2debb0a12c4c7769642d3113b61ad072b6db1bde9542e93a -- 800x953
            return src.replace(/_[0-9]+x[0-9]+(\?.*)?$/, "$1");
        }

        if (domain === "iasbh.tmgrup.com.tr") {
            // https://iasbh.tmgrup.com.tr/4a8eed/0/0/0/0/0/0?u=http://i.sabah.com.tr/sb/fotohaber/magazin/rihanna-star-trekle-nasil-tanisti/19.jpg&mw=752&mh=700
            //   http://i.sabah.com.tr/sb/fotohaber/magazin/rihanna-star-trekle-nasil-tanisti/19.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/[0-9a-f]+\/(?:[0-9]+\/){5}[0-9]+.*?[?&]u=([^&]*).*?$/,"$1"));
        }

        if (domain_nowww === "bideew.com") {
            // https://www.bideew.com/photos/thumbnail/274324/large/
            //   https://www.bideew.com/photos/thumbnail/274324/master/
            return src.replace(/(\/photos\/thumbnail\/[0-9]+\/)[a-z]+(\/*)(\?.*)?$/, "$1master$2$3");
        }

        if (domain === "media.filfan.com") {
            // https://media.filfan.com/NewsPics/FilfanNew/medium/AMRFOUADE_181.jpg
            //   https://media.filfan.com/NewsPics/FilfanNew/original/AMRFOUADE_181.jpg
            return src.replace(/(\/NewsPics\/[^/]*\/)[a-z]+(\/[^/]*)$/, "$1original$2");
        }

        if (domain_nowww === "ana.rs") {
            // https://www.ana.rs/forum/thumbs/img.php?src=https%3A%2F%2Fencrypted-tbn2.gstatic.com%2Fimages%3Fq%3Dtbn%3AANd9GcR7sIQUM-nZmJnjBnexRoKN7rxXhU83mkzTQGym27u14gZLhAZR
            //   https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcR7sIQUM-nZmJnjBnexRoKN7rxXhU83mkzTQGym27u14gZLhAZR
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/forum\/thumbs\/img\.php.*?[?&]src=([^&]*).*?$/, "$1"));
        }

        if (domain_nosub === "itvnet.lv" &&
            src.match(/\/upload[0-9]*\/articles\//)) {
            // https://spi3uk.itvnet.lv/upload2/articles/71/715723/thumbs/500Vai-zinaji-ka-sis-7-1.jpg
            //   https://spi3uk.itvnet.lv/upload2/articles/71/715723/images/Vai-zinaji-ka-sis-7-1.jpg
            //   https://spi3uk.itvnet.lv/upload2/articles/71/715723/images/_origin_Vai-zinaji-ka-sis-7-1.jpg
            // https://spi4uk.itvnet.lv/upload/articles/30/304098/images/T-257.jpg -- 830x518
            //   https://spi4uk.itvnet.lv/upload/articles/30/304098/images/_origin_T-257.jpg -- 1680x1050
            return src
                .replace(/\/thumbs\/[0-9]+([^/]*)$/, "/images/$1")
                .replace(/\/images\/([^_][^/]*)$/, "/images/_origin_$1")
        }

        if (domain_nowww === "connectgalaxy.com") {
            // https://www.connectgalaxy.com/gallery/icon/308734/taggable -- 376x550
            //   https://www.connectgalaxy.com/gallery/download/308734 -- 3600x5259
            return src.replace(/\/gallery\/icon\/([0-9]+)\/[a-z0-9]+(\?.*)?$/, "/gallery/download/$1");
        }

        if (domain === "nst.sky.it") {
            // https://nst.sky.it/content/dam/static/contentimages/original/sezioni/cinema/news/2017/08/09/sharon-stone-posa/Emma_Watson_kika2859146.jpg/_jcr_content/renditions/cq5dam.web.393.462.jpeg
            //   https://nst.sky.it/content/dam/static/contentimages/original/sezioni/cinema/news/2017/08/09/sharon-stone-posa/Emma_Watson_kika2859146.jpg
            return src.replace(/(\/[^/]*\.[^/.]*)\/_jcr_content\/renditions\/.*/, "$1");
        }

        if (domain === "cdnimage.terbitsport.com") {
            // http://cdnimage.terbitsport.com/image.php?width=84&height=55&cropratio=2:1&image=http://cdnimage.terbitsport.com/imagebank/gallery/large/20170221_100743_harianterbit_emma.jpg
            //   http://cdnimage.terbitsport.com/imagebank/gallery/large/20170221_100743_harianterbit_emma.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/image\.php.*?[?&]image=([^&]*).*?$/, "$1"));
        }

        if (domain_nowww === "beimg.com") {
            // https://beimg.com/fangimg.php?url=http://mmbiz.qpic.cn/mmbiz_jpg/pAO4jjrWd1Ts86FYpT2FNVRSiciaZ9osic0icicRiaNnsaGyWVncxMF0YwhcMD4cb7lTMCLVgbx6a7LpOg7nes0YeoLA/0?
            //   http://mmbiz.qpic.cn/mmbiz_jpg/pAO4jjrWd1Ts86FYpT2FNVRSiciaZ9osic0icicRiaNnsaGyWVncxMF0YwhcMD4cb7lTMCLVgbx6a7LpOg7nes0YeoLA/0?
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/fangimg\.php.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        if (domain_nowww === "que.es") {
            // http://www.que.es/archivos/201008/emma-watson-ancha-365xXx80.jpg
            //   http://www.que.es/archivos/201008/emma-watson-ancha.jpg
            return src.replace(/-[0-9X]+x[0-9X]+(?:x[0-9]+)?(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "independent.com.mt") {
            // http://www.independent.com.mt/file.aspx?f=124066&width=630&height=340
            //   http://www.independent.com.mt/file.aspx?f=124066
            return src.replace(/(:\/\/[^/]*\/file\.aspx).*?[?&](f=[0-9]+).*?$/, "$1?$2");
        }

        if (domain === "img.selenka.pl") {
            // http://img.selenka.pl/walls/a36f0bc8643a5315/z.jpg
            //   http://img.selenka.pl/walls/a36f0bc8643a5315/o.jpg -- 1920x1200
            // http://img.selenka.pl/fbwalls/f592eda2469339fb/z.jpg
            //   http://img.selenka.pl/fbwalls/f592eda2469339fb/o.jpg
            // doesn't work for all:
            // http://img.selenka.pl/walls/7564da16c6dc0c20/z.jpg
            //   http://img.selenka.pl/walls/7564da16c6dc0c20/o.jpg -- 404
            return src.replace(/(\/(?:fb)?walls\/[0-9a-f]+\/)[a-z](\.[^/.]*)$/, "$1o$2");
        }

        if (domain === "ki.ill.in.ua") {
            // https://ki.ill.in.ua/m/670x450/24042127.jpg
            //   https://ki.ill.in.ua/m/0x0/24042127.jpg
            return src.replace(/\/[0-9]+x[0-9]+(\/[0-9]+\.[^/.]*)$/, "/0x0$1");
        }

        if (domain === "stg.pcg.space") {
            // http://stg.pcg.space/source/1/7/3/4/8/1734843/large.jpg
            //   http://stg.pcg.space/source/1/7/3/4/8/1734843/org.jpg
            // http://stg.pcg.space/source/1/0/8/5/8/1085844/wide.jpg
            //   http://stg.pcg.space/source/1/0/8/5/8/1085844/org.jpg
            // http://stg.pcg.space/source/2/0/2/3/8/2023806/medium.jpg
            //   http://stg.pcg.space/source/2/0/2/3/8/2023806/org.jpg
            return src.replace(/\/[a-z]+(\.[^/.]*)$/, "/org$1");
        }

        if (domain === "static.noticiasaominuto.com" ||
            // https://static.noticiasaominuto.com.br/stockimages/gallery/1920/naom_5a9c9a20cc942.jpg -- 720x1080
            //   https://static.noticiasaominuto.com.br/stockimages/hires_original/naom_5a9c9a20cc942.jpg -- 3446x5168
            domain === "static.noticiasaominuto.com.br") {
            // https://static.noticiasaominuto.com/stockimages/gallery/1920/naom_590064d2d86e4.jpg -- stretched
            //   https://static.noticiasaominuto.com/stockimages/hires_original/naom_590064d2d86e4.jpg
            // https://static.noticiasaominuto.com/stockimages/1920/naom_5af00562d40f1.jpg -- 1920x1080
            //   https://static.noticiasaominuto.com/stockimages/hires_original/naom_5af00562d40f1.jpg -- 2800x1866
            return src.replace(/(\/stockimages\/)(?:gallery\/)?[^/]*(\/[^/]*)$/, "$1hires_original$2");
        }

        // PHP-Fusion
        if (domain_nowww === "harry-potter.net.pl") {
            // http://www.harry-potter.net.pl/images/photoalbum/album_63/emma-watson-vogue-australia-8_t2.jpg
            //   http://www.harry-potter.net.pl/images/photoalbum/album_63/emma-watson-vogue-australia-8.jpg
            // http://www.harry-potter.net.pl/images/photoalbum/album_63/emma-watson-vogue-australia_t1.jpg
            //   http://www.harry-potter.net.pl/images/photoalbum/album_63/emma-watson-vogue-australia.jpg
            return src.replace(/(\/images\/photoalbum\/[^/]*\/[^/]*)_t[0-9](\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "krauzer.ru" ||
            // https://kino.tricolor.tv/upload/resize_cache/iblock/dc0/800_800_1/bf1603d051ab8d4e2c0e8865885685d2740702740b52d7b809d1f848dd80e68e-1024x1024.jpg
            //   https://kino.tricolor.tv/upload/iblock/dc0/bf1603d051ab8d4e2c0e8865885685d2740702740b52d7b809d1f848dd80e68e-1024x1024.jpg
            domain === "kino.tricolor.tv" ||
            // http://www.sncmedia.ru/upload/resize_cache/iblock/9f4/400_1000_1/9f4f08d742e2118787bd6e5ee83a5980.jpg
            //   http://www.sncmedia.ru/upload/iblock/9f4/9f4f08d742e2118787bd6e5ee83a5980.jpg
            domain_nowww === "sncmedia.ru") {
            // http://krauzer.ru/upload/resize_cache/iblock/edf/600_600_1/edfdf59938b3ed07d5bad9c3da49e852.jpg
            //   http://krauzer.ru/upload/iblock/edf/edfdf59938b3ed07d5bad9c3da49e852.jpg
            return src.replace(/\/resize_cache(\/.*\/)[0-9]+_[0-9]+_[0-9]+\/([0-9a-f]+(?:-[0-9]+x[0-9]+)?\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "super.ru") {
            // http://super.ru/upload/iblock/4ca/4cad0d094ca6ff449fc32e0d63c1c97f_w749_h905_nocrp.jpg
            //   http://super.ru/upload/iblock/4ca/4cad0d094ca6ff449fc32e0d63c1c97f.jpg
            return src.replace(/(\/upload\/iblock\/[0-9a-f]+\/[0-9a-f]+)_[a-z0-9_]+(\.[^/.]*)$/, "$1$2");
        }

        if ((domain_nosub === "kanobu.ru" ||
             // http://i06.kanobu.net/r/22d1e932549980bcf58a9fc6da48898e/1040x-/u.kanobu.ru/editor/images/73/6b94d681-534d-4e8d-9fae-aaa2055cee06.jpg
             //   https://u.kanobu.ru/editor/images/73/6b94d681-534d-4e8d-9fae-aaa2055cee06.jpg
             domain_nosub === "kanobu.net") &&
            domain.match(/^i[0-9]*\./)) {
            // https://i10.kanobu.ru/r/91faf8a08abc774080a581d5e93b3d27/1040x-/u.kanobu.ru/editor/images/50/fdefed64-bfc3-4c01-a84e-1e85ddf209c2.jpg
            //   https://u.kanobu.ru/editor/images/50/fdefed64-bfc3-4c01-a84e-1e85ddf209c2.jpg
            return src.replace(/:\/\/[^/]*\/r\/[0-9a-f]+\/[-0-9]+x[-0-9]+\//, "://");
        }

        if (domain_nowww === "tv3.lt") {
            // https://www.tv3.lt/usi/980x654/2/af/ae/be/afaebed980933add6f1c3de2d1870415.jpg?v=4.0.4.37&t=cr&s=980x654&m=2&f=/Uploads/UGallery/photos/6d/42/55/31/6d425531aca787350bbe5ab170abddff.jpg
            //   https://www.tv3.lt/Uploads/UGallery/photos/6d/42/55/31/6d425531aca787350bbe5ab170abddff.jpg
            return src
                .replace(/(:\/\/[^/]*\/)usi\/.*[?&]f=([^&]*).*?$/, "$1$2")
                .replace(/(:\/\/[^/]*\/)\/*/, "$1");
        }

        if (domain_nosub === "gallery.ru" &&
            domain.match(/^data[0-9]*\.(?:i\.)?gallery\.ru/)) {
            // http://data28.i.gallery.ru/albums/gallery/171772-3f95a-97183306-h200-u1bfa6.jpg
            //   http://data28.i.gallery.ru/albums/gallery/171772-3f95a-97183306-h999999999999-u1bfa6.jpg
            //   http://data28.i.gallery.ru/albums/gallery/171772-3f95a-97183306-.jpg
            // http://data12.gallery.ru/albums/gallery/393321-84bd6-79756659-m750x740-u59fad.jpg
            //   http://data12.gallery.ru/albums/gallery/393321-84bd6-79756659-.jpg
            // http://data12.gallery.ru/albums/gallery/229815--35971692-m750x740.jpg
            //   http://data12.gallery.ru/albums/gallery/229815--35971692-.jpg
            // http://data31.i.gallery.ru/albums/gallery/99613-84e79-106270413-200-ua0c4b.jpg
            //   http://data31.i.gallery.ru/albums/gallery/99613-84e79-106270413-.jpg
            // http://data32.i.gallery.ru/albums/gallery/99613-a420d-109105308-c300x200-ued55e.jpg
            //   http://data32.i.gallery.ru/albums/gallery/99613-a420d-109105308-.jpg
            //return src.replace(/(\/albums\/gallery\/[^/]*-)[wh][0-9]+(-[0-9a-z]+\.[^/.]*)$/, "$1h999999999999$2");
            return src.replace(/(\/albums\/gallery\/[^/]*-[0-9]{5,}-)[whmc]?[0-9]+(?:x[0-9]+)?(?:-[0-9a-z]+)?(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "fotosdefamosas.tk") {
            // http://www.fotosdefamosas.tk/Fotos/Camren_Bicondova/miniaturas/TN_Camren_Bicondova_040.jpg
            //   http://www.fotosdefamosas.tk/Fotos/Camren_Bicondova/Camren_Bicondova_040.jpg
            return src.replace(/\/miniaturas\/TN_([^/]*)$/, "/$1");
        }

        if (domain_nowww === "starwiki.org") {
            // https://starwiki.org/thumbs/photos/women-halle-berry-grey/001-women-halle-berry-grey-starwiki.org.jpg
            //   https://starwiki.org/photos/women-halle-berry-grey/001-women-halle-berry-grey-starwiki.org.jpg
            return {
                url: src.replace(/\/thumbs\/photos\//, "/photos/"),
                head_wrong_contenttype: true
            };
        }

        if (domain_nowww === "postervdom.ru" && src.indexOf("/upload/") >= 0) {
            // http://postervdom.ru/upload/shop_3/3/1/6/item_3160/small_item_3160.jpg
            //   http://postervdom.ru/upload/shop_3/3/1/6/item_3160/item_3160.jpg
            return src.replace(/(\/item_[0-9]+\/)[a-z]+_(item_[0-9]+[^/]*)$/, "$1$2");
        }

        if (domain_nosub === "fastpic.ru" &&
            domain.match(/^i[0-9]*\.fastpic\.ru/)) {
            // http://i42.fastpic.ru/thumb/2012/0923/e8/f6e016d1ec53db2c82a762961f1051e8.jpeg
            //   http://i42.fastpic.ru/big/2012/0923/e8/f6e016d1ec53db2c82a762961f1051e8.jpg
            return src.replace(/(:\/\/[^/]*\/)thumb(\/.*\.)jpeg/, "$1big$2jpg");
        }

        if (domain === "cdn.oboi7.com") {
            // http://cdn.oboi7.com/static/images/m/cd/0b/cd0b818eff905203d171ea234ac475c9e7e4586e.jpg -- 760x1062
            //   http://cdn.oboi7.com/content/images/cd/0b/cd0b818eff905203d171ea234ac475c9e7e4586e.jpg -- 2656x3712
            return src.replace(/\/static\/images\/[a-z]\//, "/content/images/");
        }

        if (domain === "i.nahraj.to") {
            // http://i.nahraj.to/t/1jzQ.jpg
            //   http://i.nahraj.to/f/1jzQ.jpg
            return src.replace(/(:\/\/[^/]*\/)[a-z](\/[^/]+\.[^/.]*)$/, "$1f$2");
        }

        if (domain === "skwww.plusden.sk") {
            // http://skwww.plusden.sk/thumb/images/gallery/fotoreportaz/2009/02/Halle-Berry/Halle_Berry_8.jpg?w=142&h=80&ip=6
            //   http://skwww.plusden.sk/images/gallery/fotoreportaz/2009/02/Halle-Berry/Halle_Berry_8.jpg
            return src.replace(/\/thumb(\/images\/gallery\/.*?)(?:\?.*)?$/, "$1");
        }

        if (domain_nowww === "admags.xyz") {
            // http://admags.xyz/m/bjaa/jc/ucr9z7_tb/069.jpg
            //   http://admags.xyz/m/bjaa/jc/ucr9z7/069.jpg
            return src.replace(/_tb(\/[^/]*)$/, "$1");
        }

        if (domain === "img.topky.sk") {
            // http://img.topky.sk/vysetrenie//320px/1676317.jpg/vlasy--preplachovanie.jpg
            //   http://img.topky.sk/vysetrenie//big/1676317.jpg/vlasy--preplachovanie.jpg
            return src.replace(/\/[0-9]+px\/([^/]*)(\/[^/]*)?$/, "/big/$1$2");
        }

        if (domain_nowww === "kungahuset.org") {
            // http://kungahuset.org/uploads/thumb/100X100_inspiring-pin-by-amias-bakshi-on-hollywooed-actresses-picture-for-halle-berry-with-blonde-hair-style-and-concept_AFLK_23730.jpg
            //   http://kungahuset.org/uploads/inspiring-pin-by-amias-bakshi-on-hollywooed-actresses-picture-for-halle-berry-with-blonde-hair-style-and-concept_AFLK_23730.jpg
            return src.replace(/\/uploads\/thumb\/[0-9]+X[0-9]+_/, "/uploads/");
        }

        if (domain_nosub === "e-monsite.com") {
            // http://s2.e-monsite.com/2010/04/02/02/resize_128_128//Neree-Beauchemin.jpg
            //   http://s2.e-monsite.com/2010/04/02/02//Neree-Beauchemin.jpg
            // doesn't work for all:
            // http://s2.e-monsite.com/2009/11/11/10/resize_550_550//pochette-Supplice.jpg
            //   http://s2.e-monsite.com/2009/11/11/10//pochette-Supplice.jpg -- 404
            return src.replace(/\/resize_[0-9]+_[0-9]+\//, "/");
        }

        if (domain === "static.guide.supereva.it" ||
            // http://media.fashionblog.it/f/fes/festival-del-cinema-di-venezia-2011-look-madonna-e-asia-argento-01/thn_423.jpg
            //   http://media.fashionblog.it/f/fes/festival-del-cinema-di-venezia-2011-look-madonna-e-asia-argento-01/423.jpg
            domain === "media.fashionblog.it") {
            // http://static.guide.supereva.it/guide/guida_hollywood/halle-berry-la-donna-nera-piu-sexy/thn_halleberrysx7.jpg
            //   http://static.guide.supereva.it/guide/guida_hollywood/halle-berry-la-donna-nera-piu-sexy/halleberrysx7.jpg
            return src.replace(/\/thn_([^/]*)$/, "/$1");
        }

        if (domain_nowww === "apachan.net") {
            // https://apachan.net/thumbs/201712/20/gnBNXuiEWIKV.png
            //   https://apachan.net/previews/201712/20/gnBNXuiEWIKV.png
            //   https://apachan.net/images/201712/20/gnBNXuiEWIKV.png
            return src.replace(/(:\/\/[^/]*\/)(?:thumbs|previews)\//, "$1images/");
        }

        if (domain === "imggaleri.hurriyet.com.tr") {
            // http://imggaleri.hurriyet.com.tr/LiveImages/Foto%20Haber/207/Hollywood%E2%80%99un%20en%20%C3%A7ok%20kazan%20akt%C3%B6rleri%20(2013)/ThumbFolder/0.jpg
            //   http://imggaleri.hurriyet.com.tr/LiveImages/Foto%20Haber/207/Hollywood%E2%80%99un%20en%20%C3%A7ok%20kazan%20akt%C3%B6rleri%20(2013)/0.jpg -- 371x520
            //   http://imggaleri.hurriyet.com.tr/LiveImages/Foto%20Haber/207/Hollywood%E2%80%99un%20en%20%C3%A7ok%20kazan%20akt%C3%B6rleri%20(2013)/LargeFolder/0.jpg -- 570x800
            return src.replace(/\/ThumbFolder\/([^/]*)$/, "/LargeFolder/$1");
        }

        if (domain_nowww === "army.mil") {
            // https://www.army.mil/e2/c/images/2018/04/03/512251/size1.jpg
            //   https://www.army.mil/e2/c/images/2018/04/03/512251/original.jpg
            return src.replace(/(\/e2\/c\/images\/)(.*\/)size[0-9]*(\.[^/.]*)$/, "$1$2original$3");
        }

        if (domain_nosub === "disquscdn.com") {
            // https://a.disquscdn.com/get?url=https%3A%2F%2Fwww.army.mil%2Fe2%2Fc%2Fimages%2F2018%2F01%2F25%2F504694%2Fsize1.jpg&key=Pqr8p2wdqsfS5mYS746GtQ
            //   https://www.army.mil/e2/c/images/2018/01/25/504694/original.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/get.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        if (domain_nowww === "smore.com") {
            // https://www.smore.com/external_image?url=https://www.army.mil/e2/c/images/2017/10/02/494176/size2.jpg
            //   https://www.army.mil/e2/c/images/2017/10/02/494176/size2.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/external_image.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        if (domain === "images.ctfassets.net") {
            // http://images.ctfassets.net/55tpbg0qcsp4/5zeVQCnhqowcwiIw4kM80S/f70edd51832e8640f72c375cb1d72b6b/nagative_farewell4.jpg?w=144&h=102
            //   http://images.ctfassets.net/55tpbg0qcsp4/5zeVQCnhqowcwiIw4kM80S/f70edd51832e8640f72c375cb1d72b6b/nagative_farewell4.jpg?h=4000
            return src.replace(/\?.*$/, "?h=4000");
        }

        if (domain_nosub === "okccdn.com") {
            // https://k2.okccdn.com/php/load_okc_image.php/images/0x0/806x806/0/13816000233260326780.webp?v=2
            //   https://k2.okccdn.com/php/load_okc_image.php/images/13816000233260326780.webp?v=2
            return src.replace(/(\/php\/load_okc_image\.php\/images\/)(?:[0-9]+(?:x[0-9]+)?\/){1,}([0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "metapix.net") {
            // https://wa.ib.metapix.net/thumbnails/medium/2391/2391802_Ero_eiko_noncustom.jpg
            //   https://tx.ib.metapix.net/files/full/2391/2391802_Ero_eiko.png
            // https://wa.ib.metapix.net/files/screen/2391/2391802_Ero_eiko.png
            //   https://tx.ib.metapix.net/files/full/2391/2391802_Ero_eiko.png
            newsrc = src.replace(/\/files\/[a-z]+\/([0-9]+\/[^/]*)$/, "/files/full/$1");
            if (newsrc !== src)
                return newsrc;

            return add_extensions(src.replace(/\/thumbnails\/[a-z]*\/([0-9]+\/[0-9]+[^/]*)_noncustom(\.[^/.]*)$/, "/files/full/$1$2"));
        }

        if (domain === "cdn.furiffic.com") {
            // https://cdn.furiffic.com/thumbnails/142900.jpg
            //   https://cdn.furiffic.com/originals/142900.jpg
            // https://cdn.furiffic.com/thumbnails/126003.jpg
            //   https://cdn.furiffic.com/originals/126003.png
            return add_extensions(src.replace(/(:\/\/[^/]*\/)[a-z]+(\/[0-9]+\.[^/.]*)$/, "$1originals$2"));
        }

        if (domain === "d3gz42uwgl1r1y.cloudfront.net") {
            // https://d3gz42uwgl1r1y.cloudfront.net/br/braeburned/submission/2016/04/7bc5a92bca8a74e0ea1de0e661416d7a/315x315.jpg
            //   https://d3gz42uwgl1r1y.cloudfront.net/br/braeburned/submission/2016/04/7bc5a92bca8a74e0ea1de0e661416d7a.png
            return add_extensions(src.replace(/(\/submission\/[0-9]+\/[0-9]+\/[0-9a-f]+)\/[0-9]+x[0-9]+(\.[^/.]*)$/, "$1$2"));
        }

        if (domain_nosub === "route50.net") {
            // http://route50.net/data/gallery/submissions/248507fc33f079922aba925778ba4448_thumb.png
            //   http://route50.net/data/gallery/submissions/248507fc33f079922aba925778ba4448_full.png
            return src.replace(/(\/data\/gallery\/submissions\/[0-9a-f]+_)[a-z]+(\.[^/.]*)$/, "$1full$2");
        }

        if (domain === "img.luxusbenz.com" ||
            // http://img.benzspirit.com/medium/c620462ac0bc76ce-selena-gomez-cute.jpg
            //   http://img.benzspirit.com/full/c620462ac0bc76ce-selena-gomez-cute.jpg
            domain === "img.benzspirit.com") {
            // http://img.luxusbenz.com/medium/45309e796fb86b4c.jpg
            //   http://img.luxusbenz.com/full/45309e796fb86b4c.jpg
            return src.replace(/(:\/\/[^/]*\/)[a-z]+(\/[a-f0-9]+(?:-[^/]*)?\.[^/.]*)$/, "$1full$2");
        }

        if (domain === "dot.asahi.com") {
            // https://dot.asahi.com/S2000/upload/350_2017013000246_1.jpg?update=20170130201101
            //   https://dot.asahi.com/S2000/upload/2017013000246_1.jpg?update=20170130201101
            return src.replace(/\/upload\/[0-9]+_([0-9]{10,}_[0-9]+\.[^/.]*)$/, "/upload/$1");
        }

        if (domain === "news-img.dwango.jp") {
            // https://news-img.dwango.jp/uploads/medium/file/000/031/265/31265/md_main_hiki_web.jpg
            //   https://news-img.dwango.jp/uploads/medium/file/000/031/265/31265/main_hiki_web.jpg -- 2756x1831
            return src.replace(/(\/uploads\/[a-z]+\/file\/.*\/)(?:md|sm|lg)_([^/]*)$/, "$1$2");
        }

        if (domain_nowww === "getnews.jp") {
            // https://getnews.jp/thumb2/ext/http://px1img.getnews.jp/img/archives/2015/10/DO021.jpg
            //   https://getnews.jp/img/archives/2015/10/DO021.jpg
            // https://getnews.jp/thumb/ext/1613528
            //   http://s.okmusic.jp/news_images/images/2103004/large.jpg?1485745865
            return src.replace(/^[a-z]+:\/\/[^/]*\/thumb2\/ext\/([a-z]+:\/\/.*)$/, "$1");
        }

        // Piwigo
        if (domain_nowww === "amuro.fr") {
            // http://www.amuro.fr/_data/i/upload/2011/08/14/20110814075347-e08e571c-cu_s9999x160.jpg
            //   http://www.amuro.fr/upload/2011/08/14/20110814075347-e08e571c.jpg
            // http://www.amuro.fr/_data/i/upload/2013/09/11/20130911151431-507b3232-cu_s9999x160.jpg
            //   http://www.amuro.fr/upload/2013/09/11/20130911151431-507b3232.jpg
            return src.replace(/\/_data\/i(\/upload\/.*)-cu_s[0-9]+x[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "cdn-news30.it") {
            // https://l43.cdn-news30.it/blobs/variants/f/7/b/8/f7b8ac9b-365a-49e4-b1c8-34d715851e8d_small.jpg?_636688952210324894
            //   https://l43.cdn-news30.it/blobs/full/f/7/b/8/f7b8ac9b-365a-49e4-b1c8-34d715851e8d.jpg?_636688952210324894
            return src.replace(/\/blobs\/variants\/((?:[a-f0-9]\/){4}[-0-9a-f]+)_[a-z]+(\.[^/.]*)$/, "/blobs/full/$1$2");
        }

        if (domain === "imagebox.cz.osobnosti.cz") {
            // https://imagebox.cz.osobnosti.cz/foto/cara-delevingne/M746357-5736b.jpg -- 150x200
            //   https://imagebox.cz.osobnosti.cz/foto/cara-delevingne/O746357-5736b.jpg -- 2312x3080
            return src.replace(/\/[A-Z]([0-9]+-[0-9]+[a-z]\.[^/.]*)$/, "/O$1");
        }

        if (domain === "spicy.southdreamz.com") {
            // https://spicy.southdreamz.com/cache/the-hottest-swimsuit-models/cara-delevingne/the-very-hot-sexy-model-cara-delevingne-pictures-637_w220_h344_thumb.jpg
            //   https://spicy.southdreamz.com/cache/the-hottest-swimsuit-models/cara-delevingne/the-very-hot-sexy-model-cara-delevingne-pictures-637_650.jpg
            //   https://spicy.southdreamz.com/spicysource/the-hottest-swimsuit-models/cara-delevingne/the-very-hot-sexy-model-cara-delevingne-pictures-637.jpg
            return src.replace(/\/cache\/(.*?)(?:_[0-9]+|(?:(?:_[a-z][0-9]+){1,}(?:_thumb)?))(\.[^/.]*)$/, "/spicysource/$1$2");
        }

        if (domain === "img.miumag.pl") {
            // https://img.miumag.pl/0000/b8535.jpg
            // c, f, d, g, a, h, m, b, l, i, k, e
            return src.replace(/\/[a-z]([0-9]+\.[^/.]*)$/, "/c$1");
        }

        if (domain_nowww === "hotnews.bg") {
            // http://hotnews.bg/uploads/news/2015_07/thumb/00093561.jpg
            //   http://hotnews.bg/uploads/news/2015_07/images/00093561.jpg
            return src.replace(/(\/uploads\/news\/[^/]*\/)thumb(\/[0-9]+\.[^/.]*)$/, "$1images$2");
        }

        if (domain === "c6oxm85c.cloudimg.io" ||
            // https://ce8737e8c.cloudimg.io/width/359/q90/https://twg-live.s3.amazonaws.com/artist_image/twg_11_1519846018_0.jpg
            //   https://twg-live.s3.amazonaws.com/artist_image/twg_11_1519846018_0.jpg
            domain === "ce8737e8c.cloudimg.io") {
            // https://c6oxm85c.cloudimg.io/cdno/n/q10/https://az617363.vo.msecnd.net/imgmodels/models/MD30001282/gallery-1502272667-cara1a74d8ff2128d26eea7a6b74247a45669_thumb.jpg
            //   https://az617363.vo.msecnd.net/imgmodels/models/MD30001282/gallery-1502272667-cara1a74d8ff2128d26eea7a6b74247a45669_thumb.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/(?:cdn[a-z]\/n\/)?(?:(?:width|height)\/[0-9]+\/){0,}q[0-9]*\/([a-z]*:\/\/)/, "$1");
        }

        if (domain_nowww === "kinataka.ru") {
            // http://kinataka.ru/images_peolpe/4649/photos/240/kinataka.ru-4649-cara-delevingne_37.jpg
            //   http://kinataka.ru/images_peolpe/4649/photos/kinataka.ru-4649-cara-delevingne_37.jpg
            return src.replace(/\/photos\/[0-9]+\/([^/]*)$/, "/photos/$1");
        }

        if (domain === "easttouch.my-magazine.me") {
            // http://easttouch.my-magazine.me/main/upload/photoalbum/thumbnail/53d75489d55e5/07ddf08476c970ba690fd673c7561e74da8552a5.jpg
            //   http://easttouch.my-magazine.me/main/upload/photoalbum/original/53d75489d55e5/07ddf08476c970ba690fd673c7561e74da8552a5.jpg
            return src.replace(/(\/upload\/photoalbum\/)thumbnail(\/[0-9a-f]+\/[0-9a-f]+\.[^/.]*)$/, "$1original$2");
        }

        if (domain === "tvdaily.asiae.co.kr") {
            // http://tvdaily.asiae.co.kr/upimages/photoda/201501/1420040978_828039.jpg
            //   http://tvdaily.asiae.co.kr/upimages/gisaimg/201501/1420040978_828039.jpg
            // doesn't work with all:
            // http://tvdaily.asiae.co.kr/upimages/photoda/201508/955495.jpg
            return src.replace(/\/upimages\/photoda\//, "/upimages/gisaimg/");
        }

        if (domain === "img.thefactjp.com") {
            // http://img.thefactjp.com/service/article/2016/12/01/200/7b310164d575f0b42546d9c02e36560f.jpg
            //   http://img.thefactjp.com/service/article/2016/12/01/7b310164d575f0b42546d9c02e36560f.jpg
            // http://img.thefactjp.com/service/article/2017/05/16/thumb/1d5feb31e4765b7cac63187e155e995e.jpg
            //   http://img.thefactjp.com/service/article/2017/05/16/1d5feb31e4765b7cac63187e155e995e.jpg
            return src.replace(/(\/service\/[a-z]+\/[0-9]+\/[0-9]+\/[0-9]+\/)(?:[0-9]+|thumb)\/([0-9a-f]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "rlv.zcache.co.nz" ||
            // https://rlv.zcache.com.br/almofada_beijo_do_coelho-r37098fa59ed7493895974ae56e2c6920_i52ni_8byvr_307.jpg?rvtype=content
            //   https://rlv.zcache.com.br/almofada_beijo_do_coelho-r37098fa59ed7493895974ae56e2c6920_i52ni_8byvr_999999999.jpg?rvtype=content -- 2048x2048 (stretched?)
            domain === "rlv.zcache.com.br") {
            // https://rlv.zcache.co.nz/avengers_infinity_war_infinity_war_theatrical_poster-rff80411530e241a289d322c575acd18c_qq1_8byvr_307.jpg?rvtype=content
            //   https://rlv.zcache.co.nz/avengers_infinity_war_infinity_war_theatrical_poster-rff80411530e241a289d322c575acd18c_qq1_8byvr_999999999.jpg?rvtype=content
            return src.replace(/(-r[0-9a-f]+(?:_[_0-9a-z]+)?)_[0-9]+(\.[^/.?]*)(?:\?.*?)?$/, "$1_999999999$2?rvtype=content");
        }

        if (domain_nowww === "empireposter.de") {
            // https://www.empireposter.de/bilder/bilder_k/795120.jpg -- 74x110
            //   https://www.empireposter.de/bilder/bilder_m/795120.jpg -- 181x270
            //   https://www.empireposter.de/bilder/bilder_t/795120.jpg -- 33x50
            //   https://www.empireposter.de/bilder/bilder_l/795120.jpg -- 321x480
            return src.replace(/\/bilder\/bilder_[a-z]\//, "/bilder/bilder_l/");
        }

        if (domain === "dg31sz3gwrwan.cloudfront.net") {
            // https://dg31sz3gwrwan.cloudfront.net/actor/336385/463016_medium-optimized-2.jpg
            //   https://dg31sz3gwrwan.cloudfront.net/actor/336385/463016.jpg
            return src.replace(/(\/[0-9]+\/[0-9]+)_[a-z]+(?:-optimized-[0-9]*)?(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "img.mach-shiko.net") {
            // http://img.mach-shiko.net/images/21070418/08/s/025.jpg
            //   http://img.mach-shiko.net/images/21070418/08/025.jpg
            return src.replace(/(\/images\/[0-9]+\/[0-9]+\/)[a-z]\/([0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "img.geinou-img.com") {
            // http://img.geinou-img.com/daisuki/enta/2017_0729_05/s/27.jpg
            //   http://img.geinou-img.com/daisuki/enta/2017_0729_05/27.jpg
            return src.replace(/(\/[_0-9]+\/)[a-z]\/([0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "showbiz.cz") {
            // https://www.showbiz.cz/files/gallery/thumb/18/1825acb57fba5f41c83eb7d79f2cae02.jpg
            //   https://www.showbiz.cz/files/gallery/18/1825acb57fba5f41c83eb7d79f2cae02.jpg
            return src.replace(/(\/files\/gallery\/)thumb\/([0-9a-f]+\/[0-9a-f]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "images.nudereviews.com") {
            // http://images.nudereviews.com/data/media/image/medium/r/ravenalexis.jpg
            //   http://images.nudereviews.com/data/media/image/original/r/ravenalexis.jpg -- larger, but large white space to the right
            return src.replace(/(\/data\/media\/image\/)[a-z]+\//, "$1original/");
        }

        if (domain_nowww === "thefamouspeople.com") {
            // https://www.thefamouspeople.com/profiles/thumbs/lady-gaga-3.jpg
            //   https://www.thefamouspeople.com/profiles/images/lady-gaga-3.jpg
            return src.replace(/\/profiles\/thumbs\//, "/profiles/images/");
        }

        if (domain === "i.trust.ua") {
            // http://i.trust.ua/files/photo/2/0000047814-Grammy-2015-krasnaya-dorozhka.jpg
            //   http://i.trust.ua/files/photo/source/0000047814-Grammy-2015-krasnaya-dorozhka.jpg
            return src.replace(/\/files\/photo\/[0-9]+\//, "/files/photo/source/");
        }

        if (domain === "media.beritagar.id") {
            // https://media.beritagar.id/lme-2015-02/3f1cec246337c8195f8c2e65408160fd_imresized.jpg
            //   https://media.beritagar.id/2015-02/3f1cec246337c8195f8c2e65408160fd.jpg
            // https://media.beritagar.id/lme-2015-02/915a1d8f42ba0a9d52b56f5d1fba9483.jpg
            //   https://media.beritagar.id/2015-02/915a1d8f42ba0a9d52b56f5d1fba9483.jpg
            // https://media.beritagar.id/lme-2015-02/original_700/3f1cec246337c8195f8c2e65408160fd_imresized.jpg
            //   https://media.beritagar.id/2015-02/3f1cec246337c8195f8c2e65408160fd.jpg
            return src.replace(/\/lme-([^/]*\/)(?:[a-z]+_[0-9]+\/)?([0-9a-f]+)(?:_imresized)?(\.[^/.]*)$/, "/$1$2$3");
        }

        if (domain === "imgs.ckcdn.com" ||
            // https://i.imgscc.com/img/aaaaaRXLo.jpg?_w=100
            //   https://i.imgscc.com/img/aaaaaRXLo.jpg
            domain === "i.imgscc.com") {
            // https://imgs.ckcdn.com/img/aaaaawcBB.jpg?_w=200
            //   https://imgs.ckcdn.com/img/aaaaawcBB.jpg
            return {
                url: src.replace(/\?.*$/, ""),//src.replace(/\?.*$/, "?_w=9999999999999"),
                headers: {
                    Origin: null,
                    Referer: null
                },
                can_head: false
            };
        }

        if (domain === "im.mtv.fi") {
            // https://im.mtv.fi/image/5623620/portrait/141/235/40c589ceaaeaf970c4a391aaef56d4b3/tG/8-17547236.jpg
            //   https://im.mtv.fi/blob/5623620/fb93162a902c736ae29d0a8afa61c23e/8-17547236-data.jpg
            // https://im.mtv.fi/image/5167372/landscape16_9/1024/576/cb77a43764a29a905a138b1d305d6f69/re/29786617.jpg
            //   https://im.mtv.fi/blob/5167372/a68604d83d0af13adcf36501c49a60fe/29786617-data.jpg
            // https://im.mtv.fi/image/6895610/landscape16_9/1024/576/cf17e8d70a8272b0879f93bb17fc4457/Ev/syksy-2018.png
            //   https://im.mtv.fi/blob/6895610/54dfa9ce35989df0140b88dfe4876442/syksy-2018-data.png
            // https://im.mtv.fi/image/5670670/landscape/515/309/a675b591cf893c84b3846370bc763d2c/LZ/1004672-5869.jpg
            //   https://im.mtv.fi/blob/5670670/8fba0e97adbc51ef7f74a60f6ec8d04c/1004672-5869-data.jpg
            // https://im.mtv.fi/image/4837600/landscape1_1/1024/1024/3140f045618e82e77a6247073d04bda7/iH/frendit-yleiskuva.jpg
            //   https://im.mtv.fi/blob/4837600/3b711cb8aa2acf63fe0a60cffce964d0/frendit-yleiskuva-data.jpg
            return src.replace(/\/image(\/[0-9]+\/)(?:(?:portrait|landscape[^/]*)\/[0-9]+\/[0-9]+\/)?([0-9a-f]+\/)[a-zA-Z0-9]{2}\/([^/.]+)(\.[^/.]*)$/,
                               "/blob$1$2$3-data$4");
        }

        if (domain_nowww === "imageweb.ws" ||
            domain_nowww === "pussyspot.net") {
            // https://t.imageweb.ws/media/thumbs_200/13/12813/1435652.jpg
            // https://www.imageweb.ws/media/images_640/13/lydia-reed/lydia-reed-1435652.jpg
            //   https://www.imageweb.ws/media/images/13/lydia-reed/lydia-reed-1435652.jpg
            // http://www.pussyspot.net/media/images_640/1/mandy-tyler/mandy-tyler-317777.jpg
            //   http://www.pussyspot.net/media/images/1/mandy-tyler/mandy-tyler-317777.jpg
            return src.replace(/\/media\/images_[0-9]+\//, "/media/images/");
        }

        if ((domain === "t.imageweb.ws" ||
             // http://cdn1.pussyspot.net/media/thumbs_200/1/526/317777.jpg
             //   http://www.pussyspot.net/media/images/1/mandy-tyler/mandy-tyler-317777.jpg
             (domain_nosub === "pussyspot.net" && domain.match(/^cdn[0-9]*\./))
            ) &&
            src.indexOf("/media/") && options && options.cb && options.do_request) {
            // https://t.imageweb.ws/media/thumbs_200/12/11108/1181579.jpg
            //   https://www.imageweb.ws/media/images/12/bree-daniels/bree-daniels-1181579.jpg
            var match = src.match(/\/media\/[^/]*\/[0-9]+\/[0-9]+\/([0-9]+)\.[^/.]*/);
            if (match) {
                var id = match[1];

                var queryurl = "http://www." + domain_nosub + "/a/" + id + ".html";
                options.do_request({
                    url: queryurl,
                    method: "GET",
                    onload: function(resp) {
                        if (resp.readyState === 4) {
                            var match = resp.responseText.match(/href="(\/media\/images\/[^"]*)"/);
                            if (match) {
                                options.cb(urljoin("http://www." + domain_nosub + "/", match[1]).replace(/\?.*/, ""));
                            } else {
                                options.cb(null);
                            }
                        }
                    }
                });
            }

            return {
                waiting: true
            };
        }

        if (domain_nosub === "pictoa.com" &&
            domain.match(/^s[0-9]*\.pictoa\.com/)) {
            // https://s2.pictoa.com/media/galleries/058/990/058990556bf9f7d10b8/thumbs/1650366556bf9f89826e.jpg
            //   https://s2.pictoa.com/media/galleries/058/990/058990556bf9f7d10b8/1650366556bf9f89826e.jpg
            return src.replace(/(\/media\/galleries\/[0-9a-f]+\/[0-9a-f]+\/[0-9a-f]+\/)thumbs\/([^/]*)$/, "$1$2");
        }

        if (domain_nosub === "vcg.com" &&
            domain.match(/goss[0-9]*\.vcg/)) {
            // https://goss.vcg.com/editorial/vcg/800/new/VCG111152795068.jpg
            //   https://goss.vcg.com/editorial/vcg/nowarter800/new/VCG111152795068.jpg
            // https://goss2.vcg.com/editorial/vcg/800/new/VCG111152804617.jpg
            //   https://goss2.vcg.com/editorial/vcg/nowarter800/new/VCG111152804617.jpg
            // https://goss1.vcg.com/editorial/bank9/img13/midimg/47644000/tmb47644467.jpg
            //   https://goss4.vcg.com/editorial/vcg/800/version23/VCG31433662363.jpg
            //   https://goss4.vcg.com/editorial/vcg/nowarter800/version23/VCG31433662363.jpg -- doesn't work
            return src.replace(/\/editorial\/vcg\/[0-9]+\//, "/editorial/vcg/nowarter800/");
        }

        if (domain_nosub === "renault-dacia.com.ua") {
            // http://www.renault-dacia.com.ua/im.php?image=/topicsfoto/web-ruslan/385c5841f5a8ac13dfe2da13f11cd619.jpg
            //   http://www.renault-dacia.com.ua/topicsfoto/web-ruslan/385c5841f5a8ac13dfe2da13f11cd619.jpg
            // http://m.renault-dacia.com.ua/im.php?image=/topicsfoto/Aleksandr17/c51b93d8fd16eaac11e4d84dad3ebd20.jpg
            //   http://www.renault-dacia.com.ua/topicsfoto/Aleksandr17/c51b93d8fd16eaac11e4d84dad3ebd20.jpg
            newsrc = urljoin("http://www.renault-dacia.com.ua/", decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/im\.php.*?[?&]image=([^&]*).*?$/, "$1")));
            if (newsrc !== src)
                return newsrc;

            // http://www.renault-dacia.com.ua/pictgen/100/tuneyadets/5538f9fc896e15710648bba38f922a51.jpg
            //   http://www.renault-dacia.com.ua/topicsfoto/tuneyadets/5538f9fc896e15710648bba38f922a51.jpg
            return src.replace(/\/pictgen\/[0-9]+\//, "/topicsfoto/");
        }

        if (domain_nowww === "numberoneturk.com.tr") {
            // http://www.numberoneturk.com.tr/fotogaleri/plog-content/thumbs/number1-t__rk/milla-jovovich/rss/7941-milla-jojovich-0030.jpg
            //   http://www.numberoneturk.com.tr/fotogaleri/plog-content/images/number1-t__rk/milla-jovovich/milla-jojovich-0030.jpg
            return src.replace(/(\/fotogaleri\/[^/]*\/)thumbs(\/.*\/)rss\/[0-9]+-([^/]*)$/, "$1images$2$3");
        }

        if (domain === "prsize.allviki.com") {
            // http://prsize.allviki.com/resize_500x284/2018/3/1522137743507.jpg
            //   http://pic.allviki.com/2018/3/1522137743507.jpg
            return src.replace(/:\/\/[^/]*\/resize_[0-9]+(?:x[0-9]+)?\//, "://pic.allviki.com/");
        }

        if (domain_nowww === "celebritygalls.com") {
            // http://celebritygalls.com/cache/Bella-Hadid-goes-topless-and-poses-nude/adorable-bella-hadid-looks-perfectly_360_cw360_ch360_thumb.jpg
            //   http://celebritygalls.com/albums/Bella-Hadid-goes-topless-and-poses-nude/adorable-bella-hadid-looks-perfectly.jpg
            return src.replace(/\/cache\/(.*)_[0-9]+_cw[0-9]+_ch[0-9]+_thumb(\.[^/.]*)$/, "/albums/$1$2");
        }

        if (domain_nowww === "instantfap.com") {
            // http://instantfap.com/image/LERREOrb.jpg
            //   https://i.imgur.com/LERREOrb.jpg
            return src.replace(/:\/\/[^/]*\/image\/([^/]*)$/, "://i.imgur.com/$1");
        }

        if (domain_nowww === "agensite.com" ||
            // http://cdn.agensite.online/img/350x350/2/0/png/arquivos/1361/conteudo/posts/538920.png -- stretched
            //   http://cdn.agensite.online/temp/img/arquivos_1361_conteudo_posts_538920_png_original__0_0__png.png?1534834767
            domain === "cdn.agensite.online" ||
            // https://cdn.conexaohost.com.br/img/250x160/4/0/png/arquivos/1650/conteudo/posts/564664.jpg
            //   https://cdn.conexaohost.com.br/img/original/0/0/png/arquivos/1650/conteudo/posts/564664.jpg
            //   https://cdn.conexaohost.com.br/temp/img/arquivos_1650_conteudo_posts_564664_jpg_original__0_0__png.png?1526996294
            //   https://cdn.conexaohost.com.br/temp/img/arquivos_1650_conteudo_posts_564664_jpg_250_160_4_0__png.png?1526996294
            domain === "cdn.conexaohost.com.br") {
            // http://www.agensite.com/img/250x160/4/0/png/arquivos/34/conteudo/posts/773919.jpg -- redirects to
            //   http://www.agensite.com/temp/img/arquivos_34_conteudo_posts_773919_jpg_250_160_4_0__png.png?1532091479 (generated)
            //   http://www.agensite.com/temp/img/arquivos_34_conteudo_posts_773919_jpg_original__4_0__png.png?1532091479
            //   http://www.agensite.com/img/original/0/0/png/arquivos/34/conteudo/posts/773919.jpg
            //   http://www.agensite.com/temp/img/arquivos_34_conteudo_posts_773919_jpg_original__0_0__png.png?1534834452
            // http://www.agensite.com/imagizer_export.php?arquivos/1144/conteudo/posts/782392.jpg,,,1,0,,jpg,arquivos/1144/marca.png,3
            return {
                url: src
                    .replace(/\/img\/[0-9]+x[0-9]+\//, "/img/original/")
                    .replace(/\/temp\/img\/([0-9a-z]+)_([0-9]+)_([0-9a-z]+)_([0-9a-z]+)_([0-9]+)_([a-z]+)_[^/]*$/,
                             "/img/original/0/0/png/$1/$2/$3/$4/$5.$6")
                    .replace(/\/imagizer_export\.php\?([^,]*).*/, "/img/original/0/0/png/$1"),
                //.replace(/_(jpg|JPG|jpeg|JPEG|gif|GIF|png|PNG|webp|WEBP)_[0-9]+_[0-9]+(_[^/]*)$/, "_$1_original_$2"); -- generated
                redirects: true
            };
        }

        if (domain === "images.mtvnn.com") {
            // http://images.mtvnn.com/3000418a5c6621bbd16f5bb0370b9ddc/960x540.jpg
            //   http://images.mtvnn.com/3000418a5c6621bbd16f5bb0370b9ddc/original.jpg
            // http://images.mtvnn.com/f8cc799282e945d1d7d931f8d76ec7b2/630x354_.jpg
            //   http://images.mtvnn.com/f8cc799282e945d1d7d931f8d76ec7b2/original.jpg
            return src.replace(/(:\/\/[^/]*\/[0-9a-f]+\/)[0-9]+x[0-9]+_?(\.[^/.]*)$/, "$1original$2");
        }

        if (domain_nowww === "hipernoticias.com.br") {
            // http://www.hipernoticias.com.br/storage/webdisco/2018/07/10/475x210/a3bb4540fc170ea691e32ca3dc628b5c.jpg
            //   http://www.hipernoticias.com.br/storage/webdisco/2018/07/10/original/a3bb4540fc170ea691e32ca3dc628b5c.jpg
            // http://www.hipernoticias.com.br/storage/webdisco/2018/08/19/capa/default/D1/f59685cf15fbf97f354c0896dc23b95b.jpg
            //   http://www.hipernoticias.com.br/storage/webdisco/2018/08/19/original/f59685cf15fbf97f354c0896dc23b95b.jpg
            return src.replace(/(\/storage\/webdisco\/[0-9]+\/[0-9]+\/[0-9]+\/).*(\/[0-9a-f]+\.[^/.]*)$/, "$1original$2");
        }

        if (domain_nowww === "bd-journal.com") {
            // http://www.bd-journal.com/image-contents/110x73x1/news-photos/2018/08/21/aW1hZ2UtNDEwNzctMTUzNDc5MDg1Ny5qcGc=
            //   http://www.bd-journal.com/assets/news_photos/2018/08/21/image-41077-1534790857.jpg
            var match = src.match(/\/image-contents\/[0-9]+x[0-9]+x[0-9]+\/news-photos\/((?:[0-9]+\/){2,})([-0-9a-zA-Z_=+]+)(?:[?#].*)?$/);
            if (match) {
                return src.replace(/(:\/\/[^/]*\/).*/, "$1") + "assets/news_photos/" + match[1] + atob(match[2]);
            }
        }

        if (domain_nowww === "myidol.com.vn") {
            // http://myidol.com.vn/pictures/picsmalls/2018/08/21/200/tke1534813396.jpg
            //   http://myidol.com.vn/pictures/picfullsizes//2018/08/21/tke1534813396.jpg
            return src.replace(/\/pictures\/pic[a-z]+(\/[0-9]+\/[0-9]+\/[0-9]+\/)[0-9]+\/([a-z]+[0-9]+\.[^/.]*)$/,
                               "/pictures/picfullsizes/$1$2");
        }

        if (domain_nowww === "dw.com") {
            // https://www.dw.com/image/45139812_301.jpg -- 220x124
            //   https://www.dw.com/image/45139812_7.jpg -- 4297x2419
            return src.replace(/(:\/\/[^/]*\/image\/[0-9]+_)[0-9]+(\.[^/.]*)$/, "$17$2");
        }

        if (domain_nowww === "finds.ir") {
            // http://www.finds.ir/img/tu/2018082037083715.jpg
            //   http://www.finds.ir/img/2018082037083715.jpg
            return src.replace(/\/img\/tu\//, "/img/");
        }

        if (domain_nosub === "xuk.mobi" &&
            domain.match(/^img[0-9]*\./) &&
            src.indexOf("/images/photos/") >= 0) {
            // https://img1.xuk.mobi/images/photos/00/01/93/25/19325/thumb/6de0aa33ad9e5d5dbcd78a1153d6bb26.jpg
            //   https://img1.xuk.mobi/images/photos/00/01/93/25/19325/origin/6de0aa33ad9e5d5dbcd78a1153d6bb26.jpg
            return src.replace(/\/thumb\/([0-9a-f]+\.[^/.]*)$/, "/origin/$1");
        }

        if (domain === "s.filmsextv.com") {
            // http://s.filmsextv.com/022/123/02212354b3aa0053f52/thumbs/89156254b3aa0080293.jpg
            //   http://s.filmsextv.com/022/123/02212354b3aa0053f52/89156254b3aa0080293.jpg
            return src.replace(/(\/[0-9a-f]+\/)thumbs\/([0-9a-f]+\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "lanita.ru" &&
            src.indexOf("/images/offer/") >= 0) {
            // https://lanita.ru/images/offer/15494/9/3307559/3307559-thumb.jpg
            //   https://lanita.ru/images/offer/15494/9/3307559/3307559.jpg
            return src.replace(/(\/[0-9]+)-thumb(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "backalleypics.net") {
            // http://backalleypics.net/asiaargento/images/5-19-2012/thumbs/asia-argento-5-19-2012-dracula-3d-photocall-cannes-film-festival-france-1.jpg
            //   http://backalleypics.net/asiaargento/images/5-19-2012/asia-argento-5-19-2012-dracula-3d-photocall-cannes-film-festival-france-1.jpg
            return src.replace(/(\/images\/[0-9]+-[0-9]+-[0-9]+\/)thumbs\/([^/]*)$/, "$1$2");
        }

        if ((domain_nosub === "turboimg.net" ||
             domain_nosub === "turboimagehost.com") &&
            options && options.cb && options.do_request) {
            // http://s4d3.turboimg.net/t1/11906711_Asia_2.jpg
            // http://s4d3.turboimagehost.com/t1/11906711_Asia_2.jpg
            //   https://www.turboimagehost.com/p/11906711/Asia_2.jpg.html#
            // http://s5d3.turboimagehost.com/t1/22255196_Margot-Robbie-FocPr5.jpg
            //   http://s5d3.turboimg.net/sp/d00f885d238cb0ecea6f522e9af6b124/Margot-Robbie-FocPr5.jpg
            var id = src.replace(/.*\/([0-9]+)_([^/]*)$/, "$1/$2");
            if (id !== src) {
                var nid = id.split("/")[0];
                var pid = id.split("/")[1];
                var queryurl = "http://www.turboimagehost.com/p/" + nid + "/" + pid + ".html";
                options.do_request({
                    url: queryurl,
                    method: "GET",
                    onload: function(resp) {
                        if (resp.readyState === 4) {
                            var match = resp.responseText.match(/<meta *property="og:image" *content="([^"]*)"/);
                            if (match) {
                                options.cb(match[1]);
                            } else {
                                options.cb(null);
                            }
                        }
                    }
                });

                return {
                    waiting: true
                };
            }
        }

        if (domain_nowww === "arhivach.cf") {
            // http://arhivach.cf/storage2/t/4c1c0a8dd754497fa95deb73e843f697.jpg
            //   http://arhivach.cf/storage2/4/c1/4c1c0a8dd754497fa95deb73e843f697.jpg
            return src.replace(/(\/storage[0-9]*\/)t\/([0-9a-f])([0-9a-f]{2})([0-9a-f]+\.[^/.]*)$/, "$1$2/$3/$2$3$4");
        }

        if (domain === "content.wafflegirl.com" ||
            // https://cdn.pornpictureshq.com/galleries/gthumb/5/608/5608634_a66a64b_2400x_.jpg -- stretched
            //   https://cdn.pornpictureshq.com/galleries/content/5/608/5608634_a66a64b.jpg
            domain === "cdn.pornpictureshq.com") {
            // https://content.wafflegirl.com/galleries/gthumb/4/372/4372786_feeb209__x180.jpg
            //   https://content.wafflegirl.com/galleries/content/4/372/4372786_feeb209.jpg
            return src.replace(/\/galleries\/gthumb\/(.*)(?:__x[0-9]+|_[0-9]+x(?:[0-9]+)?_?)(\.[^/.]*)$/, "/galleries/content/$1$2");
        }

        if (domain_nowww === "anawalls.com") {
            // http://www.anawalls.com/repic/image.php?src=http://www.anawalls.com/images/games/fallout-equipment-look-wall.jpg&h=960&w=1080
            //   http://www.anawalls.com/images/games/fallout-equipment-look-wall.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/repic\/image\.php.*?[?&]src=([^&]*).*?$/, "$1"));
        }

        // xenforo
        if (domain === "d3ofq03apmfb8c.cloudfront.net" ||
            // https://www.lipstickalley.com/data/avatars/s/316/316955.jpg?1534645550
            //   https://www.lipstickalley.com/data/avatars/l/316/316955.jpg?1534645550
            domain_nowww === "lipstickalley.com" ||
            // https://cdn1-hfboards.mandatory.com/data/avatars/m/10/10860.jpg?1511299989
            //   https://cdn1-hfboards.mandatory.com/data/avatars/l/10/10860.jpg?1511299989 -- o doesn't work
            (domain_nosub === "mandatory.com" && domain.match(/^cdn[0-9]*-hfboards\./)) ||
            // https://simsettlements.com/site/data/avatars/m/0/288.jpg?1521204948
            //   https://simsettlements.com/site/data/avatars/l/0/288.jpg?1521204948 -- o doesn't work
            domain_nowww === "simsettlements.com") {
            // https://d3ofq03apmfb8c.cloudfront.net/data/avatars/m/121/121702.jpg?1514486539
            //   https://d3ofq03apmfb8c.cloudfront.net/data/avatars/o/121/121702.jpg?1514486539
            var regex = /\/data\/avatars\/[a-z]\/([0-9]+\/[0-9]+\.[^/.]*)$/;
            return [
                src.replace(regex, "/data/avatars/o/$1"),
                src.replace(regex, "/data/avatars/l/$1")
            ];
        }

        if (domain === "img-cache.cdn.gaiaonline.com") {
            // https://img-cache.cdn.gaiaonline.com/223686233997728eb65080b4a0361ad0/http://i885.photobucket.com/albums/ac52/iDeViLPsYcHo/Rp%20characters/ccf40aa911cf5800.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/[0-9a-f]+\//, "");
        }

        if (domain === "y.zdmimg.com") {
            // https://y.zdmimg.com/201709/01/59a8ec69cb8149731.jpg_e600.jpg
            //   https://y.zdmimg.com/201709/01/59a8ec69cb8149731.jpg
            return src.replace(/(\/[0-9a-f]+\.[^/._]*)_[a-z][0-9]+\.[^/.]*$/, "$1");
        }

        if (domain_nosub === "oboi.ws") {
            // https://oboi.ws/wallpapers/23_11236_oboi_zastavka_fallout_3_960x800.jpg
            //   https://oboi.ws/originals/original_11236_oboi_zastavka_fallout_3_1920x1200.jpg
            //   https://oboi.ws/originals/original_11236_oboi_zastavka_fallout_3.jpg -- same as above
            // https://srcc.oboi.ws/wallpapers/a_12503_oboi_el_v_snegopad.jpg
            //   https://srcc.oboi.ws/originals/original_12503_oboi_el_v_snegopad.jpg -- 2560x1600
            return src.replace(/\/wallpapers\/(?:[0-9]+|[a-z])_([0-9]+_[^/]*)(?:_[0-9]+x[0-9]+)?(\.[^/.]*)$/, "/originals/original_$1$2");
        }

        if (domain === "images.wallpaperscraft.com" &&
           options && options.cb && options.do_request) {
            // https://images.wallpaperscraft.com/image/fallout_3_enclave_armor_2055_1152x864.jpg
            //   https://wallpaperscraft.com/download/fallout_3_enclave_armor_2055/1152x864
            //   https://wallpaperscraft.com/wallpaper/fallout_3_enclave_armor_2055
            //   https://images.wallpaperscraft.com/image/fallout_3_enclave_armor_2055_1920x1080.jpg
            var id = src.replace(/.*\/([^/]*)_[0-9]+x[0-9]+(\.[^/.]*)$/, "$1/$2");
            if (id !== src) {
                var pid = id.split("/")[0];
                var ext = id.split("/")[1];
                options.do_request({
                    url: "https://wallpaperscraft.com/wallpaper/" + pid,
                    method: "GET",
                    onload: function(resp) {
                        if (resp.readyState !== 4) {
                            return;
                        }

                        var match = resp.responseText.match(/<a[^>]*\/download\/[^>]*>\s*Original Resolution: *([0-9]+x[0-9]+)/);
                        if (match) {
                            options.cb("https://images.wallpaperscraft.com/image/" + pid + "_" + match[1] + ext);
                        } else {
                            options.cb(null);
                        }
                    }
                });
            }

            return {
                waiting: true
            };
        }

        if (domain === "cdn.eso.org" ||
            domain_nowww === "eso.org") {
            // https://cdn.eso.org/images/thumb300y/eso9925a.jpg -- 314x300
            //   https://cdn.eso.org/images/screen/eso9925a.jpg -- 1280x1223
            //   https://cdn.eso.org/images/publicationjpg/eso9925a.jpg -- 4000x3823
            //   https://cdn.eso.org/images/large/eso9925a.jpg -- 8330x7961
            // https://www.eso.org/public/archives/postcards/screen/postcard_0040.jpg -- 1280x904
            //   https://www.eso.org/public/archives/postcards/large/postcard_0040.jpg -- 2007x1417
            return src.replace(/(\/images\/|\/archives\/postcards\/)[^/]*\/([^/.]*\.[^/.]*)$/, "$1large/$2");
        }

        if (domain === "www.galex.caltech.edu" ||
            domain === "galex.caltech.edu") {
            // http://www.galex.caltech.edu/media/images/glx2009-01f_img02_Sm.jpg
            //   http://www.galex.caltech.edu/media/images/glx2009-01f_img02.jpg -- 4402x4402
            // http://www.galex.caltech.edu/media/images/glx2007-04r_img07_small.jpg
            //   http://www.galex.caltech.edu/media/images/glx2007-04r_img07.jpg -- 1569x1600
            // http://www.galex.caltech.edu/media/videos/glx2012-02r_vid01_tn.jpg
            //   http://www.galex.caltech.edu/media/videos/glx2012-02r_vid01_shot.jpg
            return src
                .replace(/(_img[0-9]*)_(?:Sm|small)(\.[^/.]*)$/, "$1$2")
                .replace(/(_vid[0-9]*)_tn(\.[^/.]*)$/, "$1_shot$2");
        }

        if (domain_nowww === "astro-austral.cl") {
            // http://www.astro-austral.cl/imagenes/galaxies/NGC1097/med.jpg
            //   http://www.astro-austral.cl/imagenes/galaxies/NGC1097/max.jpg
            return src.replace(/(\/imagenes\/galaxies\/[^/]*\/)[a-z]+(\.[^/.]*)$/, "$1max$2");
        }

        if (domain === "cdn.spacetelescope.org") {
            // https://cdn.spacetelescope.org/archives/images/news/heic1623a.jpg -- 180x180
            //   https://cdn.spacetelescope.org/archives/images/newsfeature/heic1623a.jpg
            //   https://cdn.spacetelescope.org/archives/images/thumb700x/heic1623a.jpg
            //   https://cdn.spacetelescope.org/archives/images/large/heic1623a.jpg -- 2667x2667
            return src.replace(/(\/archives\/images\/)[^/]*(\/[^/.]*\.[^/.]*)$/, "$1large$2");
        }

        if (domain_nowww === "buddhistdoor.net") {
            // https://www.buddhistdoor.net/upload/file/20180625/17459/b0a6f633cc339d290f66e17e38bc2143_715__2.jpg
            //   https://www.buddhistdoor.net/upload/file/20180625/17459/b0a6f633cc339d290f66e17e38bc2143.jpg
            return src.replace(/(\/upload\/file\/[0-9]+\/[0-9]+\/[0-9a-f]+)_[0-9]+(?:__[0-9]+)?(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "agraroldal.hu") {
            // https://www.agraroldal.hu/nodepic/370x245/16243.png
            //   https://www.agraroldal.hu/kep/730x400/16243.jpg
            //   https://www.agraroldal.hu/upload/upimages/16243.jpg -- 680x382
            return add_extensions(src.replace(/\/[^/]*\/[0-9]+x[0-9]+\/([0-9]+\.[^/.]*)$/, "/upload/upimages/$1"));
        }

        if (domain === "media.lamsao.com") {
            // https://media.lamsao.com/Thumbnail/Cache//Data//quynhnx/13062016/cach_phong_va_dieu_tri_cac_benh_thuong_gap_o_tho(1)_410_240.gif
            //   https://media.lamsao.com//Data//quynhnx/13062016/cach_phong_va_dieu_tri_cac_benh_thuong_gap_o_tho(1).gif
            return src.replace(/\/Thumbnail\/Cache\/*Data\/(.*)_[0-9]+_[0-9]+(\.[^/.]*)$/, "/Data/$1$2");
        }

        if (domain === "tupian.aladd.net") {
            // http://tupian.aladd.net/2017/8/bizhitupian1717.jpg-400246
            //   http://tupian.aladd.net/2017/8/bizhitupian1717.jpg
            return src.replace(/(\.[^-/.]*)-[0-9]+(?:[?#]*)?$/, "$1");
        }

        if (domain === "uploadfile.huiyi8.com") {
            // https://uploadfile.huiyi8.com/2014/0528/20140528094437460.jpg.270.jpg
            //   https://uploadfile.huiyi8.com/2014/0528/20140528094437460.jpg
            return src.replace(/(\.[^/.]*)\.[0-9]+\.[^/.]*$/, "$1");
        }

        if ((domain_nosub === "redocn.com" && domain.match(/^img[0-9]*\./)) ||
            // http://image.tupian114.com/20130531/03240989.jpg.238.jpg
            //   http://image.tupian114.com/20130531/03240989.jpg
            domain === "image.tupian114.com") {
            // http://img3.redocn.com/20130611/Redocn_2013060816204606.jpg.285.jpg
            //   http://img3.redocn.com/20130611/Redocn_2013060816204606.jpg
            // http://img3.redocn.com/tupian/20130611/chuanheiyongyisongjiandewaiguomeinv_2101315_small.jpg
            //   http://img3.redocn.com/tupian/20130611/chuanheiyongyisongjiandewaiguomeinv_2101315.jpg -- doesn't work
            //   http://img3.redocn.com/20130611/chuanheiyongyisongjiandewaiguomeinv_2101315.jpg -- doesn't work
            return {
                url: src.replace(/(\/[^/]*\.[^/.]*)\.[0-9]+\.[^/.]*$/, "$1"),
                problems: {
                    watermark: true
                }
            };
        }

        if (domain === "media.alienwarearena.com") {
            // https://media.alienwarearena.com/thumbnail_630x315/8c559ad4f9e3a06173ff22db75ac65c8.jpg
            //   https://media.alienwarearena.com/media/8c559ad4f9e3a06173ff22db75ac65c8.jpg
            return src.replace(/\/thumbnail_[0-9]+x[0-9]+\/([0-9a-f]+\.[^/.]*)$/, "/media/$1");
        }

        if (domain_nowww === "6asian.com") {
            // http://6asian.com/imglink/japanpic-thumb265x385/29/0000029503/001.jpg
            //   http://6asian.com/imglink/japanpic/29/0000029503/001.jpg
            return src.replace(/(\/imglink\/[a-z]+)-thumb[0-9]+x[0-9]+\//, "$1/");
        }

        if (domain === "music.fetnet.net") {
            // http://music.fetnet.net/img/album/1482127-202.jpg
            //   http://music.fetnet.net/img/album/1482127.jpg
            return src.replace(/(\/img\/album\/[0-9]+)-[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "wallpaperscave.ru") {
            // https://wallpaperscave.ru/images/thumbs/category/355x200/17/11-15/fantasy-deer-401.jpg
            //   https://wallpaperscave.ru/images/thumbs/wp-preview/800x500/17/11-15/fantasy-deer-401.jpg
            //   https://wallpaperscave.ru/images/original/17/11-15/fantasy-deer-401.jpg
            return src.replace(/\/images\/thumbs\/[^/]*\/[0-9]+x[0-9]+\//, "/images/original/");
        }

        if (domain_nowww === "lilit.lv") {
            // http://lilit.lv/_mm/profiles/77501/180px_77560_9909613368.jpg
            //   http://lilit.lv/_mm/profiles/77501/full_77560_9909613368.jpg
            // http://lilit.lv/_mm/profiles/51501/48px_51853_57bf3c8383.jpg
            //   http://lilit.lv/_mm/profiles/51501/full_51853_57bf3c8383.jpg
            return src.replace(/\/[0-9]+px_([0-9]+_[0-9a-f]+\.[^/.]*)$/, "/full_$1");
        }

        if (domain === "img.kurocore.com") {
            // https://img.kurocore.com/thumbnail/p/46000000/46718000/46718715_0.png
            //   https://img.kurocore.com/p/46000000/46718000/46718715_0.png
            return src.replace(/(:\/\/[^/]*\/)thumbnail\/p\//, "$1p/");
        }

        if (domain_nowww === "mocah.org") {
            // https://mocah.org/thumbs/4600162-suspension-bridge-golden-gate-bridge-bridge-river.jpg
            //   https://mocah.org/uploads/posts/4600162-suspension-bridge-golden-gate-bridge-bridge-river.jpg -- 5332x3725
            return src.replace(/(:\/\/[^/]*\/)thumbs\/([0-9]+-[^/]*)$/, "$1uploads/posts/$2");
        }

        if (domain_nowww === "safebooru.org" ||
            // https://tbib.org/thumbnails/6318/thumbnail_bc6c3a6300b51966c444c1de7c882c9fe9d0e853.jpg?6830612
            //   https://tbib.org/images/6318/bc6c3a6300b51966c444c1de7c882c9fe9d0e853.png?6830612
            // https://tbib.org//samples/6401/sample_c4c751ed72f749616d5a15a5d17e7a243961ca3f.jpg?6914345 -- 850x1183
            //   https://tbib.org//images/6401/c4c751ed72f749616d5a15a5d17e7a243961ca3f.jpg?6914345 -- 2920x4065
            domain_nowww === "tbib.org" ||
            // https://realbooru.com/thumbnails/512/thumbnail_73f1ecc9ae212fa6be7e45d30aae769bfa5376c0.jpg?513812
            //   https://realbooru.com/images/512/73f1ecc9ae212fa6be7e45d30aae769bfa5376c0.jpg?513812
            domain_nowww === "realbooru.com") {
            // http://safebooru.org/thumbnails/2473/thumbnail_6cf1f0d716b67c369ffe6310219a595f.jpeg?2574463
            //   http://safebooru.org//images/2473/6cf1f0d716b67c369ffe6310219a595f.jpeg?2574463
            // http://safebooru.org//samples/1293/sample_661a213e5b86a59e86ebfb58ab60b137d4518731.png?1346716
            //   http://safebooru.org//images/1293/661a213e5b86a59e86ebfb58ab60b137d4518731.png?1346716
            return add_extensions_with_jpeg(src.replace(/\/(?:thumbnails|samples)(\/[0-9]+\/)(?:thumbnail|sample)_([0-9a-f]+\.[^/.]*)$/, "/images$1$2"));
        }

        if (domain_nowww === "anime-zone.ru") {
            // http://www.anime-zone.ru/inc/goods_wallpapers/nagi_no_asukara/small/nagi_no_asukara12.jpg
            //   http://www.anime-zone.ru/inc/goods_wallpapers/nagi_no_asukara/nagi_no_asukara12.jpg
            return src.replace(/(\/inc\/goods_[a-z]+\/[^/]*\/)[a-z]+\/([^/]*)$/, "$1$2");
        }

        if (domain_nowww === "99px.ru") {
            // https://99px.ru/sstorage/53/2018/08/mid_234704_705818.jpg
            //   https://wallpapers.99px.ru/cms/mhost.php?tid=53&act=getimage&id=234704
            return src.replace(/:\/\/[^/]*\/sstorage\/[0-9]+\/[0-9]+\/[0-9]+\/[a-z]+_([0-9]+)_[0-9]+\.[^/.]*$/,
                               "://wallpapers.99px.ru/cms/mhost.php?tid=53&act=getimage&id=$1");
        }

        if (domain_nowww === "wall2born.com") {
            // http://wall2born.com/file/download/480x272/670/image-44639280-bleach-pictures-and-wallpaper-480x272.jpg
            //   http://wall2born.com/data/out/670/image-44639280-bleach-pictures-and-wallpaper.jpg
            return src.replace(/\/file\/download\/[0-9]+x[0-9]+\/([0-9]+\/[^/]*)-[0-9]+x[0-9]+(\.[^/.]*)$/,
                               "/data/out/$1$2");
        }

        if (amazon_container === "desktop-backgrounds-org") {
            // http://desktop-backgrounds-org.s3.amazonaws.com/iphone4-640x960/bleach-anime_0.jpg
            //   http://desktop-backgrounds-org.s3.amazonaws.com/400x300/bleach-anime_0.jpg
            //   http://desktop-backgrounds-org.s3.amazonaws.com/bleach-anime_0.jpg
            return src.replace(/\/(?:[^-/]*-)?[0-9]+x[0-9]+\/([^/]*\.[^/.]*)$/, "/$1");
        }

        if (domain_nowww === "oboi.cc" ||
            // http://oboik.ru/uploads_full/11_05_2013/view/201209/oboik.ru_28819.jpg
            //   http://oboik.ru/uploads/11_05_2013/view/201209/oboik.ru_28819.jpg
            domain_nowww === "oboik.ru") {
            // http://oboi.cc/uploads/11_05_2013/thrumb/201209/oboik.ru_28819.jpg
            //   http://oboi.cc/uploads/11_05_2013/view/201209/oboik.ru_28819.jpg
            // http://oboi.cc/uploads_full/11_05_2013/view/201209/oboik.ru_11834.jpg
            //   http://oboi.cc/640-960-100-uploads/11_05_2013/view/201209/oboik.ru_11834.jpg
            //   http://oboi.cc/uploads/11_05_2013/view/201209/oboik.ru_11834.jpg
            return src.replace(/\/(?:[-0-9]+)?uploads(?:_full)?(\/[0-9]+_[0-9]+_[0-9]+\/)[a-z]+(\/[0-9]+\/[^/]*)$/,
                               "/uploads$1view$2");
        }

        if (domain === "img.getbg.net") {
            // https://img.getbg.net/upload/thumbnail/8/thumbnail_373017_devushka_krasnye_1680x1050_(www.GetBg.net).jpg
            //   https://img.getbg.net/upload/full/8/373017_devushka_krasnye_1680x1050_(www.GetBg.net).jpg
            // https://img.getbg.net/upload/small/8/373053_devochka_kukla_nakidka_povyazka_forma_1680x1050_(www.GetBg.net).jpg
            //   https://img.getbg.net/upload/full/8/373053_devochka_kukla_nakidka_povyazka_forma_1680x1050_(www.GetBg.net).jpg
            // https://img.getbg.net/upload/thumbnail/14/thumbnail_www.GetBg.net_Girls_Models_Models_M_Mandy_Moore_033567_.jpg
            //   https://img.getbg.net/upload/full/14/www.GetBg.net_Girls_Models_Models_M_Mandy_Moore_033567_.jpg
            return src.replace(/\/upload\/[a-z]+\/([0-9]*\/)(?:thumbnail_)?([^/]*)$/,
                               "/upload/full/$1$2");
        }

        if ((domain_nosub === "fichub.com" ||
             // https://scontent.ccdn.cloud/image/allsongs/8fa288f8-e322-4de4-a5df-9403982a45e7/selena-gomez-lookbook-3-maxw-250.jpg
             //   https://scontent.ccdn.cloud/image/allsongs/8fa288f8-e322-4de4-a5df-9403982a45e7/selena-gomez-lookbook-3.jpg
             domain === "scontent.ccdn.cloud")
            && src.indexOf("/image/") >= 0) {
            // https://cc-media-foxit.fichub.com/image/fox-it-life/b468e9df-a238-476c-83c4-e6b279deb76f/anthony-bourdain-e-asia-argento-maxw-654.jpg
            //   https://cc-media-foxit.fichub.com/image/fox-it-life/b468e9df-a238-476c-83c4-e6b279deb76f/anthony-bourdain-e-asia-argento.jpg
            // https://cc-media-foxit.fichub.com/image/fox-it-life/ea0e5584-d47d-44b1-9afb-c3303787cefd/953895948-114x76.jpg
            //   https://cc-media-foxit.fichub.com/image/fox-it-life/ea0e5584-d47d-44b1-9afb-c3303787cefd/953895948.jpg
            return src.replace(/(\/[-0-9a-f]+\/[^/]*)-(?:maxw-[0-9]+|[0-9]+x[0-9]+)(\.[^/.]*)$/,
                               "$1$2");
        }

        if (domain_nowww === "nishinippon.co.jp" && src.indexOf("/import/") >= 0) {
            // https://www.nishinippon.co.jp/import/showbiz_news/20180821/201808210001_001_s.jpg?1534811525
            //   https://www.nishinippon.co.jp/import/showbiz_news/20180821/201808210001_001.jpg?1534811525
            return src.replace(/(\/[0-9]+\/[0-9]+_[0-9]+)_s(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "resource.shuud.mn") {
            // http://resource.shuud.mn/shuud/image/2018/08/22/xeu7elkamwgwtpz9/01_t.jpg
            //   http://resource.shuud.mn/shuud/image/2018/08/22/xeu7elkamwgwtpz9/01.jpg
            return src.replace(/(\/[0-9]+)_t(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "anime-fresh.ru") {
            // https://anime-fresh.ru/upload/anime/thumbs/Re__Zero_kara_Hajimeru_Isekai_Seikatsu.jpg
            //   https://anime-fresh.ru/upload/anime/Re__Zero_kara_Hajimeru_Isekai_Seikatsu.jpg
            return src.replace(/(\/upload\/[a-z]+\/)thumbs\/([^/]*)$/, "$1$2");
        }

        if (domain === "imgfiles.plaync.com") {
            // http://imgfiles.plaync.com/file/BladeNSoul/download_thumbnail/20160912221145-ry9tUQKyoplI1QVtfPJB0-v4
            //   http://imgfiles.plaync.com/file/BladeNSoul/download/20160912221145-ry9tUQKyoplI1QVtfPJB0-v4
            return src.replace(/\/download_thumbnail\/([^/]*)$/, "/download/$1");
        }

        if (domain_nowww === "jjdao.com") {
            // http://www.jjdao.com/wiki/uploads/201612/1481781787amEjHAln_s.jpg
            //   http://www.jjdao.com/wiki/uploads/201612/1481781787amEjHAln.jpg
            return src.replace(/(\/wiki\/uploads\/[0-9]+\/[0-9+][0-9a-zA-Z]+)_[a-z](\.[^/.]*)$/, "$1$2");
        }

        if (domain === "t.huv.kr") {
            // http://t.huv.kr/thumb_crop_resize.php?url=http://down.humoruniv.org//hwiparambbs/data/editor/thema2/e_4718647921_fdfa6592069e332859cc96ab65d89710621d1309.jpg?SIZE=540x431
            //   http://down.humoruniv.org//hwiparambbs/data/editor/thema2/e_4718647921_fdfa6592069e332859cc96ab65d89710621d1309.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/thumb_crop_resize\.php.*?[?&]url=([^&?]*).*?$/, "$1"));
        }

        if (domain === "down.humoruniv.org") {
            // http://down.humoruniv.org//hwiparambbs/data/editor/thema2/e_4718647921_fdfa6592069e332859cc96ab65d89710621d1309.jpg -- 403 if referer is wrong
            return {
                url: src,
                headers: {
                    Referer: ""
                }
            };
        }

        if (domain_nosub === "aniimg.com" &&
            domain.match(/^static[0-9]*\./) &&
            src.indexOf("/upload/") >= 0) {
            // https://static2.aniimg.com/upload/20170517/473/R/M/N/p=700/RMNFEF.jpg -- 700x393
            //   https://static2.aniimg.com/upload/20170517/473/R/M/N/RMNFEF.jpg -- 1920x1080
            return src.replace(/\/[a-z]=[0-9]+\/([^/]*)$/, "/$1");
        }

        if (domain_nosub === "pocoimg.cn" &&
            domain.match(/^img[0-9]*\./)) {
            // http://img1001.pocoimg.cn/image/poco/works/26/2014/0829/09/17334845920140829094638013_173348459_W120.jpg
            //   http://img1001.pocoimg.cn/image/poco/works/26/2014/0829/09/17334845920140829094638013_173348459.jpg
            return src.replace(/_[WH][0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "qcmt.bid") {
            // http://www.qcmt.bid/upload/?src=http://ww4.sinaimg.cn/mw690/81309c56jw1f03kbkfyyyj20hs0qowhm.jpg&w=250&h=380&q=90
            //   http://ww4.sinaimg.cn/mw690/81309c56jw1f03kbkfyyyj20hs0qowhm.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/upload\/.*?[?&]src=([^&]*).*?$/, "$1"));
        }

        if (domain === "pic.xiao4j.com") {
            // http://pic.xiao4j.com/upload/meinv/2017_1107/162158625.jpg_330_528.jpg
            //   http://pic.xiao4j.com/upload/meinv/2017_1107/162158625.jpg
            return src.replace(/(\/[0-9]+\.[^/._]*)_[0-9]+_[0-9]+\.[^/.]*$/, "$1");
        }

        if (domain === "img.mm29.com") {
            // http://img.mm29.com/images/2017/02/17/1487303840274.jpg/800.jpg -- 800x1200
            //   http://img.mm29.com/images/2017/02/17/1487303840274.jpg -- 800x1200, no watermark
            return src.replace(/(\/[0-9]+\.[^/.]*)\/[0-9]+\.[^/.]*$/, "$1");
        }

        if (domain_nosub === "2chmatome2.jp" &&
            domain.match(/^image[0-9]*\./)) {
            // http://image2.2chmatome2.jp/v2/thumb/app/700/700/?url=http%3A%2F%2Ffile.2chmatome2.jp%2Fhttp%25253A%25252F%25252Flivedoor.blogimg.jp%25252Frabitsokuhou%25252Fimgs%25252Fc%25252F9%25252Fc98c3133-s.jpg&page_url=http%3A%2F%2Frabitsokuhou.2chblog.jp%2Farchives%2F68718395.html&site_url=http%3A%2F%2Frabitsokuhou.2chblog.jp%2F
            //   http://file.2chmatome2.jp/http%253A%252F%252Flivedoor.blogimg.jp%252Frabitsokuhou%252Fimgs%252Fc%252F9%252Fc98c3133-s.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/v2\/thumb\/app\/[0-9]+\/[0-9]+\/.*?[?&]url=([^&]*).*?$/, "$1"));
        }

        if (domain === "file.2chmatome2.jp") {
            // http://file.2chmatome2.jp/http%253A%252F%252Flivedoor.blogimg.jp%252Frabitsokuhou%252Fimgs%252Fc%252F9%252Fc98c3133-s.jpg
            //   http://livedoor.blogimg.jp/rabitsokuhou/imgs/c/9/c98c3133.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/(http)/, "$1");
            if (newsrc !== src) {
                return decodeURIComponent(decodeURIComponent(newsrc));
            }
        }

        if (domain_nowww === "wnacg.net") {
            // https://www.wnacg.net/data/thumb/0329/27/053.jpg
            //   https://www.wnacg.net/data/0329/27/053.jpg -- 1200x1800
            return src.replace(/\/data\/thumb\//, "/data/");
        }

        if (domain === "rs.n1info.com") {
            // https://rs.n1info.com/Thumbnail/210745/jpeg/063_927262244.jpg -- 131x197
            //   https://rs.n1info.com/Picture/210745/jpeg/063_927262244.jpg -- 667x1000
            return src.replace(/\/Thumbnail(\/[0-9]+\/)/, "/Picture$1");
        }

        if (domain === "s.iw.ro") {
            // https://s.iw.ro/gateway/g/ZmlsZVNvdXJjZT1odHRwJTNBJTJGJTJG/c3RvcmFnZTAzZGdmLnJjcy1yZHMucm8l/MkZzdG9yYWdlJTJGMjAxOCUyRjAzJTJG/MDUlMkY4ODY0OTFfODg2NDkxX2x1cGl0/YV9ueW9uZ19vX29zY2FyLmpwZyZ3PTcw/MCZoYXNoPWVlYjNiNjFhNzU4NzBkNGNhYzI3NjU4YzYyMjU0YjNi.thumb.jpg -- 700x1049
            //   https://s.iw.ro/gateway/g/ZmlsZVNvdXJjZT1odHRwJTNBJTJGJTJG/c3RvcmFnZTAzZGdmLnJjcy1yZHMucm8l/MkZzdG9yYWdlJTJGMjAxOCUyRjAzJTJG/MDUlMkY4ODY0OTFfODg2NDkxX2x1cGl0/YV9ueW9uZ19vX29zY2FyLmpwZyZ3PTcw/MCZoYXNoPWVlYjNiNjFhNzU4NzBkNGNhYzI3NjU4YzYyMjU0YjNi.jpg -- 3446x5168
            return src.replace(/\.thumb(\.[^/.]+)([?#].*)?$/, "$1$2");
        }

        if (domain_nowww === "adevarul.ro" && src.indexOf("/MRImage/") >= 0) {
            // https://adevarul.ro/assets/adevarul.ro/MRImage/2018/03/05/5a9ce47ddf52022f75399776/978x0.jpg
            //   https://adevarul.ro/assets/adevarul.ro/MRImage/2018/03/05/5a9ce47ddf52022f75399776/orig.jpg -- 1000x1500
            return src.replace(/\/[0-9]+x[0-9]+(\.[^/.]*)$/, "/orig$1");
        }

        if (domain_nowww === "eva.bg") {
            // https://eva.bg/media_cache/blitz_photo/media/ZVEZDI/Novini/hijklmno/lupita_18_june1.jpg -- 400x601
            //   https://eva.bg/media/ZVEZDI/Novini/hijklmno/lupita_18_june1.jpg -- 740x1112
            return src.replace(/\/media_cache\/[^/]*\/media\//, "/media/");
        }

        if (domain_nosub === "blogspot.es") {
            // http://creaeventos.blogspot.es/cache/media/files/00/248/376/2014/05/lupita-nyongo-met-gala-2014.jpg -- 600x822
            //   http://creaeventos.blogspot.es/files/00/248/376/2014/05/lupita-nyongo-met-gala-2014.jpg -- 747x1024
            return src.replace(/\/cache\/media\/files\//, "/files/");
        }

        if (domain === "data.kontrakty.ua") {
            // http://data.kontrakty.ua/cache/photo/1000/29977.jpg -- stretched
            //   http://data.kontrakty.ua/cache/photo/orig/29977.jpg -- 575x790
            // http://data.kontrakty.ua/cache/www/4500/images/stories/fotos/2010/04/1week/dollar100_new.jpg -- 4500x3370, stretched
            //   http://data.kontrakty.ua/cache/www/orig/images/stories/fotos/2010/04/1week/dollar100_new.jpg -- 450x337
            return src.replace(/(\/cache\/[a-z]+\/)[0-9]+\//, "$1orig/");
        }

        // JoomGallery
        // https://github.com/JoomGallery/JoomGallery/tree/master/components/com_joomgallery
        if (domain_nowww === "life-instyle.com") {
            // https://life-instyle.com/component/joomgallery/image.raw?view=image&type=orig&id=31914&Itemid=219
            // https://life-instyle.com/index.php?option=com_joomgallery&view=image&format=raw&id=31914&type=img
            // https://life-instyle.com/component/joomgallery/image.raw?view=image&type=img&id=31914
            if (src.match(/:\/\/[^/]*\/index\.php\?/)) {
                if (url.searchParams.get("option") === "com_joomgallery" &&
                    url.searchParams.get("view") === "image" &&
                    url.searchParams.get("id")) {
                    return src.replace(/(:\/\/[^/]*\/).*/, "$1component/joomgallery/image.raw?view=image&type=orig&id=" + url.searchParams.get("id"));
                }
            }

            return src.replace(/\/component\/joomgallery\/image\..*?[?&]id=([0-9]+).*?$/, "/component/joomgallery/image.raw?view=image&type=orig&id=$1");
        }

        if (domain === "d3t543lkaz1xy.cloudfront.net") {
            // forces download
            // https://d3t543lkaz1xy.cloudfront.net/photo/5ae9d63898c1590e44a2fdb0_m -- 400x647
            //   https://d3t543lkaz1xy.cloudfront.net/photo/5ae9d63898c1590e44a2fdb0 -- 1000x1618
            return src.replace(/(\/photo\/[0-9a-f]+)_[a-z](?:[?#].*)?$/, "$1");
        }

        if (domain_nowww === "merokhabar.net") {
            // http://www.merokhabar.net/public/images/news/2015-07-31/thumbnail/thumbvtx1438282047fashion-show-2.jpg -- 67x100
            //   http://www.merokhabar.net/public/images/news/2015-07-31/original/orivtx1438282047fashion-show-2.jpg -- 1500x2254
            return src.replace(/\/thumbnail\/thumb([^/]*)$/, "/original/ori$1");
        }

        if (domain_nosub === "ali213.net" &&
            domain.match(/^img[0-9]*\./)) {
            // http://img2.ali213.net/picfile/News/2018/04/24/584_2018042415051896.jpg -- 584x945
            //   http://img2.ali213.net/picfile/News/2018/04/24/2018042415051896.jpg -- 741x1200
            return src.replace(/\/[0-9]+_([0-9]+\.[^/.]*)$/, "/$1");
        }

        if (domain === "reseuro.magzter.com" ||
            // https://rse.magzter.com/250x300/1462317978/1524856966/images/thumb/ebony-june-2018.jpg
            //   https://cdn.magzter.com/1462317978/1524856966/images/thumb/ebony-june-2018.jpg
            // https://cdn.magzter.com/1462317978/1524856966/images/thumb/390_thumb_1.jpg
            //   https://maghtml.magzter.com/data/13294/1524856966/jpg/1.jpg
            domain === "rse.magzter.com") {
            // https://reseuro.magzter.com/1843x2390/articles/1586/225398/59312259acd64/Sonam-Kapoor.jpg
            //   https://magarticles.magzter.com/articles/1586/225398/59312259acd64/Sonam-Kapoor.jpg
            return src
                .replace(/:\/\/[^/]*\/[0-9]+x[0-9]+\/articles\//, "://magarticles.magzter.com/articles/")
                .replace(/:\/\/rse\.[^/]*\/[0-9]+x[0-9]+\//, "://cdn.magzter.com/");
        }

        if (domain === "dev.magzter.com") {
            // https://dev.magzter.com/dynimage/thumb_news.php?src=http://www.dailyexcelsior.com/wp-content/uploads/2017/07/ZULFKAR-30.jpg&h=1787&w=4749&a=t&c=b
            //   https://dev.magzter.com/dynimage/thumb_news.php?src=http://www.dailyexcelsior.com/wp-content/uploads/2017/07/ZULFKAR-30.jpg&h=1787&w=4749&a=t&c=b
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/dynimage\/thumb_news\.php.*?[?&]src=([^&]*).*$/, "$1"));
        }

        if (domain === "img.bulawayo24.com") {
            // http://img.bulawayo24.com/articles/thumbs/187x105/danai_ebony.jpg
            //   http://img.bulawayo24.com/articles/danai_ebony.jpg
            return src.replace(/\/articles\/thumbs\/[0-9]+x[0-9]+\//, "/articles/");
        }

        if (domain === "static.eva.ro") {
            // https://static.eva.ro/img/auto_resized/db/article/161/215/472963l-1280x1280-b-b4a1c2c8.jpg
            //   https://static.eva.ro/img/db/article/161/215/472963l.jpg
            // https://static.eva.ro/img/auto_resized/db/article/075/429/737028l-640x0-w-3a540bf5.jpg -- 640x480
            //   https://static.eva.ro/img/db/article/075/429/737028l.jpg -- 875x657
            return src.replace(/\/img\/auto_resized\/db\/(.*)-[0-9]+x[0-9]+(?:-.-[0-9a-f]+)?(\.[^/.]*)$/, "/img/db/$1$2");
        }

        if (domain === "s-image.hnol.net") {
            // https://s-image.hnol.net/x/300x0/auto/http:/image.hnol.net/c/2014-01/07/10/201401071005511497-2381913.jpg
            //   http://image.hnol.net/c/2014-01/07/10/201401071005511497-2381913.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/x\/[0-9]+x[0-9]+\/auto\/(https?):\/\/?/, "$1://");
        }

        if (domain === "cdn.tower.jp") {
            // http://cdn.tower.jp/za/m/92/791154050392.jpg -- 120x120
            //   http://cdn.tower.jp/za/o/92/791154050392.jpg -- 1624x1443
            // https://cdn.tower.jp/za/m/7W/zaP2_G2904027W.JPG
            //   https://cdn.tower.jp/za/o/7W/zaP2_G2904027W.JPG -- 300x300
            return src.replace(/(:\/\/[^/]*\/za\/)[a-z]\//, "$1o/");
        }

        if (domain_nowww === "gamers-onlineshop.jp" ||
            // https://www.animate-onlineshop.jp/resize_image.php?image=12251336_5a40804200b2d.jpg&width=364
            //   https://www.animate-onlineshop.jp/upload/save_image/12251336_5a40804200b2d.jpg -- 800x793
            domain_nowww === "animate-onlineshop.jp" ||
            // http://acoop-onlineshop.jp/resize_image.php?image=04281047_57216b9a96fc9.jpg&width=160&height=160
            //   http://acoop-onlineshop.jp/upload/save_image/04281047_57216b9a96fc9.jpg
            domain_nowww === "acoop-onlineshop.jp" ||
            // https://cdn.melonbooks.co.jp/user_data/packages/resize_image.php?image=213001022722.jpg
            //   https://cdn.melonbooks.co.jp/upload/save_image/213001022722.jpg
            domain === "cdn.melonbooks.co.jp" ||
            // https://www.melonbooks.co.jp/resize_image.php?image=213001018798.jpg&width=320&height=320
            //   https://www.melonbooks.co.jp/upload/save_image/213001018798.jpg
            domain_nowww === "melonbooks.co.jp" ||
            // https://melonbooks.akamaized.net/user_data/packages/resize_image.php?image=216001013898.jpg&width=225&height=317&c=0&aa=0 -- 225x223
            //   https://melonbooks.akamaized.net/user_data/packages/resize_image.php?image=216001013898.jpg -- 700x694
            //   https://melonbooks.akamaized.net/upload/save_image/216001013898.jpg -- 700x694
            domain === "melonbooks.akamaized.net") {
            // https://www.gamers-onlineshop.jp/resize_image.php?image=01231144_5a66a18ea6340.jpg&width=165&height=165&age_limit=&sex_characteristic=&image_display_restriction=0&warning_restriction=0
            //   https://www.gamers-onlineshop.jp/upload/save_image/01231144_5a66a18ea6340.jpg -- 300x297
            return src.replace(/(:\/\/[^/]*\/)(?:user_data\/packages\/)?resize_image\.php.*?[?&]image=([^&]*).*$/, "$1upload/save_image/$2");
            //return src.replace(/(\/user_data\/packages\/resize_image\.php).*?[?&]image=([^&]*).*?$/, "$1?image=$2");
        }

        if (domain_nowww === "hmv.com.hk") {
            // https://www.hmv.com.hk/data/upload/220/goods_photos/2018-04-11/5ace05b8b2637.jpg
            //   https://www.hmv.com.hk/data/upload/goods_photos/2018-04-11/5ace05b8b2637.jpg -- 500x496
            return src.replace(/\/data\/upload\/[0-9]+\//, "/data/upload/");
        }

        if (domain_nowww === "buysmartjapan.com") {
            // https://www.buysmartjapan.com/images/a59a9d8e5bfb26d558780441a0ad1152?original=https%3A%2F%2Fmelonbooks.akamaized.net%2Fuser_data%2Fpackages%2Fresize_image.php%3Fimage%3D213001024963.jpg%26width%3D450%26height%3D450
            //   https://melonbooks.akamaized.net/user_data/packages/resize_image.php?image=213001024963.jpg&width=450&height=450
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/images\/[0-9a-f]+.*?[?&]original=([^&]*).*$/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);
        }

        if (domain_nowww === "sonymusic.co.jp") {
            // http://www.sonymusic.co.jp/adm_image/common/artist_image/70007000/70007036/jacket_image/164900__240_240_0.jpg -- 240x238
            //   http://www.sonymusic.co.jp/adm_image/common/artist_image/70007000/70007036/jacket_image/164900.jpg -- 600x595
            return src.replace(/(\/adm_image\/common\/.*)__[0-9]+_[0-9]+_[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "imageban.ru" &&
            domain.match(/^i[0-9]*\./)) {
            // http://i5.imageban.ru/thumbs/2018.01.31/e4aa3be93fac2bdf3be5247651ff560c.jpg -- 400x397
            //   http://i5.imageban.ru/out/2018/01/31/e4aa3be93fac2bdf3be5247651ff560c.jpg -- 1000x992
            return src.replace(/(:\/\/[^/]*\/)thumbs\/([0-9]+)\.([0-9]+)\.([0-9]+)\/([0-9a-f]+\.[^/.]*)$/, "$1out/$2/$3/$4/$5");
        }

        if (domain === "image.hackadoll.com") {
            // http://image.hackadoll.com/thumbs?h=480&of=jpeg&u=https%3A%2F%2Fimages-na.ssl-images-amazon.com%2Fimages%2FI%2F81IgPIGF6KL._SX500_.jpg&w=480&s=251c265914eb90230ac4e8ee87c060ef&t=1516684897
            //   https://images-na.ssl-images-amazon.com/images/I/81IgPIGF6KL._SX500_.jpg
            return decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/thumbs.*?[?&]u=([^&]*).*$/, "$1"));
        }

        if (domain === "images.niooz.fr") {
            // http://images.niooz.fr/safe_image.php?width=500&i=/cache/mediaid/2/5/1/8/7/2/25187296.jpg
            //   http://images.niooz.fr/cache/mediaid/2/5/1/8/7/2/25187296.jpg
            return urljoin(src, decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/safe_image\.php.*?[?&]i=([^&]*).*$/, "$1")));
        }

        if (domain_nowww === "mengchongzhi.com") {
            // https://www.mengchongzhi.com/uploadfile/thumb/1f/0a869870.jpg
            //   https://www.mengchongzhi.com/uploadfile/1f/0a869870.jpg
            return src.replace(/\/uploadfile\/thumb\//, "/uploadfile/");
        }

        if (domain_nowww === "playground33.com") {
            // http://www.playground33.com/uploads/4/3/2/3/43233663/9781367.jpg -- 400x603
            //   http://www.playground33.com/uploads/4/3/2/3/43233663/9781367_orig.jpg -- 497x750
            return src.replace(/(\/uploads\/(?:[0-9]\/){4}[0-9]+\/[0-9]+)(\.[^/.]*)$/, "$1_orig$2");
        }

        if (domain_nosub === "trends.com.cn" &&
            domain.match(/^cdn[0-9]*\./)) {
            // http://cdn7.trends.com.cn/Fni7F2z66cOlb3SeBCiWk5Fbz7jU-tweb.album.jpeg -- 480x721
            //   http://cdn7.trends.com.cn/Fni7F2z66cOlb3SeBCiWk5Fbz7jU -- 1160x1742
            // http://cdn7.trends.com.cn/FoNOlkPcSWJtouTkWrxKl9GKBKhZ-tweb.list.jpeg -- 320x320
            //   http://cdn7.trends.com.cn/FoNOlkPcSWJtouTkWrxKl9GKBKhZ -- 462x347
            // http://cdn7.trends.com.cn/FgXqmQ9F9JEYQSDfgFwQt6Eum3hx-tweb.article -- watermark
            //   http://cdn7.trends.com.cn/FgXqmQ9F9JEYQSDfgFwQt6Eum3hx -- no watermark
            return src.replace(/-tweb\.[a-z]+(?:\.[^/.]*)?(?:[?#].*)?$/, "");
        }

        if (domain_nowww === "la-soubrette.fr") {
            // https://www.la-soubrette.fr/pornstars/thumbs-photo-nue/774221.jpg -- 112x165
            //   https://www.la-soubrette.fr/pornstars/photo-ps-nue/774221.jpg --1388x2048
            return src.replace(/\/thumbs-photo-nue\//, "/photo-ps-nue/");
        }

        if (domain === "static.feber.se" && src.indexOf("/article_images/") >= 0) {
            // https://static.feber.se/article_images/37/50/79/375079_1280.jpg -- 1280x1889
            //   https://static.feber.se/article_images/37/50/79/375079.jpg -- 1388x2048
            return src.replace(/(\/[0-9]+)_[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "previiew.com") {
            // https://previiew.com/webfile/img/3217/x=500/y=600
            //   https://previiew.com/webfile/img/3217 -- 501 on head
            return {
                url: src.replace(/(\/webfile\/img\/[0-9]+)(?:\/[xy]=[0-9]+){0,}(?:[?#].*)?$/, "$1"),
                can_head: false
            };
        }

        if (domain === "d2e7nuz2r6mjca.cloudfront.net") {
            // https://d2e7nuz2r6mjca.cloudfront.net/2017/8/1502865807_n2-1280w.jpg -- stretched
            //   https://d2e7nuz2r6mjca.cloudfront.net/2017/8/1502865807_n2.jpg -- 796x532
            return src.replace(/-[0-9]+[wh](\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "vplate.ru" ||
            // http://wlooks.ru/images/article/cropped/220-308/2016/12/vechernie-tufli-y-goda.jpg
            //   http://wlooks.ru/images/article/orig/2016/12/vechernie-tufli-y-goda.jpg -- 1000x501
            domain_nowww === "wlooks.ru") {
            // http://www.vplate.ru/images/article/cropped/220-308/2017/02/zhenskie-vechernie-klatchi-93.jpg -- 220x308
            //   http://www.vplate.ru/images/article/orig/2017/02/zhenskie-vechernie-klatchi-93.jpg -- 480x720
            return src.replace(/\/images\/article\/cropped\/[0-9]+-[0-9]+\//, "/images/article/orig/");
        }

        if (domain === "media.vogue.com") {
            // http://media.vogue.com/r/h_660,w_440/2016/12/08/00-holding-jones.jpg
            //   http://media.vogue.com/r/original/2016/12/08/00-holding-jones.jpg
            //   https://assets.vogue.com/photos/589153bd97a3db337a249a68/original/original/00-holding-jones.jpg
            // http://media.vogue.com/r/pass/2016/05/12/11-margot-robbie-best-red-carpet-looks.jpg -- 2000x3000
            //   http://media.vogue.com/r/original/2016/05/12/11-margot-robbie-best-red-carpet-looks.jpg -- 2000x3000
            return src.replace(/(:\/\/[^/]*\/)r\/[a-z]_[0-9]+(?:,[a-z]_[0-9]+){0,}\//, "$1r/original/");
        }

        if (domain_nosub === "efu.com.cn" &&
            domain.match(/^img[0-9]*\./)) {
            // http://img1.efu.com.cn/upfile/fashion/photo/small/36745/824909.jpg -- 100x151
            //   http://img1.efu.com.cn/upfile/fashion/photo/36745/824909.jpg -- 720x1086
            return src.replace(/(\/upfile\/[^/]*\/photo\/)[a-z]+\/([0-9]+\/[0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "images.stopgame.ru") {
            // https://images.stopgame.ru/articles/2018/08/28/c456x256/eMlTwGkFEIomrj50ODUKhQ/xDGn_Lq7.jpg -- 456x256
            //   https://images.stopgame.ru/articles/2018/08/28/xDGn_Lq7.jpg -- 1280x720
            // https://images.stopgame.ru/articles/2018/08/28/death_s_gambit_review_igry-1535467258-s.jpg
            //   https://images.stopgame.ru/articles/2018/08/28/death_s_gambit_review_igry-1535467258.jpg
            // https://images.stopgame.ru/uploads/images/386005/form/2018/03/13/normal_1520890359.jpg
            //   https://images.stopgame.ru/uploads/images/386005/form/2018/03/13/1520890359.jpg
            return src
                .replace(/(\/articles\/[0-9]+\/[0-9]+\/[0-9]+\/)c[0-9]+x[0-9]+\/[0-9a-zA-Z]+\/([^/]*)$/, "$1$2")
                .replace(/(\/articles\/[0-9]+\/[0-9]+\/[0-9]+\/[^/]*-[0-9]+)-s(\.[^/.]*)$/, "$1$2")
                .replace(/(\/uploads\/images\/[0-9]+\/[a-z]+\/[0-9]+\/[0-9]+\/[0-9]+\/)[a-z]+_([0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "pure-nude-celebs.com") {
            // http://www.pure-nude-celebs.com/celebsextape/felicity-jones/pic-felicity-jones-011.jpg
            //   http://www.pure-nude-celebs.com/celebsextape/felicity-jones/felicity-jones-011.jpg
            return src.replace(/\/pic-([^/]*)$/, "/$1");
        }

        if (domain_nowww === "pincelebs.net") {
            // https://www.pincelebs.net/thumbs/3/5/6/356e393056c304cf357fa6f81bd00943.jpg
            //   https://www.pincelebs.net/images/3/5/6/356e393056c304cf357fa6f81bd00943.jpg
            return src.replace(/\/thumbs(\/(?:[0-9a-f]\/){3}[0-9a-f]+\.[^/.]*)$/, "/images$1");
        }

        if (domain === "img.new2005.com") {
            // https://img.new2005.com/Article/20170114/97b85523ee6063831376bf1a15c5c8c0.jpeg_old -- 400x601, blurred
            //   https://img.new2005.com/Article/20170114/97b85523ee6063831376bf1a15c5c8c0.jpeg -- 640x961
            return src.replace(/(\/[0-9a-f]+\.[^/._]+)_old(?:[?#].*)?$/, "$1");
        }

        if (domain === "s.libertaddigital.com") {
            // https://s.libertaddigital.com/2016/12/19/1280/720/fit/gq.jpg -- 480x720
            //   https://s.libertaddigital.com/2016/12/19/gq.jpg -- 900x1350
            // https://s.libertaddigital.com/fotos/galerias/culos-famosas/244/0/eva-mendes.jpg
            //   https://s.libertaddigital.com/fotos/galerias/culos-famosas/eva-mendes.jpg
            // https://s.libertaddigital.com/fotos/noticias/375/225/pedro-sanchez-microfonos-1.jpg
            //   https://s.libertaddigital.com/fotos/noticias/pedro-sanchez-microfonos-1.jpg
            return src
                .replace(/(:\/\/[^/]*\/[0-9]+\/[0-9]+\/[0-9]+\/)[0-9]+\/[0-9]+\/fit\/([^/]*)$/, "$1$2")
                .replace(/(\/fotos\/(?:galerias\/[^/]*\/|[a-z]+\/))[0-9]+\/[0-9]+\/([^/]*)$/, "$1$2");
        }

        if (domain_nowww === "imgstudio.org" ||
            // https://imgadult.com/upload/small/2017/10/26/59f205b06c988.jpg
            //   https://imgadult.com/upload/big/2017/10/26/59f205b06c988.jpg
            // https://imgadult.com/upload/small-medium/2017/10/26/59f205b06c988.jpg
            //   https://imgadult.com/upload/big/2017/10/26/59f205b06c988.jpg
            domain_nowww === "imgadult.com" ||
            // http://imgcredit.xyz/upload/small/2017/07/25/5976cb96e01db.jpg
            //   http://imgcredit.xyz/upload/big/2017/07/25/5976cb96e01db.jpg
            // http://sr85.imgcredit.xyz/upload/small/2017/07/26/5978364c3cade.jpg
            //   http://sr85.imgcredit.xyz/upload/big/2017/07/26/5978364c3cade.jpg
            domain_nosub === "imgcredit.xyz") {
            // http://imgstudio.org/upload/small/2017/05/13/59170f8f9877a.jpg
            //   http://imgstudio.org/upload/big/2017/05/13/59170f8f9877a.jpg
            return src.replace(/\/upload\/[-a-z]+\//, "/upload/big/");
        }

        if (domain_nowww === "imgwallet.com" ||
            // https://imgdrive.net/images/small-medium/2018/08/09/5b6c2958dc37e.jpg
            //   https://imgdrive.net/images/big/2018/08/09/5b6c2958dc37e.jpg
            // https://imgdrive.net/images/small/2016/04/11/570b6d6587b1e.jpg
            //   https://imgdrive.net/images/big/2016/04/11/570b6d6587b1e.jpg
            domain_nowww === "imgdrive.net" ||
            // https://imgtaxi.com/images/small-medium/2018/08/09/5b6c293ee9fb6.jpg
            //   https://imgtaxi.com/images/big/2018/08/09/5b6c293ee9fb6.jpg
            domain_nowww === "imgtaxi.com") {
            // https://imgwallet.com/images/small-medium/2018/08/09/5b6baf82cecf8.jpg
            //   https://imgwallet.com/images/big/2018/08/09/5b6baf82cecf8.jpg
            return src.replace(/\/images\/[-a-z]+\//, "/images/big/");
            //return src.replace(/(:\/\/[^/]*\/)images\/[a-z]+\//, "$1images/big/");
        }

        if (domain === "img.depo.ua") {
            // https://img.depo.ua/745xX/Oct2017/309002.jpg -- stretched
            //   https://img.depo.ua/original/Oct2017/309002.jpg
            return src.replace(/(:\/\/[^/]*\/)[0-9X]+x[0-9X]+\//, "$1original/");
        }

        if (domain_nowww === "elfagr.com" &&
            src.indexOf("/upload/photo/") >= 0) {
            // http://www.elfagr.com/upload/photo/news/312/4/100x56o/85.jpg?q=2
            //   http://www.elfagr.com/upload/photo/news/312/4/200x113o/85.jpg?q=2
            //   http://www.elfagr.com/upload/photo/news/312/4/85.jpg?q=2
            return src.replace(/\/[0-9]+x[0-9]+[a-z]?\/([^/]*)(?:[?#].*)?$/, "/$1");
        }

        if (domain_nowww === "cdnimpuls.com") {
            // https://cdnimpuls.com/www.tej.al/media3/-400-229-5af07701ee93a.png
            //   https://cdnimpuls.com/www.tej.al/media3/5af07701ee93a.png
            // https://cdnimpuls.com/v.xing.al/media3/-640-0-5b4c84a8d02f1.png
            //   https://cdnimpuls.com/v.xing.al/media3/5b4c84a8d02f1.png
            // https://cdnimpuls.com/o.anabel.al/media/-200-0-14165474411416509206938_image_galleryimage_santa_monica_ca_october_2.jpg
            //   https://cdnimpuls.com/o.anabel.al/media/14165474411416509206938_image_galleryimage_santa_monica_ca_october_2.jpg
            return src.replace(/\/-[0-9]+-[0-9]+-([0-9a-f]+(?:_[^/]*)?\.[^/.]*)$/, "/$1");
        }

        if (domain_nowww === "mshreqnews.net") {
            // http://mshreqnews.net/img/2000x506/CsiPl.jpg -- stretched
            //   http://mshreqnews.net/img/CsiPl.jpg
            return src.replace(/\/img\/[0-9]+x[0-9]+\/([^/]*)$/, "/img/$1");
        }

        if (domain_nowww === "choisirunfilm.fr") {
            // http://www.choisirunfilm.fr/persons/small/148328.jpg
            //   http://www.choisirunfilm.fr/persons/148328.jpg
            return src.replace(/\/persons\/small\/([0-9]+\.[^/.]*)$/, "/persons/$1");
        }

        if (domain_nowww === "gazetaexpress.com") {
            // https://www.gazetaexpress.com/public/uploads/image/2017/09/145x80/ririiiii_1505314458-884629.jpg
            //   https://www.gazetaexpress.com/public/uploads/image/2017/09/ririiiii_1505314458-884629.jpg -- 2691x1725
            return src.replace(/(\/public\/uploads\/image\/[0-9]+\/[0-9]+\/)[0-9]+x[0-9]+\/([^/]*)$/, "$1$2")
        }

        if (domain_nowww === "haynews.am") {
            // http://haynews.am/thumbs/150x/aE17BTVGoGcf21pQ7SnFc7wPNI.jpg
            //   http://haynews.am/images/aE17BTVGoGcf21pQ7SnFc7wPNI.jpg
            return src.replace(/\/thumbs\/[0-9]+x(?:[0-9]+)?\//, "/images/");
        }

        if (domain_nowww === "emlakkulisi.com") {
            // https://emlakkulisi.com/resim/thumb/ODc3OTI5MT-rihanna-cannesda-villa-aldi.jpg
            //   https://emlakkulisi.com/resim/orjinal/ODc3OTI5MT-rihanna-cannesda-villa-aldi.jpg
            return src.replace(/\/resim\/[a-z]+\//, "/resim/orjinal/");
        }

        if (domain_nowww === "aquarellefm.md" && src.indexOf("/storage/") >= 0) {
            // http://www.aquarellefm.md/storage/2018/08/01/1533131537_62137400_Fit_340x1000.jpg
            //   http://www.aquarellefm.md/storage/2018/08/01/1533131537_62137400.jpg
            return src.replace(/_Fit_[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "joy.hu" ||
            // https://static.marquardmedia.hu/data/cikk/232/232566-rihanna-enekesno.775x400.jpg
            //   https://static.marquardmedia.hu/data/cikk/232/232566.jpg
            domain === "static.marquardmedia.hu") {
            // https://www.joy.hu/data/cikk/211/211260.340.jpg
            //   https://www.joy.hu/data/cikk/211/211260.jpg
            // https://www.joy.hu/data/cikk/232/232566-rihanna-enekesno.775x400.jpg
            //   https://www.joy.hu/data/cikk/232/232566.jpg
            // https://www.joy.hu/data/cgaleria/151/151339.340.jpg
            //   https://www.joy.hu/data/cgaleria/151/151339.jpg
            // doesn't work for all:
            // https://www.joy.hu/data/star/0/4.200.jpg
            return src.replace(/(\/data\/[^/]*\/[0-9]+\/[0-9]+)(?:-[^/.]*)?\.[0-9]+(?:x[0-9]+)?(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "ivoirematin.com") {
            // http://www.ivoirematin.com/content/news/images/01-2018/fb_bac6ce231671b57ea3d297719f4992f1a1423b52.jpg
            //   http://www.ivoirematin.com/content/news/images/01-2018/bac6ce231671b57ea3d297719f4992f1a1423b52.jpg
            return src.replace(/(\/images\/[0-9]+-[0-9]+\/)fb_([0-9a-f]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "img.theqoo.net") {
            // http://img.theqoo.net/proxy.php?url=i.imgur.com/z4DWTpG.jpg
            //   http://i.imgur.com/z4DWTpG.jpg
            // http://img.theqoo.net/proxy/http://i.imgur.com/z4DWTpG.jpg
            //   http://i.imgur.com/z4DWTpG.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/proxy\.php.*?[?&]url=([^&]*).*?$/, "$1");

            if (newsrc === src) {
                newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/proxy\/(.*)$/, "$1");
            }

            if (newsrc !== src) {
                if (!newsrc.match(/^[a-z]+:\/\//))
                    newsrc = "http://" + newsrc;
                return newsrc;
            }
        }

        if (domain_nowww === "gpslifetime.com.br" && src.indexOf("/uploads/") >= 0) {
            // https://gpslifetime.com.br/uploads/content_manager/contents/48833/image/thumbs/marca-de-rihanna-faz-seu-debut-no-new-york-fashion-week-ba66.jpg
            //   https://gpslifetime.com.br/uploads/content_manager/contents/48833/image/marca-de-rihanna-faz-seu-debut-no-new-york-fashion-week-ba66.jpg
            return src.replace(/\/image\/thumbs\//, "/image/");
        }

        if (domain_nowww === "lasillarota.com" ||
            domain === "lasillarotarm.blob.core.windows.net.optimalcdn.com" ||
            // https://info7rm.blob.core.windows.net.optimalcdn.com/images/2018/02/22/ria-focus-0-0-600-315.jpg
            //   https://lasillarotarm.blob.core.windows.net.optimalcdn.com/images/2018/03/15/snapchatenproblemasporlanzarcampanadeviolenciacontrarihanna.jpg
            domain === "info7rm.blob.core.windows.net.optimalcdn.com") {
            // https://lasillarota.com/images/tnfocus/0/0/480/345/2018/03/15/snapchatenproblemasporlanzarcampanadeviolenciacontrarihanna.jpg
            //   https://lasillarotarm.blob.core.windows.net.optimalcdn.com/images/2018/03/15/snapchatenproblemasporlanzarcampanadeviolenciacontrarihanna.jpg
            // https://lasillarotarm.blob.core.windows.net.optimalcdn.com/images/2018/03/15/snapchatenproblemasporlanzarcampanadeviolenciacontrarihanna-focus-0-0-480-345.jpg
            //   https://lasillarotarm.blob.core.windows.net.optimalcdn.com/images/2018/03/15/snapchatenproblemasporlanzarcampanadeviolenciacontrarihanna.jpg
            //return src.replace(/\/images\/tnfocus\/(?:[0-9]+\/){4}([0-9]+\/[0-9]+\/[0-9]+\/[^/]*)$/, "/images/$1"); -- doesn't work
            return src
                .replace(/:\/\/[^/]*lasillarota\.com\/images\/tnfocus\/(?:[0-9]+\/){4}([0-9]+\/[0-9]+\/[0-9]+\/[^/]*)$/, "://lasillarotarm.blob.core.windows.net.optimalcdn.com/images/$1")
                .replace(/(\/images\/[0-9]+\/[0-9]+\/[0-9]+\/[^/]*)-focus(?:-[0-9]+){4}(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "znaj.ua") {
            // https://znaj.ua/crops/aef15f/620x0/1/0/2017/11/47/rihanna.jpg
            //   https://znaj.ua/images/2017/11/47/rihanna.jpg
            return src.replace(/\/crops\/[a-z0-9]+\/[0-9]+x[0-9]+\/[0-9]+\/[0-9]+\/([0-9]+\/[0-9]+\/[0-9]+\/[^/]*)$/, "/images/$1");
        }

        if (domain_nowww === "raragente.com.br") {
            // http://www.raragente.com.br/imagem/noticia/750/4000/333660_170663_44226.jpg
            //   http://www.raragente.com.br/images/materias/333660_170663_44226.jpg -- doesn't seem to do anything
            return src.replace(/\/imagem\/noticia\/[0-9]+\/[0-9]+\//, "/images/materias/");
        }

        if (domain_nowww === "pastefs.com") {
            // http://www.pastefs.com/resource/preview/65/0/d5f142aaae66f7df532ae11fa85bac51/amy-acker-fashion-1-dvdbash-6.jpg -- 1200x1506
            //   http://www.pastefs.com/resource/files/65/0/d5f142aaae66f7df532ae11fa85bac51/amy-acker-fashion-1-dvdbash-6.jpg -- 1500x1882
            // {files, download}, preview, thumb
            return src.replace(/\/resource\/[a-z]+\//, "/resource/files/");
        }

        if (domain_nowww === "sigmalive.com") {
            // http://www.sigmalive.com/application/cache/default/images/news/900x450/rihannaFDDSFDFSDFS.jpg
            //   http://www.sigmalive.com/uploads/images/news/rihannaFDDSFDFSDFS.jpg
            return src.replace(/\/application\/cache\/[^/]*\/(images\/[^/]*\/)[0-9]+x[0-9]+\//, "/uploads/$1");
        }

        if (domain_nowww === "luna.ovh") {
            // https://www.luna.ovh/imgw/450px/Christian_Serratos_by_Gage_Skidmore.jpg
            //   https://www.luna.ovh/imgw/Christian_Serratos_by_Gage_Skidmore.jpg
            return src.replace(/\/imgw\/[0-9]+px\//, "/imgw/");
        }

        if (domain_nowww === "shalala.ru") {
            // http://shalala.ru/upload/artists/19149/medium/5916281_7531137.jpg
            //   http://shalala.ru/upload/artists/19149/5916281_7531137.jpg
            return src.replace(/(\/upload\/artists\/[0-9]+\/)[a-z]+\/([0-9]+_[0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "fay3.com") {
            // https://www.fay3.com/assets/uploads/images_thumbs/45HT7t3V.jpg?1403510896 -- 800x987
            //   https://www.fay3.com/assets/uploads/images/45HT7t3V.jpg?1403510896 -- 961x1186
            // https://www.fay3.com/assets/uploads/thumbs/2z43ucFA.jpg?1403520485
            //   https://www.fay3.com/assets/uploads/images/2z43ucFA.jpg?1403520485
            return src.replace(/\/assets\/uploads\/(?:images_)?thumbs\//, "/assets/uploads/images/");
        }

        if (domain_nowww === "vijesti.ba") {
            // https://vijesti.ba/storage/2016/03/12/thumbs/56e45307-12bc-497f-b9d9-21210a0a0a80-lopez-haljina-1-previewOrg.jpg
            //   https://vijesti.ba/storage/2016/03/12/56e45307-12bc-497f-b9d9-21210a0a0a80-lopez-haljina-1.jpg
            return src.replace(/(\/storage\/[0-9]+\/[0-9]+\/[0-9]+\/)thumbs\/([^/]*)-previewOrg(\.[^/.]*)$/, "$1$2$3");
        }

        if (domain === "m.smedata.sk") {
            // https://m.smedata.sk/api-media/media/image/sme/3/15/153563/153563_1000x.jpg?rev=1
            //   https://m.smedata.sk/api-media/media/image/sme/3/15/153563/153563.jpg?rev=1
            return src.replace(/(\/api-media\/media\/image\/.*)_[0-9]+x(\.[^/.]*)$/, "$1$2");
        }

        if ((domain_nosub === "diariolibre.com" && domain.match(/estatico[0-9]*\.diariolibre\.com/)) ||
            // https://www.canarias7.es/binrepository/300x169/0c0/0d0/none/11314/SDSB/1524696124-leslie-grace-colabora-con_4109175_20181011193330.jpg
            //   https://www.canarias7.es/binrepository/1524696124-leslie-grace-colabora-con_4109175_20181011193330.jpg
            domain_nowww === "canarias7.es") {
            // https://estatico2.diariolibre.com/binrepository/400x300/0c0/0d0/none/10904/QQUT/image_content_10068843_20180531145201.jpg
            //   https://estatico2.diariolibre.com/binrepository/image_content_10068843_20180531145201.jpg
            return src.replace(/\/binrepository\/[0-9]+x[0-9]+\/.*(\/[^/]*)(?:[?#].*)?$/, "/binrepository$1");
        }

        if (domain_nowww === "modelisto.com") {
            // https://modelisto.com/photoshoot/enji-night-model-75610@180.jpg
            //   https://modelisto.com/photoshoot/enji-night-model-75610.jpg
            return src.replace(/(-[0-9]+)@[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "media.kg-portal.ru") {
            // https://media.kg-portal.ru/games/s/supermariobros/cosplay/supermariobros_3t.jpg
            //   https://media.kg-portal.ru/games/s/supermariobros/cosplay/supermariobros_3.jpg
            return src.replace(/t(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "desktopwallpaperhd.net") {
            // http://www.desktopwallpaperhd.net/thumbs/1/a/anime-wallpaper-17258.jpg
            //   http://www.desktopwallpaperhd.net/wallpapers/1/a/anime-wallpaper-17258.jpg
            return src.replace(/(:\/\/[^/]*\/)thumbs\//, "$1wallpapers/");
        }

        if (domain_nowww === "wallpaperplay.com") {
            // https://wallpaperplay.com/walls/small-retina/b/5/f/43064.jpg
            //   https://wallpaperplay.com/walls/full/b/5/f/43064.jpg
            return src.replace(/\/walls\/[^/]*\//, "/walls/full/");
        }

        if (domain_nosub === "pics.vc" &&
            domain.match(/^s[0-9]*\./)) {
            // http://s4.pics.vc/pics/s/369/7ed/eb1/39d/3697edeb139df8076edb3390ad8f91c4.jpg -- 300x449
            //   http://s4.pics.vc/pics/n/369/7ed/eb1/39d/3697edeb139df8076edb3390ad8f91c4.jpg -- 800x1199
            //   http://s4.pics.vc/pics/o/369/7ed/eb1/39d/3697edeb139df8076edb3390ad8f91c4.jpg -- 2815x4220
            return src.replace(/(:\/\/[^/]*\/pics\/)[a-z]\//, "$1o/");
        }

        if ((domain_nosub === "imageshack.us" ||
             domain_nosub === "imageshack.com") &&
            domain.match(/^imagizer/)) {
            // http://imagizer-cv.imageshack.us/v2/0x500q90/922/2inlKT.jpg
            //   http://imagizer-cv.imageshack.us/v2/x/922/2inlKT.jpg
            // https://imagizer.imageshack.com/v2/1280x0q90/922/2inlKT.jpg
            //   https://imagizer.imageshack.com/v2/x/922/2inlKT.jpg
            return src.replace(/(:\/\/[^/]*\/v2\/)[^/]*\//, "$1x/");
        }

        if (domain_nowww === "girlofthehour.com") {
            // http://girlofthehour.com/IMG/poster_resized/AJE004x005.jpg
            //   http://girlofthehour.com/IMG/poster/AJE004x005.jpg
            return src.replace(/\/IMG\/poster_resized\//, "/IMG/poster/");
        }

        if (domain === "hwcdn.ddstatic.com") {
            // http://hwcdn.ddstatic.com/bp-content/tour/tour_photos/2013_04_30/11481/bree_daniels_11481_13-gal-150-jpg/0008.jpg
            //   http://hwcdn.ddstatic.com/bp-content/tour/tour_photos/2013_04_30/11481/bree_daniels_11481_13-gal-1600-jpg/0008.jpg
            // http://hwcdn.ddstatic.com/bp-content/fhg/fhg_desktops/2010_11_desk/gal-1680-jpg/0005.jpg
            regex = /(-gal-)[0-9]+(-[a-z]+\/[^/]*)$/;
            return [
                src.replace(regex, "$11600$2"),
                src.replace(regex, "$11024$2")
            ];
        }

        if (domain === "img.sexpornpages.com") {
            // https://img.sexpornpages.com/converted/th/images01/image-169705.jpg
            //   https://img.sexpornpages.com/images01/image-169705.jpg
            return src.replace(/\/converted\/[a-z]+\/(images[0-9]*\/image-[0-9]+\.[^/.]*)$/, "/$1");
        }

        if (domain_nosub === "taopic.com" &&
            domain.match(/^pic[0-9]*\./)) {
            // http://pic01.taopic.com/180402/235105-1P4020Q04920-lp.jpg
            //   http://img01.taopic.com/180402/235105-1P4020Q04920.jpg
            return src.replace(/:\/\/pic([0-9]*\.[^/]*\/[0-9]+\/[0-9]+-[A-Z0-9]+)-[a-z]+(\.[^/.]*)$/,
                               "://img$1$2");
        }

        if (domain === "static.hdw.eweb4.com" &&
            options && options.cb && options.do_request) {
            // http://static.hdw.eweb4.com/media/thumbs/1/111/1104264.jpg
            //   http://hdw.eweb4.com/out/1104264.html
            //   http://static.hdw.eweb4.com/media/wallpapers_dl/1/111/1104264-mandy-moore.jpg
            //return src.replace(/\/media\/[^/]*\//, "/media/wallpapers_dl/");
            var id = src.replace(/.*\/media\/thumbs\/.*\/([0-9]+)\.[^/.]*$/, "$1");
            if (id !== src) {
                options.do_request({
                    url: "http://hdw.eweb4.com/out/" + id + ".html",
                    method: "GET",
                    onload: function(resp) {
                        if (resp.readyState === 4) {
                            var match = resp.responseText.match(/<meta *property="og:image" *content="([^"]*)"/);
                            if (match) {
                                options.cb(match[1]);
                            } else {
                                options.cb(null);
                            }
                        }
                    }
                });

                return {
                    waiting: true
                };
            }
        }

        if (domain_nowww === "wallpaperbackgrounds.com") {
            // http://wallpaperbackgrounds.com/Content/wallpapers/celebrity/mandy%20moore/thumb-108169-16695.jpg
            //   http://wallpaperbackgrounds.com/Content/wallpapers/celebrity/mandy%20moore/108169-16695.jpg
            return src.replace(/(\/Content\/wallpapers\/.*\/)thumb-([0-9]+-[0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "img.barelist.com") {
            // http://img.barelist.com/images/hosted/tgp/halle-von-051415/thumbs/Halle-Von-gives-a-sloppy-blowjob-in-the-kitchen-1.jpg
            //   http://img.barelist.com/images/hosted/tgp/halle-von-051415/pics/halle-von-gives-a-sloppy-blowjob-in-the-kitchen-1.jpg
            return src.replace(/(\/images\/hosted\/[^/]*\/[^/]*\/)thumbs\//, "$1pics/");
        }

        if (domain === "proxy.imgsmail.ru") {
            // https://proxy.imgsmail.ru/?h=muij44Zj9u9YAKrdkDnkBQ&e=1358400352&url717=s018.radikal.ru/i521/1301/32/a24fb200297f.jpg
            //   http://s018.radikal.ru/i521/1301/32/a24fb200297f.jpg
            return add_http(decodeURIComponent(src.replace(/^[a-z]+:\/\/[^/]*\/.*?[?&]url[0-9]*=([^&]*).*?$/, "$1")));
        }

        if (domain_nowww === "pornoonline.com.pl") {
            // http://www.pornoonline.com.pl/images/galerie/1849/small/small_4fdccc9ca7074.jpg
            //   http://www.pornoonline.com.pl/images/galerie/1849/4fdccc9ca7074.jpg
            return src.replace(/(\/images\/galerie\/[0-9]+\/)[a-z]+\/[a-z]+_([0-9a-f]+\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "photo-erotique.org") {
            // http://photo-erotique.org/girls/1378403247/thumb_3.jpg
            //   http://photo-erotique.org/girls/1378403247/3.jpg
            return src.replace(/(\/girls\/[0-9]+\/)thumb_([0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "s.mediasole.ru") {
            // https://s.mediasole.ru/cache/preview/data/images/90/90939/237305_1000.jpg
            //   https://mediasole.ru/data/images/90/90939/237305_1000.jpg
            return src.replace(/:\/\/[^/]*\/cache\/preview\/data\//, "://mediasole.ru/data/");
        }

        if (domain_nosub === "godsartnudes.com" &&
            domain.match(/^pics[0-9]*\./)) {
            // http://pics16.godsartnudes.com/4/3/2/3/bree-daniels-spreads-her-thighs-show-you-where-she-needs-attention--desire-digital-33091_4.jpg -- 110x150
            //   http://pics16.godsartnudes.com/4/3/2/3/bree-daniels-spreads-her-thighs-show-you-where-she-needs-attention--desire-digital-33091_4_thumb.jpg -- 198x281
            //   http://pics16.godsartnudes.com/4/3/2/3/bree-daniels-spreads-her-thighs-show-you-where-she-needs-attention--desire-digital-33091_4_big.jpg -- 638x1024
            return src.replace(/(-[0-9]+_[0-9]+)(?:_[a-z]+)?(\.[^/.]*)$/, "$1_big$2");
        }

        if (domain_nowww === "gotgalleries.com") {
            // http://www.gotgalleries.com/pics/digitaldesire/61/bree-daniels-sexy-lith13.jpg
            //   http://www.gotgalleries.com/pics/digitaldesire/61/bree-daniels-sexy-li13.jpg
            return src.replace(/th([0-9]*\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "perfectnaked.com" && src.indexOf("/galleries/") >= 0) {
            // http://www.perfectnaked.com/galleries/bree-daniels-teasing-in-her-cute-pink-panties/3_tn.jpg
            //   http://www.perfectnaked.com/galleries/bree-daniels-teasing-in-her-cute-pink-panties/3_big.jpg
            return src.replace(/(\/[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1_big$2");
        }

        if (domain === "cdn.eroticbeauties.net") {
            // https://cdn.eroticbeauties.net/content/digital-desire-bree-daniels-11136-1/auto/3/tn@1x/04.jpg
            //   https://cdn.eroticbeauties.net/content/digital-desire-bree-daniels-11136-1/full/04.jpg
            return src.replace(/(\/content\/[^/]*\/)[^/]*\/[^/]*\/tn@[^/]*\/([0-9]+\.[^/.]*)$/, "$1full/$2");
        }

        if (domain_nowww === "barahla.net") {
            // https://www.barahla.net/images/photo/2/20141209/5780838/141812085383385200.jpg
            //   https://www.barahla.net/images/photo/2/20141209/5780838/big/141812085383385200_big.jpg
            return src.replace(/(\/images\/photo\/[0-9]+\/[0-9]+\/[0-9]+\/)(?:[a-z]+\/)?([0-9]+)(?:_[a-z]+)?(\.[^/.]*)$/, "$1big/$2_big$3");
        }

        if (domain === "i.pipec.info") {
            // http://i.pipec.info/20180906/600px/53776596847438_mos_02.jpg
            //   http://i.pipec.info/20180906/600px/53776596847438_mos_02.jpg
            return src.replace(/\/[0-9]+px\/([^/]*)$/, "/$1");
        }

        if (domain_nosub === "hothag.com" && domain.match(/^cdn[0-9]*\./)) {
            // https://cdn1.hothag.com/media/galleries_160/1/1/755/24856.jpg
            //   https://cdn1.hothag.com/media/galleries/1/1/755/24856.jpg
            return src.replace(/\/media\/galleries_[0-9]+\//, "/media/galleries/");
        }

        if ((domain_nosub === "1zoom.ru" ||
             // http://s1.1zoom.me/big0/733/363283-sepik.jpg
             //   http://s1.1zoom.me/big3/733/363283-sepik.jpg
             domain_nosub === "1zoom.me") &&
            domain.match(/^s[0-9]*\./)) {
            // https://s1.1zoom.ru/big0/639/363168-commander06.jpg -- 1280x800
            //   https://s1.1zoom.ru/big3/639/363168-commander06.jpg -- 3000x1875
            // https://s1.1zoom.ru/b5050/363168-commander06_300x188.jpg -- 300x188
            return src.replace(/(:\/\/[^/]*\/)big[0-9]*\//, "$1big3/");
        }

        if (domain === "st-gdefon.gallery.world" ||
            // http://st.gde-fon.com/wallpapers_medium/413849_devushka_nagota_dlinnye-volosy_cvety_1680x1050_www.Gde-Fon.com.jpg
            //   http://st.gde-fon.com/wallpapers_original/413849_devushka_nagota_dlinnye-volosy_cvety_1680x1050_www.Gde-Fon.com.jpg
            domain === "st.gde-fon.com") {
            // http://st-gdefon.gallery.world/wallpapers_medium/780527_gallery.world.jpg
            //   http://st-gdefon.gallery.world/wallpapers_original/780527_gallery.world.jpg
            return src.replace(/\/wallpapers_[a-z]+(\/[0-9]+_[^/]*)$/, "/wallpapers_original$1");
        }

        if (domain_nowww === "boorp.com") {
            // https://www.boorp.com/sfondi_gratis_desktop_pc/sfondi_gratis/sfondi_anime_manga/miniature/anime_manga_libro_dei_sogni.jpg
            //   https://www.boorp.com/sfondi_gratis_desktop_pc/sfondi_gratis/sfondi_anime_manga/anime_manga_libro_dei_sogni.jpg
            return src.replace(/\/miniature(\/[^/]*)$/, "$1");
        }

        if (domain === "d2pptc4exyus09.cloudfront.net") {
            // https://d2pptc4exyus09.cloudfront.net/puzzle/128/127/thumb.jpg
            //   https://d2pptc4exyus09.cloudfront.net/puzzle/128/127/original.jpg
            return src.replace(/(\/puzzle\/[0-9]+\/[0-9]+\/)[a-z]+(\.[^/.]*)$/, "$1original$2");
        }

        if (domain_nowww === "sfondo.info") {
            // https://sfondo.info/i/small/4/c/1/13408.jpg
            //   https://sfondo.info/i/original/4/c/1/13408.jpg
            return src.replace(/\/i\/[a-z]+\//, "/i/original/");
        }

        if (domain_nosub === "yiihuu.com" &&
            domain.match(/^img[0-9]*\./)) {
            // http://img4.yiihuu.com/130X130/upimg/courses/2016/04/19/1-1461055933-335054.jpg?auto=h
            //   http://img4.yiihuu.com/upimg/courses/2016/04/19/1-1461055933-335054.jpg
            return src
                .replace(/\/[0-9]+X[0-9]+\/upimg\//, "/upimg/")
                .replace(/\?.*/, "");
        }

        if (domain_nowww === "superwall.us") {
            // https://superwall.us/thumbnail/redjuice_pointy_ears_girl_blue_eyes_male-rABC.jpg
            //   https://superwall.us/wallpaper/redjuice_pointy_ears_girl_blue_eyes_male-rABC.jpg
            return src.replace(/(:\/\/[^/]*\/)thumbnail\//, "$1wallpaper/");
        }

        if (domain_nosub === "mangadrawing.net") {
            // http://mangadrawing.net/users/imagecache/display/image/19418-belt-black-hair-blonde-hair-blue-eyes-gloves.c40921ef095eaadb0bb668a193b1da3b.jpg
            //   http://mangadrawing.net/users/image/19418-belt-black-hair-blonde-hair-blue-eyes-gloves.c40921ef095eaadb0bb668a193b1da3b.jpg
            // http://static.mangadrawing.net/users/imagecache/display/image/19418-belt-black-hair-blonde-hair-blue-eyes-gloves.c40921ef095eaadb0bb668a193b1da3b.jpg
            //   http://static.mangadrawing.net/users/image/19418-belt-black-hair-blonde-hair-blue-eyes-gloves.c40921ef095eaadb0bb668a193b1da3b.jpg
            return src.replace(/\/imagecache\/display\/image\//, "/image/");
        }

        if (domain_nosub === "ucoz.ru") {
            // http://nadinaderose.ucoz.ru/_ph/37/1/660567815.jpg?1535302566
            //   http://nadinaderose.ucoz.ru/_ph/37/660567815.jpg?1535302566
            return src.replace(/(\/_ph\/[0-9]+\/)[0-9]+\/([0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "wallpapersdig.com") {
            // http://wallpapersdig.com/images/thumb/category/100x100/wolf-wallpaper-white-girl-soldier-anime-images-4k-full-hd-iphone-143018.jpg
            //    http://wallpapersdig.com/images/original/wolf-wallpaper-white-girl-soldier-anime-images-4k-full-hd-iphone-143018.jpg
            return src.replace(/\/images\/[a-z]+(?:\/.*)?(\/[^/]*-[0-9]+\.[^/.]*)$/, "/images/original$1");
        }

        if (domain === "img.hebus.com") {
            // https://img.hebus.com/hebus_2011/11/21/preview/111121161002_92.jpg
            //   https://img.hebus.com/hebus_2011/11/21/111121161002_92.jpg
            // https://img.hebus.com/hebus_2013/09/26/tn/b1380199789_87580.jpg
            //   https://img.hebus.com/hebus_2013/09/26/1380199789_87580.jpg
            return src.replace(/\/[a-z]+\/[a-z]?([0-9]+_[0-9]+\.[^/.]*)$/, "/$1");
        }

        if (domain === "content.eroo.pl") {
            // http://content.eroo.pl/87HpR8ufu8RBvC69xz15QM7885u4yUkG/2_mini.jpg
            //   http://content.eroo.pl/87HpR8ufu8RBvC69xz15QM7885u4yUkG/2.jpg
            return src.replace(/(\/[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "timdir.com") {
            // http://timdir.com/ws/bree_daniels_babe_purple_top/bree_daniels_07.tn.jpg
            //   http://timdir.com/ws/bree_daniels_babe_purple_top/bree_daniels_07.jpg
            return src.replace(/\.tn(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "live-stats.me") {
            // https://live-stats.me/pics/thumbs/104/372/12.jpg
            //   https://live-stats.me/pics/images/104/372/12.jpg
            return src.replace(/\/pics\/thumbs\//, "/pics/images/");
        }

        if (domain === "cdn.xpics.me" ||
            // http://cdn.pussy-porn-pics.com/2/231/115601/5.jpg
            //   http://cdn.pussy-porn-pics.com/0/231/115601/5.jpg
            domain === "cdn.pussy-porn-pics.com") {
            // https://cdn.xpics.me/2/231/115601/8.jpg
            //   https://cdn.xpics.me/0/231/115601/8.jpg
            return src.replace(/(:\/\/[^/]*\/)[0-9]\//, "$10/");
        }

        if (domain_nowww === "nehuha.net" && src.indexOf("/data/photo/") >= 0) {
            // http://nehuha.net/data/photo/photo_0/bree_daniels_krasivaya_erotika_736/thumb.photo_1.jpg -- stretched
            //   http://nehuha.net/data/photo/photo_0/bree_daniels_krasivaya_erotika_736/photo_1.jpg
            return src.replace(/\/thumb\.([^/]*)$/, "/$1")
        }

        if (domain_nowww === "pornrice.com") {
            // https://pornrice.com/media/thumbs/5/6/3/c/a/563ca27211a80/236x355/10236.jpg
            //   https://pornrice.com/media/galleries/5/6/3/c/a/563ca27211a80/10236.jpg
            return src.replace(/\/media\/thumbs\/((?:[0-9a-f]\/){5}[0-9a-f]+\/)[0-9]+x[0-9]+\//, "/media/galleries/$1");
        }

        if (domain === "wallpapers.jami.lt") {
            // http://wallpapers.jami.lt/wallpapers/Celebrities/Mandy-Moore/Mandy-Moore-37_big.jpg
            //   http://wallpapers.jami.lt/wallpapers/Celebrities/Mandy-Moore/Mandy-Moore-37.jpg
            return src.replace(/_big(\.[^/.]*)$/, "$1");
        }

        if (domain === "y.yarn.co") {
            // https://y.yarn.co/0660ad5b-af07-4955-b979-4819b385ae57_thumb.jpg -- 273x114
            //   https://y.yarn.co/0660ad5b-af07-4955-b979-4819b385ae57_screenshot.jpg -- 1142x480
            return src.replace(/(:\/\/[^/]*\/[-0-9a-f]+)_thumb(\.[^/.]*)$/,
                               "$1_screenshot$2");
        }

        if (domain === "images.genius.com") {
            // https://images.genius.com/avatars/small/74258e95c84bfe31cfa588c5d6900e42
            //   https://images.genius.com/avatars/original/74258e95c84bfe31cfa588c5d6900e42
            return src.replace(/\/avatars\/[a-z]+\/([0-9a-f]+)(?:[?#].*)?$/, "/avatars/original/$1");
        }

        if (domain_nosub === "smcloud.net" &&
            domain.match(/^cdn[0-9]*\.thumbs\.common\./)) {
            // http://cdn4.thumbs.common.smcloud.net/common/R/U/s/RU2317200DQNu.jpg/ru-0-ra-104,104-n-RU2317200DQNu_human_behaviour.jpg
            //   http://static.common.smcloud.net/s/RU2317200DQNu.jpg
            return src.replace(/:\/\/[^/]*\/common\/.\/.\/s\/([^/]*\.[^/.]*)\/.*/, "://static.common.smcloud.net/s/$1");
        }

        if (domain_nowww === "recordeli.com") {
            // https://recordeli.com/items/1566/image_small
            //   https://recordeli.com/items/1566/image_big
            return src.replace(/(\/items\/[0-9]+\/image_)[a-z]+(?:[?#].*)?$/, "$1big");
        }

        if (domain_nosub === "liveinternet.ru" &&
            domain.match(/^img[0-9]*\./)) {
            // https://img1.liveinternet.ru/images/attach/d/1/130/383/130383339_preview_1.jpg
            //   https://img1.liveinternet.ru/images/attach/d/1/130/383/130383339_1.jpg
            return src.replace(/(\/[0-9]+)_[a-z]+(_[0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "assets.heart.co.uk") {
            // https://assets.heart.co.uk/2015/43/naomie-harris-attends-the-royal-world-premiere-after-party-of-spectre-at-the-british-museum-1445940762-view-0.jpg
            //   https://assets.heart.co.uk/2015/43/naomie-harris-attends-the-royal-world-premiere-after-party-of-spectre-at-the-british-museum-1445940762.jpg
            return src.replace(/(-[0-9]+)-view-[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "kms.yawmiyati.com") {
            // http://kms.yawmiyati.com/Images/120x150xi/180219100537296~8.jpg -- 109x150
            //   http://kms.yawmiyati.com/content/uploads/Article/180219100537296~8.jpg -- 624x858
            // http://kms.yawmiyati.com/Images/613x307xo/170923100547235~job-yawmiyati.jpg
            //   http://kms.yawmiyati.com/content/uploads/Article/170923100547235~job-yawmiyati.jpg
            return src.replace(/\/Images\/[0-9io]+x[0-9io]+x[0-9io]+\//, "/content/uploads/Article/");
        }

        if (domain === "pic.chinasspp.com") {
            // http://pic.chinasspp.com/News/u/693191/image/201606/12124410_6647_s_605x455.jpg
            //   http://pic.chinasspp.com/News/u/693191/image/201606/12124410_6647.jpg
            return src.replace(/_s_[0-9]+x[0-9]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "eveningecho.ie") {
            // https://www.eveningecho.ie/portalsuite/image//5513a649-667d-4265-bca2-eaa230f04405/mainMediaSize=MEDIUM_type=image_publish=true__image.jpg -- 601x1024
            //   https://www.eveningecho.ie/portalsuite/image//5513a649-667d-4265-bca2-eaa230f04405/mainMediaSize=FILE__image.jpg -- 1200x2044
            // https://www.eveningecho.ie/portalsuite/image//65d7f9a3-93db-48e7-8a2c-736530dd703a/mainMediaSize=FILE_type=image_x0=0_y0=0_x1=100_y1=88.03_alf_ticket=guest_format=1.778__image.jpg -- 4307x2780
            //   https://www.eveningecho.ie/portalsuite/image//65d7f9a3-93db-48e7-8a2c-736530dd703a/mainMediaSize=FILE__image.jpg -- 4307x2780
            return src.replace(/(\/portalsuite\/image\/+[-0-9a-f]+)\/+[^/]*(\.[^/.]*)$/,
                               "$1/mainMediaSize=FILE__image$2");
        }

        if (domain_nowww === "drunkenstepfather.com") {
            // https://drunkenstepfather.com/cms/ul/t-20080416-Aubrey_ODay_Nipples.jpg
            //   https://drunkenstepfather.com/cms/ul/20080416-Aubrey_ODay_Nipples.jpg
            return src.replace(/\/cms\/ul\/t-/, "/cms/ul/");
        }

        if (domain_nowww === "fraufluger.ru") {
            // http://www.fraufluger.ru/files/images/html_gallerys/cultura_gallery/ae2fee29363f533f30e796a30c2a52e5_560.jpg
            //   http://www.fraufluger.ru/files/images/html_gallerys/cultura_gallery/ae2fee29363f533f30e796a30c2a52e5_origin.jpg
            return src.replace(/(\/files\/images\/html_gallerys\/[^/]*\/[0-9a-f]+)_[0-9]+(\.[^/.]*)$/, "$1_origin$2");
        }

        if (domain_nowww === "alfacdn.com") {
            // http://alfacdn.com/2018/03/19/10/2552.jpg -- 200x100
            //   http://alfacdn.com/2018/03/19/10/2552h.jpg -- 270x150
            //   http://alfacdn.com/2018/03/19/10/2552m.jpg -- 600x450
            // open directory listing, even back to 2011, "m" is the largest size
            return src.replace(/(\/[0-9]+)h?(\.[^/.]*)/, "$1m$2");
        }

        if (domain === "s.img.mix.sina.com.cn") {
            // http://s.img.mix.sina.com.cn/auto/resize?img=http%3A%2F%2Fn.sinaimg.cn%2Fent%2F4_img%2Fupload%2F1edcbf7a%2F20171018%2FMW3e-fymvuyt3988351.jpg&size=100_100
            //   http://n.sinaimg.cn/ent/4_img/upload/1edcbf7a/20171018/MW3e-fymvuyt3988351.jpg -- forces download
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/auto\/resize.*?[?&]img=([^&]*).*?$/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);
        }

        if (domain === "albums.timg.co.il") {
            // http://albums.timg.co.il/userFolders/211/3155441/small/315544120174711119762.jpg
            //   http://albums.timg.co.il/userFolders/211/3155441/315544120174711119762.jpg
            // http://albums.timg.co.il/userFolders/211/3155441/small/3155441201762513520249.jpg
            //   http://albums.timg.co.il/userFolders/211/3155441/3155441201762513520249.jpg
            return src.replace(/(\/userFolders\/[0-9]+\/[0-9]+\/)[a-z]+\/([0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "aljanh.net") {
            // http://www.aljanh.net/data/archive/preview/img/2658161267.jpeg
            //   http://www.aljanh.net/data/archive/img/2658161267.jpeg
            return src.replace(/(\/data\/archive\/)[a-z]+\/(img\/[0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (amazon_container === "files.d20.io") {
            // https://s3.amazonaws.com/files.d20.io/images/5100331/I7Z4uj0ryab6NZZqOZRYHw/thumb.jpg?1407651646450&size=100 -- 200x160
            //   https://s3.amazonaws.com/files.d20.io/images/5100331/I7Z4uj0ryab6NZZqOZRYHw/max.jpg -- 300x240
            return src.replace(/(\/images\/[0-9]+\/[^/]*\/)[a-z]+(\.[^/.?]*)(?:[?#].*)?$/, "$1max$2");
        }

        if (domain_nowww === "wallpaperdx.com") {
            // http://www.wallpaperdx.com/photo/jennifer-lawrence-in-black-dress-full-hd-wallpaper-178-101.jpg
            //   http://www.wallpaperdx.com/images/jennifer-lawrence-in-black-dress-full-hd-wallpaper.jpg
            return src.replace(/\/photo(\/[^/]*)-[0-9]+-[0-9]+(\.[^/.]*)$/, "/images$1$2");
        }

        if (domain_nowww === "patrasevents.gr") {
            // https://www.patrasevents.gr/imgsrv/f/188x/1783196.jpg
            //   https://www.patrasevents.gr/imgsrv/f/full/1783196.jpg
            return src.replace(/(\/imgsrv\/.\/)[0-9]+x\//, "$1full/");
        }

        if (domain_nowww === "bestfon.info") {
            // http://www.bestfon.info/images/joomgallery/thumbnails/chicas_24/jennifer_lawrence_2016_20161009_1500650344.jpg
            //   http://www.bestfon.info/images/joomgallery/originals/chicas_24/jennifer_lawrence_2016_20161009_1500650344.jpg
            return src.replace(/\/images\/joomgallery\/[a-z]+\//, "/images/joomgallery/originals/");
        }

        if (domain_nowww === "alazmenah.com" ||
            // http://syria-in.com/thumb_photo//mots/jennifer_lawrence.jpg
            //   http://syria-in.com/photo//mots/jennifer_lawrence.jpg
            domain_nowww === "syria-in.com") {
            // http://alazmenah.com/thumb_photo//00/73/54.jpg
            //   http://alazmenah.com/photo//00/73/54.jpg
            return src.replace(/\/thumb_photo\//, "/photo/");
        }

        if (domain === "images.alwatanvoice.com") {
            // https://images.alwatanvoice.com/news/thumbs/9998658247.jpg
            //   https://images.alwatanvoice.com/news/large/9998658247.jpg
            return src.replace(/\/news\/thumbs\//, "/news/large/");
        }

        if (domain_nowww === "ammanalyoum.com") {
            // http://www.ammanalyoum.com/images/upload/p19ta6fqfi6co16dsveh19k616ku5.jpg/200/200/0
            //   http://www.ammanalyoum.com/images/upload/p19ta6fqfi6co16dsveh19k616ku5.jpg
            // seems to be running timthumb? ommitting /0 results in this error:
            // Query String : src=images/upload&h=p19ta6fqfi6co16dsveh19k616ku5.jpg&w=200&zc=200
            // TimThumb version : 2.8.11
            return {
                url: src.replace(/(\/images\/upload\/[^/]*\.[^/.]*)\/[0-9]+\/[0-9]+\/[0-9]+(?:[?#].*)?$/, "$1"),
                can_head: false // 403
            };
        }

        if (domain_nowww === "shitpostbot.com") {
            // https://www.shitpostbot.com/resize/250/250?img=%2Fimg%2Fsourceimages%2Fjennifer-lawrence-58d3fee56f6e9.jpeg
            //   https://www.shitpostbot.com/img/sourceimages/jennifer-lawrence-58d3fee56f6e9.jpeg
            newsrc = src.replace(/(:\/\/[^/]*\/)resize\/[0-9]+\/[0-9]+.*?[?&]img=([^&]*).*?$/, "$1$2");
            if (newsrc !== src) {
                return decodeURIComponent(newsrc).replace(/(:\/\/[^/]*)\/+/, "$1/");
            }
        }

        if (domain_nowww === "extremnews.com") {
            // https://www.extremnews.com/images/article_portrait-ddef435dbc734c7697b473434f18961e.jpg
            //   https://www.extremnews.com/images/full-ddef435dbc734c7697b473434f18961e.jpg
            return src.replace(/\/images\/[a-z_]+-([0-9a-f]+\.[^/.]*)$/, "/images/full-$1");
        }

        if (domain === "contestimg.wish.com") {
            // https://contestimg.wish.com/api/webimage/56a1c22c297b29182fa5d7e9-medium.jpg -- 200x300
            //   https://contestimg.wish.com/api/webimage/56a1c22c297b29182fa5d7e9-full.jpg -- 400x600
            //   https://contestimg.wish.com/api/webimage/56a1c22c297b29182fa5d7e9-original.jpg -- 400x600, text/html
            // https://contestimg.wish.com/api/webimage/56a1c22c297b29182fa5d7e9-large.jpg?cache_buster\u003d513b122f92896cc70053585f36900b84
            //   https://contestimg.wish.com/api/webimage/56a1c22c297b29182fa5d7e9-full.jpg
            // https://contestimg.wish.com/api/webimage/5908286fc0b6c4293245d792-11-large.jpg -- 600x600
            //   https://contestimg.wish.com/api/webimage/5908286fc0b6c4293245d792-11-full.jpg -- 800x800
            //   https://contestimg.wish.com/api/webimage/5908286fc0b6c4293245d792-11-original.jpg -- 800x800
            return {
                url: src.replace(/(\/api\/webimage\/[0-9a-f]+(?:-[0-9]+)?)-[a-z]+(\.[^/.?]*)(?:[?#].*)?$/, "$1-original$2"),
                head_wrong_contenttype: true
            };
        }

        if (domain === "image.phimmoi.net") {
            // http://image.phimmoi.net/profile/19210/medium.jpg
            //   http://image.phimmoi.net/profile/19210/full.jpg
            return src.replace(/(\/profile\/[0-9]+\/)[a-z]+(\.[^/.]*)$/, "$1full$2");
        }

        if (domain_nosub === "static-bluray.com" &&
            domain.match(/^images[0-9]*\./)) {
            // https://images3.static-bluray.com/products/22/76649_1_medium.jpg -- 136x204
            //   https://images3.static-bluray.com/products/22/76649_1_original.jpg -- 471x709
            return src.replace(/(\/[0-9]+_[0-9]+_)[a-z]+(\.[^/.]*)$/, "$1original$2");
        }

        if (domain_nowww === "titus.kz") {
            // http://titus.kz/load_theme/files/2014092615075454252ceaef976.j_s.jpg
            //   http://titus.kz/load_theme/files/2014092615075454252ceaef976.jpg
            return src.replace(/(\/load_theme\/files\/[0-9a-f]+)\.[^/]*(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "mfoxes.net") {
            // https://mfoxes.net/c/castimagethumb-1157358.jpg
            //   https://mfoxes.net/c/castimage-1157358.jpg
            // https://mfoxes.net/w,300,/gal/8675-t-poster-english/mfoxes-net-cover-english-11.jpg
            //   https://mfoxes.net/gal/8675-t-poster-english/mfoxes-net-cover-english-11.jpg
            return src
                .replace(/\/[a-z],[0-9]+,[^/]*\/gal\//, "/gal/")
                .replace(/\/castimagethumb-([0-9]+\.[^/.]*)$/, "/castimage-$1");
        }

        if (domain === "i.ucrazy.ru") {
            // http://i.ucrazy.ru/files/i/2012.11.10/thumbs/1352508738_k-54.jpg
            //   http://i.ucrazy.ru/files/i/2012.11.10/1352508738_k-54.jpg
            return src.replace(/(\/files\/i\/[0-9]+\.[0-9]+\.[0-9]+\/)thumbs\//, "$1");
        }

        if (domain_nowww === "athinorama.gr") {
            // http://www.athinorama.gr/lmnts/articles/2523568/emilia%20.jpg.ashx?w=210
            //   http://www.athinorama.gr/lmnts/articles/2523568/emilia%20.jpg
            return src.replace(/(\/articles\/[0-9]+\/[^/.]*\.[^/.]*)\.ashx\?.*$/, "$1");
        }

        if (domain_nowww === "murekkephaber.com") {
            // https://www.murekkephaber.com/images/haberler/2018/09/emilia-clarke-rol-alacagim-yapimlari-ince-eleyip-sik-dokuyacagim_t.jpg
            //   https://www.murekkephaber.com/images/haberler/2018/09/emilia-clarke-rol-alacagim-yapimlari-ince-eleyip-sik-dokuyacagim.jpg
            return src.replace(/(\/images\/[^/]*\/[0-9]+\/[0-9]+\/[^/]*)_t(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "dienvienvietnam.vn" &&
            src.indexOf("/assets/img/") >= 0) {
            // https://dienvienvietnam.vn/assets/img/tall-all-1_1530277982_large.jpg
            //   https://dienvienvietnam.vn/assets/img/tall-all-1_1530277982_grande.jpg
            // tiny, small, medium (512), large (1024), grande (1280)
            return src.replace(/(_[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1_grande$2");
        }

        if (amazon_container === "s3bucketvn") {
            // https://s3-sa-east-1.amazonaws.com/s3bucketvn/images/thumbs/medium/2da02f15db2cd72551d53a53757aab70016eb7f0.jpg
            //   https://s3-sa-east-1.amazonaws.com/s3bucketvn/images/2da02f15db2cd72551d53a53757aab70016eb7f0.jpg
            return src.replace(/\/images\/thumbs\/[a-z]+\/([0-9a-f]+\.[^/.]*)$/, "/images/$1");
        }

        if (domain_nosub === "gazeta.ua" &&
            domain.match(/^static[0-9]*\./)) {
            // https://static2.gazeta.ua/img2/cache/preview/858/858985_a_290_232.jpg?v=0
            //   https://static2.gazeta.ua/img2/original/preview/858/858985.jpg?v=0
            // https://static2.gazeta.ua/img2/cache/gallery/858/858985_3_w_1000.jpg?v=0 -- different image from above
            // https://static2.gazeta.ua/img2/cache/gallery/758/758623_1_w_1200.jpg?v=0
            //   https://static2.gazeta.ua/img2/original/gallery/758/758623.jpg?v=0 -- doesn't work
            //   https://static2.gazeta.ua/img2/original/preview/758/758623.jpg?v=0 -- works, similar but possibly different image?
            return src.replace(/\/img2\/[a-z]+\/([a-z]+\/[0-9]+\/[0-9]+)_[^/]*(\.[^/.]*)$/, "/img2/original/$1$2");
        }

        if (domain_nowww === "gazzettadiparma.it" ||
            // https://www.liberoquotidiano.it/resizer/610/-1/false/1472720861989.jpg--.jpg?1472720874000
            //   https://www.liberoquotidiano.it/resizer/-1/-1/false/1472720861989.jpg--.jpg?1472720874000
            //   https://www.liberoquotidiano.it/upload/1472720861989.jpg
            domain_nowww === "liberoquotidiano.it") {
            // https://www.gazzettadiparma.it/resizer/299/183/true/1536836112579.jpg--.jpg?1536836014000
            //   https://www.gazzettadiparma.it/resizer/-1/-1/false/1536836112579.jpg--.jpg?1536836014000
            //   https://www.gazzettadiparma.it/upload/1536836112579.jpg
            // https://www.gazzettadiparma.it/resizer_ext/300/-1/true/https%3A//pad.mymovies.it/filmclub/2017/04/227/locandina.jpg--.jpg
            //   https://pad.mymovies.it/filmclub/2017/04/227/locandina.jpg
            // true = ignore aspect ratio
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/resizer_ext\/[-0-9]+\/[-0-9]+\/[a-z]+\/(http)/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc).replace(/--(\.[^/.]*)$/, "");

            //newsrc = src.replace(/\/resizer\/[-0-9]+\/[-0-9]+\/[a-z]+\//, "/resizer/-1/-1/false/");
            newsrc = src.replace(/\/resizer\/[-0-9]+\/[-0-9]+\/[a-z]+\/([0-9]+\.[^-/.]+)--.*/, "/upload/$1");
            if (newsrc !== src)
                return newsrc;

            newsrc = src.replace(/\/resizer\/[-0-9]+\/[-0-9]+\/[a-z]+\//, "/resizer/-1/-1/false/");
            if (newsrc !== src)
                return newsrc;
        }

        if (domain === "multimidia.correiodopovo.com.br") {
            // http://multimidia.correiodopovo.com.br/thumb.aspx?Caminho=multimidia/2016/11/19/407295.JPG&Tamanho=690
            //   http://multimidia.correiodopovo.com.br/multimidia/2016/11/19/407295.JPG
            return src.replace(/(:\/\/[^/]*\/)thumb\.aspx.*?Caminho=([^&]*).*?$/, "$1$2");
        }

        if (domain_nosub === "diziler.com" &&
            domain.match(/^s[0-9]*\./)) {
            // https://s01.diziler.com/img/300x170/18-05/16/siren-dizisi-yeni-sezon-onayi.jpg?0.36658649956594314
            //   https://s01.diziler.com/original/18-05/16/siren-dizisi-yeni-sezon-onayi.jpg?0.36658649956594314
            return src.replace(/(:\/\/[^/]*\/)img\/[0-9]+x[0-9]+\//, "$1original/");
        }

        if (domain === "g.denik.cz") {
            // https://g.denik.cz/56/15/eline-powell-twitter-nude1_sip-140up.jpg
            //   https://g.denik.cz/56/15/eline-powell-twitter-nude1.jpg
            return src.replace(/_sip-[0-9]+up(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "imperiodefamosas.com") {
            // http://www.imperiodefamosas.com/image_cache.php?file=Fotos/Eline_Powell/Eline_Powell_018.jpg
            //   http://www.imperiodefamosas.com/Fotos/Eline_Powell/Eline_Powell_018.jpg
            return src.replace(/(:\/\/[^/]*\/)image_cache\.php.*?[?&]file=([^&]*).*?$/, "$1$2");
        }

        if (domain_nowww === "lostfilm.info") {
            // http://lostfilm.info/images/150photo_actor/69/2569792_689554.jpg
            //   http://lostfilm.info/images/photo_actor/69/2569792_689554.jpg
            return src.replace(/\/images\/[0-9]+photo/, "/images/photo");
        }

        if (domain_nowww === "hinhnenso1.com") {
            // http://hinhnenso1.com/images/blogs/2016/06/tiny/hinh-anh-cac-co-gai-cosplay-cuc-dep-1465867333.jpg
            // http://hinhnenso1.com/images/blogs/2016/06/original/hinh-anh-cac-co-gai-cosplay-cuc-dep-1465867333.jpg
            return src.replace(/(\/images\/blogs\/[0-9]+\/[0-9]+\/)[a-z]+\//, "$1original/");
        }

        if (domain_nowww === "avatarko.ru") {
            // https://avatarko.ru/img/preview/32/devushka_31031.jpg
            //   https://avatarko.ru/img/kartinka/32/devushka_31031.jpg
            return src.replace(/(:\/\/[^/]*\/img\/)[a-z]+\//, "$1kartinka/");
        }

        if (domain_nowww === "ppe.pl") {
            // https://www.ppe.pl/upload/news/88/83/10/normal_888310616.jpg
            //   https://www.ppe.pl/upload/news/88/83/10/888310616.jpg
            return src.replace(/(\/upload\/news\/(?:[0-9]+\/){3})[a-z]+_([0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "storge.pic2.me") {
            // https://storge.pic2.me/c/560x350/211/57caf262ca47b.jpg
            //   https://storge.pic2.me/upload/211/57caf262ca47b.jpg
            // https://storge.pic2.me/cm/480x272/677/Animals%20Wallpapers%2070.jpg
            //   https://storge.pic2.me/upload/677/Animals%20Wallpapers%2070.jpg
            return src.replace(/\/cm?\/[0-9]+x[0-9]+\//, "/upload/");
        }

        if (domain_nowww === "serey.io") {
            // https://serey.io/imageproxy/100x100/https://serey.io/imageupload_data/7251e692d4e1c8295fce5ba38596a51478f2569d
            //   https://serey.io/imageupload_data/7251e692d4e1c8295fce5ba38596a51478f2569d
            return src.replace(/^[a-z]+:\/\/[^/]*\/imageproxy\/[0-9]+x[0-9]+\/(https?:\/\/)/, "$1");
        }

        if (domain === "static.pjmedia.com") {
            // https://static.pjmedia.com/trending/user-content/51/files/2016/06/shutterstock_335198975.sized-770x415xt.jpg
            //   https://static.pjmedia.com/trending/user-content/51/files/2016/06/shutterstock_335198975.jpg
            return src.replace(/\.sized-[0-9t]+x[0-9t]+x[0-9t]+(\.[^/.]*)$/, "$1");
        }

        if (domain === "file.nxing.cn") {
            // http://file.nxing.cn/uploads/uploads/2017/05/12/0000015/201705121104364104e5b14-size950x1330_thum_w260xh360xm0xf0xc1.jpeg
            //   http://file.nxing.cn/uploads/uploads/2017/05/12/0000015/201705121104364104e5b14.jpeg
            // http://file.nxing.cn/uploads/uploads/2016/10/17/0000000/20161017060127040585051-size666x1000.jpg
            //   http://file.nxing.cn/uploads/uploads/2016/10/17/0000000/20161017060127040585051.jpg
            return src.replace(/(\/uploads\/uploads\/[0-9]+\/[0-9]+\/[0-9]+\/[0-9]+\/[0-9a-f]+)-size[0-9]+x[0-9]+(?:_[^/]*)?(\.[^/.]*)$/, "$1$2");
        }

        // LookBooks
        if (amazon_container === "kateryan") {
            // https://kateryan.s3.amazonaws.com/lg_54c2cdfa-5a58-46c5-ba51-1a270a771fd0.jpg
            //   https://kateryan.s3.amazonaws.com/gxxl_54c2cdfa-5a58-46c5-ba51-1a270a771fd0.jpg
            return src.replace(/\/[a-z]+_/, "/gxxl_");
        }

        if (domain_nowww === "havepussy.com") {
            // https://havepussy.com/uploads/photos/previews/3576_havepussy_.jpg
            //   https://havepussy.com/0-0/3576_havepussy_.jpg
            return src.replace(/\/uploads\/photos\/previews\/([0-9]+_[^/]*)$/, "/0-0/$1");
        }

        if (domain === "news.walkerplus.com") {
            // https://news.walkerplus.com/article/118051/651728_615.jpg
            //   https://news.walkerplus.com/article/118051/651728.jpg
            return src.replace(/(\/article\/[0-9]+\/[0-9]+)_[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "img.jj20.com") {
            // http://img.jj20.com/up/allimg/mx01/06161QT509/1P6161T509-5-lpp.jpg
            //   http://img.jj20.com/up/allimg/mx01/06161QT509/1P6161T509-5.jpg
            //   http://pic.jj20.com/up/allimg/mx01/06161QT509/1P6161T509-5.jpg
            return src.replace(/(\/[0-9A-Z]+-[0-9]+)-[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "i.iplsc.com") {
            // https://i.iplsc.com/-/0006NKP5448WTEJI-C105.jpg -- 120x180
            //   https://i.iplsc.com/-/0006NKP5448WTEJI-C0.jpg -- 2804x4213
            // https://i.iplsc.com/emma-watson-to-dopiero-poczatek/0004CKQ6GXCVEDM4-C322-F4.webp
            //   https://i.iplsc.com/emma-watson-to-dopiero-poczatek/0004CKQ6GXCVEDM4-C0.webp
            return src.replace(/(\/[0-9A-Z]+)-C[0-9]+(?:-F[0-9]+)?(\.[^/.]*)$/, "$1-C0$2");
        }

        if (domain === "s3.viva.pl") {
            // http://s3.viva.pl/newsy/emma-watson-w-sukni-kitx-418529-GALLERY_600.jpg -- 600x901
            //   http://s3.viva.pl/newsy/emma-watson-w-sukni-kitx-418529-GALLERY_BIG.jpg -- 820x1232
            return src.replace(/-GALLERY_[0-9]+(\.[^/.]*)$/, "-GALLERY_BIG$1");
        }

        if ((domain_nosub === "vogue.com.tr" && domain.match(/^cdn[0-9]*\./)) ||
            // http://cdn1.gq.com.tr/files/img/photo_gallery_b/15-08/24/_arc0047-640x960_1_0.jpg
            //   http://cdn1.gq.com.tr/files/original/15-08/24/_arc0047-640x960_1_0.jpg
            (domain_nosub === "gq.com.tr" && domain.match(/^cdn[0-9]*\./)) ||
            // https://voguecdn.blob.core.windows.net/files/img/article_detail/18-09/09/gettyimages-1027861520-1536442474.jpg
            //   https://voguecdn.blob.core.windows.net/files/original/18-09/09/gettyimages-1027861520-1536442474.jpg
            domain === "voguecdn.blob.core.windows.net") {
            // https://cdn1.vogue.com.tr/files/img/photo_gallery_m/17-05/08/emma-watson-gettyimages-680131122.jpg
            //   https://cdn1.vogue.com.tr/files/original/17-05/08/emma-watson-gettyimages-680131122.jpg
            // https://cdn1.vogue.com.tr/files/img/vertical_m/18-09/09/gettyimages-1027861520.jpg?0.02722366776135532
            //   https://cdn1.vogue.com.tr/files/img/vertical_m/18-09/09/gettyimages-1027861520.jpg?0.02722366776135532
            return src.replace(/\/files\/img\/[^/]*\//, "/files/original/");
        }

        if (domain_nosub === "clients-cdnnow.ru") {
            // https://user32265.clients-cdnnow.ru/localStorage/e4/d0/09/25/e4d00925_resizedScaled_740to1116.jpg -- 740x1116
            //   https://user32265.clients-cdnnow.ru/localStorage/e4/d0/09/25/e4d00925.jpg -- 960x1448
            // https://user32265.clients-cdnnow.ru/localStorage/post/bf/6c/45/84/bf6c4584_resizedScaled_740to493.jpg
            //   https://user32265.clients-cdnnow.ru/localStorage/post/bf/6c/45/84/bf6c4584.jpg
            return src.replace(/(\/localStorage\/(?:post\/)?(?:[0-9a-f]{2}\/){1,}[0-9a-f]+)_resizedScaled_[0-9]+to[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "hollywoodtuna.com") {
            // http://www.hollywoodtuna.com/images3/cailin_russo_66_the_nice_4.jpg
            //   http://www.hollywoodtuna.com/images3/bigimages3/cailin_russo_66_the_nice_4.jpg -- 1456x2184
            return src.replace(/\/images([0-9])\/([^/]*)$/, "/images$1/bigimages$1/$2");
        }

        if (domain_nosub === "soupcdn.com" &&
            domain.match(/^asset-.\./)) {
            // http://asset-e.soupcdn.com/asset/8062/1434_eafb_500.jpeg
            //   http://asset-e.soupcdn.com/asset/8062/1434_eafb.jpeg
            return src.replace(/(\/asset\/[0-9]+\/[0-9]+_[0-9a-z]+)_[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "qqmofasi.com" &&
            domain.match(/^pic[0-9]*\./)) {
            // http://pic4.qqmofasi.com/2014/08/29/127_eRSs6BrBJBjsU0033630_crop.jpg
            //   http://pic4.qqmofasi.com/2014/08/29/127_eRSs6BrBJBjsU0033630.jpg
            return src.replace(/_crop(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "download-rooz.com") {
            // https://download-rooz.com/img/600-900/cast/49015-Peyton-List-v1.jpg
            //   https://download-rooz.com/img/cast/49015-Peyton-List-v1.jpg
            return src.replace(/\/img\/[0-9]+-[0-9]+\//, "/img/");
        }

        if (domain_nowww === "know.cf") {
            // https://www.know.cf/imgw/450px/Peyton_Roi_List.JPG
            //    https://www.know.cf/imgw/Peyton_Roi_List.JPG
            return src.replace(/\/imgw\/[0-9]+px\/([^/]*)$/, "/imgw/$1");
        }

        if (amazon_container === "timely-api-public") {
            // https://timely-api-public.s3.us-west-2.amazonaws.com/116743_phpg7Ixww_small.JPG
            //   https://timely-api-public.s3.us-west-2.amazonaws.com/116743_phpg7Ixww.JPG
            return src.replace(/(\/timely-api-public[^/]*\/[0-9]+_[0-9a-zA-Z]+)_[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "image-share.com") {
            // http://image-share.com/upload/3439/222m.jpg
            //   http://image-share.com/upload/3439/222.jpg
            return src.replace(/(\/upload\/[0-9]+\/[0-9]+)m(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "amando.it") {
            // https://www.amando.it/imagesdyn/gallery_plus/80x80/13/67/lok-fine-estate_136712.jpg
            //   https://www.amando.it/imagesdyn/gallery_plus/orig_660/13/67/lok-fine-estate_136712.jpg
            //   https://www.amando.it/imagesdyn/gallery_plus/orig/13/67/lok-fine-estate_136712.jpg
            return src.replace(/\/imagesdyn\/gallery_plus\/(?:[0-9]+x[0-9]+|orig_[0-9]+)\//,
                               "/imagesdyn/gallery_plus/orig/");
        }

        if (domain_nowww === "textureking.com") {
            // https://www.textureking.com/content/img/stock/DSC_4465.jpg
            //   https://www.textureking.com/content/img/stock/big/DSC_4465.JPG
            return add_extensions_upper(src.replace(/\/content\/img\/stock\/([^/]*)$/, "/content/img/stock/big/$1"));
        }

        if (domain_nowww === "textures.com") {
            // https://www.textures.com/system/gallery/photos/Floors/Herringbone/118323/FloorHerringbone0118_2_download600.jpg
            //   https://www.textures.com/system/gallery/photos/Floors/Herringbone/118323/FloorHerringbone0118_2_500.jpg
            //   https://www.textures.com/system/gallery/photos/Floors/Herringbone/118323/hotlink-ok/FloorHerringbone0118_2_shared.jpg
            // parts: https://www.textures.com/system/gallery/photos/Floors/Herringbone/118323/zoomed_preview/FloorHerringbone0118_2_z24.jpg 0-24 (for all images)
            // https://www.textures.com/browse/getPhotoInfoAjax?id=118323
            if (src.match(/\/system\/gallery\/photos\/[^/]*\/[^/]*\/[0-9]+\/[^/]*$/)) {
                return {
                    url: src.replace(/(\/[0-9]+\/)([^/]*_)(?:download)?[0-9]+(\.[^/.]*)$/, "$1hotlink-ok/$2shared$3"),
                    problems: {
                        watermark: true
                    }
                };
            }
        }

        if ((domain_nosub === "gmbox.ru" ||
             // https://b1.vestifinance.ru/c/53285.200x250.jpg
             //   https://b1.vestifinance.ru/c/53285.jpg
             domain_nosub === "vestifinance.ru") &&
            domain.match(/^[a-z][0-9]*\./)) {
            // https://b1.gmbox.ru/c/160165.815x310c5020.jpg
            //   https://b1.gmbox.ru/c/160165.jpg
            // https://b1.gmbox.ru/c/161499.823x463.jpg
            //   https://b1.gmbox.ru/c/161499.jpg -- stretched? (2608x1392)
            // https://b1.gmbox.ru/c/160518.815x310c5020.jpg
            //   https://b1.gmbox.ru/c/160518.jpg -- stretched? (2608x1739)
            // https://b1.gmbox.ru/c/156676.jpg -- 1280x853 (not stretched)
            // https://b1.gmbox.ru/c/150458.815xp.jpg
            //   https://b1.gmbox.ru/c/150458.jpg
            return src.replace(/(\/c\/[0-9]+)\.[0-9]+x[0-9p]+(?:c[0-9]+)?(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "game2day.ru") {
            // https://game2day.ru/images/made/7b4f3a1209326b54/2992239-1_600_400_c1.jpg
            //   https://game2day.ru/uploads/userfiles/images/2992239-1.jpg
            // https://game2day.ru//images/made/7b4f3a1209326b54/ciri_585_390_s_c1.jpg
            //   https://game2day.ru/uploads/userfiles/images/ciri.jpg -- doesn't work
            return src.replace(/\/images\/made\/[0-9a-f]+\/([0-9]+-[0-9]+)_[0-9]+_[0-9]+_(?:s_)?c[0-9]+(\.[^/.]*)$/,
                               "/uploads/userfiles/images/$1$2");
        }

        if (domain_nosub === "nupics.pro" ||
            // https://repicsx.com/pics/1342/_steampunk-girl.jpg
            //   https://repicsx.com/pics/1342/steampunk-girl.jpg
            domain_nowww === "repicsx.com") {
            // https://nupics.pro/pics/2267/_keira-metz-witcher-3.jpg
            //   https://nupics.pro/pics/2267/keira-metz-witcher-3.jpg
            return src.replace(/(\/pics\/[0-9]+\/)_([^/]*)$/, "$1$2");
        }

        if (domain_nosub === "cloud.it" &&
            domain.match(/^ldm[0-9]*\.r1-it\.storage\./)) {
            // https://ldm.r1-it.storage.cloud.it/img/18/1/18/big/8440_5a5fe09abb8af3.57794750.jpg -- 640x426
            //   https://ldm.r1-it.storage.cloud.it/img/18/1/18/8440_5a5fe09abb8af3.57794750.jpg -- 1024x683
            // https://ldm.r1-it.storage.cloud.it/av/18/8/3/thumbs/5b63f8c783b74.png -- 50x50
            //   https://ldm.r1-it.storage.cloud.it/av/18/8/3/5b63f8c783b74.png -- 150x150
            // https://ldm2.r1-it.storage.cloud.it/av/18/9/16/thumbs/5b9e9e1052d09.jpg
            //   https://ldm2.r1-it.storage.cloud.it/av/18/9/16/5b9e9e1052d09.jpg
            // https://ldm.r1-it.storage.cloud.it/logo/16-9/9/thumbs/57d2ee9a28a46.png
            //   https://ldm.r1-it.storage.cloud.it/logo/16-9/9/57d2ee9a28a46.png
            return src
                .replace(/(\/img\/.*\/)big\/([0-9]+_[0-9a-f]+\.[0-9]+\.[^/.]*)$/, "$1$2")
                .replace(/(\/(?:av|logo)\/.*\/)thumbs\/([0-9a-f]+\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "m2ch.hk") {
            // https://m2ch.hk/cg/big/thumb/1252393/15246051789290s.jpg
            //   https://m2ch.hk/cg/src//1252393/15246051789290.jpg
            return src.replace(/\/big\/thumb(\/[0-9]+\/[0-9]+)s(\.[^/.]*)$/, "/src/$1$2");
        }

        if (domain_nosub === "cfimg.com" &&
            domain.match(/^i[0-9]*\./)) {
            // http://i2.cfimg.com/562411/4b16f553bb78d943s.jpg
            //   http://i2.cfimg.com/562411/4b16f553bb78d943.jpg -- same size (730x1095)
            return src.replace(/(:\/\/[^/]*\/[0-9]+\/[0-9a-f]+)s(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "i.chzbgr.com") {
            // https://i.chzbgr.com/thumb400/9029115904/h545C0A2E/
            //   https://i.chzbgr.com/full/9029115904/h545C0A2E/
            return src.replace(/\/thumb[0-9]*\//, "/full/");
        }

        if (domain === "img.memecdn.com") {
            // https://img.memecdn.com/rogue-cosplay_t_3023679.webp
            //   https://img.memecdn.com/rogue-cosplay_o_3023679.webp
            return src.replace(/_[a-z]_([0-9]+\.[^/.]*)$/, "_o_$1");
        }

        if (domain_nowww === "mmorpg.org.pl" ||
            // https://esportivo.net/system/post_pictures/files/000/000/007/medium/Bez_tytu%C5%82u.jpg?1500980126
            //   https://esportivo.net/system/post_pictures/files/000/000/007/original/Bez_tytu%C5%82u.jpg?1500980126
            // https://esportivo.net/system/posts/posters/000/001/303/thumb/fortnite.jpg?1536761386
            //   https://esportivo.net/system/posts/posters/000/001/303/original/fortnite.jpg?1536761386
            domain_nowww === "esportivo.net" ||
            // http://pvgroup.ru/system/post_pictures/pictures/000/000/260/medium/Thermoplast_2018-9.jpg?1531233838
            //   http://pvgroup.ru/system/post_pictures/pictures/000/000/260/original/Thermoplast_2018-9.jpg?1531233838 -- doesn't work
            // http://pvgroup.ru/system/post_pictures/pictures/000/000/072/medium/DSC09097.JPG?1425970948
            //   http://pvgroup.ru/system/post_pictures/pictures/000/000/072/original/DSC09097.JPG?1425970948 -- works
            domain_nowww === "pvgroup.ru" ||
            // http://leit.is/system/events/images/000/002/054/small/6-mind-blowing-ways-wear-your-steampunk-goggles.w654.jpg?1433916032
            //   http://leit.is/system/events/images/000/002/054/original/6-mind-blowing-ways-wear-your-steampunk-goggles.w654.jpg?1433916032
            domain_nowww === "leit.is" ||
            // http://www.rovina-project.eu/system/post_pictures/assets/000/000/054/big/premiazione-fabrizio.jpg?1450022017 -- 600x417
            //   http://www.rovina-project.eu/system/post_pictures/assets/000/000/054/original/premiazione-fabrizio.jpg?1450022017 -- 1319x917
            domain_nowww === "rovina-project.eu") {
            // https://mmorpg.org.pl/system/post_pictures/files/000/006/015/thumb/40668144_2172392399469743_8786830147845095424_n.jpg?1537099596
            //   https://mmorpg.org.pl/system/post_pictures/files/000/006/015/original/40668144_2172392399469743_8786830147845095424_n.jpg?1537099596
            return src.replace(/(\/system\/(?:post_pictures\/(?:files|assets|pictures)\/|posts\/posters\/|events\/images\/)(?:[0-9]+\/){3})[a-z]+(\/[^/]*)$/, "$1original$2");
        }

        if (domain_nosub === "123rf.com") {
            // https://previews.123rf.com/images/buchachon/buchachon1206/buchachon120600029/13974083-open-book-of-the-big-tree-fantacy.jpg
            //   https://us.123rf.com/450wm/buchachon/buchachon1206/buchachon120600029/13974083-open-book-of-the-big-tree-fantacy.jpg
            if (!src.match(/:\/\/[a-z]+cdn\./) &&
                src.match(/:\/\/[^/]*\/(?:images|[0-9]+wm)\//)) {
                var full = src.replace(/:\/\/[^/]*\/[^/]*\//, "://previews.123rf.com/images/");
                var small = src.replace(/:\/\/[^/]*\/[^/]*\//, "://us.123rf.com/450wm/");

                return [
                    {
                        url: full,
                        problems: {
                            watermark: true
                        }
                    },
                    {
                        url: small,
                        problems: {
                            smaller: true
                        }
                    }
                ];
            }
        }

        if (domain_nowww === "chenderroad.com") {
            // https://chenderroad.com/image.php?v=20180813&src=https%3A%2F%2Fi.imgur.com%2FQL25lgF.jpg
            //   https://i.imgur.com/QL25lgF.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/image\.php.*?[?&]src=([^&]*).*?$/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);
        }

        if (domain_nosub === "estranky.cz" ||
            // http://www.kappa123.estranky.sk/img/mid/1/fb_img_1516053994463.jpg
            //   http://www.kappa123.estranky.sk/img/original/1/fb_img_1516053994463.jpg
            domain_nosub === "estranky.sk") {
            // http://www.karolinka-hola.estranky.cz/img/tiny/18.jpg
            //   http://www.karolinka-hola.estranky.cz/img/original/18/image.jpg
            // http://www.karolinka-hola.estranky.cz/img/mid/18/selena16.jpg -- stretched
            //   http://www.karolinka-hola.estranky.cz/img/original/18/image.jpg
            //
            // http://s3a.estranky.sk/img/d/1000000001/bg-header-rside.jpg -- doesn't work
            if (domain !== "s3a.estranky.sk") {
                return src
                    .replace(/(:\/\/[^/]*\/img\/)[a-z]+\//, "$1original/")
                    .replace(/(:\/\/[^/]*\/img\/original\/[0-9]+)(\.[^/.]*)/, "$1/image$2");
            }
        }

        if (domain_nowww === "stagelook.ru") {
            // http://stagelook.ru/images/tumbs/StageLook_post_2962.jpg
            return src.replace(/\/images\/tumbs\//, "/images/");
        }

        if (domain === "media.taaze.tw") {
            // https://media.taaze.tw/showProdImageByPK.html?pid=1004729762&width=100&height=150
            //   https://media.taaze.tw/showTakeLook/1004729762.jpg
            // https://media.taaze.tw/showLargeImage.html?sc=24100007066&width=289&height=386
            //   https://media.taaze.tw/showTakeLook/1004729760.jpg
            return src.replace(/\/showProdImageByPK\.html.*?[?&]pid=([0-9]+).*?$/, "/showTakeLook/$1.jpg");
        }

        if (domain === "st.cdjapan.co.jp") {
            // http://st.cdjapan.co.jp/pictures/s/13/48/NEOBK-2039626_ADD.jpg?v=1 -- 102x128
            //   http://st.cdjapan.co.jp/pictures/l/13/48/NEOBK-2039626_ADD.jpg?v=1 -- 400x500
            return src.replace(/\/pictures\/s\//, "/pictures/l/");
        }

        if (domain === "image.blozoo.info") {
            // http://image.blozoo.info/v2/thumb/163/133/?url=https%3A%2F%2Ferologz.com%2Fwp-content%2Fuploads%2F2018%2F09%2F7b35309a-1.jpg&page_url=https%3A%2F%2Ferologz.com%2F97621.html&site_url=http%3A%2F%2Ferologz.com%2F&title=%E3%83%86%E3%83%AC%E6%9C%9D%E3%83%BB%E6%A3%AE%E5%B7%9D%E5%A4%95%E8%B2%B4%E3%82%A2%E3%83%8A%E3%81%8C%E3%83%8E%E3%83%BC%E3%83%96%E3%83%A9%E3%81%A7%E5%A4%A9%E6%B0%97%E4%BA%88%E5%A0%B1%E3%81%97%E3%81%A6%E3%82%8B%E3%81%A8%E8%A9%B1%E9%A1%8C%E3%81%AB%E3%80%82
            //   https://erologz.com/wp-content/uploads/2018/09/7b35309a-1.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/v2\/thumb\/[0-9]+\/[0-9]+\/.*?[?&]url=(http[^&]*).*?$/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);
        }

        if (domain === "img.suilengea.com") {
            // http://img.suilengea.com/img.php?tag=a&url=mmbiz.qpic.cn/mmbiz_jpg/TyNGUXnL4t0e7YCuyZubYhg0BrVZ3c0cFrt8bkmhwdKujZS6pLwv0GYnBcmoibQT04omHDg5Bic6Hic1pOmNicSVfA/640?
            //   http://mmbiz.qpic.cn/mmbiz_jpg/TyNGUXnL4t0e7YCuyZubYhg0BrVZ3c0cFrt8bkmhwdKujZS6pLwv0GYnBcmoibQT04omHDg5Bic6Hic1pOmNicSVfA/640
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/img\.php.*?[?&]url=([^&]*).*?$/, "$1");
            if (newsrc !== src)
                return add_http(decodeURIComponent(newsrc));
        }

        if (domain === "files.sirclocdn.xyz") {
            // https://files.sirclocdn.xyz/jkloop/products/_170715162210_Nogizaka46-Nigemizu-LEA.jpg
            //   https://files.sirclocdn.xyz/jkloop/products/_170715162210_Nogizaka46-Nigemizu-LEA_zoom.jpg
            //   https://files.sirclocdn.xyz/jkloop/products/_170715162210_Nogizaka46-Nigemizu-LEA_ori.jpg
            return src.replace(/(\/products\/_[0-9]+_[^/._]*)(?:_[a-z]+)?(\.[^/.]*)$/, "$1_ori$2");
        }

        if (domain === "s.tvp.pl") {
            // http://s.tvp.pl/images/4/2/3/uid_4232752c96d1f9e3bf91e7e116b2d8aa1303465175421_width_268_play_0_pos_3_gs_0.jpg
            //   http://s.tvp.pl/images/4/2/3/uid_4232752c96d1f9e3bf91e7e116b2d8aa1303465175421_width_9999999999999.jpg
            // http://s.tvp.pl/images2/8/d/8/uid_8d88e0204c8cf269ce0a38939f2428121537448809944_width_200_play_6_pos_5_gs_0_height_150.jpg
            //   http://s.tvp.pl/images2/8/d/8/uid_8d88e0204c8cf269ce0a38939f2428121537448809944_width_9999999999999.jpg -- stretched? (992x743)
            // http://s.tvp.pl/images2/4/f/7/uid_4f7200dfd11aa2f280c8e62aa23e31b91536341825746_width_600_play_0_pos_0_gs_0_height_450.jpg
            //   http://s.tvp.pl/images2/4/f/7/uid_4f7200dfd11aa2f280c8e62aa23e31b91536341825746_width_9999999999999.jpg -- 1280x959 (not stretched)
            return src.replace(/(\/images2?\/(?:[0-9a-f]\/){3})[-_a-zA-Z0-9]*(uid_[0-9a-f]+)[^/.]*?(\.[^/.]*)$/,"$1$2_width_9999999999999$3");
        }

        if (domain === "sf.be.com") {
            // http://sf.be.com/1/perso/elisez-beach-grand/photo/412412/13683751f7/elisez-beach-grand-berry-bikini-orange-p460.jpg -- 460x613 (stretched)
            //   http://sf.be.com/1/perso/elisez-beach-grand/photo/412412/13683751f7/elisez-beach-grand-berry-bikini-orange-img.jpg -- 368x500
            // http://sf.be.com/1/beaute/be_reserved-beaute/photo/013270013/1710563593/be_reserved-beaute-rhianna-preferez-voter-s220.jpg -- 220x220
            //   http://sf.be.com/1/beaute/be_reserved-beaute/photo/013270013/1710563593/be_reserved-beaute-rhianna-preferez-voter-img.jpg -- 400x400
            return src.replace(/(\/photo\/[0-9]+\/[0-9a-z]+\/[^/]*-)[a-z][0-9]+(\.[^/.]*)$/, "$1img$2");
        }

        if (domain_nowww === "fitwell.bg") {
            // http://fitwell.bg/pictures/1711680_500_.jpg -- stretched (499x759)
            //   http://fitwell.bg/pictures/1711680.jpg (316x480)
            return src.replace(/(\/pictures\/[0-9]+)_[0-9]+_*(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "bilder.bild.de") {
            // https://bilder.bild.de/fotos-skaliert/halle-berry-in-stirb-an-einem-anderen-tag-155165-26537384/4,w=596,q=high,c=0.bild.jpg
            //   https://bilder.bild.de/fotos/halle-berry-in-stirb-an-einem-anderen-tag-155165-26537384/Bild/4.bild.jpg
            return src.replace(/\/fotos-skaliert(\/[^/]*\/)([0-9]+),[^/.]*(\.bild\.[^/.]*)$/, "/fotos$1Bild/$2$3");
        }

        if (domain === "galeria.cdn.divany.hu") {
            // https://galeria.cdn.divany.hu/tejbenvajban/2016/07/05/70_eves_a_bikini/12190389_32ac79914cd1607d4d558e9215c7367a_m.jpg -- 644x1000
            //   https://galeria.cdn.divany.hu/tejbenvajban/2016/07/05/70_eves_a_bikini/12190389_32ac79914cd1607d4d558e9215c7367a_y.jpg -- 1159×1800
            //   https://galeria.cdn.divany.hu/tejbenvajban/2016/07/05/70_eves_a_bikini/12190389_32ac79914cd1607d4d558e9215c7367a.jpg -- 2567x3986
            return src.replace(/(\/[0-9]+_[0-9a-f]+)_[a-z](\.[^/.]*)$/, "$1$2");
        }

        if (domain === "img.cncenter.cz") {
            // https://img.cncenter.cz/img/3/gsmall/2479246_.jpg
            //   https://img.cncenter.cz/img/3/full/2479246_.jpg
            return src.replace(/(\/img\/[0-9]+\/)[a-z]+(\/[^/]*)$/, "$1full$2");
        }

        if (domain_nowww === "cosmopolitan.de") {
            // https://www.cosmopolitan.de/bilder/300x300/2016/07/22/84841-dekollete-contouring-so-einfach-schminkst-du-deinen-busen-groesser.jpg?itok=uYfU4n5O
            //   http://www.cosmopolitan.de/bilder/610/2016/07/22/84841-dekollete-contouring-so-einfach-schminkst-du-deinen-busen-groesser.jpg?itok=z9s-r8pE
            //   https://www.cosmopolitan.de/assets/2016/07/22/84841-dekollete-contouring-so-einfach-schminkst-du-deinen-busen-groesser.jpg?itok=uYfU4n5O
            return src.replace(/\/bilder\/[0-9]+(?:x[0-9]+)?\//, "/assets/");
        }

        if (domain === "d1o73ibskzeirn.cloudfront.net") {
            // https://d1o73ibskzeirn.cloudfront.net/168x168/content/generic/1517912290.4027.gif
            //   https://d1o73ibskzeirn.cloudfront.net/0x0/content/generic/1517912290.4027.gif
            return src.replace(/(:\/\/[^/]*\/)[0-9]+x[0-9]+\/content\//, "$10x0/content/");
        }

        if (domain_nowww === "elle.co.za") {
            // https://www.elle.co.za/uploads/files/_768xAUTO_crop_center-center/Screen-Shot-2018-03-09-at-11.17.38-AM.png
            //   https://www.elle.co.za/uploads/files/Screen-Shot-2018-03-09-at-11.17.38-AM.png
            return src.replace(/\/uploads\/files\/_[0-9AUTO]+x[0-9AUTO]+[^/]*\//, "/uploads/files/");
        }

        if (domain_nowww === "kartinnay-galerey.ru") {
            // https://kartinnay-galerey.ru/uploads/posts/news_thumb/2018-05/romi-streyd-v-svadebnom-plate-horoshee-nastroenie_7.jpeg
            //   https://kartinnay-galerey.ru/uploads/posts/2018-05/romi-streyd-v-svadebnom-plate-horoshee-nastroenie_7.jpeg
            return src.replace(/\/uploads\/posts\/news_thumb\//, "/uploads/posts/");
        }

        if (domain_nowww === "imhomir.com") {
            // http://imhomir.com/uploads/topics/preview/00/02/16/15/4941b45ad6_235.jpg -- 235x354
            //   http://imhomir.com/uploads/topics/preview/00/02/16/15/4941b45ad6.jpg -- 662x997
            return src.replace(/(\/uploads\/[a-z]+\/preview\/.*)_[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "mumsnet.com") {
            // https://www.mumsnet.com/uploads/talk/201602/large-876231-margot-robbie-oscars-2016-red-carpet-vogue-28feb16-getty-b-592x888.jpg
            //   https://www.mumsnet.com/uploads/talk/201602/876231-margot-robbie-oscars-2016-red-carpet-vogue-28feb16-getty-b-592x888.jpg
            return src.replace(/(\/uploads\/talk\/[0-9]+\/)[a-z]+-([0-9]+-[^/]*)$/, "$1$2");
        }

        if (domain === "static.stylemagazin.hu") {
            // http://static.stylemagazin.hu/medias/87150/120x120/Oscar-ruha_594464b87fc78093ce253b95e3456ae0.jpg
            //   http://static.stylemagazin.hu/medias/87150/Oscar-ruha_594464b87fc78093ce253b95e3456ae0.jpg
            return src.replace(/(\/medias\/[0-9]+\/)[0-9]+x[0-9]+\//, "$1");
        }

        if (domain === "img.thoibao.today") {
            // http://img.thoibao.today/home/fetch?u=http%3A%2F%2Fk14.vcmedia.vn%2Fthumb_w%2F600%2F2016%2F15-1456708833735.jpg -- redirects to
            //   http://img.thoibao.today/Content/fetch/http___k14_vcmedia_vn_thumb_w_600_2016_15-1456708833735.jpg
            //   http://k14.vcmedia.vn/thumb_w/600/2016/15-1456708833735.jpg -- doesn't exist?
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/home\/fetch.*?[?&]u=([^&]*).*?$/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);
        }

        if (amazon_container === "photo.elcinema.com") {
            // http://photo.elcinema.com.s3.amazonaws.com/uploads/_640x_aa64a53316b52d94e76da3981ad2e103d363612fbfb7210ca1c5a154c707d5b4.jpg
            //   http://photo.elcinema.com.s3.amazonaws.com/uploads/aa64a53316b52d94e76da3981ad2e103d363612fbfb7210ca1c5a154c707d5b4.jpg
            // http://photo.elcinema.com.s3.amazonaws.com/uploads/_315x420_95603e1b0b0ed02d0f8151643ccff9d5b9a4333ef78d928cd6c8df0d2d8ed9bc.jpg
            //   http://photo.elcinema.com.s3.amazonaws.com/uploads/95603e1b0b0ed02d0f8151643ccff9d5b9a4333ef78d928cd6c8df0d2d8ed9bc.jpg
            return src.replace(/\/uploads\/_[0-9]+x(?:[0-9]+)?_([0-9a-f]+\.[^/.]*)$/, "/uploads/$1");
        }

        if (domain_nowww === "colors.life") {
            // https://www.colors.life/upload/blogs/f6/1f/f61fbe46c12ba6d65f1928ffebda620c_RSZ_690.jpg
            //   https://www.colors.life/upload/blogs/f6/1f/f61fbe46c12ba6d65f1928ffebda620c.jpg
            return src.replace(/(\/upload\/blogs\/[0-9a-f]{2}\/[0-9a-f]{2}\/[0-9a-f]+)_RSZ_[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "clickatlife.gr" && false) {
            // https://www.clickatlife.gr/fu/p/119829/1200/100/0000000000589d8d/1/oscartime-2.jpg
            // high width stretches it, high height doesn't
            //return src.replace(/(\/p\/[0-9]+\/)[0-9]+\/[0-9]+\//, "$1999999999/999999999/");
        }

        if (domain_nosub === "tnews.ir" && domain.match(/^i[0-9]*\./)) {
            // https://i2.tnews.ir/2018/01/25/Thumbnail/104244481_129508645febef.jpg
            //   https://i2.tnews.ir/2018/01/25/104244481_129508645febef.jpg
            return src.replace(/(\/[0-9]+\/[0-9]+\/[0-9]+\/)Thumbnail\//, "$1");
        }

        if (domain === "multimedia.mmc.com.do") {
            // http://multimedia.mmc.com.do/multimedia/multimedia/2018/01/08/16e0ca7197cee4f803769eaa48b953bb_maxh_347x520.jpg
            //   http://multimedia.mmc.com.do/multimedia/multimedia/2018/01/08/16e0ca7197cee4f803769eaa48b953bb.jpg
            return src.replace(/(\/multimedia\/[0-9]+\/[0-9]+\/[0-9]+\/[0-9a-f]+)_max.?_[0-9]+x[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "img.europapress.es") {
            // https://img.europapress.es/fotoweb/fotogaleriafamosos_185837_680.jpg
            //   https://img.europapress.es/fotoweb/fotogaleriafamosos_185837.jpg
            return src.replace(/(\/fotoweb\/[a-z]+_[0-9]+)_[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "img.estadao.com.br") {
            // https://img.estadao.com.br/thumbs/940/resources/jpg/8/7/1515373465478.jpg
            //   https://img.estadao.com.br/resources/jpg/8/7/1515373465478.jpg
            return src.replace(/\/thumbs\/[0-9]+\/resources\//, "/resources/");
        }

        if (domain_nosub === "asianews.cc" &&
            domain.match(/^s[0-9]*\./)) {
            // https://s1.asianews.cc/201809/19dad57188b898e3445a8fd01a6b2f30_thum.jpg
            //   https://s1.asianews.cc/201809/19dad57188b898e3445a8fd01a6b2f30_orgn.jpg
            return src.replace(/(\/[0-9]+\/[0-9a-f]+)_[a-z]+(\.[^/.]*)$/, "$1_orgn$2");
        }

        if (domain_nosub === "wallpapermix.club") {
            // http://wallpapermix.club/shared/doc/wallpaper/img/s/actress_karen_gillian_photoshoot-1515118545.jpg -- 400x400
            //   http://wallpapermix.club/shared/doc/wallpaper/img/l/actress_karen_gillian_photoshoot-1515118545.jpg -- 1986x1986
            return src.replace(/(\/shared\/doc\/wallpaper\/img\/)[a-z]\//, "$1l/");
        }

        if (domain_nowww === "utaten.com" && src.indexOf("/uploads/images/") >= 0) {
            // https://utaten.com/uploads/images/news/4943/2/image_l.jpeg
            //   https://utaten.com/uploads/images/news/4943/2/image.jpeg
            // https://utaten.com/uploads/images/news/18284/16ac19f8f5bfc99c2a56195a895e947fa165f3cf_100x100.jpeg
            //   https://utaten.com/uploads/images/news/18284/16ac19f8f5bfc99c2a56195a895e947fa165f3cf.jpeg
            return src.replace(/_(?:[a-z]|[0-9]+x[0-9]+)(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "frostsnow.com") {
            // https://frostsnow.com/uploads/gossip/2016/07/15/360x225/xdid-you-know-what-cnn-election-analyst-jennifer-agiesta-did-before-starting-her-cnn-career.jpeg.pagespeed.ic.yCYobxBryF.jpg
            //   https://frostsnow.com/uploads/gossip/2016/07/15/did-you-know-what-cnn-election-analyst-jennifer-agiesta-did-before-starting-her-cnn-career.jpg
            // https://frostsnow.com/uploads/news/2017/05/26/xbaywatch-actress-priyanka-chopra-s-production-banner-announces-six-films-at-cannes-film-festival.jpg.pagespeed.ic.t6hWvA5aNx.jpg
            //   https://frostsnow.com/uploads/news/2017/05/26/baywatch-actress-priyanka-chopra-s-production-banner-announces-six-films-at-cannes-film-festival.jpg
            return add_extensions_with_jpeg(src
                                            .replace(/\/x([^/.]*\.[^/.]*)\.pagespeed\.[^/]*$/, "/$1")
                                            .replace(/\/[0-9]+x[0-9]+\/([^/]*)$/, "/$1"));
        }

        if (domain_nowww === "mewch.net") {
            // https://mewch.net/.media/t_d2831e5aac58339eb9799388464fc9df-imagejpeg
            //   https://mewch.net/.media/d2831e5aac58339eb9799388464fc9df-imagejpeg.jpg
            return src.replace(/\/\.media\/t_([0-9a-f]+-imagejpeg)(?:[?#].*)?$/, "/.media/$1.jpg");
        }

        if (domain === "media.mehrnews.com") {
            // https://media.mehrnews.com/old/Larg1/1393/01/24/IMG09484014.jpg
            //   https://media.mehrnews.com/old/Original/1393/01/24/IMG09484014.jpg
            return src.replace(/\/old\/[^/]*\/([0-9]+\/)/, "/old/Original/$1");
        }

        if (domain_nowww === "barking-moonbat.com") {
            // http://www.barking-moonbat.com/images/uploads/copper_mine_landslide_2_thumb.jpg
            //   http://www.barking-moonbat.com/images/uploads/copper_mine_landslide_2.jpg
            return src.replace(/(\/images\/uploads\/[^/]*)_thumb(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "deseretnews.com") {
            // https://www.deseretnews.com/images/article/midres/1119476/1119476.jpg
            //   https://www.deseretnews.com/images/article/hires/1119476/1119476.jpg
            return src.replace(/\/images\/article\/[a-z]+res\//, "/images/article/hires/");
        }

        if (domain_nowww === "orsm.net") {
            // https://www.orsm.net/i/galleries/random-shite-2017-08-17/thumbnails/random-shite-2017-08-17-08.jpg
            //   https://www.orsm.net/i/galleries/random-shite-2017-08-17/random-shite-2017-08-17-08.jpg
            return src.replace(/(\/i\/galleries\/[^/]*\/)thumbnails\//, "$1");
        }

        if (domain_nowww === "niklife.com.ua") {
            // http://niklife.com.ua/680x510W/images/2013_12/40518_17_948x600.jpeg
            //   http://niklife.com.ua/images/2013_12/40518_17_948x600.jpeg
            return src.replace(/(:\/\/[^/]*\/)[0-9]+x[0-9]+[A-Z]?\/images\//, "$1images/");
        }

        if (domain === "img.ef43.com.cn") {
            // http://img.ef43.com.cn/newsImages/2013/5/25102842136small.jpg
            //   http://img.ef43.com.cn/newsImages/2013/5/25102842136.jpg
            return src.replace(/(\/newsImages\/[0-9]+\/[0-9]+\/[0-9]+)small(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "st.clopotel.t1.ro") {
            // http://st.clopotel.t1.ro/_files/datafiles/vedete/poze/thumbs/1706.jpg
            //   http://st.clopotel.t1.ro/_files/datafiles/vedete/poze/1706.jpg
            return src.replace(/(\/_files\/datafiles\/.*\/)thumbs\/([0-9]+\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "akamaized.net" &&
            domain.match(/^cdn[0-9]*-production-images-kly\./)) {
            // https://cdn0-production-images-kly.akamaized.net/du9wg7rl9-EJ1nj2GU_SiJU_Sa4=/535x710/smart/filters:quality(75):strip_icc():format(jpeg)/kly-media-production/medias/1528771/original/fc327fd09a4441d25f6a49431da40f4370.jpg
            //   https://cdn-production-assets-kly.akamaized.net/medias/1528771/original/fc327fd09a4441d25f6a49431da40f4370.jpg
            //   https://cdn0-production-assets-kly.akamaized.net/medias/1528771/original/fc327fd09a4441d25f6a49431da40f4370.jpg
            // https://cdn1-production-images-kly.akamaized.net/b3twF7fVlOQqKXZ2Od6vJL80HFc=/673x379/smart/filters:quality(75):strip_icc():format(jpeg)/kly-media-production/thumbnails/1850982/original/050925300_1517330947-gadis-wonogiri-dipersunting-bule-ganteng-asal-selandia-baru-d27917.jpg
            //   https://cdn-production-assets-kly.akamaized.net/thumbnails/1850982/original/050925300_1517330947-gadis-wonogiri-dipersunting-bule-ganteng-asal-selandia-baru-d27917.jpg
            return src.replace(/:\/\/[^/]*\/.*?\/kly-media-production\/([a-z]+\/[0-9]+\/)/, "://cdn-production-assets-kly.akamaized.net/$1");
        }

        if (domain === "cdn.xn--cumpleaosdefamosos-t0b.com") {
            // https://cdn.xn--cumpleaosdefamosos-t0b.com/gallery/2017/1/emmy-rossum/emmy-rossum-2014-jeff-vespa-el-arte-del-descubrimiento_thumb.jpg
            //   https://cdn.xn--cumpleaosdefamosos-t0b.com/gallery/2017/1/emmy-rossum/emmy-rossum-2014-jeff-vespa-el-arte-del-descubrimiento.jpg
            return src.replace(/(\/gallery\/[0-9]+\/[0-9]+\/[^/]*\/[^/]*)_thumb(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "up.zhuoku.org" ||
            // http://up.padtu.com/pic_360/b3/63/2f/b3632fbe12a5b684106148ded6dc96f9.jpg
            //   http://up.padtu.com/pic/b3/63/2f/b3632fbe12a5b684106148ded6dc96f9.jpg
            domain === "up.padtu.com" ||
            // http://up.8desk.com/12/pic_360/fe/06/54/fe0654c871b4ea84ac99a4773542d3b1.jpg
            //   http://up.8desk.com/12/pic/fe/06/54/fe0654c871b4ea84ac99a4773542d3b1.jpg
            domain === "up.8desk.com") {
            // http://up.zhuoku.org/pic_360/6b/76/41/6b7641d45646cfffee39818463a57b92.jpg
            //   http://up.zhuoku.org/pic/6b/76/41/6b7641d45646cfffee39818463a57b92.jpg
            return src.replace(/\/pic_[0-9]+\//, "/pic/");
        }

        if (domain_nowww === "apherald.com" && src.indexOf("/ImageStore/images/") >= 0) {
            // https://www.apherald.com/ImageStore/images/movies/movies-actress/tn-Emmy-Rossum-Latest-Photoshoot-Stills19.jpg
            //   https://www.apherald.com/ImageStore/images/movies/movies-actress/Emmy-Rossum-Latest-Photoshoot-Stills19.jpg
            return src.replace(/\/tn-([^/]*)$/, "/$1");
        }

        if (domain_nowww === "luxo.co.za") {
            // http://www.luxo.co.za/system-files/small/selena-gomez-at-veni-1346868458.jpg
            //   http://www.luxo.co.za/system-files/selena-gomez-at-veni-1346868458.jpg
            return src.replace(/\/system-files\/[a-z]+\//, "/system-files/");
        }

        if (domain_nowww === "longroom.com") {
            // https://www.longroom.com/uploads/stock/hm_1100528.jpg
            //   https://www.longroom.com/uploads/stock/1100528.jpg
            return src.replace(/\/uploads\/stock\/[a-z]+_([0-9]+\.[^/.]*)$/, "/uploads/stock/$1");
        }

        if (domain === "img.cdn.cennoticias.com") {
            // http://img.cdn.cennoticias.com/67569b0b-476c-4e06-bf37-2ad80d8f5936?allowRedirect=true
            //   http://raw.cdn.cennoticias.com/67569b0b-476c-4e06-bf37-2ad80d8f5936
            return src.replace(/:\/\/[^/]*\/([-0-9a-f]+)(?:[?#].*)?$/, "://raw.cdn.cennoticias.com/$1");
        }

        if (domain === "cdn-tehran.wisgoon.com") {
            // http://cdn-tehran.wisgoon.com/dlir-s3/1053500x625_1472821254218324.jpg -- 500x625
            //   http://cdn-tehran.wisgoon.com/dlir-s3/10531472821254218324.jpg
            //   http://cdn-tehran.wisgoon.com/dlir-s3/1472821254218324.jpg -- 404
            // http://cdn-tehran.wisgoon.com/dlir-s3/236x335_1534720001305721.jpg
            //   http://cdn-tehran.wisgoon.com/dlir-s3/1534720001305721.jpg

            return src.replace(/\/dlir-s3\/([0-9]+)?[0-9]{3}x[0-9]{3}_([0-9]+\.[^/.]*)$/, "/dlir-s3/$1$2");
        }

        if (domain === "s.stylemode.com") {
            // http://s.stylemode.com/uploads/article_desc/640x640/2016/08/05/20160805104319_65072.jpg -- 500x700, watermark
            //   http://s.stylemode.com/uploads/article_desc/deal/2016/08/05/20160805104319_65072.jpg -- same as above
            //   http://s.stylemode.com/uploads/article_desc/origin/2016/08/05/20160805104319_65072.jpg -- 500x700, no watermark
            // http://s.stylemode.com/uploads/blog_desc/640x640/2016/02/25/20160225070143_88064.jpg -- 640x426
            //   http://s.stylemode.com/uploads/blog_desc/origin/2016/02/25/20160225070143_88064.jpg -- 1843x1229
            // http://s.stylemode.com/uploads/album_detail/640x640/2015/02/20150226064643_64454.jpg -- 640x959, no watermark
            //   http://s.stylemode.com/uploads/album_detail/deal/2015/02/20150226064643_64454.jpg -- 1366x2048, watermark
            //   http://s.stylemode.com/uploads/album_detail/origin/2015/02/20150226064643_64454.jpg -- 1366x2048, no watermark
            // http://s.stylemode.com/uploads/article/382x480/2018/06/20180629072850_92505.jpg
            //   http://s.stylemode.com/uploads/article/origin/2018/06/20180629072850_92505.jpg
            // http://s.stylemode.com/uploads/recommend/deal/2018/09/20180907110017_19778.jpg
            //   http://s.stylemode.com/uploads/recommend/origin/2018/09/20180907110017_19778.jpg -- same as above
            return src.replace(/(\/uploads\/(?:(?:article|blog|album|recommend)(?:_desc|detail)?)\/)(?:[0-9]+x[0-9]+|deal)\//, "$1origin/");
        }

        if (domain_nosub === "akairan.com" && domain.match(/^cdn[0-9]*\./) &&
            src.indexOf("/files/images/") >= 0) {
            // https://cdn53.akairan.com/files/images/20186/19/20186191817112885728awaterM.jpg -- watermark
            //   https://cdn53.akairan.com/files/images/20186/19/20186191817112885728a.jpg -- no watermark
            return src.replace(/waterM(\.[^/.]*)$/, "$1");
        }

        if (domain === "cdn.idntimes.com" && src.indexOf("/content-images/") >= 0) {
            // https://cdn.idntimes.com/content-images/community/2017/08/6cdff28fa924ff873351ff744d0b5751-hair-and-makeup-beauty-makeup-2e2cd63689fd60e873cbd27ef9c1a342_600xauto.jpg
            //   https://cdn.idntimes.com/content-images/community/2017/08/6cdff28fa924ff873351ff744d0b5751-hair-and-makeup-beauty-makeup-2e2cd63689fd60e873cbd27ef9c1a342.jpg
            return src.replace(/_[0-9auto]+x[0-9auto]+(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "comicsblog.fr") {
            // http://www.comicsblog.fr//images/galerie/smallimage/small_the-laughing-fish-batman-tas.jpg
            //   http://www.comicsblog.fr//images/galerie/bigimage/the-laughing-fish-batman-tas.jpg
            return src.replace(/\/images\/galerie\/[a-z]+image\/(?:small_)?/, "/images/galerie/bigimage/");
        }

        if (domain === "ent.sina.com.cn") {
            // http://ent.sina.com.cn/n.sinaimg.cn/ent/transform/w446h299/20180308/TWeg-fysanuf7233873.jpg
            //   http://n.sinaimg.cn/ent/transform/w446h299/20180308/TWeg-fysanuf7233873.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/([^/]*\.sinaimg\.cn\/)/, "http://$1");
        }

        if (domain_nowww === "analisadaily.com") {
            // http://analisadaily.com/assets/image/news/small/2018/08/elizabeth-banks-bintangi-queen-for-a-day-604270-1.jpg
            //   http://analisadaily.com/assets/image/news/big/2018/08/elizabeth-banks-bintangi-queen-for-a-day-604270-1.jpg
            return src.replace(/\/assets\/image\/news\/small\//, "/assets/image/news/big/");
        }

        if (domain === "fi.realself.com") {
            // https://fi.realself.com/small/0ceb0a64f3e0a74cbbfef9b42ce441bd/a/2/d/userimage-868845.jpg
            //   https://fi.realself.com/full/0ceb0a64f3e0a74cbbfef9b42ce441bd/a/2/d/userimage-868845.jpg
            return src.replace(/(:\/\/[^/]*\/)[a-z]+(\/[0-9a-f]+\/)/, "$1full$2");
        }

        if (domain_nosub === "babeimpact.com" && domain.match(/^content[0-9]*\./)) {
            // https://content4.babeimpact.com/celebmatrix.com/1604/Paula_Bulczynska_tn_09.jpg
            //   https://content4.babeimpact.com/celebmatrix.com/1604/Paula_Bulczynska_09.jpg
            return src.replace(/_tn(_[0-9]+\.[^/.]*)$/, "$1");
        }

        if (domain === "i.widelec.org") {
            // http://i.widelec.org/3nnj_s.jpg
            //   http://i.widelec.org/3nnj.jpg
            // http://i.widelec.org/zdjecia/4491/2017071812093810_c.jpg
            //   http://i.widelec.org/zdjecia/4491/2017071812093810.jpg
            return src.replace(/_[a-z](\.[^/.]*)$/, "$1");
        }

        if (domain === "image.kurier.at") {
            // https://image.kurier.at/images/cfs_616w/25149/08050907_ppsvie.jpg
            //   https://image.kurier.at/images/original/25149/08050907_ppsvie.jpg
            return src.replace(/\/images\/[^/]*(\/[0-9]+\/)/, "/images/original$1");
        }

        if (domain === "media.game8.vn") {
            // http://media.game8.vn/media2/game8/2015/09/23/c5-3.jpg.310.233.cache
            //   http://media.game8.vn/srv_thumb.ashx?w=jpg&h=310&f=/media2/game8/2015/09/23/c5-3
            //   http://media.game8.vn/media2/game8/2015/09/23/c5-3 -- works, but has no content type (displays as text)
            //   http://media.game8.vn/media2/game8/2015/09/23/c5-3.jpg
            newsrc = src.replace(/\.[0-9]+\.(?:[0-9]+\.)?cache(?:[?#].*)?$/, "");
            if (newsrc !== src)
                return newsrc;

            if (src.indexOf("/srv_thumb.ashx") >= 0) {
                return urljoin("http://media.game8.vn/", url.searchParams.get("f"), true) + "." + url.searchParams.get("w");
            }
        }

        if (domain_nosub === "xiongyan.tv" &&
            domain.match(/^img[0-9]*\./)) {
            // http://img2.xiongyan.tv/Public/upload/gallery/51lol/other/half_58cf4bd6e9b4bP4B.jpg
            //   http://img2.xiongyan.tv/Public/upload/gallery/51lol/other/origin_58cf4bd6e9b4bP4B.jpg
            // http://img2.xiongyan.tv/Public/upload/gallery/51lol/other/half_58cf4bd6ca93cYee.jpg
            //   http://img2.xiongyan.tv/Public/upload/gallery/51lol/other/origin_58cf4bd6ca93cYee.jpg
            return src.replace(/\/[a-z]+_([0-9a-f]+[0-9A-Za-z]+\.[^/.]*)$/, "/origin_$1");
        }

        if (domain_nowww === "coffelt.me") {
            // https://coffelt.me/image?id=6461696c796d6f74696f6e2678366c32726d7a&q=http://s1.dmcdn.net/qkD1H.jpg
            //   http://s1.dmcdn.net/qkD1H.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/image.*?[?&]q=([^&]*)$/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);
        }

        if (domain === "kiev.segodnya.ua") {
            // https://kiev.segodnya.ua/img/gallery/5498/40/582407_tn.jpg
            //   https://kiev.segodnya.ua/img/gallery/5498/40/582407_main.jpg
            return src.replace(/(\/img\/gallery\/[0-9]+\/[0-9]+\/[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1_main$2");
        }

        if (domain === "image.jjang0u.service.concdn.com") {
            // http://image.jjang0u.service.concdn.com/data3/chalkadak/162/201204/23/t_133516093835090.jpg
            //   http://image.jjang0u.service.concdn.com/data3/chalkadak/162/201204/23/133516093835090.jpg
            return src.replace(/\/t_([0-9]+\.[^/.]*)$/, "/$1");
        }

        if (domain_nowww === "fotoshoots.be") {
            // http://www.fotoshoots.be/images/fotografen/9891/thumbs//fotoshoots_be-fotograaf-9891-1-1500543888.JPG
            //   http://www.fotoshoots.be/images/fotografen/9891//fotoshoots_be-fotograaf-9891-1-1500543888.JPG
            return src.replace(/(\/images\/fotografen\/[0-9]+\/)thumbs\//, "$1");
        }

        if (domain_nosub === "tapatalk.com") {
            // https://www.tapatalk.com/groups/anthroscape/imageproxy.php?url=http://i300.photobucket.com/albums/nn24/ashleyvale/Sexy%20Steampunk%20Engineer%201_zps80aeq6tz.png
            //   http://i300.photobucket.com/albums/nn24/ashleyvale/Sexy%20Steampunk%20Engineer%201_zps80aeq6tz.png
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/groups\/[^/]*\/imageproxy\.php.*?[?&]url=([^&]*).*?$/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);
        }

        if (domain === "dl.backbook.me") {
            // https://dl.backbook.me/preview_rect/9ef5ca80a6.jpg
            //   https://dl.backbook.me/full/9ef5ca80a6.jpg
            return src.replace(/(:\/\/[^/]*\/)[a-z_]+(\/[0-9a-f]+\.[^/.]*)$/, "$1full$2");
        }

        if (domain === "nthumb.cyworld.com") {
            // http://nthumb.cyworld.com/thumb?width=810&url=http%3A%2F%2Fc2down.cyworld.co.kr%2Fdownload%3Ffid%3D642235ae2c277c8ce4e435bc8a41722a%26name%3D07.jpg
            //   http://c2down.cyworld.co.kr/download?fid=642235ae2c277c8ce4e435bc8a41722a&name=07.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/thumb.*?[?&]url=([^&]*).*?$/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);
        }

        if (domain === "e.porosenka.net") {
            // https://e.porosenka.net/uploads/a/d/ad4341cf93c4e1e3de869903348e0708_small.jpg
            //   https://e.porosenka.net/uploads/a/d/ad4341cf93c4e1e3de869903348e0708.jpg
            return src.replace(/(\/uploads\/[0-9a-f]\/[0-9a-f]+\/[0-9a-f]+)_[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "qhimg.com" && domain.match(/^p[0-9]*\./)) {
            // https://p1.ssl.qhimg.com/sdm/180_100_/t01c8a2e57eb3f030a5.png
            //   https://p1.ssl.qhimg.com/t01c8a2e57eb3f030a5.png
            return src.replace(/\/sdm\/[0-9]+_[0-9]+_\//, "/");
        }

        if (domain_nosub === "gamersky.com" && domain.match(/^img[0-9]*\./)) {
            // http://img1.gamersky.com/upimg/pic/2018/04/24/201804241437415526_tiny.jpg
            //   http://img1.gamersky.com/upimg/pic/2018/04/24/201804241437415526.jpg
            // http://img1.gamersky.com/upimg/users/2018/04/03/small_201804031127123136.jpg
            //   http://img1.gamersky.com/upimg/users/2018/04/03/origin_201804031127123136.jpg
            // wip:
            // http://img1.gamersky.com/image2018/09/20180927_lr_176_1/gamersky_05small_10_201892710124AE.jpg
            //   http://img1.gamersky.com/image2018/09/20180927_lr_176_1/gamersky_05origin_09_2018927101216A.jpg
            return src
                .replace(/(\/upimg\/pic\/[0-9]{4}\/[0-9]{2}\/[0-9]{2}\/[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1$2")
                .replace(/(\/upimg\/users\/[0-9]{4}\/[0-9]{2}\/[0-9]{2}\/)[a-z]+_([^/]*)$/, "$1origin_$2");
        }

        if (domain_nosub === "game234.com" && domain.match(/^webimg[0-9]*\./)) {
            // http://webimg1.game234.com/http://i-4.yxdown.com/2018/3/30/KDYwMHgp/a9be3ebb-50a7-4993-9cfb-c1a3ddc3ff61.png
            //   http://i-4-yxdown.715083.com/2018/3/30/a9be3ebb-50a7-4993-9cfb-c1a3ddc3ff61.png?imageView2/2/q/65/w/600 -- broken with referrer
            return src.replace(/^[a-z]+:\/\/[^/]*\/([a-z]+:\/\/)/, "$1");
        }

        if (domain === "cdn.snsimg.carview.co.jp") {
            // https://cdn.snsimg.carview.co.jp/minkara/blog/000/025/020/952/25020952/p1s.jpg
            //   https://cdn.snsimg.carview.co.jp/minkara/blog/000/025/020/952/25020952/p1.jpg
            return src.replace(/(\/blog\/(?:[0-9]+\/){5}[^/]*)[sm](\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "wallpapersontheweb.net") {
            // http://wallpapersontheweb.net/wallpapers/m/a-dog_looking_at_the_sea_animals_dog_sea-550.jpg
            //   http://wallpapersontheweb.net/wallpapers/b/3750x3000/3750x3000-dog_looking_at_the_sea_animals_dog_sea-550.jpg -- upscaled?
            //   http://wallpapersontheweb.net/wallpapers/l/dog_looking_at_the_sea_animals_dog_sea-550.jpg -- 1920x1200 (The original resolution that this wallpaper is uploaded : 1920x1200)
            // http://wallpapersontheweb.net/wallpapers/l/vica_kerekes_women_face-13576.jpg
            //   http://wallpapersontheweb.net/wallpapers/l/vica_kerekes_women_face-13576.jpg -- 4288x2848
            regex = /\/wallpapers\/[a-z]\/(?:(?:[0-9]+x[0-9]+)?\/)?(?:(?:[a-z]|[0-9]+x[0-9]+)-)?([^/]*)-([0-9]+)(\.[^/.]*)$/;
            return {
                url: src.replace(regex, "/wallpapers/l/$1-$2$3"),
                headers: {
                    Referer: src.replace(regex, "/$2-$1/")
                }
            };
        }

        if (domain_nosub === "funon.cc" && domain.match(/^s[0-9]*\./)) {
            // https://s1.funon.cc/img/thumb/201510/29/56325fd18a79e.jpg
            //   https://s1.funon.cc/img/orig/201510/29/56325fd18a79e.jpg
            return src.replace(/(\/img\/)[a-z]+(\/[0-9]+\/)/, "$1orig$2");
        }

        if (domain === "img.joemonster.org") {
            // https://img.joemonster.org/upload/qnp/l_1299836adea5b70k.jpg
            //   https://img.joemonster.org/upload/qnp/1299836adea5b70k.jpg
            return src.replace(/(\/upload\/[^/]*\/)[a-z]_([0-9a-f]+[0-9a-z]+\.[^/.]*)$/, "$1$2");
        }

        if (domain === "mobimg.b-cdn.net") {
            // https://mobimg.b-cdn.net/pic/v2/gallery/111x185/aktery-devushki-ika_erekesh_vica_kerekes-lyudi-17894.jpg -- 111x185
            //   https://mobimg.b-cdn.net/pic/v2/gallery/preview/aktery-devushki-ika_erekesh_vica_kerekes-lyudi-17894.jpg -- 1120x700
            //   https://mobimg.b-cdn.net/pic/v2/gallery/real/aktery-devushki-ika_erekesh_vica_kerekes-lyudi-17894.jpg -- 1680x1050
            return src.replace(/\/pic\/v2\/gallery\/[^/]*\//, "/pic/v2/gallery/real/");
        }

        if (domain === "img.wanduorou.com") {
            // http://img.wanduorou.com/imgs/i.gbc.tw/gb_img/3840974l.jpg
            //   http://i.gbc.tw/gb_img/3840974l.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/imgs\/([^/.]*\.[^/]*\/)/, "http://$1");
        }

        if (domain === "i.gbc.tw") {
            // http://i.gbc.tw/gb_img/3840974l.jpg -- 600x902
            //   http://i.gbc.tw/gb_img/3840974m.jpg -- 200x300
            //   http://i.gbc.tw/gb_img/3840974.jpg -- 624x939
            return src.replace(/(\/gb_img\/[0-9]+)[a-z](\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "xuehuaimg.com" &&
            domain.match(/^pic[0-9]*\./)) {
            // https://pic1.xuehuaimg.com/proxy/https://i.gbc.tw/gb_img/3840974l.jpg
            //   https://i.gbc.tw/gb_img/3840974l.jpg
            return src.replace(/^[a-z]+:\/\/[^/]*\/proxy\/([a-z]+:\/\/)/, "$1");
        }

        if (domain === "img.tgchengzi.com") {
            // http://img.tgchengzi.com/Uploads/ueditor/php/upload/image/20180927/1538020617568109_l.jpg -- watermark
            //   http://img.tgchengzi.com/Uploads/ueditor/php/upload/image/20180927/1538020617568109.jpg -- no watermark
            return src.replace(/(\/Uploads\/ueditor\/php\/upload\/image\/[0-9]+\/[0-9]+)_[a-z](\.[^/.]*)$/, "$1$2");
        }

        if (domain_nosub === "doyo.cn" &&
            domain.match(/^s[0-9]*\./)) {
            // http://s1.doyo.cn/img/55/36/01c89e9e784a3e0001e4.jpg_news
            //   http://s1.doyo.cn/img/55/36/01c89e9e784a3e0001e4.jpg -- 650x433
            return src.replace(/(\/img\/(?:[0-9a-f]{2}\/){2}[0-9a-f]+\.[^/._]*)_[a-z]+(?:[?#].*)?$/, "$1");
        }

        if (domain === "newsimg.hankookilbo.com" ||
            // http://betaimage.hankookilbo.com/level/2018/10/10/516a1b8e-f0e2-49f2-b1be-9bc7a651fab3_t.jpg
            //   http://betaimage.hankookilbo.com/level/2018/10/10/516a1b8e-f0e2-49f2-b1be-9bc7a651fab3.jpg
            domain === "betaimage.hankookilbo.com") {
            // http://newsimg.hankookilbo.com/2018/10/10/201810101339781259_1_t.jpg -- 384x287
            //   http://newsimg.hankookilbo.com/2018/10/10/201810101339781259_1.jpg -- 640x479
            return src.replace(/(\/[0-9]{4}\/[0-9]{2}\/[0-9]{2}\/(?:[0-9]+_[0-9]+|[-0-9a-f]+))_[a-z](\.[^/.]*)$/, "$1$2");
        }

        if (domain === "dispatch.cdnser.be") {
            // https://dispatch.cdnser.be/dispatch_image/2013/12/24/2013122404539998anet_T1_59068.jpg -- 51x100
            //   https://dispatch.cdnser.be/dispatch_image/2013/12/24/2013122404539998anet_T5_59068.jpg -- 1642x3210
            return src.replace(/(\/[0-9]+[^-/_.]*_)T[0-9]*(_[0-9]+\.[^/.]*)$/, "$1T5$2");
        }

        if (domain === "cms.artandarchaeology.princeton.edu") {
            // https://cms.artandarchaeology.princeton.edu/media/thumbnails/jessicawomack.jpg?w=1630&h=1222&c=true&d=true -- upscaled
            //   https://cms.artandarchaeology.princeton.edu/media/files/jessicawomack.jpg
            return src.replace(/\/media\/thumbnails\/([^/?]*)\?.*$/, "/media/files/$1");
        }

        if (domain_nowww === "pronto.com.ar") {
            // https://www.pronto.com.ar/asset/thumbnail%252C998%252C540%252Ccenter%252Ccenter/media/prontoar/images/2018/09/18/2018091813104610387.png -- 333x540
            //   https://www.pronto.com.ar/media/prontoar/images/2018/09/18/2018091813104610387.png -- 882x1430
            return src.replace(/\/asset\/thumbnail[,%][^/]*\/media\//, "/media/");
        }

        if (domain === "cdn.thebest.gr") {
            // http://cdn.thebest.gr/media/images/thumbnail/wekkstmsor5bc22ca4898b6.jpg --140x105
            //   http://cdn.thebest.gr/media/images/original/wekkstmsor5bc22ca4898b6.jpg -- 960x655
            return src.replace(/\/media\/images\/[^/]*\//, "/media/images/original/");
        }

        if (domain_nowww === "glow.gr") {
            // https://glow.gr/portal-img/featured-full/23/vraveia-emmy-2.jpg?crop=1280,647,0,37
            //   https://glow.gr/image/original/23/vraveia-emmy-2.jpg
            // https://glow.gr/portal-img/sq-list/25/vivian-van-singer-3fKcf.jpg
            //   https://glow.gr/image/original/25/vivian-van-singer-3fKcf.jpg
            return src.replace(/(:\/\/[^/]*\/)(?:image|[a-z]+-img)\/[^/]*(\/[0-9]+\/[^/]*\.[^/.?#]*)(?:[?#].*)?$/,
                               "$1image/original$2");
        }

        if (domain_nowww === "scifi-forum.de") {
            // https://www.scifi-forum.de/filedata/fetch?id=4498608&d=1527659360&type=medium -- 216x330
            //   https://www.scifi-forum.de/filedata/fetch?id=4498608 -- 775x1186
            return src.replace(/\/filedata\/fetch.*?[?&](id=[0-9]+).*?$/, "/filedata/fetch?$1");
        }

        if (domain === "cache.net-a-porter.com") {
            // https://cache.net-a-porter.com/content/images/story-body-content-V1-2-1526635489420.jpeg/w1000_q10.jpeg
            //   https://assets.ynap-content.com/story-body-content-V1-2-1526635489420.jpeg
            // https://cache.net-a-porter.com/content/images/story-head-content-SUBBED-1518700752405.jpeg/w1900_q65.jpeg
            //   https://assets.ynap-content.com/story-head-content-SUBBED-1518700752405.jpeg
            // https://cache.net-a-porter.com/content/images/story-body-content-V1-0-1516806140638.jpeg/w1900_q65.jpeg
            //   https://assets.ynap-content.com/story-body-content-V1-0-1516806140638.jpeg
            return src.replace(/^[a-z]+:\/\/[^/]*\/content\/images\/(story-[^/]*\.[^/.]*)\/[^/]*$/, "https://assets.ynap-content.com/$1");
        }

        if (domain_nowww === "celluloidportraits.com" && src.indexOf("/img/") >= 0) {
            // http://www.celluloidportraits.com/img/Registiattori/imgREGISTIeATTORI21/Thandie%20Newton%2010_5816_S.jpg
            //    http://www.celluloidportraits.com/img/Registiattori/imgREGISTIeATTORI21/Thandie%20Newton%2010_5816_L.jpg
            // L, N, S
            return src.replace(/(_[0-9]+_)[A-Z](\.[^/.]*)$/, "$1L$2");
        }

        if (domain_nowww === "nowtoronto.com") {
            // https://nowtoronto.com/downloads/92683/download/Camila-Cabello.jpg?cb=13f90313ffbdd4175ade951c3fa6ce76&w=640
            //   https://nowtoronto.com/downloads/92683/download/Camila-Cabello.jpg?cb=13f90313ffbdd4175ade951c3fa6ce76
            return src.replace(/(\/downloads\/[0-9]+\/download\/[^/?#]*)(?:.*?[?&](cb=[0-9a-f]+).*?)?$/, "$1?$2");
        }

        if (domain === "cde.peru.com") {
            // https://cde.peru.com//ima/0/1/7/7/1/1771314/924x530/becky.jpg
            //   https://cde.peru.com//ima/0/1/7/7/1/1771314/becky.jpg
            return src.replace(/(\/ima\/(?:[0-9]\/){5}[0-9]+\/)[0-9]+x[0-9]+\/([^/]*)$/, "$1$2");
        }

        if (domain_nowww === "celebritytalent.net") {
            // https://www.celebritytalent.net/sampletalent/photos/sm/43319126.jpg
            //   https://www.celebritytalent.net/sampletalent/photos/lg/43319126.jpg
            return src.replace(/\/photos\/[a-z]+\/([0-9]+\.[^/.]*)$/, "/photos/lg/$1");
        }

        if (domain === "img-ovh-cloud.zszywka.pl") {
            // https://img-ovh-cloud.zszywka.pl/1/0669/thb_0429.jpg
            //   https://img-ovh-cloud.zszywka.pl/1/0669/0429.jpg
            return src.replace(/\/thb_([0-9]+\.[^/.]*)$/, "/$1");
        }

        if (domain_nosub === "clickthecity.com" && domain.match(/^cdn[0-9]*\./)) {
            // https://cdn1.clickthecity.com/profiles/200/19229_1.jpg
            //   https://cdn1.clickthecity.com/profiles/19229_1.jpg
            return src.replace(/\/profiles\/[0-9]+(\/[0-9]+(?:_[0-9]+)?\.[^/.]*)$/, "/profiles$1");
        }

        if (domain_nowww === "lafactoriadelshow.com") {
            // https://www.lafactoriadelshow.com/small_5acc8d7fac603_1604661039882031028.jpg
            //   https://www.lafactoriadelshow.com/full_5acc8d7fac603_1604661039882031028.jpg
            return src.replace(/\/[a-z]+_([0-9a-f]+_[0-9]+\.[^/.]*)$/, "/full_$1");
        }

        if (domain_nowww === "elintra.com.ar") {
            // https://www.elintra.com.ar/u/fotografias/m/2018/8/25/f260x146-100007_105447_0.jpg
            //   https://www.elintra.com.ar/u/fotografias/fotosnoticias/2018/8/25/100007.jpg
            return src.replace(/\/fotografias\/m\/([0-9]{4}\/[0-9]+\/[0-9]+\/)f[0-9]+x[0-9]+-([0-9]+)_[0-9]+[^/]*(\.[^/.]*)$/,
                               "/fotografias/fotosnoticias/$1$2$3");
        }

        if (domain === "f.aukro.cz") {
            // https://f.aukro.cz/images/sk6914079582/400x300/787f902d-2dbc-4eb6-a1b6-402d85079b69
            //   https://f.aukro.cz/images/sk6914079582/787f902d-2dbc-4eb6-a1b6-402d85079b69 -- forces download
            return src.replace(/(\/images\/[^/]*\/)[0-9]+x[0-9]+\/([-0-9a-f]+)(?:[?#].*)?$/, "$1$2");
        }

        if (domain_nowww === "wallpapershome.com" ||
            domain_nowww === "wallpapershome.ru" && false) {
            // wip
            // https://wallpapershome.com/celebrities/leslie-grace-beauty-5k-16892.html
            // https://wallpapershome.com/images/pages/ico_v/16892.jpg -- 253x450
            // https://wallpapershome.com/images/pages/pic_h/16892.jpg -- 1920x1080
            // https://wallpapershome.com/images/pages/pic_v/16892.jpg -- 640x1138
            // https://wallpapershome.com/images/wallpapers/leslie-grace-5120x2880-beauty-5k-16892.jpg
            //   https://wallpapershome.com/images/wallpapers/a-5120x2880-16892.jpg -- also works
            //   https://wallpapershome.com/images/wallpapers/a-5880x5880-16892.jpg -- scales up
            //   https://wallpapershome.com/images/wallpapers/-5880x5880-16892.jpg -- doesn't work
            //   https://wallpapershome.com/images/wallpapers/5880x5880-16892.jpg -- doesn't work
            // https://wallpapershome.ru/images/pages/ico_hs/16892.jpg -- 800x450
            // https://wallpapershome.ru/images/pages/ico_h/16892.jpg -- identical to above
            // 0x0 is empty
            // Xx0 seems to return the last image done with the same name/tags, no matter X
        }

        if (domain === "envivoblog.estrellatv.com") {
            // http://envivoblog.estrellatv.com/assets/envivoblog.estrellatv.com/articles/images/06-2018/_resampled/SetWidth360-1524696124-leslie-grace-colabora-con-super-junior.jpg
            //   http://envivoblog.estrellatv.com/assets/envivoblog.estrellatv.com/articles/images/06-2018/1524696124-leslie-grace-colabora-con-super-junior.jpg
            return src.replace(/\/_resampled\/Set(?:Width|Height)[0-9]+-([^/]*)$/, "/$1");
        }

        if (domain === "images.sex.com") {
            // https://images.sex.com/images/pinporn/2017/05/03/300/17715654.jpg
            //   https://images.sex.com/images/pinporn/2017/05/03/620/17715654.jpg -- no watermark
            // https://images.sex.com/images/pinporn/2017/11/03/300/18602164.jpg -- no watermark
            //   https://images.sex.com/images/pinporn/2017/11/03/620/18602164.jpg -- watermark
            return src.replace(/(\/images\/pinporn\/[0-9]{4}\/[0-9]{2}\/[0-9]{2}\/)300\//, "$1620/");
        }

        if (domain === "fotografias.antena3.com" ||
            // https://image.europafm.com/clipping/cmsimages01/2018/10/14/D4C3AFC5-9FF1-456D-9732-AC2F6234F48A/50.jpg -- 1024x400
            //   https://image.europafm.com/clipping/cmsimages01/2018/10/14/D4C3AFC5-9FF1-456D-9732-AC2F6234F48A/18.jpg -- 1408x864, looks stretched
            //   https://image.europafm.com/clipping/cmsimages01/2018/10/14/D4C3AFC5-9FF1-456D-9732-AC2F6234F48A/default.jpg -- 470x486
            domain === "image.europafm.com" ||
            // https://fotografias.atresmediacorporacion.com/clipping/cmsimages01/2018/04/16/9C0DCE85-092F-457C-873E-BB30D26656AF/63.jpg
            //   https://fotografias.atresmediacorporacion.com/clipping/cmsimages01/2018/04/16/9C0DCE85-092F-457C-873E-BB30D26656AF/default.jpg
            //   https://fotografias.atresmediacorporacion.com/2018/04/16/9C0DCE85-092F-457C-873E-BB30D26656AF/default.jpg
            src.match(/^[a-z]+:\/\/[^/]*\/clipping\/cmsimages[0-9]*\/[0-9]{4}\/[0-9]{2}\/[0-9]{2}\/[-0-9A-F]+\/[^/]*\.[^/.]*$/)) {
            // https://fotografias.antena3.com/clipping/cmsimages01/2018/06/25/B83EC976-8270-4642-99FB-3C2E69B63233/53.jpg -- 700x394
            // https://fotografias.antena3.com/clipping/cmsimages01/2018/06/25/B83EC976-8270-4642-99FB-3C2E69B63233/58.jpg -- 1000x567
            //   https://fotografias.antena3.com/2018/06/25/B83EC976-8270-4642-99FB-3C2E69B63233/58.jpg -- same, although non-numbers return 404 instead of a java error:
            // Se ha producido un error de tipo class org.springframework.web.client.HttpServerErrorException con la causa: 500 Internal Server Error al localizar el fichero /cmsimages01/2018/06/25/B83EC976-8270-4642-99FB-3C2E69B63233/0.jpg
            // Se ha producido un error de tipo class java.lang.NumberFormatException con la causa: For input string: "-" al localizar el fichero /cmsimages01/2018/06/25/B83EC976-8270-4642-99FB-3C2E69B63233/-.jpg
            // 18, 54, 57, 69, 67, 55, 16, 51, 22, 58, 4, 14
            // https://fotografias.antena3.com/clipping/cmsimages01/2018/06/25/B83EC976-8270-4642-99FB-3C2E69B63233/18.jpg -- 1407x854
            //   https://fotografias.antena3.com/clipping/cmsimages01/2018/06/25/B83EC976-8270-4642-99FB-3C2E69B63233/default.jpg -- 1920x1282
            return src.replace(/(\/clipping\/cmsimages[0-9]*\/[0-9]{4}\/[0-9]{2}\/[0-9]{2}\/[-0-9A-F]+\/)[^/]*(\.[^/.]*)$/,
                               "$1default$2");
        }

        if (domain_nosub === "nickiswift.com" && domain.match(/^img[0-9]*\./)) {
            // https://img1.nickiswift.com/img/uploads/2018/01/Camila_Cabello_s_Not_So_Nice_Side-780x438_rev1.jpg
            //   https://img1.nickiswift.com/img/uploads/2018/01/Camila_Cabello_s_Not_So_Nice_Side.jpg
            return src.replace(/-[0-9]+x[0-9]+(?:_rev[0-9]*)?(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "marieclaire.ru" && false) {
            // wip, current rule is useless
            // http://www.marieclaire.ru/images/th/2086/6208/7c76/330@500@62087c76fe029aea49984ab5ecda1a89-OTk3YzNiYWVmNg.jpg?time=952
            //   http://www.marieclaire.ru/images/330/500/330@500@62087c76fe029aea49984ab5ecda1a89.jpg
            return src.replace(/\/images\/th\/[0-9a-f]+\/[0-9a-f]+\/[0-9a-f]+\/(([0-9]+)@([0-9]+)@[0-9a-f]+)-[^/.]*(\.[^/.?#]*)(?:[?#].*)?$/,
                               "/images/$2/$3/$1$4");
        }

        if (amazon_container === "sphm-female-site-production") {
            // http://sphm-female-site-production.s3.amazonaws.com/2015/05/want-lily-collins-flawless-skin-750px.jpg
            //   http://sphm-female-site-production.s3.amazonaws.com/2015/05/want-lily-collins-flawless-skin.jpg
            return src.replace(/-[0-9]+px(\.[^/.]*)$/, "$1");
        }

        if (domain_nowww === "maxpapendieck.com") {
            // http://www.maxpapendieck.com/app/webroot/upload/840/lily-collins-image-4-thumb.jpg -- 105x150
            //   http://www.maxpapendieck.com/app/webroot/upload/840/lily-collins-image-4-medium.jpg -- 337x480
            //   http://www.maxpapendieck.com/app/webroot/upload/840/lily-collins-image-4-large.jpg -- 843x1200
            //   http://www.maxpapendieck.com/app/webroot/upload/840/lily-collins-image-4.jpg -- 1406x2000
            return src.replace(/(\/app\/webroot\/upload\/[0-9]+\/[^/]*)-(?:large|medium|thumb)(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "i.mdel.net") {
            // https://i.mdel.net/i/db/2017/1/635631/635631-500w.jpg
            //   https://i.mdel.net/i/db/2017/1/635631/635631-orig.jpg -- 883x1080
            return src.replace(/(\/i\/db\/[0-9]+\/[0-9]+\/[0-9]+\/[0-9]+)-[0-9]+[a-z](\.[^/.]*)$/, "$1-orig$2");
        }

        if (domain === "cdn-img.fimfiction.net") {
            // https://cdn-img.fimfiction.net/story/rhzk-1432553346-172155-medium
            //   https://cdn-img.fimfiction.net/story/rhzk-1432553346-172155-full
            // https://cdn-img.fimfiction.net/user/z6pg-1431818522-935-160
            //   https://cdn-img.fimfiction.net/user/z6pg-1431818522-935-512
            return src
                .replace(/(\/story\/[^-/]*-[0-9]+-[0-9]+-)[a-z]+([?#].*)?$/, "$1full$2")
                .replace(/(\/user\/[^-/]*-[0-9]+-[0-9]+-)[0-9]+([?#].*)?$/, "$1512$2");
        }

        if (domain_nosub === "tv-happening.com" && domain.match(/^img(?:-[a-z]+)?[0-9]*\./)) {
            // http://img01.tv-happening.com/img_post/722/s/19.jpg -- 795x447
            //   http://img01.tv-happening.com/img_post/722/b/19.jpg -- 1600x900
            // http://img-fdc03.tv-happening.com/img_post/2230/s/14.jpg
            //   http://img-fdc03.tv-happening.com/img_post/2230/b/14.jpg
            return src.replace(/\/[a-z]\/([0-9]+\.[^/.]*)$/, "/b/$1");
        }

        if (domain_nowww === "kbbs.jp" ||
            // http://ibbs.info/fitimg/cache/corei7/9/w150ht1385397216crq60_corei7_52937be044ce1_9_84-3.jpg
            //   http://ibbs.info/data/corei7/img/corei7_52937be044ce1_9_84-3.jpg
            domain_nowww === "ibbs.info") {
            // http://kbbs.jp/fitimg/cache/cun/5/w720ht1539562482crq60_cun_UPD8U_5_75-5.jpg
            //   http://kbbs.jp/data/cun/img/cun_UPD8U_5_75-5.jpg
            return src.replace(/\/fitimg\/cache\/([^/]*)\/[0-9]+\/[^/_.]*_([^/]*)(?:[?#].*)?$/, "/data/$1/img/$2");
        }

        if (domain_nowww === "pzy.be") {
            // https://pzy.be/t/2/1000984_684906931534949_844139657_n.jpg
            //   https://pzy.be/i/2/1000984_684906931534949_844139657_n.jpg
            return src.replace(/(:\/\/[^/]*\/)t(\/[0-9]+\/[^/]*)$/, "$1i$2");
        }

        if ((domain_nosub === "blick.ch" && domain.match(/^f[0-9]*\./)) ||
            // https://static.pulse.ng/img/incoming/origs3982140/1970485862-w980-h640/Boris-Kodjoe.png
            //   https://static.pulse.ng/media/3982140/Boris-Kodjoe.png
            // https://static.pulse.ng/img/gist/origs3194543/2955564792-w644-h429/saeon-EP-1.jpg
            //   https://static.pulse.ng/media/3194543/saeon-EP-1.jpg
            // https://static.pulse.ng/img/gist/crop2729803/5934674216-chorizontal-w1200-h630/android.jpg
            //   https://static.pulse.ng/media/2729803/android.jpg
            // https://static.pulse.ng/img/finance/origs7762673/8080488404-w980-h640/5a37d8c67cc41ec8358b45c6.png
            //   https://static.pulse.ng/media/7762673/5a37d8c67cc41ec8358b45c6.png
            // https://static.pulse.ng/img/incoming/origs5267563/5549728609-w900-h600/ankara-dress-7.jpg?_ga=1.141366900.733172374.1446814233
            //   https://static.pulse.ng/media/5267563/ankara-dress-7.jpg
            domain === "static.pulse.ng" ||
            // https://img.bildderfrau.de/img/incoming/origs210102467/328335677-w800-h960-dc1/Der-Regisseur-Lars-Kraume-dreht-den-Film-Das-schweigende-Klassenzimmer-.jpg
            //   https://img.bildderfrau.de/media/210102467/Der-Regisseur-Lars-Kraume-dreht-den-Film-Das-schweigende-Klassenzimmer-.jpg -- doesn't work
            //domain === "img.bildderfrau.de" ||
            // https://img.abendblatt.de/img/incoming/origs205814601/4592947493-w800-h960/Pippis-geistige-Mutter-die-schwedische-Kinderbuchautorin-Astrid-Lindgren-1987-.jpg
            //   https://img.abendblatt.de/media/205814601/Pippis-geistige-Mutter-die-schwedische-Kinderbuchautorin-Astrid-Lindgren-1987-.jpg -- doesn't work
            //domain === "img.abendblatt.de" ||
            // https://bilder2.n-tv.de/img/incoming/crop20559669/377132103-cImg_16_9-w1200/Harley-Davidson-LiveWire.jpg
            //   https://bilder2.n-tv.de/media/20559669/Harley-Davidson-LiveWire.jpg -- doesn't work (zero length image)
            //(domain_nosub === "n-tv.de" && domain.match(/^bilder[0-9]*\./)) ||
            // https://static.pulselive.co.ke/img/incoming/origs7049829/1888631095-w980-h653-q70/FB-IMG-1501048439025.jpg
            //   https://static.pulselive.co.ke/media/7049829/FB-IMG-1501048439025.jpg
            domain === "static.pulselive.co.ke" ||
            // https://static.pulse.com.gh/img/incoming/crop5437370/195799655-chorizontal-w980-q99/IMG-20160518-WA0003.jpg
            //   https://static.pulse.com.gh/media/5437370/IMG-20160518-WA0003.jpg
            domain === "static.pulse.com.gh") {
            // https://f3.blick.ch/img/incoming/origs2943461/0000147929-w980-h653/21287423.jpg -- 980x647
            //   https://f3.blick.ch/media/2943461--3106/21287423.jpg -- 3000x1982
            //   https://f3.blick.ch/media/2943461/21287423.jpg -- same
            // https://f3.blick.ch/img/incoming/origs5189144/3772535931-w1280-h960/BREXIT-Absurdistan1.jpg -- 661x960
            //   https://f3.blick.ch/media/5189144/BREXIT-Absurdistan1.jpg -- 2067x3000
            // https://f3.blick.ch/img/incoming/origs2941934/5770143486-w980-h653/7e6e2681-f4c3-5538-661d-80f649a659a9-.jpg
            //   https://f3.blick.ch/media/2941934/7e6e2681-f4c3-5538-661d-80f649a659a9-.jpg
            // http://f.blick.ch/img/incoming/origs2049415/009556218-w644-h429/MelanieOesch-90-P.jpg
            //   http://f.blick.ch/media/2049415/MelanieOesch-90-P.jpg
            return src.replace(/\/img\/[a-z]+\/(?:origs|crop)([0-9]*)\/[0-9]+(?:-[^/]*)?\/([^/?#]*\.[^/.?#]*)(?:[?#].*)?$/,
                               "/media/$1/$2");
        }

        if (domain_nowww === "mixnews.lv") {
            // http://www.mixnews.lv/uploads/media/image/2013/02/07/20130207-heidi_11_medium.png
            //   http://www.mixnews.lv/uploads/media/image/2013/02/07/20130207-heidi_11.jpg
            // http://www.mixnews.lv/uploads/media/image/2012/05/15/greec_medium.png
            //   http://www.mixnews.lv/uploads/media/image/2012/05/15/greec.jpg
            return src.replace(/(\/uploads\/media\/image\/[0-9]{4}\/[0-9]{2}\/[0-9]{2}\/[^/]*)_medium\.png(?:[?#].*)?$/,
                               "$1.jpg");
        }

        if (domain_nosub === "promiflash.de" &&
            domain.match(/^content[0-9]*\./)) {
            // https://content5.promiflash.de/article-images/gallery1024/charlie-sheen-und-lindsay-lohan-posieren.jpg
            //   https://content5.promiflash.de/article-images/gallery2048/charlie-sheen-und-lindsay-lohan-posieren.jpg
            return src.replace(/\/article-images\/gallery1024\//, "/article-images/gallery2048/");
        }

        if (domain_nowww === "mycharm.ru") {
            // https://www.mycharm.ru/data/cache/2016jul/28/45/257823_37157thumb650.jpg
            //   https://www.mycharm.ru/data/cache/2016jul/28/45/257823_37157.jpg
            return src.replace(/(\/data\/cache\/[0-9]{4}[a-z]+\/.*)thumb[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain === "images.worthpoint.com") {
            // https://images.worthpoint.com/files/is/tn/auctionimages/4859/2983/4859_2983_27L0WNK2L.jpg
            //   https://images.worthpoint.com/files/is/auctionimages/4859/2983/4859_2983_27L0WNK2L.jpg
            // https://images.worthpoint.com/files/sloans/tn/full/360/116360.jpg
            //   https://images.worthpoint.com/files/sloans/full/360/116360.jpg
            return src.replace(/(\/files\/[^/]*\/)tn\//, "$1");
        }

        if (domain_nowww === "benishop.co") {
            // https://benishop.co/imgcdn/4096/https/img.auctiva.com/imgdata/1/1/2/0/0/4/7/webimg/621815239_o.jpg_.jpg
            //   https://img.auctiva.com/imgdata/1/1/2/0/0/4/7/webimg/621815239_o.jpg -- 1025x1023
            return src.replace(/^[a-z]+:\/\/[^/]*\/imgcdn\/[0-9]+\/([a-z]+)\/(.*)_\.[^/.]*$/, "$1://$2");
        }

        if (domain === "img.auctiva.com") {
            // https://img.auctiva.com/imgdata/1/7/6/4/9/0/5/webimg/993566635_tp.jpg -- 199x300
            //   https://img.auctiva.com/imgdata/1/7/6/4/9/0/5/webimg/993566635_o.jpg -- 350x525
            // doesn't work for all:
            // https://img.auctiva.com/imgdata/7/4/2/5/8/9/webimg/333726972_tp.gif -- 2560x1707
            //   https://img.auctiva.com/imgdata/7/4/2/5/8/9/webimg/333726972_o.gif -- 1024x682 (downscaled)
            return src.replace(/(\/[0-9]+_)[a-z]+(\.[^/.]*)$/, "$1o$2");
        }

        if (domain === "img.networthpost.com") {
            // https://img.networthpost.com/thumbs/3205512_rachel-riley/3205512_rachel-riley_1.jpeg
            //   https://img.networthpost.com/images/3205512_rachel-riley/3205512_rachel-riley_1.jpeg
            return src.replace(/\/thumbs\/([0-9]+_)/, "/images/$1");
        }

        if (domain === "img.static.butygirls.com") {
            // http://img.static.butygirls.com/resize/800/800/1/22278a8dd3f85a68c6daec086521fe56.png
            //   http://img.static.butygirls.com/22278a8dd3f85a68c6daec086521fe56.png
            return src.replace(/\/resize\/[0-9]+\/[0-9]+\/[0-9]+(\/[0-9a-f]+\.[^/.]*)$/, "$1");
        }

        if (domain === "coubsecure-s.akamaihd.net") {
            // https://coubsecure-s.akamaihd.net/get/b172/p/coub/simple/cw_timeline_pic/17b16f52a33/6c1b462c16515880e38f7/med_1497507210_image.jpg
            //   https://coubsecure-s.akamaihd.net/get/b172/p/coub/simple/cw_timeline_pic/17b16f52a33/6c1b462c16515880e38f7/1497507210_image.jpg
            return src.replace(/\/[a-z]+_([0-9]+_image\.[^/.]*)$/, "/$1");
        }

        if (domain_nowww === "wallpapersmug.com") {
            // https://wallpapersmug.com/download/1224x1224/78d9e0/alejandra-guilmant-5k.jpg
            //   https://wallpapersmug.com/u/78d9e0/alejandra-guilmant-5k.jpg
            // https://wallpapersmug.com/thumb/b56a09/camila-queiroz-beautiful-celebrity.jpg
            //   https://wallpapersmug.com/u/b56a09/camila-queiroz-beautiful-celebrity.jpg
            // https://wallpapersmug.com/large/912787/barbara-palvin-cute-smiling.jpg
            //   https://wallpapersmug.com/u/912787/barbara-palvin-cute-smiling.jpg
            return src.replace(/(?:\/download\/[0-9]+x[0-9]+\/|\/(?:thumb|large)\/)([0-9a-f]+\/[^/]*)$/, "/u/$1");
        }

        if (domain === "cp12.nevsepic.com.ua") {
            // http://cp12.nevsepic.com.ua/92/thumbs/1348495006-842567-alejandra_guilmant_24.jpg
            //   http://cp12.nevsepic.com.ua/92/1348495006-842567-alejandra_guilmant_24.jpg
            return src.replace(/(\/[0-9]+\/)thumbs\/([0-9]+-[0-9]+-[^/]*)$/, "$1$2");
        }

        if (domain === "itn.dmarge.com") {
            // https://itn.dmarge.com/313x190/2018/10/tudor2.jpg
            //   https://i.dmarge.com/2018/10/tudor2.jpg
            return src.replace(/:\/\/[^/]*\/[0-9]+x[0-9]+\//, "://i.dmarge.com/");
        }

        if (domain_nosub === "idnes.cz" && domain.match(/^img[0-9]*\./)) {
            // https://img30.rajce.idnes.cz/d3002/15/15141/15141025_b6576d288fb5a9cabf9341f6d52dd8bb/thumb/209625_50.jpg?ver=3
            //   https://img30.rajce.idnes.cz/d3002/15/15141/15141025_b6576d288fb5a9cabf9341f6d52dd8bb/images/209625_50.jpg?ver=3
            return src.replace(/\/thumb\//, "/images/");
        }

        if (domain_nowww === "funsubstance.com") {
            // https://funsubstance.com/uploads/preview/487/487309.jpg
            //   https://funsubstance.com/uploads/original/487/487309.jpg
            return src.replace(/\/uploads\/[a-z]+\//, "/uploads/original/");
        }

        if (domain === "global.unitednations.entermediadb.net") {
            // https://global.unitednations.entermediadb.net/assets/mediadb/services/module/asset/downloads/preset/assets/2014/07/19535/image1170x530cropped.jpg
            //   https://global.unitednations.entermediadb.net/assets/mediadb/services/module/asset/downloads/preset/assets/2014/07/19535/image.jpg
            return src.replace(/\/image[0-9]+x[0-9]+(?:cropped)?(\.[^/.]*)$/, "/image$1");
        }

        if (domain_nowww === "vjav.com") {
            // https://www.vjav.com/get_image/2/749399d324d9f4118ef241f8a2d497eb/main/1600x1200/47000/47925/575030.jpg/
            //   https://www.vjav.com/contents/albums/main/1600x1200/47000/47925/575030.jpg
            return src.replace(/\/get_image\/[0-9a-f]\/[0-9a-f]+\/main\/(.*?)\/+(?:[?#].*)?$/, "/contents/albums/main/$1");
        }

        if (domain === "rimg.bookwalker.jp") {
            // thanks to NotLemon at https://github.com/qsniyg/maxurl/issues/17
            // https://rimg.bookwalker.jp/7759762/frDGCemG5kX9EBY8IrbThQ__.jpg
            //   https://c.bookwalker.jp/7759762/t_700x780.jpg
            return src.replace(/:\/\/[^/]*\/([0-9]+)\/[0-9a-zA-Z_]+(\.[^/.]*)$/, "://c.bookwalker.jp/$1/t_700x780$2");
        }

        if (domain === "c.bookwalker.jp") {
            // thanks to NotLemon at https://github.com/qsniyg/maxurl/issues/17
            // https://c.bookwalker.jp/7759762/t_700x780.jpg
            //   https://c.bookwalker.jp/coverImage_2679576.jpg
            // https://c.bookwalker.jp/2247491/t_700x780.jpg
            //   https://c.bookwalker.jp/coverImage_1947421.jpg
            match = src.match(/:\/\/[^/]*\/([0-9]+)\/[^/]*(?:[?#].*)?$/);
            if (match) {
                var number = match[1];
                var reversed_number = parseInt(number.split("").reverse().join("")) - 1;
                return "https://c.bookwalker.jp/coverImage_" + reversed_number + src.replace(/.*(\.[^/.?#]*)(?:[?#].*)?$/, "$1");
            }
        }

        if (domain === "images.cdn.circlesix.co") {
            // https://images.cdn.circlesix.co/image/1/700/0/uploads/articles/subaru_coloni_f1_03-54e4e95ecb141.jpg
            //   https://images.cdn.circlesix.co/image/uploads/articles/subaru_coloni_f1_03-54e4e95ecb141.jpg
            return src.replace(/\/image\/(?:[0-9]+\/){3}uploads\//, "/image/uploads/");
        }

        if (domain === "static.japanhdv.com") {
            // https://static.japanhdv.com/cache/actress/airi-tachibana.270x480.jpg
            //   https://static.japanhdv.com/actress/airi-tachibana.jpg
            return src.replace(/(:\/\/[^/]*\/)cache\/(.*)\.[0-9]+x[0-9]+(\.[^/.]*)$/, "$1$2$3");
        }

        if (domain === "mosaic.tnaflix.com") {
            // https://mosaic.tnaflix.com/1883746/a16:8q10w300/22.jpg
            //   https://mosaic.tnaflix.com/1883746/a16/22.jpg
            return src.replace(/(\/[0-9a-z]+):[0-9a-z]+(\/|\.[^/.]*)/, "$1$2");
        }

        if (domain_nosub === "tnastatic.com" && domain.match(/^img[0-9]*\./)) {
            // http://img.tnastatic.com/q80w200r/pics/alpha/2687237821/510542978/332373910.jpg
            //   http://img.tnastatic.com/q100/pics/alpha/2687237821/510542978/332373910.jpg
            // https://img.tnastatic.com/a3:2q80w600r/thumbs/b5/31_1029639l.jpg -- stretched
            //   https://img.tnastatic.com/a3/thumbs/b5/31_1029639l.jpg
            return src.replace(/(:\/\/[^/]*\/)[^/]*\/(pics|thumbs)\//, "$1q100/$2/");
        }

        if (domain === "image.gala.de") {
            // https://image.gala.de/v1/cms/zU/helene-kathrin-ge_7589848-portrait-article_4col_fix_width.jpg?v=9918049
            //   https://image.gala.de/v1/cms/zU/helene-kathrin-ge_7589848-original-lightbox.jpg?v=9918049
            return src.replace(/(:\/\/[^/]*\/v[0-9]*\/cms\/[^/]*\/[^/]*_[0-9]+-)[a-z]+[-_][^/]*(\.[^/.]*)$/, "$1original-lightbox$2");
        }

        if (domain_nosub === "fashionwelike.com" &&
            domain.match(/^static[0-9]*\./)) {
            // http://static2.fashionwelike.com/interviews/photos/thumbnail/Pixie_Lott_2.jpg?1477838134
            //   http://static2.fashionwelike.com/interviews/photos/original/Pixie_Lott_2.jpg?1477838134
            return src.replace(/\/photos\/thumbnail\//, "/photos/original/");
        }

        if (domain === "images.metmuseum.org") {
            // https://images.metmuseum.org/CRDImages/rl/web-large/SLP0129.jpg
            //   https://images.metmuseum.org/CRDImages/rl/original/SLP0129.jpg
            return src.replace(/(\/CRDImages\/+[^/]*\/+)[^/]*\/+/, "$1original/");
        }

        if (domain === "images-assets.nasa.gov") {
            // https://images-assets.nasa.gov/image/PIA18139/PIA18139~thumb.jpg
            //   https://images-assets.nasa.gov/image/PIA18139/PIA18139~orig.jpg
            return src.replace(/~[a-z]+(\.[^/.]*)$/, "~orig$1");
        }

        if (amazon_container === "attachments.readmedia.com") {
            // https://s3.amazonaws.com/attachments.readmedia.com/files/99789/medium/13._Halina_Reijn_and_Jude_Law_in_Obsession_at_the_Barbican_Theatre._Photo_by_Jan_Versweyveld.jpg?1511195599
            //   https://s3.amazonaws.com/attachments.readmedia.com/files/99789/original/13._Halina_Reijn_and_Jude_Law_in_Obsession_at_the_Barbican_Theatre._Photo_by_Jan_Versweyveld.jpg?1511195599
            return src.replace(/(\/+files\/+[0-9]+\/+)[a-z]+\/+([^/]*)(?:[?#].*)?$/, "$1original/$2");
        }

        if (domain === "files.sexyandfunny.com") {
            // https://files.sexyandfunny.com/img_disp/2/img5b908dc1bbd17.jpg
            //   https://files.sexyandfunny.com/img_orig/2/img5b908dc1bbd17.jpg
            return src.replace(/\/img_[a-z]+\//, "/img_orig/");
        }

        if (domain === "mb.cision.com") {
            // http://mb.cision.com/Public/56/2533153/95d7520c43d9bf6a_400x400ar.jpg
            //   http://mb.cision.com/Public/56/2533153/95d7520c43d9bf6a_org.jpg
            return src.replace(/(\/Public\/+[0-9]+\/+[0-9]+\/+[0-9a-f]+)_[^/_]*(\.[^/.]*)$/, "$1_org$2");
        }

        if (domain_nowww === "ftvmagic.com") {
            // https://ftvmagic.com/wp-content/grand-media/image/thumb/1005_5.jpg
            //   https://ftvmagic.com/wp-content/grand-media/image/1005_5.jpg
            // https://ftvmagic.com/post_pics/2018/06/03004-585x389.jpg
            //   https://ftvmagic.com/post_pics/2018/06/03004.jpg
            // http://ftvmagic.com/post_pics/2014/08/107_thumb.jpg
            //   http://ftvmagic.com/post_pics/2014/08/107.jpg
            return src
                .replace(/(\/+grand-media\/+image\/+)thumb\//, "$1")
                .replace(/-[0-9]+x[0-9]+(\.[^/.]*)$/, "$1")
                .replace(/(\/post_pics\/+[0-9]+\/+[0-9]+\/+[0-9]+)_thumb(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "wdb.space") {
            // https://wdb.space/media/2016-6-7/_HpTtKNB2W_scale_300x500.jpg
            //   https://wdb.space/media/2016-6-7/_HpTtKNB2W.jpg
            return src.replace(/(\/media\/[^/]*\/[^/]*)_scale_[0-9]+x[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "iphone8wallpapers.com" && src.indexOf("/media/uploads/") >= 0) {
            // https://iphone8wallpapers.com/media/uploads/2017/08/Barbara-Palvin-Dark-Model-Cute-300x533.jpg
            //   https://iphone8wallpapers.com/media/uploads/2017/08/Barbara-Palvin-Dark-Model-Cute.jpg
            return {
                url: src.replace(/-[0-9]+x[0-9]+(\.[^/.]*)$/, "$1"),
                headers: {
                    Referer: src.replace(/(:\/\/[^/]*\/).*/, "$1") // works without, but adds a "click here full resolution, no hotlinking" watermark
                }
            };
        }

        if (domain === "upload.sanqin.com") {
            // http://upload.sanqin.com/2017/0103/thumb_228__1483406299511.jpg
            //   http://upload.sanqin.com/2017/0103/1483406299511.jpg
            return src.replace(/\/thumb_[0-9]+__([^/]*)(?:[?#]*.*)?$/, "/$1");
        }

        if (domain_nowww === "best-wallpaper.net" && src.indexOf("/wallpaper/") >= 0 &&
            options && options.do_request && options.cb) {
            // https://best-wallpaper.net/Barbara-Palvin-01_wallpapers.html
            // https://best-wallpaper.net/wallpaper/m/1205/Barbara-Palvin-01_m.jpg
            //   https://best-wallpaper.net/wallpaper/1920x1200/1205/Barbara-Palvin-01_1920x1200.jpg
            match = src.match(/\/wallpaper\/+[^/]+\/[0-9]+\/([^/]*)_[^-_/.]+\.[^/.]*$/);
            if (match) {
                options.do_request({
                    url: "https://best-wallpaper.net/" + match[1] + "_wallpapers.html",
                    method: "GET",
                    onload: function(resp) {
                        if (resp.readyState === 4) {
                            var match = resp.responseText.match(/<img ID="viewImg"[^>]*data-src="([^">]*)"/);
                            if (match) {
                                options.cb(urljoin(src, match[1], true));
                            } else {
                                options.cb(null);
                            }
                        }
                    }
                });

                return {
                    waiting: true
                };
            }
        }

        if (domain_nosub === "trueart.com" &&
            domain.match(/^s[0-9]*\./)) {
            // http://s1.trueart.com/20161222/011726940_640.jpg
            //   http://s1.trueart.com/20161222/011726940.jpg
            return src.replace(/(\/[0-9]+)_[0-9]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "atkfan.com") {
            // https://atkfan.com/atk-exotics/sasha/2010-07-07_f6a/thumbs/atk-exotics-sasha-bleu-007_140.jpg
            //   https://atkfan.com/atk-exotics/sasha/2010-07-07_f6a/set/atk-exotics-sasha-bleu-007.jpg
            return src.replace(/\/thumbs(\/[^/]*)_[0-9]+(\.[^/.]*)$/, "/set$1$2");
        }

        if (domain === "imbbsfile.imbc.com") {
            // http://imbbsfile.imbc.com/drama07/hideandseek_photo/201810/thnb_hideandseek_photo181026114501imbcdrama10.jpg
            //   http://imbbsfile.imbc.com/drama07/hideandseek_photo/201810/hideandseek_photo181026114501imbcdrama10.jpg
            return src.replace(/\/thnb_([^/]*\.[^/.]*)(?:[?#].*)?$/, "/$1");
        }

        if (domain_nowww === "hdwall.us") {
            // http://hdwall.us/thumbnail-small/jessica_stroup_desktop_1067x1600_hd-wallpaper-997205.jpg
            //   http://hdwall.us/wallpaper/jessica_stroup_desktop_1067x1600_hd-wallpaper-997205.jpg
            // works, but adds watermark, needs a correct cookie to bypass
            return {
                url: src.replace(/(:\/\/[^/]*\/+)(?:wallpaper|thumbnail)[^/]*\/+([^/]*\.[^/.]*)(?:[?#].*)?$/, "$1wallpaper/$2"),
                problems: {
                    watermark: true
                }
            };
        }

        if (domain === "thmbs.baklol.com") {
            // https://thmbs.baklol.com/Tori-Black0842210141469530776.jpg
            //   https://images.baklol.com/Tori-Black0842210141469530776.jpg
            return src.replace(/:\/\/thmbs\./, "://images.");
        }

        if (domain_nowww === "svtstatic.se") {
            // issue page: (thanks to TheLovinator1 on github)
            // https://github.com/qsniyg/maxurl/issues/18
            // https://www.svtstatic.se/image/cinema/760/19912234/1541383772?quality=70&format=auto
            //   https://www.svtstatic.se/image/original/unscaled/19912234/1541383772.jpg?quality=10
            //   https://www.svtstatic.se/image/original/unscaled/19912234/1541383772.png
            return {
                url: src.replace(/\/image\/+[^/]*\/+[^/]*\/+([0-9]+\/+[0-9]+)(?:\.[^/?#]*)?(?:[?#].*)?$/,
                                 "/image/original/unscaled/$1.png"),
                                 //"/image/original/unscaled/$1?quality=100"),
                head_wrong_contentlength: true
            };
        }








































































































































































        if (src.match(/\/ImageGen\.ashx\?/)) {
            // http://www.lookalikes.info/umbraco/ImageGen.ashx?image=/media/97522/nick%20hewer%20-%20mark%20brown.jpeg&width=250&constrain=true
            //   http://www.lookalikes.info/media/97522/nick%20hewer%20-%20mark%20brown.jpeg
            return urljoin(src, src.replace(/.*\/ImageGen\.ashx.*?image=([^&]*).*/, "$1"));
        }

        // coppermine
        if (src.search(/(?::\/\/[^/]*\/(gallery|photos|photogallery)|:\/\/gallery\.[^/]*)?\/albums\/[^/]*\/.*\/(normal|thumb|userpics)_[^/.]*\.[^/.]*$/) >= 0) {
            // http://emma-w.net/photos/albums/Events/2017/MARCH13/001/thumb_001.jpg
            //   http://emma-w.net/photos/albums/Events/2017/MARCH13/001/001.jpg
            // http://emilia-clarke.net/gallery/albums/Photoshoots/Session031/thumb_2013_10_12.jpg
            //   http://emilia-clarke.net/gallery/albums/Photoshoots/Session031/2013_10_12.jpg
            // http://emilia-clarke.com/gallery/albums/ModelingPromos/DolceGabbana/2018-Campaign/20180204-Dolce%20and%20Gabbana%20Set%20in%20Rome%20Italy/normal_012.jpg
            //   http://emilia-clarke.com/gallery/albums/ModelingPromos/DolceGabbana/2018-Campaign/20180204-Dolce%20and%20Gabbana%20Set%20in%20Rome%20Italy/012.jpg
            // https://gallery.mileycyrusworld.net/albums/userpics/10001/thumb_007~55.jpg
            //   https://gallery.mileycyrusworld.net/albums/userpics/10001/007~55.jpg
            // http://emmawatson.cz/photogallery/albums/userpics/10001/thumb_peterlindbergh17-001.jpg
            //   http://emmawatson.cz/photogallery/albums/userpics/10001/peterlindbergh17-001.jpg
            // http://thewalking-dead.sosugary.com/albums/userpics/10001/normal_danai4318_282329.jpg
            //   http://thewalking-dead.sosugary.com/albums/userpics/10001/danai4318_282329.jpg
            newsrc = src.replace(/(\/albums\/.*\/)[a-z]*_([^/.]*\.[^/.]*)$/, "$1$2");
            if (newsrc !== src)
                return newsrc;
        }

        // gnuboard
        // /data/editor/...
        // /data/file/...
        // /data/works/...
        if (src.match(/\/data\/[^/]*\/[^/]*\/(?:_thumb\/[^/]*\/)?[^/]*$/)) {
            // https://threppa.com/data/editor/1803/_thumb/750x0_90/20180307005201_f0940271b9a94b4a3544733c05ae638b_yeno.jpg
            //   https://threppa.com/data/editor/1803/20180307005201_f0940271b9a94b4a3544733c05ae638b_yeno.jpg
            return src
                .replace(/\/thumb-([^/]*)_[0-9]+x[0-9]+(\.[^/.]*)$/, "/$1$2")
                .replace(/(\/data\/[^/]*\/[0-9]+\/)_thumb\/[0-9]+x[0-9]_[0-9]+\//, "$1");
        }

        // various korean news sites (heraldpop etc.)
        // test:
        // http://cgeimage.commutil.kr/phpwas/restmb_allidxmake.php?idx=1&simg=2017111113495301086f97ee432d6203243244.jpg
        // http://res.heraldm.com/phpwas/restmb_jhidxmake.php?idx=999&simg=201712220654304807972_20171222065329_01.jpg
        // http://cgeimage.commutil.kr/phpwas/restmb_setimgmake.php?w=90&h=60&m=1&simg=201712231138280443342246731f35814122117.jpg
        //   http://cgeimage.commutil.kr/phpwas/restmb_allidxmake.php?idx=999&simg=201712231138280443342246731f35814122117.jpg
        // http://res.heraldm.com/phpwas/restmb_jhidxmake.php?idx=5&simg=201507120010285799190_20150712001052_01.jpg
        // http://nimage.globaleconomic.co.kr/phpwas/restmb_allidxmake.php?idx=5&simg=201403241833510093084_00.jpg
        //   http://nimage.globaleconomic.co.kr/phpwas/restmb_allidxmake.php?idx=999&simg=201403241833510093084_00.jpg -- same size
        // doesn't work:
        // http://cliimage.commutil.kr/phpwas/restmb_setimgmake.php?w=550&h=412&m=5&simg=2018030210280201075d307c1aeb0121131233211.jpg
        //   http://cliimage.commutil.kr/phpwas/restmb_setimgmake.php?idx=999&simg=2018030210280201075d307c1aeb0121131233211.jpg
        //   error: nIdx null
        //   http://cliimage.commutil.kr/phpwas/restmb_allidxmake.php?idx=999&simg=2018030210280201075d307c1aeb0121131233211.jpg - works
        if (src.search(/\/phpwas\/restmb_[a-z]*make\.php\?/) >= 0) {
            if (domain === "cgeimage.commutil.kr" ||
                domain === "cliimage.commutil.kr") {
                src = src.replace(/\/phpwas\/restmb_[a-z]*make\.php/, "/phpwas/restmb_allidxmake.php");
            }

            if (domain.indexOf("nimage.") === 0) {
                // http://nimage.newsway.kr/phpwas/restmb_idxmake.php?idx=200&simg=20180202000058_1024.jpg
                //   http://nimage.newsway.kr/photo/2018/02/02/20180202000058_1024.jpg
                // http://nimage.dailygame.co.kr/phpwas/restmb_idxmake.php?idx=3&simg=2015120515361257066_20151205153842_1.jpg
                //   http://nimage.dailygame.co.kr/photo/2015/12/05/2015120515361257066_20151205153842_1.jpg
                // doesn't work for all: (so keep to restmb_idxmake for now)
                // http://nimage.globaleconomic.co.kr/phpwas/restmb_allidxmake.php?idx=999&simg=201403241833510093084_00.jpg
                //   http://nimage.globaleconomic.co.kr/photo/2014/03/24/201403241833510093084_00.jpg -- doesn't work
                newsrc = src.replace(/\/phpwas\/restmb_idxmake\.php.*?simg=([0-9]{4})([0-9]{2})([0-9]{2})([^&]*).*?$/, "/photo/$1/$2/$3/$1$2$3$4");
                if (newsrc !== src)
                    return newsrc;
            }

            if (domain === "res.heraldm.com" &&
                decodeURIComponent(src.match(/simg=([^&]*)/)[1])[0] === "/") {
                // http://res.heraldm.com/phpwas/restmb_idxmake.php?idx=999&simg=%2Fcontent%2Fimage%2F2015%2F07%2F13%2F20150713001359_0.jpg
                //   http://res.heraldm.com/content/image/2015/07/13/20150713001359_0.jpg
                // http://res.heraldm.com/phpwas/restmb_idxmake.php?idx=999&simg=/content/image/2018/02/02/20180202000714_0.jpg
                //   http://res.heraldm.com/content/image/2018/02/02/20180202000714_0.jpg
                return urljoin(src, decodeURIComponent(src.match(/simg=([^&]*)/)[1]));
            }

            //return src.replace(/\/phpwas\/restmb_[a-z]*make\.php\?.*(simg=[^&]*)/, "/phpwas/restmb_allidxmake.php?idx=999&$1");
            return src.replace(/(\/phpwas\/restmb_[a-z]*make\.php)\?.*(simg=[^&]*)/, "$1?idx=999&$2");
        }

        if (src.match(/.*?\/timthumb(?:\/index)?\.php[?/].*?src=(.*)/)) {
            // http://dublinfilms.fr/wp-content/themes/purity/includes/timthumb.php?src=http://dublinfilms.fr/wp-content/uploads/2014/06/Actu-bandeau-bis.jpg&h=260&w=662&zc=1
            //   http://dublinfilms.fr/wp-content/uploads/2014/06/Actu-bandeau-bis.jpg
            // http://www.hcwd.com.tw/template/corporate_site/fk1/timthumb.php?src=http://www.hcwd.com.tw/snlev801/product/bimg/_MG_8893(001).jpg&w=410&s=1
            //   http://www.hcwd.com.tw/snlev801/product/bimg/_MG_8893(001).jpg
            // http://www.moviehotties.com/timthumb.php?src=/moviehotties/images/news-gallery/orig/Em-Rat-Met-G_1.jpg&w=85&h=85&q=100
            //   http://www.moviehotties.com/moviehotties/images/news-gallery/orig/Em-Rat-Met-G_1.jpg
            // https://www.wordonfire.org/wof-core/libraries/timthumb/timthumb.php?zc=1&w=1328&h=598&src=https://www.wordonfire.org/wof-site/media/brchristianitycrucifixion.jpg
            //   https://www.wordonfire.org/wof-site/media/brchristianitycrucifixion.jpg
            // http://imagecache.blastro.com/timthumb.php/src=http%3A%2F%2Fimages.blastro.com%2Fimages%2Fartist_images%2Ffull%2Ffull_booty_luv_artist_photo1.jpg&w=610&h=457&zc=2&a=T
            //   http://images.blastro.com/images/artist_images/full/full_booty_luv_artist_photo1.jpg
            // http://lauradaluna.com/timthumb.php?src=image/gallery/141441178010306.jpg&zc=2&w=314
            //   http://lauradaluna.com/image/gallery/141441178010306.jpg
            // http://www.articlelike.com/timthumb/index.php?src=https://www.articlelike.com/manage/0/product/17589/334/17589_0.jpg
            //   https://www.articlelike.com/manage/0/product/17589/334/17589_0.jpg
            return urljoin(src, decodeURIComponent(src.replace(/.*\/timthumb(?:\/index)?\.php[?/].*?src=([^&]*).*/, "$1")), true);
        }

        if (src.match(/\/fotogallery\/[0-9]+X[0-9]+\//)) {
            // http://static.pourfemme.it/pfcoppia/fotogallery/1200X0/11285/solene-rigot-e-zacharie-chasseriaud.jpg
            //   http://static.pourfemme.it/pfcoppia/fotogallery/99999999999X0/11285/solene-rigot-e-zacharie-chasseriaud.jpg
            // http://static.stylosophy.it/stshoes/fotogallery/1200X0/183603/decolletes-gioiello-gedebe-gialle.jpg
            //   http://static.stylosophy.it/stshoes/fotogallery/9999999999X0/183603/decolletes-gioiello-gedebe-gialle.jpg
            // http://static.qnm.it/www/fotogallery/1200X0/110767/martina-stella-bikini.jpg
            //   http://static.qnm.it/www/fotogallery/9999999999X0/110767/martina-stella-bikini.jpg
            // http://static.myluxury.it/myluxury/fotogallery/1200X0/119923/uovo-zen-by-nobu.jpg
            //   http://static.myluxury.it/myluxury/fotogallery/9999999999X0/119923/uovo-zen-by-nobu.jpg
            // http://static.derapate.it/derapate/fotogallery/1200X0/64729/grid-girls-motogp-le-ragazze-del-paddock-4.jpg
            //   http://static.derapate.it/derapate/fotogallery/9999999999X0/64729/grid-girls-motogp-le-ragazze-del-paddock-4.jpg
            return src.replace(/\/fotogallery\/[0-9]+X[0-9]+\//, "/fotogallery/9999999999X0/");
        }

        if (src.indexOf("/redim_recadre_photo.php") >= 0) {
            // probably the only site with this?
            // http://diffusionph.cccommunication.biz/jpgok/redim_recadre_photo.php?path_url=http://diffusionvid.cccommunication.biz/thumbnail_embed/46408.jpg&width=480&height=320
            //   http://diffusionvid.cccommunication.biz/thumbnail_embed/46408.jpg
            return src.replace(/.*\/redim_recadre_photo\.php\?.*?path_url=([^&]*).*/, "$1");
        }

        if (src.indexOf("/wp-apps/imrs.php?") >= 0) {
            // https://img.washingtonpost.com/wp-apps/imrs.php?src=https://img.washingtonpost.com/rw/2010-2019/Wires/Images/2017-10-15/AP/Britain_Hogwarts_Express_15930-4186c.jpg
            // https://img.washingtonpost.com/wp-apps/imrs.php?src=https://img.washingtonpost.com/news/comic-riffs/wp-content/uploads/sites/15/2017/11/PIXAR-COCO-frida-kahlo-cordova-buckley.jpg&w=480
            return src.replace(/.*\/wp-apps\/imrs\.php\?[^/]*src=([^&]*).*/, "$1");
        }

        if (src.match(/\/dynimage\/[^/]*\/[0-9]*\/[^/]*$/)) {
            // https://www.yield247.com/dynimage/imagesize10/1301/image.jpg
            // https://www.kyphimalta.com/dynimage/imagesize10/541/image.png
            // http://www.hitradingltd.com/dynimage/imagesize10/514/image.png
            return src.replace(/\/dynimage\/[^/]*\//, "/dynimage/original/"); // can be anything
        }

        if (src.match(/\/phocagallery\/.*\/thumbs\/[^/]*$/)) {
            // https://www.beautybybeccy.com.au/images/phocagallery/photoshoot/Promo%20Model%20shoot/thumbs/phoca_thumb_m_DSC09589-edit.jpg
            //   https://www.beautybybeccy.com.au/images/phocagallery/photoshoot/Promo%20Model%20shoot/DSC09589-edit.jpg
            return src.replace(/\/thumbs\/phoca_thumb_[^/._]*_/, "/");
        }

        if (src.match(/\/sfc\/servlet\.shepherd\/version\/renditionDownload/)) {
            // wip, need way to disable downloading?
            // sources:
            // https://salesforce.stackexchange.com/questions/171149/lightning-component-using-renditiondownload-to-view-files-img-doc-xlxs-etc
            // https://forum.bigcommerce.com/s/question/0D51B00003zftI0SAI/hide-the-bigcommerce-cdn-image-path-on-image-mouseover-product-detail-page
            // https://developer.salesforce.com/docs/atlas.en-us.chatterapi.meta/chatterapi/connect_resources_files_rendition.htm
            // https://developer.salesforce.com/docs/atlas.en-us.chatterapi.meta/chatterapi/connect_resources_files_preview_format.htm
            //
            // https://forum.bigcommerce.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB720BY480&versionId=0681B0000064R3r&operationContext=CHATTER&contentId=05T1B00000GDv1i&page=0
            //   https://forum.bigcommerce.com/sfc/servlet.shepherd/version/renditionDownload?rendition=ORIGINAL_Png&versionId=0681B0000064R3r&operationContext=CHATTER&contentId=05T1B00000GDv1i
            //   https://forum.bigcommerce.com/sfc/servlet.shepherd/version/download/0681B0000064R3r (versionId, works, but requires download)
            // https://support.bigcommerce.com/servlet/rtaImage?eid=ka61B000000ClUi&feoid=00N1300000BR3CT&refid=0EM130000018Xoh
            //
            // doesn't work:
            // https://forum.bigcommerce.com/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB720BY480&versionId=06813000005iizB&operationContext=CHATTER&contentId=05T1300000FCL6J
            //   https://forum.bigcommerce.com/sfc/servlet.shepherd/version/renditionDownload?rendition=ORIGINAL_Jpg&versionId=06813000005iizB&operationContext=CHATTER&contentId=05T1300000FCL6J -- works
            //return src.replace(/(\/renditionDownload.*?[?&]rendition=)[^&]*/, "$1ORIGINAL_Png");
            return src.replace(/\/renditionDownload.*?[?&]versionId=([^&]*).*/, "/download/$1");
        }

        if (domain === "cdn.ome.lt") {
            // https://cdn.ome.lt/0gFXoqAQm38hc0iNSj6p0vA1Uas=/fit-in/1070x750/smart/filer_public/ff/27/ff27f835-1db5-4623-a776-353bca6daa9d/vingadoresguerrainfinitamondo-02.jpeg
            //   https://cdn.ome.lt/filer_public/ff/27/ff27f835-1db5-4623-a776-353bca6daa9d/vingadoresguerrainfinitamondo-02.jpeg
            return src.replace(/(:\/\/[^/]*\/)[-_A-Za-z0-9]+=\/(?:(?:full-)?fit-in\/)?(?:[0-9x:]+\/)?(?:[0-9x:]+\/)?(?:(?:top|center|middle)\/)?(?:(?:smart|top|center|middle)\/)?(?:filters:[^/]*\/)?/, "$1");
        }

        if ((domain_nosub === "vox-cdn.com" && domain.indexOf("cdn.vox-cdn.com") >= 0) ||
            domain === "thumbnails.trvl-media.com" ||
            domain === "thumbor-static.factorymedia.com" ||
            // https://cdnrockol-rockolcomsrl.netdna-ssl.com/Q3UJZHxl455fWTe78h_5zbtv-WY=/700x0/smart/http%3A%2F%2Fs.mxmcdn.net%2Fimages-storage%2Falbums%2F4%2F5%2F4%2F7%2F6%2F0%2F12067454_800_800.jpg
            //   http://s.mxmcdn.net/images-storage/albums/4/5/4/7/6/0/12067454_800_800.jpg
            domain === "cdnrockol-rockolcomsrl.netdna-ssl.com" ||
            // https://thumbor-titelmediaug.netdna-ssl.com/kY004Q5cCawBfZZWcm4g9MjPrtw=/480x320/filters:strip_icc()/http%3A%2F%2Fwhatdropsnow.s3.amazonaws.com%2Fproduct_images%2Fimages%2F46237%2Fe22a12e352862c818b75c15d150ef49f3458aaac.jpeg
            //   http://whatdropsnow.s3.amazonaws.com/product_images/images/46237/e22a12e352862c818b75c15d150ef49f3458aaac.jpeg
            domain === "thumbor-titelmediaug.netdna-ssl.com" ||
            // https://www.infobae.com/new-resizer/jfCQ7-AjnQyNdmWHdFGYvzYmVx4=/600x0/filters:quality(100)/arc-anglerfish-arc2-prod-infobae.s3.amazonaws.com/public/4IOFEV5GJVES3DVJ2XHDFXA2TE
            domain === "www.infobae.com" ||
            // http://s2.glbimg.com/i7GBoDhq8XYOfFinAMZv0YYZdPY=/e.glbimg.com/og/ed/f/original/2016/12/26/eb8.jpg
            //   http://e.glbimg.com/og/ed/f/original/2016/12/26/eb8.jpg
            // https://s2.glbimg.com/guJ0REQ3RhF8RtD-dacV89xdGQI=/140x111/e.glbimg.com/og/ed/f/original/2015/02/12/nicole_scherzinger.jpg
            //   http://e.glbimg.com/og/ed/f/original/2015/02/12/nicole_scherzinger.jpg
            // http://s2.glbimg.com/ItD12-q38NBBvxkw1cEHaNjZVYQT-0uANSHHRhD3QUNIoz-HdGixxa_8qOZvMp3w/e.glbimg.com/og/ed/f/original/2013/02/07/lilo.jpg
            //   http://e.glbimg.com/og/ed/f/original/2013/02/07/lilo.jpg
            (domain_nosub === "glbimg.com" && domain.match(/s[0-9]*\.glbimg\.com/)) ||
            // https://i.amz.mshcdn.com/vWTWthC534bzcGDk15NwrBy-dd4=/fit-in/1200x9600/https%3A%2F%2Fblueprint-api-production.s3.amazonaws.com%2Fuploads%2Fcard%2Fimage%2F54484%2FGettyImages-520238014.jpg
            //   https://blueprint-api-production.s3.amazonaws.com/uploads/card/image/54484/GettyImages-520238014.jpg
            domain === "i.amz.mshcdn.com" ||
            // https://img.ilcdn.fi/64wZEcZPDqMNu7XwxW5cDqWKPYQ=/full-fit-in/612x/img-s3.ilcdn.fi/e36990bb042d3364aa4c91d8105889fc29941e7ae97600defb8f12cbb87e55c6.jpg
            //   https://img.ilcdn.fi/64wZEcZPDqMNu7XwxW5cDqWKPYQ=/full-fit-in/612x/img-s3.ilcdn.fi/e36990bb042d3364aa4c91d8105889fc29941e7ae97600defb8f12cbb87e55c6.jpg -- 403
            domain === "img.ilcdn.fi" ||
            // https://img.fstatic.com/JOPw9nZjrfLTo9avaG2aY1drkko=/full-fit-in/640x480/https://cdn.fstatic.com/media/artists/avatar/2017/05/christopher-nolan_a8719.jpg
            //   https://cdn.fstatic.com/media/artists/avatar/2017/05/christopher-nolan_a8719.jpg
            domain === "img.fstatic.com" ||
            // https://img.mthcdn.com/ksCA14bSIxTz78rH3WvCXR9ZdkU=/798x1197/picpost.mthai.com/pic/2017/01/2025222.jpg
            //   https://picpost.mthai.com/pic/2017/01/2025222.jpg
            domain === "img.mthcdn.com" ||
            // https://images.thestar.com/U9Ew-rkVyhtmv0u2Rjox3G637AA=/0x0:1200x675/93x52/smart/filters:cb(1530307526313)/https://www.thestar.com/content/dam/thestar/news/gta/2018/06/28/in-one-hour-we-watched-toronto-drivers-block-this-downtown-intersection-at-virtually-every-red-light/blocked_box_main.jpg
            //   https://www.thestar.com/content/dam/thestar/news/gta/2018/06/28/in-one-hour-we-watched-toronto-drivers-block-this-downtown-intersection-at-virtually-every-red-light/blocked_box_main.jpg
            // https://images.thestar.com/-ZOPF3_-dhsPDK5diZsl7k2AWyE=/1086x724/smart/filters:cb(1533380883140)/https://www.thestar.com/content/dam/thestar/opinion/contributors/2018/08/02/mall-is-wrong-about-use-of-captured-images/rpjeatoncameras04.jpg
            //   https://www.thestar.com/content/dam/thestar/opinion/contributors/2018/08/02/mall-is-wrong-about-use-of-captured-images/rpjeatoncameras04.jpg
            domain === "images.thestar.com" ||
            // https://thumb2.holidaypirates.com/xU1qXNGnGgXc2Du6ukUPcdDpBRg=/657x300/https://media.mv.urlaubspiraten.de/images/2016/08/57a4ddb17986a419264487wv9gugyx.jpg
            //   https://media.mv.urlaubspiraten.de/images/2016/08/57a4ddb17986a419264487wv9gugyx.jpg
            (domain_nosub === "holidaypirates.com" && domain.match(/thumb[0-9]*\.holidaypirates\.com/)) ||
            // https://img.yasmina.com/UoZCII39qwhfihSDsCZ845tCp_Y=/0x0/smart/http://harmony-assets-live.s3.amazonaws.com/image_source/7d/5f/7d5fc9007db632d8ce71fe01f00429732b3dad80.jpg
            domain === "img.yasmina.com" ||
            // https://s2.glbimg.com/OHrR1QoyTUJ2TZmqGkRumRkr0lQ=/540x304/top/smart/https://i.s3.glbimg.com/v1/AUTH_59edd422c0c84a879bd37670ae4f538a/internal_photos/bs/2018/T/0/N2V0VIRCKjVb81zquEMA/iceberg.jpg
            //   https://i.s3.glbimg.com/v1/AUTH_59edd422c0c84a879bd37670ae4f538a/internal_photos/bs/2018/T/0/N2V0VIRCKjVb81zquEMA/iceberg.jpg -- keeps loading
            //domain_nosub === "glbimg.com" ||
            // http://resize.abcradio.net.au/46VfqasBbN7ydth1Lt3R6jMlyqY=/100x100/center/middle/http://www.abc.net.au/triplej/albums/56918/covers/original.jpg
            //   http://www.abc.net.au/triplej/albums/56918/covers/original.jpg
            domain === "resize.abcradio.net.au" ||
            // http://th.pinkblog.it/fc6UonR3mdccWeikfHzJWGarjyQ=/fit-in/655x437/http://media.pinkblog.it/a/att/attrici-con-belle-gambe/20.jpg
            //   http://media.pinkblog.it/a/att/attrici-con-belle-gambe/20.jpg
            domain === "th.pinkblog.it" ||
            // http://th.blogosfere.it/plCtg4gdnF39TsBttt7YKsZbq-4=/fit-in/655x437/http://media-s3.blogosfere.it/styleandfashion/5/525/rihanna_red.jpg
            //   http://media-s3.blogosfere.it/styleandfashion/5/525/rihanna_red.jpg
            domain === "th.blogosfere.it" ||
            // http://th.fashionblog.it/zKoiw2TNqiEHlEeyzcp3EXepM18=/fit-in/655x437/http://media.fashionblog.it/6/620/rihanna-occhiali-dior-2.jpg
            //   http://media.fashionblog.it/6/620/rihanna-occhiali-dior-2.jpg
            domain === "th.fashionblog.it" ||
            // http://images.jovempanfm.uol.com.br/uxStmg4HPCcgXXvjwfGvutRAAgM=/0x420/top/media.jovempanfm.uol.com.br/archives/2015/10/13/1700269713-rihanna-estampa-capa-de-revista-e-comenta-sobre-racismo-isso-nunca-tem-fim.jpg
            //   http://media.jovempanfm.uol.com.br/archives/2015/10/13/1700269713-rihanna-estampa-capa-de-revista-e-comenta-sobre-racismo-isso-nunca-tem-fim.jpg
            domain === "images.jovempanfm.uol.com.br" ||
            // https://img.atyabtabkha.com/tAdkSxuvDctdbq1cdEqaL0dVc7g=/640x360/smart/http://harmony-assets-live.s3.amazonaws.com/image_source/31/35/31352be7d3b4eb37c687b43924647d69b824f232.jpg
            //   http://harmony-assets-live.s3.amazonaws.com/image_source/31/35/31352be7d3b4eb37c687b43924647d69b824f232.jpg
            domain === "img.atyabtabkha.com" ||
            // https://imageresizer.static9.net.au/O8cJcEACaHhMxDRZ4cBZ8S24CQc=/1396x785/http%3A%2F%2Fprod.static9.net.au%2F_%2Fmedia%2F2018%2F08%2F24%2F15%2F31%2F2408_jt_ENV.jpg
            //   http://prod.static9.net.au/_/media/2018/08/24/15/31/2408_jt_ENV.jpg
            domain === "imageresizer.static9.net.au" ||
            // https://img-ha.mthcdn.com/JvqkBfjJ5ffdeenRYJFr8wwNUq8=/300x375/picpost.mthai.com/pic/2017/02/2055783.jpg
            domain === "img-ha.mthcdn.com" ||
            // http://imagenes.milenio.com/PlgEwrqNd1MJG5_6x7VjGPQ4DFw=/0x530/smart/http://www.milenio.com/uploads/media/2018/06/19/luz-blanchet-juan-carlos-bautista.jpg
            //   http://www.milenio.com/uploads/media/2018/06/19/luz-blanchet-juan-carlos-bautista.jpg
            domain === "imagenes.milenio.com" ||
            // https://dyn.media.titanbooks.com/QhAZD6toTjeDw1071wW9x7nSAzs=/fit-in/600x600/https://media.titanbooks.com/catalog/products/asscreedodysjkt_8gPJPbE.jpg
            //   https://media.titanbooks.com/catalog/products/asscreedodysjkt_8gPJPbE.jpg
            domain_nowww === "dyn.media.titanbooks.com" ||
            src.match(/:\/\/[^/]*\/thumbor\/[^/]*=\//) ||
            src.match(/:\/\/[^/]*\/resizer\/[^/]*=\/[0-9]+x[0-9]+(?::[^/]*\/[0-9]+x[0-9]+)?\/(?:filters:[^/]*\/)?/)) {
            // https://cdn.vox-cdn.com/thumbor/ta2xdyUViVrBXCLGapdwLY7is_s=/0x0:3000x2355/1200x800/filters:focal(1116x773:1596x1253)/cdn.vox-cdn.com/uploads/chorus_image/image/55856727/815434448.0.jpg
            //   https://cdn.vox-cdn.com/uploads/chorus_image/image/55856727/815434448.0.jpg
            // https://cdn.vox-cdn.com/thumbor/dXu99BQwBagCavae7oYNG0uBfxQ=/0x46:1100x779/1200x800/filters:focal(0x46:1100x779)/cdn.vox-cdn.com/assets/1763547/Screenshot_2012.11.12_10.39.10.jpg
            // https://cdn.vox-cdn.com/thumbor/iTJF1PhWPiR3-LoITuXxS2u8su0=/1200x0/filters:no_upscale()/cdn.vox-cdn.com/uploads/chorus_asset/file/4998263/keenan_2010.0.jpg
            // https://dotesports-cdn-prod-tqgiyve.stackpathdns.com/thumbor/baiRf8sOE9flXNjU5cHytZ9fqwA=/1200x0/filters:no_upscale()/https://dotesports-cdn-prod-tqgiyve.stackpathdns.com/article/ee3f5018-0e8b-4e5f-b040-c466c8979315.png
            //   https://dotesports-cdn-prod-tqgiyve.stackpathdns.com/article/ee3f5018-0e8b-4e5f-b040-c466c8979315.png
            // https://www.armytimes.com/resizer/M5qc8PYkbDFYKpOg0Bt-5rxWMXE=/1200x0/filters:quality(100)/arc-anglerfish-arc2-prod-mco.s3.amazonaws.com/public/QRMIMUNV7ZDDJFOLI5FJSYZKQI.jpg
            //   http://arc-anglerfish-arc2-prod-mco.s3.amazonaws.com/public/QRMIMUNV7ZDDJFOLI5FJSYZKQI.jpg
            // http://www.latimes.com/resizer/S-IaQvJtBOga26puDEgDkHihCqE=/1400x0/arc-anglerfish-arc2-prod-tronc.s3.amazonaws.com/public/TQAY2PZTVBAQVBCFEMZRY57HSE.jpg
            //   http://arc-anglerfish-arc2-prod-tronc.s3.amazonaws.com/public/TQAY2PZTVBAQVBCFEMZRY57HSE.jpg
            // https://thumbnails.trvl-media.com/8ngGMfPTsqKt4MGmUrf-ErVrGm4=/a.travel-assets.com/mediavault.le/media/9eed34ce4955bc445d38357fa3eb076400431778.jpeg
            //   http://a.travel-assets.com/mediavault.le/media/9eed34ce4955bc445d38357fa3eb076400431778.jpeg
            // https://thumbnails.trvl-media.com/cPqnei5uS1AEzRn7k5XzNoUjFuo=/534x356/images.trvl-media.com/hotels/1000000/30000/22100/22046/22046_358_y.jpg
            // https://www.theglobeandmail.com/resizer/fyZn3o3OC1db2M-zd1Vkc0Z-O8I=/0x80:5738x3906/400x0/filters:quality(80)/arc-anglerfish-tgam-prod-tgam.s3.amazonaws.com/public/GVZVQCEPZFKPHG4UAE2AEI3PQU.jpg
            //   http://arc-anglerfish-tgam-prod-tgam.s3.amazonaws.com/public/GVZVQCEPZFKPHG4UAE2AEI3PQU.jpg
            // https://thumbor-static.factorymedia.com/qBeNkBSFgEWpq0AbpElby6YyNTs=/1920x1080/smart/http%3A%2F%2Fcoresites-cdn.factorymedia.com%2Fmpora_new%2Fwp-content%2Fuploads%2F2015%2F12%2FSea-Life-Aquariums-Animal-Captivity-Beluga-Whale.jpg
            //   http://coresites-cdn.factorymedia.com/mpora_new/wp-content/uploads/2015/12/Sea-Life-Aquariums-Animal-Captivity-Beluga-Whale.jpg
            //return src.replace(/.*\/thumbor\/.*?\/([^/]*\..*)/, "http://$1");
            newsrc = src.replace(/.*\/(?:thumb(?:or)?|(?:new-)?resizer)\/.*?\/(?:filters:[^/]*\/)?([a-z]*:\/\/.*)/, "$1");
            if (newsrc !== src)
                return newsrc;

            newsrc = src.replace(/.*\/(?:thumb(?:or)?|(?:new-)?resizer)\/.*?\/(?:filters:[^/]*\/)?([^/]*\..*)/, "http://$1");
            if (newsrc !== src)
                return newsrc;

            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/[-_A-Za-z0-9]{64}\/([^/]*\.[^/]*\/)/, "http://$1");
            if (newsrc !== src)
                return newsrc;

            newsrc = src.replace(/.*\/[-_A-Za-z0-9]+=\/(?:(?:full-)?fit-in\/)?(?:[0-9x:]+\/)?(?:[0-9x:]+\/)?(?:(?:smart|top|center|middle)\/)?(?:(?:smart|top|center|middle)\/)?(?:filters:[^/]*\/)?((?:https?:\/\/)?[^/]*\..*)/, "$1");
            if (newsrc.indexOf("http") !== 0) {
                newsrc = "http://" + newsrc;
            }

            if (newsrc.match(/^[a-z]*%3/))
                newsrc = decodeURIComponent(newsrc);
            return newsrc;
        }

        if (src.match(/:\/\/[^/]*\/astronaut\/uploads\/[a-z]_[^/]*$/)) {
            // http://zoodydesign.com/astronaut/uploads/m_dt8a0843-1.jpg
            // http://astronaut-project.com/astronaut/uploads/s_scenes-1.jpg
            // http://coffeemegane.com/astronaut/uploads/s_buttertoast3.jpg
            // m, s, t
            return src.replace(/\/[a-z]_([^/]*)$/, "/$1");
        }

        if (src.match(/\/spree\/images\/attachments\/[0-9]+\/[0-9]+\/[0-9]+\//) ||
            domain === "d3on60wtl1ot7i.cloudfront.net") {
            // https://static-assets.glossier.com/production/spree/images/attachments/000/001/802/square_tiny/1.jpg?1518217843
            //   https://static-assets.glossier.com/production/spree/images/attachments/000/001/802/original/1.jpg?1518217843
            // http://d3on60wtl1ot7i.cloudfront.net/system/topics/covers/000/000/122/medium/Sfondo-test-j-law.jpg?1460719638
            //   http://d3on60wtl1ot7i.cloudfront.net/system/topics/covers/000/000/122/big/Sfondo-test-j-law.jpg?1460719638
            return src.replace(/(\/[0-9]+\/[0-9]+\/[0-9]+\/)[^/]*\/([^/?]*)[^/]*?$/, "$1original/$2");
        }

        if (src.match(/\/applications\/core\/interface\/imageproxy\/imageproxy\.php/)) {
            // https://www.gfsquad.com/forums/applications/core/interface/imageproxy/imageproxy.php?img=http%3A%2F%2Fpds.joins.com%2Fnews%2Fcomponent%2Filgan_isplus%2F201701%2F13%2F2017011315392489300.jpeg&key=6b519f95396e21199c45a761bfe54fadbb09cf562c31b39591a14f25386ea26c
            //   http://pds.joins.com/news/component/ilgan_isplus/201701/13/2017011315392489300.jpeg
            return decodeURIComponent(src.replace(/.*\/imageproxy\/imageproxy\.php.*?[&?]img=([^&]*).*?$/, "$1"));
        }

        if (src.match(/\/dims[0-9]*\/.*?\/(?:(?:(?:thumbnail|resize)\/[0-9>%A-F]+[xX][0-9>%A-F]+[^/]*\/)|(?:crop\/[0-9]+[xX][0-9]+)).*?(?:\/https?:\/\/|\?url=https?%3A)/)) {
            // https://www.usnews.com/dims4/USNEWS/b09d13c/2147483647/thumbnail/970x647/quality/85/?url=http%3A%2F%2Fmedia.beam.usnews.com%2Fd0%2F686a3b584a63500605362dd3a1da31%2Ftag%3Areuters.com%2C2018%3Anewsml_LYNXNPEE25072%3A12018-03-06T044537Z_1_LYNXNPEE25072_RTROPTP_3_THAILAND-POLITICS.JPG
            // https://www.usnews.com/dims4/USNEWS/f128de1/2147483647/thumbnail/640x420/quality/85/?url=http%3A%2F%2Fmedia.beam.usnews.com%2Fbd%2F0cf00f10ccd3788e7b9a42f1717e9d%2Ftag%3Areuters.com%2C2018%3Anewsml_LYNXNPEE1R088%3A12018-02-28T035131Z_1_LYNXNPEE1R088_RTROPTP_3_NORTHKOREA-SOUTHKOREA.JPG
            // https://assets.sourcemedia.com/dims4/default/80669dd/2147483647/thumbnail/1200x630%3E/quality/90/?url=https%3A%2F%2Fassets.sourcemedia.com%2Fd9%2Fdf%2Fdf39cfb641848cd34eb997e96dc1%2Ffp-hockey-thumbnail-3-7-18.jpg
            // http://cdn.expansion.mx/dims4/default/5227468/2147483647/thumbnail/850x478%5E/quality/75/?url=https%3A%2F%2Fcdn.expansion.mx%2Fmedia%2F2010%2F06%2F08%2Fobreros-chinos-trabajadores-china.jpg
            // https://static.politico.com/dims4/default/cf5f5c0/2147483647/thumbnail/1160x629%5E/quality/90/?url=https%3A%2F%2Fstatic.politico.com%2F0f%2F99%2F94afe4ce45b9ab5aae5bab68ba12%2F23-donald-trump-145-gty-1160.jpg
            // https://cdn.peopleewnetwork.com/dims4/default/120c6ea/2147483647/thumbnail/1200x630/quality/90/?url=http%3A%2F%2Fpmd369713tn.download.theplatform.com.edgesuite.net%2FTime_Inc._-_OTT_-_Production%2F938%2F485%2Foscars-red-carpet-live-2018-thumbnail.jpg
            // https://d1nwosmzpc2sru.cloudfront.net/dims4/GG/54de7b9/2147483647/thumbnail/1350x580/quality/90/?url=https%3A%2F%2Fd1nwosmzpc2sru.cloudfront.net%2F27%2Fa8%2Ff64376a04a1babb29fe2f46c651c%2Fdp-bcg54217-online-store-generic-dl.png
            // http://cdn2.uvnimg.com/dims4/default/2fc4182/2147483647/thumbnail/400x250%3E/quality/75/?url=http%3A%2F%2Fcdn4.uvnimg.com%2F18%2F9e%2F0bc507aa44d6a563d06d223a647c%2Funtitled-1.jpg
            // https://cdn.video.nationalgeographic.com/dims4/default/8efd9cf/2147483647/thumbnail/354x199%3E/quality/90/?url=http%3A%2F%2Fcdn.video.nationalgeographic.com%2F6b%2F61%2F546ff7344acaac17399cd281fcef%2Fnw-seo-srt-013-nobel-prize-thumbnail-final.jpg
            //   http://cdn.video.nationalgeographic.com/6b/61/546ff7344acaac17399cd281fcef/nw-seo-srt-013-nobel-prize-thumbnail-final.jpg
            // https://mediadc.brightspotcdn.com/dims4/default/2a5e0c0/2147483647/strip/true/crop/2300x1302+0+16/resize/1060x600!/quality/90/?url=https%3A%2F%2Fmediadc.brightspotcdn.com%2F02%2F1d%2Fbbc21ecf48179b92cc23616443d3%2Fsun.jpg
            //   https://mediadc.brightspotcdn.com/02/1d/bbc21ecf48179b92cc23616443d3/sun.jpg
            // https://static.politico.com/dims4/default/b45191a/2147483647/resize/1160x%3E/quality/90/?url=https%3A%2F%2Fstatic.politico.com%2F85%2Fd5%2F3ffa5d764ae681f97ad70be2eecc%2F171205-mag-taylor-swift-ap-2-1160.jpg
            //   https://static.politico.com/85/d5/3ffa5d764ae681f97ad70be2eecc/171205-mag-taylor-swift-ap-2-1160.jpg
            //
            // https://d33ljpvc0tflz5.cloudfront.net/dims3/MMH/thumbnail/620x392/quality/75/?url=https%3A%2F%2Fd26ua9paks4zq.cloudfront.net%2F68%2F8d%2F197eef2a45cb84795efda4607102%2Fendoscopy-738x399-s1-stk-119373043.jpg
            //   https://d26ua9paks4zq.cloudfront.net/68/8d/197eef2a45cb84795efda4607102/endoscopy-738x399-s1-stk-119373043.jpg
            // http://o.aolcdn.com/dims-shared/dims3/MUSIC/thumbnail/280X390/quality/90/http://o.aolcdn.com/os/music/artist/wikipedia/the-platters-1970.jpg
            // http://o.aolcdn.com/dims-shared/dims3/MUSIC/thumbnail/280X390/http://o.aolcdn.com/os/music/artist/wikipedia/the-platters-1970.jpg
            //   http://o.aolcdn.com/os/music/artist/wikipedia/the-platters-1970.jpg
            // https://s.aolcdn.com/dims-shared/dims3/GLOB/crop/2039x3000+0+0/resize/630x927!/format/jpg/quality/85/https://s.aolcdn.com/hss/storage/midas/4d5ea3524916327c5b9a2d8b7b75dad6/205490598/cara-delevingne-attends-the-premiere-of-europacorp-and-stx-valerian-picture-id817090276
            //   https://s.aolcdn.com/hss/storage/midas/4d5ea3524916327c5b9a2d8b7b75dad6/205490598/cara-delevingne-attends-the-premiere-of-europacorp-and-stx-valerian-picture-id817090276
            newsrc = src.replace(/.*\/(?:thumbnail|crop|resize)\/.*?\/(https?:\/\/.*)/, "$1");
            if (newsrc !== src)
                return newsrc;
            newsrc = src.replace(/.*\/(?:thumbnail|crop|resize)\/.*?\/\?url=(https?.*)/, "$1");
            if (newsrc !== src)
                return decodeURIComponent(newsrc);
        }

        if (src.match(/\/dims\/CSFF\/[0-9]+\/[-0-9]+\/[-0-9]+\/[-0-9]+\/https?:\/\//)) {
            // https://o.aolcdn.com/dims/CSFF/1/90/-/75/http://wppd-images.web.aol.com/fotosrch/0/AFP_19J74A_GTY.jpg
            //   http://wppd-images.web.aol.com/fotosrch/0/AFP_19J74A_GTY.jpg
            newsrc = src.replace(/^[a-z]+:\/\/[^/]*\/dims\/CSFF\/[0-9]+\/[-0-9]+\/[-0-9]+\/[-0-9]+\/(https?:\/\/)/, "$1");
            if (newsrc !== src)
                return newsrc;
        }

        // joomla
        if (src.match(/\/media\/k2\/items\/cache\/[^/]*_[^/]*\.[^/.]*$/)) {
            // http://www.truth-out.org/media/k2/items/cache/3393b2ec8c305f926fd19b07e9a77e2a_L.jpg
            //   http://www.truth-out.org/media/k2/items/src/3393b2ec8c305f926fd19b07e9a77e2a.jpg
            // http://www.frankie.com.au/media/k2/items/cache/d3a6ffb9fa95acd07ae12a9b3648acf3_M.jpg
            //   http://www.frankie.com.au/media/k2/items/src/d3a6ffb9fa95acd07ae12a9b3648acf3.jpg
            return src.replace(/\/cache\/([^/]*)_[^/._]*?(\.[^/.]*)$/, "/src/$1$2");
        }

        // xenforo
        if (src.match(/:\/\/[^/]*\/proxy\.php.*?[?&]image=http/)) {
            return decodeURIComponent(src.replace(/.*:\/\/[^/]*\/proxy\.php.*?[?&]image=(http[^&]*).*/, "$1"));
        }

        // django-photologue
        if (src.match(/\/media\/photologue\/photos\/cache\//)) {
            // http://www.thewesternstar.com/media/photologue/photos/cache/EDM113447235_large.jpg
            //   http://www.thewesternstar.com/media/photologue/photos/EDM113447235.jpg
            // http://www.django-photologue.net/media/photologue/photos/cache/312960255_85e378833b_o_thumbnail.jpg
            //   http://www.django-photologue.net/media/photologue/photos/312960255_85e378833b_o.jpg
            return src.replace(/\/cache\/([^/]*)_[a-z]+(\.[^/.]*)$/, "/$1$2");
        }

        if (src.match(/\/\.evocache\/([^/]*\.[^/]*)\/fit-[0-9]+x[0-9]+\.[^/.]*$/)) {
            // http://look.onemonkey.org/.evocache/LondonBUR.png/fit-80x80.png
            return src.replace(/\/\.evocache\/([^/]*\.[^/]*)\/[^/]*$/, "/$1");
        }

        if (src.match(/:\/\/[^/]*\/yahoo_site_admin[0-9]*\/assets\/images\//)) {
            // http://www.asthedj.com/yahoo_site_admin2/assets/images/IMG_5618.13210131_large.JPG
            //   http://www.asthedj.com/yahoo_site_admin2/assets/images/IMG_5618.13210131.JPG
            // http://gio-ott.com/yahoo_site_admin2/assets/images/_MG_9380.20591513_large.jpg
            //   http://gio-ott.com/yahoo_site_admin2/assets/images/_MG_9380.20591513.jpg
            // http://www.spiritwalkministry.com/yahoo_site_admin2/assets/images/stonehenge-full-moon-night.27260345_std.jpg
            //   http://www.spiritwalkministry.com/yahoo_site_admin2/assets/images/stonehenge-full-moon-night.27260345.jpg
            // http://www.merrickartgallery.org/yahoo_site_admin2/assets/images/Merrick_Masters_Cover.12375349_std.jpg
            //   http://www.merrickartgallery.org/yahoo_site_admin2/assets/images/Merrick_Masters_Cover.12375349.jpg
            return src.replace(/(\.[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if (domain_nowww === "dvdprime.com" ||
            src.match(/\/data\/cheditor[0-9]*\/[0-9]+\/view_thumbnail\/[^/]*$/)) {
            // https://hiphopplaya.com/g2/data/cheditor5/1806/view_thumbnail/mania-done-20180621001609_mduiyalw.jpg
            //   https://hiphopplaya.com/g2/data/cheditor5/1806/mania-done-20180621001609_mduiyalw.jpg
            // https://dvdprime.com/g2/data/cheditor5/1806/view_thumbnail/mania-done-20180618175156_aftmezvl.jpg
            //   https://dvdprime.com/g2/data/cheditor5/1806/mania-done-20180618175156_aftmezvl.jpg
            // https://dvdprime.com/g2//data/file/comm/view_thumbnail/135924_201180154028029.jpg
            //   https://dvdprime.com/g2//data/file/comm/135924_201180154028029.jpg
            return src.replace(/\/view_thumbnail\/([^/]*)$/, "/$1");
        }

        if (src.match(/\/images\/easyblog_articles\/[0-9]+\/b2ap3_[^/]*$/)) {
            // http://veetbox.ru/images/easyblog_articles/1747/b2ap3_small_36.jpg
            //   http://veetbox.ru/images/easyblog_articles/1747/36.jpg
            // http://hcesd9.org/images/easyblog_articles/6/b2ap3_small_IMG_8444.JPG
            //   http://hcesd9.org/images/easyblog_articles/6/IMG_8444.JPG
            // large, medium, small, icon, thumbnail
            return src.replace(/\/b2ap3_[a-z]+_([^/]*)$/, "/$1");
        }

        if (src.match(/\/wp-content\/plugins\/BdSGallery\//)) {
            // https://blogdesuperheroes.es/wp-content/plugins/BdSGallery/BdSGaleria/69235_medium.jpg
            //   https://blogdesuperheroes.es/wp-content/plugins/BdSGallery/BdSGaleria/69235.jpg
            return src.replace(/(\/BdSGallery\/BdSGaleria\/[0-9]+)_[a-z]+(\.[^/.]*)$/, "$1$2");
        }

        if ((((domain_nosub === "fbcdn.net" &&
               domain.match(/^external\..*\.fbcdn\.net/)) ||
              // https://img.globuya.com/2/safe_image.php?d=AQCqGACH61FCb4Jm&url=http%3A%2F%2Fmtdata.ru%2Fu18%2Fphoto2F2D%2F20511034205-0%2Foriginal.jpg&_nc_hash=AQChQHo04N9q7EES
              //   http://mtdata.ru/u18/photo2F2D/20511034205-0/original.jpg
              domain === "img.globuya.com" ||
              // https://img.gluseum.com/2/safe_image.php?d=AQCxf7NZReZYk3Rh&url=https%3A%2F%2Fwww.army.mil%2Fe2%2Fc%2Fimages%2F2017%2F07%2F30%2F487195%2Fsize2.jpg&_nc_hash=AQA7FsCtw6bphTLG
              //   https://www.army.mil/e2/c/images/2017/07/30/487195/size2.jpg
              domain === "img.gluseum.com" ||
              // https://img.govserv.org/2/safe_image.php?d=AQCG0Wjodv3cqn93&url=https%3A%2F%2Fwww.army.mil%2Fe2%2Fc%2Fimages%2F2017%2F07%2F04%2F484198%2Fsize2.jpg&_nc_hash=AQCKXvmTRivEICKk
              //   https://www.army.mil/e2/c/images/2017/07/04/484198/size2.jpg
              domain === "img.govserv.org" ||
              // https://img.gleauty.com/2/safe_image.php?d=AQChuRdGJPcVKNPt&url=http%3A%2F%2Fstatic.ounousa.com%2Fcontent%2Fuploads%2FArticle%2F160914105046133.jpg&_nc_hash=AQDsb3aUh7VMOuHy
              //   http://static.ounousa.com/content/uploads/Article/160914105046133.jpg
              domain === "img.gleauty.com") || (
                  src.match(/^[a-z]+:\/\/[^/]*\/2\/safe_image\.php.*?[?&]url=http/)
              )) && src.indexOf("safe_image.php") >= 0) {
            // https://external.xx.fbcdn.net/safe_image.php?d=AQAWoxh_q3ft0f3S&w=130&h=130&url=https%3A%2F%2Fi2.wp.com%2Fblog.native-instruments.com%2Fwp-content%2Fuploads%2F2018%2F01%2Fnative-summit-at-namm-collaborating-on-the-future-of-sound-hero.jpg%3Ffit%3D1920%252C880%26ssl%3D1&cfs=1&sx=257&sy=0&sw=880&sh=880&_nc_hash=AQCDl7GN-wkuS3BX
            //   http://blog.native-instruments.com/wp-content/uploads/2018/01/native-summit-at-namm-collaborating-on-the-future-of-sound-hero.jpg
            // https://external.fyvr3-1.fna.fbcdn.net/safe_image.php?d=AQAReTYxnQTQOpsB&w=147&h=147&url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FxTo02rvrMXE%2Fhqdefault.jpg&cfs=1&upscale=1&fallback=news_d_placeholder_publisher&sx=120&sy=0&sw=360&sh=360&_nc_eui2=AeGEb7UCGGY2knZiITvwfUugt_JGWM192SmN_z8mNrwGcVY5H1PaPbuXuA21koF5ehdVgERy7WFFxu1GcWy4TKrhpVjj9d-tyHC8Jv-Qn3GT9A&_nc_hash=AQDxVA0hfYftm3Fv
            //   https://i.ytimg.com/vi/xTo02rvrMXE/hqdefault.jpg
            return decodeURIComponent(src.replace(/.*safe_image\.php.*?[?&]url=([^&]*).*/, "$1"));
        }

        // Storenvy
        if (src.match(/^[a-z]+:\/\/[^/]*\/product_photos\/[0-9]+\/[^/.]*_[^/.]*\.[^/.]*$/)) {
            // http://d2a2wjuuf1c30f.cloudfront.net/product_photos/52139630/2118646912_1845346882_original_original_medium.jpg
            //   http://d2a2wjuuf1c30f.cloudfront.net/product_photos/52139630/2118646912_1845346882_original_original_original.jpg
            // http://dlp2gfjvaz867.cloudfront.net/product_photos/62536200/file_e5a4ce5fa4_medium.jpg
            //   http://dlp2gfjvaz867.cloudfront.net/product_photos/62536200/file_e5a4ce5fa4_original.jpg
            return src.replace(/(\/product_photos\/[0-9]+\/[^/]*)_[^/._]*(\.[^/.]*)$/, "$1_original$2");
        }

        if (domain_nowww === "beckygworld.com" ||
            // http://mariahsworld.com/public/img/posts/photos/81_c8989ab5702aa4f3851726aae479eb20_l.jpg
            //   http://mariahsworld.com/public/img/posts/photos/81_c8989ab5702aa4f3851726aae479eb20.jpg
            domain_nowww === "mariahsworld.com" ||
            // http://nferaclub.com/public/img/posts/photos/11_2f0c94c62faa8007f9052d36a19725c5_l.jpg
            //   http://nferaclub.com/public/img/posts/photos/11_2f0c94c62faa8007f9052d36a19725c5.jpg
            domain_nowww === "nferaclub.com" ||
            // http://www.tdjakes.com/public/img/posts/photos/226_71724cada4d8cc8a13e5d6e61e2047c2_l.jpg
            //   http://www.tdjakes.com/public/img/posts/photos/226_71724cada4d8cc8a13e5d6e61e2047c2.jpg
            domain_nowww === "tdjakes.com" ||
            src.match(/^[a-z]+:\/\/[^/]*\/public\/img\/posts\/photos\/[0-9]+_[0-9a-f]+_[a-z]\.[^/.]*$/)) {
            // http://beckygworld.com/public/img/posts/photos/146_3f719931b900b94fd25153b75723ca63_l.jpg
            //   http://beckygworld.com/public/img/posts/photos/146_3f719931b900b94fd25153b75723ca63.jpg
            return src.replace(/(\/img\/posts\/photos\/[0-9]+_[0-9a-f]+)_[a-z](\.[^/.]*)$/, "$1$2");
        }

        if (src.match(/\/wp-content\/uploads\/(?:.*?\/)?nggallery\/(?:.*?\/)?dynamic\/[^/]*\.[^-_/.]*-nggid[0-9]+-ngg0dyn-[^/]*$/)) {
            // https://ojp8zqasz32qat8n13om56p4-wpengine.netdna-ssl.com/wp-content/uploads/sites/1/nggallery/billboard-music-awards-2018/dynamic/NUP_183094_0909.JPG-nggid0515516-ngg0dyn-100x150x100-00f0w010c011r110f110r010t010.JPG
            //   https://ojp8zqasz32qat8n13om56p4-wpengine.netdna-ssl.com/wp-content/uploads/sites/1/nggallery/billboard-music-awards-2018/NUP_183094_0909.JPG
            return src.replace(/\/dynamic(\/[^/]*\.[^-_/.]*)-[^/]*$/, "$1");
        }








        if (domain === "blogs-images.forbes.com" ||
            // http://images-origin.playboy.com/ogz4nxetbde6/3CJdCBvUEU2qaE6E00CYQU/a8277fb2808ea265a219036c150c4ffe/24_Dodger.jpg
            domain === "images-origin.playboy.com" ||
            // http://images.kpopstarz.com/data/images/full/87676/roy-kim-says-he-is-sorry-that-his-song-spring-spring-spring-bom-bom-bom-has-drawn-plagiarism-accusations.jpg
            domain === "images.kpopstarz.com" ||
            // https://etimg.etb2bimg.com/photo/62837430.cms
            domain === "etimg.etb2bimg.com" ||
            // http://feeds.thetimes.co.uk/web/imageserver/imageserver/image/methode%2Ftimes%2Fprod%2Fweb%2Fbin%2F851fb466-202d-11e7-ba28-54204ca551ca.jpg?crop=1500,844,0,38
            domain_nosub === "thetimes.co.uk" ||
            // http://images.contentful.com/l7es9q9kzr9z/KVC2bUAzyUkW6KaMgGkeA/2f45f07b331a60fc360ff8d641a29d7a/778_KimberlyMcArthur_15.jpg
            domain === "images.contentful.com") {
            return {
                url: src,
                head_wrong_contentlength: true
            };
        }

        if ((domain_nosub === "appspot.com" && domain.match(/^wixmp-[0-9a-f]+\./))) {
            // https://wixmp-ed30a86b8c4ca887773594c2.appspot.com/_api/download/file?downloadToken=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsImV4cCI6MTU0MTMwNDIwMSwiaWF0IjoxNTQxMzAzNTkxLCJqdGkiOiI1YmRlNmQzMTkzZjgzIiwib2JqIjpudWxsLCJhdWQiOlsidXJuOnNlcnZpY2U6ZmlsZS5kb3dubG9hZCJdLCJwYXlsb2FkIjp7InBhdGgiOiJcL2ZcL2JjMTFhNWJkLWM4NWEtNGUwNy1hODkwLWE4M2NlMjg2Y2ZlZVwvZGNxamJvbS01YjQyMzA4Yi0xODFjLTRiYjYtOTEwOC01Y2UzNTA4OTg2ZTQuanBnIn19.AoP-jqpFXSX1QmZ1fmrsKDKKU1dRZoNqVShSh5De92I
            return {
                url: src,
                head_wrong_contentlength: true,
                head_wrong_contenttype: true
            };
        }

        if (domain === "images.thestar.com" &&
            src.indexOf("/content/dam/") >= 0) {
            return {
                url: src,
                can_head: false
            };
        }

        if (domain_nosub === "radikal.ru" &&
            domain.match(/^s[0-9]*\./)) {
            // http://s018.radikal.ru/i521/1301/32/a24fb200297f.jpg
            return {
                url: src,
                headers: {
                    Referer: ""
                }
            };
        }










        if (options.null_if_no_change) {
            if (src !== origsrc)
                return src;
            return null;
        }

        return src;
    }
    // -- end bigimage --

    var fullurl_obj = function(currenturl, obj) {
        if (!obj)
            return obj;

        if (!(obj instanceof Array)) {
            obj = [obj];
        }

        var newobj = [];
        obj.forEach(function (url) {
            if (typeof(url) === "string") {
                newobj.push(fullurl(currenturl, url));
            } else {
                if (url.url) {
                    if (url.url instanceof Array) {
                        for (var i = 0; i < url.url.length; i++) {
                            url.url[i] = fullurl(currenturl, url.url[i]);
                        }
                    } else {
                        url.url = fullurl(currenturl, url.url);
                    }
                }
                newobj.push(url);
            }
        });

        return newobj;
    };

    var fillobj = function(obj, baseobj) {
        //if (typeof obj === "undefined")
        if (!obj)
            return [];

        if (!(obj instanceof Array)) {
            obj = [obj];
        }

        if (!baseobj)
            baseobj = {};

        if (baseobj instanceof Array)
            baseobj = baseobj[0];

        for (var i = 0; i < obj.length; i++) {
            if (typeof(obj[i]) === "undefined") {
                continue;
            }

            if (typeof(obj[i]) === "string") {
                obj[i] = {url: obj[i]};
            }

            var item;
            for (item in baseobj) {
                if (!(item in obj[i])) {
                    obj[i][item] = baseobj[item];
                }
            }

            for (item in default_object) {
                if (!(item in obj[i])) {
                    obj[i][item] = default_object[item];
                }
            }
        }

        return obj;
    };

    var same_url = function(url, obj) {
        obj = fillobj(obj);

        if (obj[0] && obj[0].url === url)
            return true;

        return false;

        for (var i = 0; i < obj.length; i++) {
            // handle !obj.url?
            if (obj[i].url === url)
                return true;
        }

        return false;
    };

    var bigimage_recursive = function(url, options) {
        if (!url)
            return url;

        if (!options)
            options = {};

        for (var option in default_options) {
            if (!(option in options)) {
                options[option] = default_options[option];
            }
        }

        if (is_userscript || is_extension) {
            for (var option in settings) {
                if (settings[option] && option in option_to_problems) {
                    options.exclude_problems.splice(options.exclude_problems.indexOf(option_to_problems[option]), 1);
                }
            }
        }

        var waiting = false;

        var newhref = url;
        var currenthref = url;
        var pasthrefs = [url];
        var lastobj = fillobj(newhref);
        var pastobjs = [];
        var currentobj = null;
        var used_cache = false;
        var i = 0;

        var do_cache = function() {
            if (!newhref || !currentobj)
                return;

            currenthref = get_currenthref(fillobj(newhref, currentobj));
            if (!used_cache && options.use_cache && !waiting) {
                for (var i = 0; i < pasthrefs.length; i++) {
                    var href = pasthrefs[i];

                    if (href !== currenthref || true)
                        url_cache[href] = newhref;
                }
            }
        };

        var get_currenthref = function(objified) {
            if (!objified) {
                return objified;
            }

            if (objified instanceof Array) {
                objified = objified[0];
            }

            if (!objified) {
                return objified;
            }

            if (objified.url instanceof Array)
                currenthref = objified.url[0];
            else
                currenthref = objified.url;
            return currenthref;
        };

        var parse_bigimage = function(big) {
            if (!big) {
                if (newhref === url && options.null_if_no_change)
                    newhref = big;
                return false;
            }

            var newhref1 = fullurl_obj(currenthref, big);
            if (!newhref1) {
                return false;
            }

            var objified = fillobj(deepcopy(newhref1));

            for (var i = 0; i < objified.length; i++) {
                var obj = objified[i];

                for (var problem in obj.problems) {
                    if (obj.problems[problem] &&
                        options.exclude_problems.indexOf(problem) >= 0) {
                        objified.splice(i, 1);
                        if (newhref1 instanceof Array) {
                            newhref1.splice(i, 1);
                        }

                        i--;
                    }
                }
            }

            if (objified.length === 0) {
                return false;
            }

            waiting = false;
            var temp_newhref1 = newhref1;
            if (newhref1 instanceof Array)
                temp_newhref1 = newhref1[0];
            if (typeof(temp_newhref1) === "object") {
                currentobj = newhref1;
                if (temp_newhref1.waiting) {
                    waiting = true;
                    if (!temp_newhref1.url) {
                        newhref = newhref1;
                        return false;
                    }
                }
            } else {
                currentobj = null;
            }

            if (same_url(currenthref, objified)) {
                return false;
            } else {
                currenthref = get_currenthref(objified);
                newhref = newhref1;
            }

            pasthrefs.push(currenthref);
            var current_pastobjs = [];
            for (var i = 0; i < objified.length; i++) {
                current_pastobjs.push(objified[i]);
            }

            for (var i = 0; i < pastobjs.length; i++) {
                current_pastobjs.push(pastobjs[i]);
            }

            pastobjs = current_pastobjs;

            if (!waiting)
                lastobj = newhref;

            if (_nir_debug_) {
                return false;
            }

            return true;
        };

        var do_bigimage = function() {
            if (options.use_cache && (currenthref in url_cache)) {
                newhref = url_cache[currenthref];
                used_cache = true;
                return false;
            }

            var big = bigimage(currenthref, options);

            return parse_bigimage(big);
        };

        var finalize = function() {
            if (options.fill_object) {
                newhref = fillobj(newhref, currentobj);

                if (options.include_pastobjs) {
                    for (var i = 0; i < pastobjs.length; i++) {
                        if (obj_indexOf(newhref, pastobjs[i].url) < 0)
                            newhref.push(pastobjs[i]);
                    }
                }
            }
        }

        var cb = null;
        if (options.cb) {
            var orig_cb = options.cb;
            options.cb = function(x) {
                var do_end = function() {
                    finalize();
                    do_cache();

                    var blankurl = null;
                    if (!options.null_if_no_change)
                        blankurl = pasthrefs[pasthrefs.length - 1];

                    if (!newhref || (newhref instanceof Array && !newhref[0])) {
                        newhref = blankurl;
                    } else if (typeof newhref === "string") {
                        newhref = blankurl;
                    } else if (newhref instanceof Array && typeof newhref[0] === "string") {
                        newhref[0] = blankurl;
                    } else if (newhref instanceof Array && newhref[0] && !newhref[0].url) {
                        newhref[0].url = blankurl;
                    }

                    orig_cb(newhref);
                };

                if (!parse_bigimage(x) || (i + 1) >= options.iterations) {
                    do_end();
                } else {
                    for (; i < options.iterations; i++) {
                        if (!do_bigimage()) {
                            break;
                        }
                    }

                    if (!waiting) {
                        do_end();
                    }
                }
            };
        }

        for (i = 0; i < options.iterations; i++) {
            if (!do_bigimage())
                break;
        }

        finalize();
        do_cache();

        if (options.cb && !waiting) {
            options.cb(newhref);
        }

        return newhref;
    };

    var obj_to_simplelist = function(obj) {
        var out = [];
        for (var i = 0; i < obj.length; i++) {
            out.push(obj[i].url);
        }
        return out;
    };

    var obj_indexOf = function(obj, url) {
        return obj_to_simplelist(obj).indexOf(url);
    };

    var bigimage_recursive_loop = function(url, options, query) {
        var newoptions = {};
        for (var option in options) {
            if (option === "cb") {
                newoptions.cb = function(obj) {
                    var images = obj_to_simplelist(obj);

                    query(obj, function(newurl, data) {
                        if (images.indexOf(newurl) < 0 && newurl !== url) {
                            bigimage_recursive_loop(newurl, options, query);
                        } else {
                            obj = [obj[images.indexOf(newurl)]];
                            options.cb(obj, data);
                        }
                    });
                };
            } else {
                newoptions[option] = options[option];
            }
        }
        return bigimage_recursive(url, newoptions);
    };

    var send_redirect = function(obj, cb) {
        if (is_extension) {
            extension_send_message({
                type: "redirect",
                data: obj
            }, function() {
                cb();
            });
        } else {
            cb();
        }
    }

    var redirect = function(url, obj) {
        if (_nir_debug_)
            return;

        if (url === document.location.href)
            return;

        // wrap in try/catch due to nano defender
        try {
            // avoid downloading more before redirecting
            window.stop();
        } catch (e) {
        }

        send_redirect(obj, function() {
            if (settings.redirect_history) {
                document.location = url;
            } else {
                window.location.replace(url);
            }
        });
    };

    var cursor_wait = function() {
        document.documentElement.style.cursor = "wait";
    };

    var cursor_default = function() {
        document.documentElement.style.cursor = "default";
    };


    var infobox_timer = null;
    var show_image_infobox = function(text) {
        var div = document.createElement("div");
        div.style.backgroundColor = "#fffabb";
        div.style.position = "absolute";
        div.style.top = "0px";
        div.style.left = "0px";
        div.style.padding = ".4em .8em";
        div.style.boxShadow = "0px 0px 20px rgba(0,0,0,.6)";
        div.style.margin = ".8em";

        div.innerHTML = text;

        div.onclick = function() {
            document.body.removeChild(div);

            if (infobox_timer) {
                clearTimeout(infobox_timer);
                infobox_timer = null;
            }
        };

        document.body.appendChild(div);

        var do_timeout = function() {
            if (infobox_timer)
                return;

            infobox_timer = setTimeout(function() {
                document.body.removeChild(div);
            }, 6000);
        };

        if (document.hasFocus()) {
            do_timeout();
        } else {
            document.onfocus = function() {
                do_timeout();
                document.onfocus = null;
            };

            window.onfocus = function() {
                do_timeout();
                window.onfocus = null;
            };
        }
    };

    var check_ok_error = function(ok_errors, error) {
        if (ok_errors && ok_errors instanceof Array) {
            for (var i = 0; i < ok_errors.length; i++) {
                if (error.toString() === ok_errors[i].toString()) {
                    return true;
                }
            }

            return false;
        }

        return null;
    }

    var check_image = function(obj, err_cb, ok_cb) {
        if (obj instanceof Array) {
            obj = obj[0];
        }

        if (!obj || !obj.url) {
            ok_cb(obj);
            return;
        }

        var url = obj.url;
        var err_txt;

        if (url === document.location.href) {
            ok_cb(url);
        } else  {
            var headers = obj.headers;
            console_log(obj.url);

            if (obj && obj.bad) {
                err_txt = "Bad image";
                if (err_cb) {
                    err_cb(err_txt);
                } else {
                    console_error(err_txt);
                }
                return;
            }

            var mouseover_text = function(reason) {
                var mouseover = settings.mouseover_trigger.join(", ");
                if (!settings.mouseover)
                    mouseover = "disabled";

                show_image_infobox("Mouseover (<a style='color:blue; font-weight:bold' href='" + options_page + "' target='_blank'>" + mouseover + "</a>) is needed to display the original version (" + reason + ")");
            };

            if (!_nir_debug_ || !_nir_debug_.no_request) {
                cursor_wait();

                var url_domain = url.replace(/^([a-z]+:\/\/[^/]*).*?$/, "$1");

                var origheaders = deepcopy(headers);

                var customheaders = true;
                if (!headers || Object.keys(headers).length === 0) {
                    customheaders = false;
                    headers = {
                        "Origin": url_domain,
                        "Referer": url
                    };
                } else if (!headers.Origin && !headers.origin) {
                    headers.Origin = url_domain;
                }

                if (customheaders && !is_extension) {
                    document.documentElement.style.cursor = "default";
                    console_log("Custom headers needed, currently unhandled");

                    mouseover_text("custom headers");
                    return;
                }

                if (_nir_debug_)
                    console.dir(headers);

                do_request({
                    method: 'HEAD',
                    url: url,
                    headers: headers,
                    onload: function(resp) {
                        if (_nir_debug_)
                            console.dir(resp);

                        // nano defender removes this.DONE
                        if (resp.readyState == 4) {
                            cursor_default();

                            if (resp.finalUrl === document.location.href) {
                                console_log(resp.finalUrl);
                                console_log("Same URL");
                                return;
                            }

                            var headers = {};
                            var headers_splitted = resp.responseHeaders.split("\n");
                            headers_splitted.forEach(function (header) {
                                header = header
                                    .replace(/^\s*/, "")
                                    .replace(/\s*$/, "");
                                var headername = header.replace(/^([^:]*?):\s*.*/, "$1");
                                var headerbody = header.replace(/^[^:]*?:\s*(.*)/, "$1");
                                headers[headername.toLowerCase()] = headerbody;
                            });

                            if (_nir_debug_)
                                console.dir(headers);


                            var digit = resp.status.toString()[0];

                            var ok_error = check_ok_error(obj.head_ok_errors, resp.status);

                            if (((digit === "4" || digit === "5") &&
                                 resp.status !== 405) &&
                                ok_error !== true) {
                                err_txt = "Error: " + resp.status;
                                if (err_cb) {
                                    err_cb(err_txt);
                                } else {
                                    console_error(err_txt);
                                }

                                return;
                            }

                            var content_type = headers["content-type"];
                            if (!content_type)
                                content_type = "";
                            content_type = content_type.toLowerCase();

                            if (content_type.match(/text\/html/) && !obj.head_wrong_contenttype &&
                                ok_error !== true) {
                                var err_txt = "Error: Not an image: " + content_type;
                                if (err_cb) {
                                    err_cb(err_txt);
                                } else {
                                    console_error(err_txt);
                                }

                                return;
                            }

                            if (!is_extension && (((content_type.match(/binary\//) ||
                                  content_type.match(/application\//)) && !obj.head_wrong_contenttype) ||
                                (headers["content-disposition"] &&
                                 headers["content-disposition"].toLowerCase().match(/^ *attachment/)))) {
                                console_error("Forces download");
                                mouseover_text("forces download");
                                return;
                            }

                            if (headers["content-length"] && headers["content-length"] == "0" && !obj.head_wrong_contentlength) {
                                console_error("Zero-length image");
                                return;
                            }

                            if (!customheaders || is_extension)
                                ok_cb(url);
                            else
                                console_log("Custom headers needed, currently unhandled");
                        }
                    }
                });
            }
        }
    };

    function do_export() {
        $$IMU_EXPORT$$ = bigimage_recursive;

        if (is_node) {
            module.exports = bigimage_recursive;
        } else if (is_scripttag) {
            imu_variable = bigimage_recursive;
        }
    }

    function do_redirect() {
        if (document.contentType.match(/^text\//)) {
            return;
        }

        cursor_wait();

        bigimage_recursive_loop(document.location.href, {
            fill_object: true,
            cb: function(newhref) {
                cursor_default();

                if (!newhref) {
                    return;
                }

                var newurl = newhref[0].url;

                if (newurl === document.location.href)
                    return;

                if (!newurl)
                    return;

                if (_nir_debug_)
                    console.dir(newhref);

                redirect(newurl, newhref);
            }
        }, function(newhref, finalcb) {
            if (_nir_debug_)
                console.dir(newhref);

            if (!newhref[0].can_head || newhref[0].always_ok) {
                var newurl = newhref[0].url;

                if (newurl === document.location.href) {
                    cursor_default();
                    return;
                }

                if (_nir_debug_) {
                    console_log("Not checking due to can_head == false || always_ok == true");
                }

                finalcb(newurl);
                return;
            }

            var index = 0;
            var cb = function(err_txt) {
                index++;
                if (index >= newhref.length) {
                    cursor_default();
                    console_error(err_txt);
                    return;
                }
                check_image(newhref[index], cb, finalcb);
            };
            check_image(newhref[0], cb, finalcb);
        });
    }

    function onload(cb) {
        if (document.readyState === "complete" ||
            document.readyState === "interactive") {
            cb();
        } else {
            var state_cb = function() {
                if (document.readyState === "complete" ||
                    document.readyState === "interactive") {
                    cb();

                    document.removeEventListener("readystatechange", state_cb);
                }
            };

            document.addEventListener("readystatechange", state_cb);
        }
    }

    function do_options() {
        var options_el = document.getElementById("options");

        if (!is_extension_options_page)
            options_el.innerHTML = "<h1>Options</h1>";
        else
            options_el.innerHTML = "";

        var saved_el = document.createElement("p");
        saved_el.innerHTML = "Saved!<br />Refresh the target page for changes to take effect";
        saved_el.id = "saved";
        saved_el.style.visibility = "hidden";
        saved_el.style.textAlign = "center";
        saved_el.style.paddingTop = "1em";
        saved_el.style.fontStyle = "italic";
        saved_el.style.color = "#0af";
        var saved_timeout = null;

        function check_disabled_options() {
            var options = options_el.querySelectorAll("div.option");

            for (var i = 0; i < options.length; i++) {
                var setting = options[i].id.replace(/^option_/, "");

                var meta = settings_meta[setting];
                if (meta.requires) {
                    // fixme: this only works for one option in meta.requires
                    for (var required_setting in meta.requires) {
                        var value = settings[required_setting];

                        if (value === meta.requires[required_setting]) {
                            options[i].classList.remove("disabled");

                            options[i].querySelectorAll("input").forEach((input) => {
                                input.disabled = false;
                            });
                        } else {
                            options[i].classList.add("disabled");

                            options[i].querySelectorAll("input").forEach((input) => {
                                input.disabled = true;
                            });
                        }
                    }
                }
            }
        }

        for (var setting in settings) {
            (function(setting) {
                var meta = settings_meta[setting];
                var value = settings[setting];
                var orig_value = orig_settings[setting];

                if (meta.userscript_only && !is_userscript)
                    return;

                if (meta.extension_only && !is_extension)
                    return;

                var option = document.createElement("div");
                option.classList.add("option");
                option.id = "option_" + setting;

                var table = document.createElement("table");
                table.style.border = "0";

                var tr = document.createElement("tr");
                table.appendChild(tr);

                var name = document.createElement("strong");
                name.innerText = meta.name;
                name.title = meta.description;

                var name_td = document.createElement("td");
                name_td.style.verticalAlign = "middle";
                name_td.classList.add("name_td");
                name_td.appendChild(name);
                tr.appendChild(name_td);

                var value_td = document.createElement("td");
                value_td.classList.add("value_td");

                var type = "options";
                var option_list = {};

                if (typeof orig_value === "boolean") {
                    type = "options";
                    option_list["true"] = {name: "Yes"};
                    option_list["false"] = {name: "No"};
                    if (value)
                        option_list["true"].checked = true;
                    else
                        option_list["false"].checked = true;
                } else if (meta.options) {
                    type = "options";
                    option_list = deepcopy(meta.options);

                    var check_optionlist = function(val, list) {
                        if (val in list) {
                            list[val].checked = true;
                        } else {
                            for (var item in list) {
                                if (item.match(/^_group/)) {
                                    check_optionlist(val, list[item]);
                                }
                            }
                        }
                    };

                    if (value instanceof Array) {
                        value.forEach(function (val) {
                            check_optionlist(val, option_list);
                        });
                    } else {
                        check_optionlist(value, option_list);
                    }
                } else if (meta.type) {
                    if (meta.type === "textarea")
                        type = "textarea";
                }

                if (type === "options") {
                    var option_type = option_list._type;
                    if (!option_type)
                        option_type = "or";

                    var add_setting = function(parent, op, val, option_type, group, group_type) {
                        var id = "input_" + setting + "_" + op;
                        var name = setting;
                        if (group && group_type === "and")
                            name += "_" + group;

                        var input = document.createElement("input");
                        if (option_type === "or" && false)
                            input.setAttribute("type", "radio");
                        else if (option_type === "and" || true)
                            input.setAttribute("type", "checkbox");
                        input.name = name;
                        input.value = op;
                        input.id = id;
                        if (val.checked)
                            input.setAttribute("checked", "true");

                        input.addEventListener("change", function(event) {
                            var value = this.value;

                            if (value === "true") {
                                value = true;
                            }

                            if (value === "false")
                                value = false;

                            if (this.checked) {
                                if (group && group_type === "or") {
                                    for (var child_i = 0; child_i < value_td.children.length; child_i++) {
                                        var child = value_td.children[child_i];
                                        if (child.id !== (setting + group)) {
                                            for (var subchild_i = 0; subchild_i < child.children.length; subchild_i++) {
                                                var subchild = child.children[subchild_i];
                                                if (subchild.tagName === "INPUT") {
                                                    subchild.checked = false;
                                                }
                                            }
                                        }
                                    }
                                }

                                if (option_type === "or") {
                                    for (var child_i = 0; child_i < parent.children.length; child_i++) {
                                        var child = parent.children[child_i];
                                        if (child.tagName === "INPUT" && child.id != input.id) {
                                            child.checked = false;
                                        }
                                    }
                                }
                            } else {
                                var onechecked = false;
                                for (var child_i = 0; child_i < value_td.children.length; child_i++) {
                                    var child = value_td.children[child_i];
                                    for (var subchild_i = 0; subchild_i < child.children.length; subchild_i++) {
                                        var subchild = child.children[subchild_i];
                                        if (subchild.tagName === "INPUT") {
                                            if (subchild.checked) {
                                                onechecked = true;
                                                break;
                                            }
                                        }
                                    }
                                    if (onechecked)
                                        break;
                                }

                                if (!onechecked) {
                                    this.checked = true;
                                }
                            }

                            var new_value = value;
                            if (group || option_type !== "or") {
                                var out_value = [];

                                var inputs = value_td.getElementsByTagName("input");
                                for (var child_i = 0; child_i < inputs.length; child_i++) {
                                    var child = inputs[child_i];
                                    if (child.checked) {
                                        out_value.push(child.value);
                                    }
                                }

                                new_value = out_value;
                                set_value(setting, new_value);
                            } else {
                                set_value(setting, value);
                            }

                            settings[setting] = new_value;
                            check_disabled_options();

                            saved_el.style.visibility = "visible";

                            if (saved_timeout)
                                clearTimeout(saved_timeout);

                            saved_timeout = setTimeout(function() {
                                saved_el.style.visibility = "hidden";
                            }, 5000);
                        });

                        parent.appendChild(input);

                        var label = document.createElement("label");
                        label.setAttribute("for", id);
                        label.innerText = val.name;

                        if (val.description)
                            label.title = val.description;

                        parent.appendChild(label);
                    }

                    for (var op in option_list) {
                        if (op.match(/^_group/)) {
                            var option_type1 = option_list[op]._type;
                            if (!option_type1)
                                option_type1 = "or";

                            var sub = document.createElement("div");
                            sub.classList.add("group");
                            sub.id = setting + op;
                            for (var op1 in option_list[op]) {
                                if (!op1.match(/^_/))
                                    add_setting(sub, op1, option_list[op][op1], option_type1, op, option_type);
                            }
                            value_td.appendChild(sub);
                        } else if (!op.match(/^_/)) {
                            add_setting(value_td, op, option_list[op], option_type);
                        }
                    }
                } else if (type === "textarea") {
                    var sub = document.createElement("table");
                    var sub_tr = document.createElement("tr");
                    var sub_ta_td = document.createElement("td");
                    sub_ta_td.style.verticalAlign = "middle";
                    sub_ta_td.style.height = "1px";
                    var sub_button_td = document.createElement("td");
                    sub_button_td.style.verticalAlign = "middle";
                    sub_button_td.style.height = "1px";
                    var textarea = document.createElement("textarea");
                    textarea.style.height = "5em";
                    textarea.style.width = "20em";
                    var savebutton = document.createElement("button");
                    savebutton.innerHTML = "Save";
                    savebutton.onclick = function() {
                        set_value(setting, textarea.value);
                        settings[setting] = textarea.value;
                    };

                    sub_ta_td.appendChild(textarea);
                    sub_button_td.appendChild(savebutton);
                    sub_tr.appendChild(sub_ta_td);
                    sub_tr.appendChild(sub_button_td);
                    sub.appendChild(sub_tr);

                    value_td.appendChild(sub);
                }

                tr.appendChild(value_td);

                option.appendChild(table);
                options_el.appendChild(option);
            })(setting);
        }

        check_disabled_options();

        options_el.appendChild(saved_el);
    }

    function parse_value(value) {
        try {
            return JSON_parse(value);
        } catch (e) {
            return value;
        }
    }

    function serialize_value(value) {
        return JSON_stringify(value);
    }

    function get_value(key, cb) {
        if (is_extension) {
            chrome.storage.sync.get([key], function(response) {
                cb(parse_value(response[key]));
            });
        } else if (typeof GM_getValue !== "undefined") {
            return cb(parse_value(GM_getValue(key, undefined)));
        } else if (typeof GM !== "undefined" && GM.getValue) {
            GM.getValue(key, undefined).then(function (value) {
                cb(parse_value(value));
            });
        }
    }

    function set_value(key, value) {
        value = serialize_value(value);
        console_log("Setting " + key + " = " + value);
        if (is_extension) {
            var kv = {};
            kv[key] = value;
            chrome.storage.sync.set(kv, function() {
            });
        } else if (typeof GM_setValue !== "undefined") {
            return GM_setValue(key, value);
        } else if (typeof GM !== "undefined" && GM.getValue) {
            return GM.setValue(key, value);
        }
    }

    function do_config() {
        if (is_userscript || is_extension) {
            var settings_done = 0;
            for (var setting in settings) {
                (function(setting) {
                    get_value(setting, function(value) {
                        settings_done++;
                        if (value !== undefined)
                            settings[setting] = value;
                        if (settings_done >= Object.keys(settings).length)
                            start();
                    });
                })(setting);
            }
        } else {
            start();
        }
    }

    function check_image_get(obj, cb, processing) {
        if (!obj || !obj[0]) {
            return cb(null);
        }

        if (!processing.running) {
            return cb(null);
        }

        var method = "GET";
        var responseType = "blob";

        if (processing.head) {
            method = "HEAD";
            responseType = undefined;
        }

        if (obj[0].url.match(/^data:/)) {
            var img = document.createElement("img");
            img.src = obj[0].url;
            img.onload = function() {
                cb(img, obj[0].url);
            };
            return;
        }

        function err_cb() {
            obj.shift();
            return check_image_get(obj, cb, processing);
        }

        var url = obj[0].url;

        console_log("Trying " + url);

        if (obj && obj.bad) {
            return err_cb();
        }

        var url_domain = url.replace(/^([a-z]+:\/\/[^/]*).*?$/, "$1");

        var headers = obj[0].headers;

        if (!headers || Object.keys(headers).length === 0) {
            headers = {
                "Origin": url_domain,
                "Referer": document.location.href
            };
        } else if (!headers.Origin && !headers.origin) {
            headers.Origin = url_domain;
        }

        do_request({
            method: method,
            url: url,
            responseType: responseType,
            headers: headers,
            onload: function(resp) {
                if (!processing.running) {
                    return cb(null);
                }

                if (resp.readyState == 4) {
                    var digit = resp.status.toString()[0];

                    var ok_error = check_ok_error(obj[0].head_ok_errors, resp.status);

                    if (((digit === "4" || digit === "5") &&
                         resp.status !== 405) && obj[0].can_head &&
                        ok_error !== true) {
                        if (err_cb) {
                            console_log("Bad status: " + resp.status + " ( " + url + " )");
                            err_cb();
                        } else {
                            console_error("Error: " + resp.status);
                        }

                        return;
                    }

                    if (processing.head) {
                        cb(resp, obj[0]);
                        return;
                    }

                    if (!resp.response) {
                        err_cb();
                        return;
                    }

                    var a = new FileReader();
                    a.onload = function(e) {
                        var img = document.createElement("img");
                        img.src = e.target.result;
                        img.onload = function() {
                            cb(img, resp.finalUrl, obj[0]);
                        };
                        img.onerror = function() {
                            err_cb();
                        };
                    };
                    a.readAsDataURL(resp.response);
                }
            }
        });
    }

    function do_mouseover() {
        var mouseX = 0;
        var mouseY = 0;

        var mouseAbsX = 0;
        var mouseAbsY = 0;

        var mouseDelayX = 0;
        var mouseDelayY = 0;

        var processing_list = [];
        var popups = [];
        var popups_active = false;
        var controlPressed = false;
        var waiting = false;

        var waitingel = null;
        var waitingsize = 200;

        var str_to_keycode = {
            shift: 16,
            ctrl: 17,
            alt: 19
        };

        var keycode_to_str = {
            16: "shift",
            17: "ctrl",
            18: "alt"
        };

        var current_chord = [];

        function resetifout(e) {
            // doesn't work, as e doesn't contain ctrlKey etc.
            if (!trigger_complete(e)) {
                //current_chord = [];
                stop_waiting();
                resetpopups();
            }
        }

        // runs on every focusout, not just window
        /*document.addEventListener("focusout", resetifout);
          document.addEventListener("blur", resetifout);
          unsafeWindow.addEventListener("focusout", resetifout);
          unsafeWindow.addEventListener("blur", resetifout);*/

        var disable_click = false;
        document.addEventListener("click", function(e) {
            if (disable_click) {
                e.stopPropagation();
                e.stopImmediatePropagation();
                return true;
            }
        }, true);

        var delay = false;
        var delay_handle = null;
        var delay_mouseonly = true;

        function update_waiting() {
            var x = mouseX;//mouseAbsX;
            var y = mouseY;//mouseAbsY;
            waitingel.style.left = (x - (waitingsize / 2)) + "px";
            waitingel.style.top = (y - (waitingsize / 2)) + "px";
        }

        function start_waiting() {
            if (!waitingel) {
                waitingel = document.createElement("div");
                waitingel.style.zIndex = Number.MAX_SAFE_INTEGER;
                waitingel.style.cursor = "wait";
                waitingel.style.width = waitingsize + "px";
                waitingel.style.height = waitingsize + "px";
                waitingel.style.position = "fixed";//"absolute";
                document.body.appendChild(waitingel);
            }

            waiting = true;
            waitingel.style.cursor = "wait";
            waitingel.style.display = "block";

            update_waiting();
        }

        function start_progress() {
            start_waiting();
            waitingel.style.cursor = "progress";
        }

        function stop_waiting() {
            if (waitingel)
                waitingel.style.display = "none";

            waiting = false;
        }

        function resetpopups() {
            popups.forEach(function (popup) {
                if (popup.parentNode)
                    popup.parentNode.removeChild(popup);

                var index = popups.indexOf(popup);
                if (index > -1) {
                    popups.splice(index, 1);
                }
            });

            disable_click = false;
            popups_active = false;

            if (!delay_mouseonly && delay_handle) {
                clearTimeout(delay_handle);
                delay_handle = null;
            }
        }

        function makePopup(obj, orig_url, processing, data) {
            var openb = get_single_setting("mouseover_open_behavior");
            if (openb === "newtab") {
                stop_waiting();

                var theobj = data.data.obj;
                theobj.url = data.data.resp.finalUrl;

                extension_send_message({
                    type: "newtab",
                    data: {
                        imu: theobj
                    }
                }, function() {
                    popups_active = true;
                });
                return;
            }

            //var x = mouseX;//mouseAbsX;
            //var y = mouseY;//mouseAbsY;
            var x = data.x;
            var y = data.y;

            function cb(img, url) {
                if (!controlPressed && false) {
                    if (processing.running)
                        stop_waiting();
                    return;
                }

                if (!img) {
                    if (processing.running)
                        stop_waiting();
                    return;
                }

                var estop = function(e) {
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    return true;
                };

                img.onclick = estop;
                img.onmousedown = estop;

                var div = document.createElement("div");
                //div.style.all = "initial";
                var styles = settings.mouseover_styles.replace("\n", ";");
                div.setAttribute("style", styles);
                if (!styles.match(/^\s*box-shadow\s*:/) &&
                    !styles.match(/;\s*box-shadow\s*:/)) {
                    div.style.boxShadow = "0 0 15px rgba(0,0,0,.5)";
                }

                div.style.position = "fixed"; // instagram has top: -...px
                div.style.zIndex = Number.MAX_SAFE_INTEGER;


                div.onclick = estop;
                div.onmousedown = estop;
                disable_click = true;


                var vw;
                var vh;

                if (window.visualViewport) {
                    vw = window.visualViewport.width;
                    vh = window.visualViewport.height;
                } else {
                    vw = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
                    vh = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
                }

                vw -= 10;
                vh -= 10;
                img.style.all = "initial";
                img.style.cursor = "pointer";
                img.style.maxWidth = vw + "px";
                img.style.maxHeight = vh + "px";

                var imgh = img.naturalHeight;
                var imgw = img.naturalWidth;

                if (imgh < 20 ||
                    imgw < 20) {
                    stop_waiting();
                    return;
                }

                if (imgh > vh ||
                    imgw > vw) {
                    var ratio;
                    if (imgh / vh >
                        imgw / vw) {
                        ratio = imgh / vh;
                    } else {
                        ratio = imgw / vw;
                    }

                    imgh /= ratio;
                    imgw /= ratio;
                }

                var sct = scrollTop();
                var scl = scrollLeft();
                sct = scl = 0;
                div.style.top = (sct + Math.min(Math.max((y - sct) - (imgh / 2), 5), Math.max(vh - imgh, 5))) + "px";
                div.style.left = (scl + Math.min(Math.max((x - scl) - (imgw / 2), 5), Math.max(vw - imgw, 5))) + "px";
                /*console_log(x - (imgw / 2));
                  console_log(vw);
                  console_log(imgw);
                  console_log(vw - imgw);*/


                var a = document.createElement("a");
                a.addEventListener("click", function(e) {
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    return true;
                }, true);
                a.style.all = "initial";
                a.style.cursor = "pointer";
                a.href = url;
                a.target = "_blank";
                a.appendChild(img);
                div.appendChild(a);
                document.body.appendChild(div);
                popups.push(div);

                stop_waiting();
                popups_active = true;
                //console_log(div);
            }

            cb(data.data.img, data.data.newurl);
            return;

            var newobj = deepcopy(obj);
            if (orig_url && obj_indexOf(orig_url) < 0) {
                newobj.push(fillobj(orig_url)[0]);
            }

            check_image_get(newobj, cb, processing);
        }

        function getUnit(unit) {
            if (unit.match(/^ *([0-9]+)px *$/)) {
                return unit.replace(/^ *([0-9]+)px *$/, "$1");
            }

            // https://github.com/tysonmatanich/getEmPixels/blob/master/getEmPixels.js
            var important = "!important;";
            var style = "position:absolute!important;visibility:hidden!important;width:" + unit + "!important;font-size:" + unit + "!important;padding:0!important";

            var extraBody;

            var unitel;
            if (!unitel) {
                // Emulate the documentElement to get rem value (documentElement does not work in IE6-7)
                unitel = extraBody = document.createElement("body");
                extraBody.style.cssText = "font-size:" + unit + "!important;";
                document.documentElement.insertBefore(extraBody, document.body);
            }

            // Create and style a test element
            var testElement = document.createElement("i");
            testElement.style.cssText = style;
            unitel.appendChild(testElement);

            // Get the client width of the test element
            var value = testElement.clientWidth;

            if (extraBody) {
                // Remove the extra body element
                document.documentElement.removeChild(extraBody);
            }
            else {
                // Remove the test element
                unitel.removeChild(testElement);
            }

            // Return the em value in pixels
            return value;
        }

        function find_source(els) {
            // resetpopups() is already called in trigger_popup()
            /*if (popups.length >= 1)
                return;*/

            //console_log(els);

            var sources = {};
            var picture_sources = {};
            var picture_minw = false;
            var picture_maxw = false;
            var picture_minh = false;
            var picture_maxh = false;

            var id = 0;
            var minW = 0;
            var minH = 0;
            var minMinW = 0;
            var minMinH = 0;
            var minMaxW = 0;
            var minMaxH = 0;
            var minX = 0;

            var thresh = 20;

            var source;

            function getsource() {
                var thesource = null;
                var first = false;
                for (var source in sources) {
                    if (first)
                        return;
                    first = true;
                    thesource = sources[source];
                }
                return thesource;
            }

            function getfirstsource(sources) {
                var smallestid = Number.MAX_SAFE_INTEGER;
                var thesource = null;
                for (var source_url in sources) {
                    var source = sources[source_url];
                    if (source.id < smallestid) {
                        smallestid = source.id;
                        thesource = sources[source_url];
                    }
                }

                return thesource;
            }

            function norm(src) {
                return urljoin(document.location.href, src, true);
            }

            function addImage(src, el, options) {
                // blank images
                // https://www.harpersbazaar.com/celebrity/red-carpet-dresses/g7565/selena-gomez-style-transformation/?slide=2
                var el_style = null;
                if (el) {
                    el_style = window.getComputedStyle(el);
                }

                if (src.match(/^data:/) && src.length <= 500 ||
                    // https://www.smugmug.com/
                    (el_style && (el_style.opacity === '0' ||
                                  el_style.visibility === "hidden")))
                    return false;

                if (!options) {
                    options = {};
                }

                if (!(src in sources)) {
                    sources[src] = {
                        count: 1,
                        src: src,
                        el: el,
                        id: id++
                    };

                    if (options.isbg)
                        sources[src].isbg = true;
                } else {
                    sources[src].count++;
                }

                return true;
            }

            function addTagElement(el) {
                if (el.tagName === "PICTURE") {
                    for (var i = 0; i < el.children.length; i++) {
                        addElement(el.children[i]);
                    }
                } else if (el.tagName === "SOURCE" || el.tagName === "IMG") {
                    if (el.src) {
                        var src = norm(el.src);
                        if (!addImage(src, el))
                            return;

                        sources[src].width = el.naturalWidth;
                        sources[src].height = el.naturalHeight;
                    }

                    if (!el.srcset)
                        return;

                    var ssources = el.srcset.split(/ +[^ ,/],/);

                    var sizes = [];
                    if (el.sizes) {
                        sizes = el.sizes.split(",");
                    }

                    for (var i = 0; i < ssources.length; i++) {
                        var src = norm(ssources[i].replace(/ .*/, ""));
                        var desc = ssources[i].replace(/.* /, "");

                        if (!addImage(src, el))
                            continue;

                        picture_sources[src] = sources[src];

                        sources[src].picture = el.parentElement;

                        if (desc) {
                            sources[src].desc = desc;

                            if (desc.match(/^ *[0-9]*x *$/)) {
                                var desc_x = parseInt(desc.replace(/^ *([0-9]*)x *$/, "$1"));
                                if (!sources[src].desc_x || sources[src].desc_x > desc_x) {
                                    sources[src].desc_x = desc_x;
                                }
                            }
                        }

                        if (el.media) {
                            sources[src].media = el.media;
                            if (el.media.match(/min-width: *([0-9]+)/)) {
                                picture_minw = true;
                                var minWidth = getUnit(el.media.replace(/.*min-width: *([0-9.a-z]+).*/, "$1"));
                                if (!sources[src].minWidth || sources[src].minWidth > minWidth)
                                    sources[src].minWidth = minWidth;
                            }

                            if (el.media.match(/max-width: *([0-9]+)/)) {
                                picture_maxw = true;
                                var maxWidth = getUnit(el.media.replace(/.*max-width: *([0-9.a-z]+).*/, "$1"));
                                if (!sources[src].maxWidth || sources[src].maxWidth > maxWidth)
                                    sources[src].maxWidth = maxWidth;
                            }

                            if (el.media.match(/min-height: *([0-9]+)/)) {
                                picture_minh = true;
                                var minHeight = getUnit(el.media.replace(/.*min-height: *([0-9.a-z]+).*/, "$1"));
                                if (!sources[src].minHeight || sources[src].minHeight > minHeight)
                                    sources[src].minHeight = minHeight;
                            }

                            if (el.media.match(/max-height: *([0-9]+)/)) {
                                picture_maxh = true;
                                var maxHeight = getUnit(el.media.replace(/.*max-height: *([0-9.a-z]+).*/, "$1"));
                                if (!sources[src].maxHeight || sources[src].maxHeight > maxHeight)
                                    sources[src].maxHeight = maxHeight;
                            }
                        }
                    }
                }
            }

            function addElement(el) {
                addTagElement(el);

                var style = window.getComputedStyle(el);
                if (style.getPropertyValue("background-image")) {
                    var bgimg = style.getPropertyValue("background-image");
                    if (bgimg.match(/^ *url[(]/)) {
                        // url('https://t00.deviantart.net/I94eYVLky718W9_zFjV-SJ-_qm8=/300x200/filters:fixed_height(100,100):origin()/pre00/abda/th/pre/i/2013/069/9/0/black_rock_shooter_by_mrtviolet-d5xktg7.jpg');
                        var src = norm(bgimg.replace(/^ *url[(](?:(?:'(.*?)')|(?:"(.*?)")|(?:([^)]*)))[)].*$/, "$1$2$3"));
                        if (src !== bgimg)
                            addImage(src, el, {
                                isbg: true
                            });
                    }
                }
            }

            // todo: do multiple passes, one per layer
            // would fix google+, with large backgrounds and small profile images

            for (var i = 0; i < els.length; i++) {
                var el = els[i];
                addElement(el);
            }

            /*console_log(els);
            console_log(sources);*/

            if ((source = getsource()) !== undefined)
                return source;

            // disable for now, fix later, for websites that don't work with imu
            if (false) {
                for (var source_url in sources) {
                    var source = sources[source_url];

                    if (source.width && source.width > minW)
                        minW = source.width;
                    if (source.height && source.height > minH)
                        minH = source.height;

                    if (source.minWidth && source.minWidth > minMinW)
                        minMinW = source.minWidth;
                    if (source.minHeight && source.minHeight > minMinH)
                        minMinH = source.minHeight;

                    if (source.maxWidth && source.maxWidth > minMaxW)
                        minMaxW = source.maxWidth;
                    if (source.maxHeight && source.maxHeight > minMaxH)
                        minMaxH = source.maxHeight;

                    if (source.desc_x && source.desc_x > minX)
                        minX = source.desc_x;
                }
            }

            var newsources = {};

            /*console_log(minW);
              console_log(minH);
              console_log(minMinW);
              console_log(minMinH);
              console_log(minMaxW);
              console_log(minMaxH);
              console_log(minX);*/

            /*if (minW <= thresh)
                minW = 0;

            if (minH <= thresh)
                minH = 0;

            if (minMinW <= thresh)
                minMinW = 0;

            if (minMinH <= thresh)
                minMinH = 0;

            if (minMaxW <= thresh)
                minMaxW = 0;

            if (minMaxH <= thresh)
            minMaxH = 0;*/

            for (var source_url in sources) {
                var source = sources[source_url];

                if (source.width && source.width < thresh ||
                    source.height && source.height < thresh)
                    continue;

                newsources[source_url] = source;
            }

            sources = newsources;
            newsources = {};

            if ((source = getsource()) !== undefined)
                return source;

            if ((minW !== 0 ||
                 minH !== 0 ||
                 minMinW !== 0 ||
                 minMinH !== 0 ||
                 minMaxW !== 0 ||
                 minMaxH !== 0 ||
                 minX !== 0) && false) {
                for (var source_url in sources) {
                    var source = sources[source_url];

                    if ((source.width && source.width > thresh && source.width >= minW) || (source.height && source.height > thresh && source.height >= minH))
                        newsources[source_url] = source;

                    if ((source.minWidth && source.minWidth > thresh && source.minWidth >= minMinW) || (source.minHeight && source.minHeight > thresh && source.minHeight >= minMinH))
                        newsources[source_url] = source;

                    if ((source.maxWidth && source.maxWidth > thresh && source.maxWidth >= minMaxW) || (source.maxHeight && source.maxHeight > thresh && source.maxHeight >= minMaxH))
                        newsources[source_url] = source;

                    if (source.desc_x && source.desc_x >= minX)
                        newsources[source_url] = source;

                    if (source.width === undefined &&
                        source.height === undefined &&
                        source.minWidth === undefined &&
                        source.minHeight === undefined &&
                        source.maxWidth === undefined &&
                        source.maxHeight === undefined)
                        newsources[source_url] = source;

                }

                //console_log(newsources);

                sources = newsources;
                newsources = {};

                if ((source = getsource()) !== undefined)
                    return source;

                for (var source_url in sources) {
                    var source = sources[source_url];

                    if (!source.picture) {
                        newsources[source_url] = source;
                        continue;
                    }

                    if (picture_minw && (!source.minWidth || source.minWidth < minMinW))
                        continue;

                    if (picture_minh && (!source.minHeight || source.minHeight < minMinW))
                        continue;

                    if (picture_maxw && (!source.maxWidth || source.maxWidth < minMaxW))
                        continue;

                    if (picture_maxh && (!source.maxHeight || source.maxHeight < minMaxW))
                        continue;

                    if (source.desc_x && source.desc_x < minX)
                        continue;

                    newsources[source_url] = source;
                }

                //console_log(newsources);

                sources = newsources;
                newsources = {};

                if ((source = getsource()) !== undefined)
                    return source;
            }

            for (var source_url in sources) {
                var source = sources[source_url];

                if (source_url.match(/^data:/))
                    continue;

                newsources[source_url] = source;
            }

            var orig_sources = sources;
            sources = newsources;
            newsources = {};

            //console_log(sources);

            if (source = getsource())
                return source;
            else if (source === null)
                return getfirstsource(orig_sources);


            // if there are background images ahead of an image, it's likely to be masks
            if (Object.keys(sources).length > 1 && sources[Object.keys(sources)[0]].isbg) {
                for (var source in sources) {
                    if(!sources[source].isbg)
                        return sources[source];
                }
            }


            for (var source_url in sources) {
                var source = sources[source_url];

                var source_url_imu = bigimage_recursive(source_url, {
                    fill_object: false,
                    use_cache: false,
                    do_request: function() {},
                    cb: function() {}
                });
                if (source_url_imu !== source_url)
                    newsources[source_url] = source;
            }

            var orig_sources = sources;
            sources = newsources;

            //console_log(sources);

            if (source = getsource())
                return source;
            else if (source === null)
                return getfirstsource(orig_sources);
            else
                return getfirstsource(sources);
        }

        function normalize_trigger() {
            if (!(settings.mouseover_trigger instanceof Array)) {
                settings.mouseover_trigger = [settings.mouseover_trigger];
            }
        }

        normalize_trigger();

        for (var i = 0; i < settings.mouseover_trigger.length; i++) {
            if (settings.mouseover_trigger[i].match(/^delay_[0-9]*/)) {
                delay = parseInt(settings.mouseover_trigger[i].replace(/^delay_([0-9]*)/, "$1"));
                break;
            } else {
                delay_mouseonly = false;
            }
        }

        function key_in_trigger(key) {
            if (!(key in keycode_to_str))
                return false;

            return settings.mouseover_trigger.indexOf(keycode_to_str[key]) >= 0;
        }

        function set_chord(key, value) {
            if (!key_in_trigger(key))
                return false;

            var str = keycode_to_str[key];

            if (value) {
                if (current_chord.indexOf(str) < 0) {
                    current_chord.push(str);
                }
            } else {
                if (current_chord.indexOf(str) >= 0) {
                    current_chord.splice(current_chord.indexOf(str), 1);
                }
            }

            return true;
        }

        function trigger_complete(e) {
            for (var i = 0; i < settings.mouseover_trigger.length; i++) {
                var key = settings.mouseover_trigger[i];

                /*if (current_chord.indexOf(key) < 0)
                    return false;*/

                if (key === "ctrl" && !e.ctrlKey)
                    return false;

                if (key === "shift" && !e.shiftKey)
                    return false;

                if (key === "alt" && !e.altKey)
                    return false;
            }

            return true;
        }

        function trigger_partially_complete(e) {
            for (var i = 0; i < settings.mouseover_trigger.length; i++) {
                var key = settings.mouseover_trigger[i];

                /*if (current_chord.indexOf(key) < 0)
                    return false;*/

                if (key === "ctrl" && e.ctrlKey)
                    return true;

                if (key === "shift" && e.shiftKey)
                    return true;

                if (key === "alt" && e.altKey)
                    return true;
            }

            return false;
        }

        function get_single_setting(setting) {
            if (settings[setting] instanceof Array)
                return settings[setting][0];
            return settings[setting];
        }

        function get_close_behavior() {
            return get_single_setting("mouseover_close_behavior");
        }

        function trigger_popup() {
            controlPressed = true;
            // todo: rewrite to use a manual method, in order to find pointer-events: none too
            var els = document.elementsFromPoint(mouseX, mouseY);

            var processing = {running: true};
            for (var i = 0; i < processing_list.length; i++) {
                processing_list[i].running = false;
            }
            processing_list = [processing];

            var source = find_source(els);
            if (source) {
                resetpopups();
                //console_log(source);

                var do_popup = function() {
                    start_waiting();

                    var x = mouseX;
                    var y = mouseY;

                    var realcb = function(source_imu, data) {
                        //console_log(source_imu);
                        makePopup(source_imu, source.src, processing, {
                            data: data,
                            x: x,
                            y: y
                        });
                    };

                    try {
                        bigimage_recursive_loop(source.src, {
                            fill_object: true,
                            host_url: document.location.href,
                            document: document,
                            window: window,
                            element: source.el,
                            cb: realcb
                        }, function(obj, finalcb) {
                            var newobj = deepcopy(obj);

                            if (source.src && obj_indexOf(newobj, source.src) < 0)
                                newobj.push(fillobj(source.src)[0]);

                            var openb = get_single_setting("mouseover_open_behavior");

                            if (openb === "newtab") {
                                processing.head = true;
                            }

                            check_image_get(newobj, function(img, newurl) {
                                var data = {img: img, newurl: newurl};
                                var newurl1 = newurl;

                                if (openb === "newtab") {
                                    data = {resp: img, obj: newurl};
                                    newurl1 = data.resp.finalUrl;
                                }

                                finalcb(newurl1, data);
                                return;
                                // why?
                                if (newurl == source.src) {
                                    realcb(obj, data);
                                } else {
                                    finalcb(newurl, data);
                                }
                            }, processing);
                        });
                    } catch (e) {
                        console_error(e);
                        // this doesn't work
                        makePopup(source.src);
                    }
                };

                if (delay && !delay_mouseonly) {
                    start_progress();
                    delay_handle = setTimeout(function() {
                        delay_handle = null;
                        do_popup();
                    }, delay * 1000);
                } else {
                    do_popup();
                }
            }
        }

        document.addEventListener('keydown', function(event) {
            if (set_chord(event.which, true)) {
                if (trigger_complete(event) && !popups_active) {
                    if (!delay_handle)
                        trigger_popup();
                }
            }
        });

        document.addEventListener('keyup', function(event) {
            var condition = set_chord(event.which);

            if (condition && get_close_behavior() === "all") {
                condition = !trigger_partially_complete(event);
            }

            if (condition) {
                controlPressed = false;
                stop_waiting();

                resetpopups();
            }

            // esc
            if (event.which === 27)
                resetpopups();
        });

        function scrollLeft() {
            var doc = document.documentElement;
            var body = document.body;
            return (doc && doc.scrollLeft || body && body.scrollLeft || 0) -
                (doc && doc.clientLeft || body && body.clientLeft || 0);
        }

        function scrollTop() {
            var doc = document.documentElement;
            var body = document.body;
            return (doc && doc.scrollTop || body && body.scrollTop || 0) -
                (doc && doc.clientTop || body && body.clientTop || 0);
        }

        document.addEventListener('mousemove', function(event) {
            // https://stackoverflow.com/a/7790764
            event = event || window.event;

            if (event.pageX === null && event.clientX !== null) {
                eventDoc = (event.target && event.target.ownerDocument) || document;
                doc = eventDoc.documentElement;
                body = eventDoc.body;

                event.pageX = event.clientX + scrollLeft();
                event.pageY = event.clientY + scrollTop();
            }

            mouseX = event.clientX;
            mouseY = event.clientY;

            mouseAbsX = event.pageX;
            mouseAbsY = event.pageY;

            if (waiting) {
                update_waiting();
            }

            if (delay !== false && typeof delay === "number" && delay_mouseonly) {
                if (delay_handle) {
                    clearTimeout(delay_handle);

                    if (waiting)
                        stop_waiting();

                    if (popups.length > 0) {
                        var jitter_threshx = 40;
                        var jitter_threshy = jitter_threshx;

                        var img = popups[0].getElementsByTagName("img")[0];
                        if (img) {
                            var w = Math.min(parseInt(img.style.maxWidth), img.naturalWidth);
                            var h = Math.min(parseInt(img.style.maxHeight), img.naturalHeight);

                            jitter_threshx = Math.min(Math.max(jitter_threshx, w / 3), img.naturalWidth);
                            jitter_threshy = Math.min(Math.max(jitter_threshy, h / 3), img.naturalHeight);
                        }

                        if (Math.abs(mouseX - mouseDelayX) > jitter_threshx ||
                            Math.abs(mouseY - mouseDelayY) > jitter_threshy) {
                            resetpopups();
                        }
                    }
                }

                if (popups.length === 0) {
                    mouseDelayX = mouseX;
                    mouseDelayY = mouseY;

                    delay_handle = setTimeout(trigger_popup, delay * 1000);
                }
            }
        });
    }

    function do_websitehome() {
        unsafeWindow.imu_variable = bigimage_recursive;
        unsafeWindow.imu_inject = 1;
        unsafeWindow.do_imu = function(url, cb) {
            return unsafeWindow.imu_variable(url, {
                fill_object: true,
                do_request: do_request,
                cb: cb
            });
        };

        var orig_set_max = unsafeWindow.set_max;
        unsafeWindow.set_max = function(obj) {
            if (!obj || !obj[0].url) {
                orig_set_max(obj);
                return;
            }

            var loop_url = function(obj, cb, options, lasturl) {
                check_image_get(obj, function(img, newurl) {
                    var finalurl = newurl;
                    if (!newurl && img && img.finalUrl) {
                        finalurl = img.finalUrl;
                    }

                    if (!finalurl) {
                        cb(img, newurl);
                        return;
                    }

                    if (obj_indexOf(obj, finalurl) < 0 &&
                        lasturl !== finalurl) {
                        bigimage_recursive(finalurl, {
                            fill_object: true,
                            do_request: do_request,
                            cb: function(obj) {
                                loop_url(obj, cb, options, finalurl);
                            }
                        });
                    } else {
                        cb(img, newurl);
                    }
                }, options);
            };

            if (settings.website_image) {
                loop_url(obj, function(img, url) {
                    if (!img) {
                        orig_set_max("broken");
                    } else {
                        orig_set_max([{url: url}]);
                        maximgel.src = img.src;
                    }
                }, {running: true});
            } else if (obj.can_head) {
                loop_url(obj, function(resp) {
                    if (!resp) {
                        orig_set_max("broken");
                    } else {
                        orig_set_max([{url: resp.finalUrl}]);
                    }
                }, {running: true, head: true});
            } else {
                orig_set_max(obj);
            }
        };
    }

    function start() {
        do_export();

        if (is_userscript || is_extension) {
            if (settings.redirect)
                do_redirect();

            if (document.location.href.match(/^https?:\/\/qsniyg\.github\.io\/maxurl\/options\.html/) ||
                document.location.href.match(/^file:\/\/.*\/maxurl\/site\/options\.html/) ||
                (is_extension && is_extension_options_page)) {
                onload(function() {
                    do_options();
                });
            }

            if (document.location.href.match(/^https?:\/\/qsniyg\.github\.io\/maxurl(\/|\/index\.html(?:[?#].*)?)?$/) ||
                document.location.href.match(/^file:\/\/.*\/maxurl\/site\/index\.html/)) {
                if (typeof(unsafeWindow) !== "undefined") {
                    onload(function() {
                        do_websitehome();
                    });
                }
            }

            if (settings.mouseover)
                do_mouseover();
        }
    }

    do_config();
})();
